(()=>{var Ri=Object.defineProperty;var Ci=(p,e,s)=>e in p?Ri(p,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[e]=s;var d=(p,e,s)=>(Ci(p,typeof e!="symbol"?e+"":e,s),s),je=(p,e,s)=>{if(!e.has(p))throw TypeError("Cannot "+s)};var i=(p,e,s)=>(je(p,e,"read from private field"),s?s.call(p):e.get(p)),r=(p,e,s)=>{if(e.has(p))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(p):e.set(p,s)},f=(p,e,s,t)=>(je(p,e,"write to private field"),t?t.call(p,s):e.set(p,s),s);var c=(p,e,s)=>(je(p,e,"access private method"),s);var b=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var k=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let s=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",s),100)};window.addEventListener("DOMContentLoaded",s)}}static getUniqueId(e="WUSE"){let s="_"+(e||"")+"_";for(var t;window.document.getElementById(t=s+(""+window.Math.random()).substring(2))!==null;);return t}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(e).filter(n=>n.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var ne,Ft,ke,u=class{static get EMPTY_ARRAY(){return i(this,ne)}static noop(){}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,s){return typeof e=="string"?e.split(s):new window.Array}static buildArray(e){return c(this,Ft,ke).call(this,new window.Array,e)}static buildObject(e){return c(this,Ft,ke).call(this,new window.Object,e)}static ensureFunction(e,s=()=>{}){return typeof e=="function"?e:s}static isOf(e,s){return e!=null&&(e.constructor===s||s!=null&&e.constructor.name===s.name)}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static isAssignedObject(e){return typeof e=="object"&&e!==null}static isAssignedArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"}static isNonEmptyArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"&&!!e.length}};ne=new WeakMap,Ft=new WeakSet,ke=function(e,s){return this.isOf(s,window.Function)&&s(e),e},r(u,Ft),r(u,ne,new window.Array);var re,R,Ke=class{static get UNKNOWN_ERROR(){return i(this,R).call(this,0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return i(this,R).call(this,1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return i(this,R).call(this,2,e=>`Unregistered class: ${e}.`)}static get UNREGISTRABLE_CLASS(){return i(this,R).call(this,3,e=>`Unregistrable class: ${e}.`)}static get INVALID_CLASS(){return i(this,R).call(this,4,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return i(this,R).call(this,5,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return i(this,R).call(this,10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return i(this,R).call(this,11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return i(this,R).call(this,12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return i(this,R).call(this,13,e=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return i(this,R).call(this,20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return i(this,R).call(this,21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return i(this,R).call(this,22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return i(this,R).call(this,30,e=>`Unespecified slot: #${e}.`)}},y=Ke;re=new WeakMap,R=new WeakMap,r(y,re,"[WUSE:ERROR]"),r(y,R,(e,s)=>({code:e,emit:t=>{let n=`${i(Ke,re)} ${e} | ${s(t)}`;if(Wuse.FATALS||e<10)throw new window.Error(n);return window.console.error(n),null}}));var _t,$t,Pt,jt,mt=class{constructor(e){d(this,"rounds",0);r(this,_t,0);r(this,$t,null);r(this,Pt,!1);r(this,jt,null);f(this,jt,typeof e=="function"?e:()=>{})}compute(e){return this.rounds+=+f(this,Pt,i(this,_t)==f(this,$t,i(this,jt).call(this,e))),f(this,_t,i(this,$t)),i(this,Pt)}};_t=new WeakMap,$t=new WeakMap,Pt=new WeakMap,jt=new WeakMap;var z,Kt,Be,kt=class{constructor(){r(this,Kt);r(this,z,new window.Object)}get length(){return c(this,Kt,Be).call(this).length}key(e){return c(this,Kt,Be).call(this)[e]||null}getItem(e){return i(this,z)[e]}setItem(e,s){i(this,z)[e]=s}removeItem(e){delete i(this,z)[e]}clear(){f(this,z,new window.Object)}hasItem(e){return i(this,z).hasOwnProperty(e)}};z=new WeakMap,Kt=new WeakSet,Be=function(){return window.Object.keys(i(this,z))};var at,K,Z,ae,Qe,wt=class{constructor(e,s){r(this,ae);r(this,at,null);r(this,K,null);r(this,Z,null);if(e instanceof Node&&s instanceof Node)f(this,at,e),f(this,K,s),f(this,Z,s.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return i(this,K)}affiliate(){i(this,at).appendChild(i(this,K))}disaffiliate(){i(this,at).removeChild(i(this,K))}promote(e){i(this,Z).innerHTML=e,i(this,at).replaceChild(i(this,Z),i(this,K)),c(this,ae,Qe).call(this)}};at=new WeakMap,K=new WeakMap,Z=new WeakMap,ae=new WeakSet,Qe=function(){let e=i(this,Z);f(this,Z,i(this,K).cloneNode(!1)),f(this,K,e)};var ot,ht,ct=class{constructor(e){d(this,"owner",null);r(this,ot,!1);r(this,ht,"");this.owner=e}get invalidated(){return i(this,ot)}reset(e){f(this,ot,!1),f(this,ht,e)}append(e){f(this,ht,i(this,ht)+e)}verify(e){f(this,ot,e(i(this,ht)))}process(){i(this,ot)&&this.on_content_invalidation(i(this,ht))}on_content_invalidation(e){}};ot=new WeakMap,ht=new WeakMap;var ue,ti,Ze,le,de,Et,oe=p=>p>1e3?(p/1e3).toFixed(2)+"s":p.toFixed(2)+"ms",he=class{constructor(){d(this,"round",0);d(this,"domTime",window.Number.MAX_SAFE_INTEGER);d(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=oe(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=oe(this.renderTime)),e}},ce=class{constructor(e){d(this,"name","");d(this,"rounds",0);d(this,"time",0);d(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=oe(this.time),s=oe(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:s}}},M=class{static initialize(e){typeof e=="function"&&f(M,Et,e),M.DOMUpdate.overall=new ce("overall-dom-update"),M.BrowserRender.overall=new ce("overall-browser-render")}},C=M;Et=new WeakMap,r(C,Et,()=>{}),d(C,"StopWatch",(Ze=class{constructor(){r(this,ue);d(this,"_begin",0);d(this,"_end",{dom:0,render:0});d(this,"rounds",0);d(this,"last",new he);d(this,"best",new he);d(this,"averages",{dom:0,render:0})}start(){(M.DOMUpdate.check||M.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var s;M.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,M.DOMUpdate.overall.compute(this.last.domTime)),M.BrowserRender.check?setTimeout(()=>c(this,ue,ti).bind(this)(e)):e&&i(s=M,Et).call(s,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},ue=new WeakSet,ti=function(e){var s;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,M.BrowserRender.overall.compute(this.last.renderTime),e&&i(s=M,Et).call(s,this,"finish")},Ze)),d(C,"DOMUpdate",(le=class{},d(le,"check",!0),d(le,"overall",null),le)),d(C,"BrowserRender",(de=class{},d(de,"check",!1),d(de,"overall",null),de));var gt,yt,At,St,bt,fe,si,pe,ni,me,ri,we,ai,{noop:Bt,ensureFunction:lt,isAssignedObject:ei,isAssignedArray:Qi,isNonEmptyArray:ii}=u,vi=p=>p.toLowerCase().replaceAll("_","-"),v=class{static registerClasses(e){ii(e)&&window.Array.prototype.forEach.call(e,s=>typeof s=="function"?c(this,pe,ni).call(this,s):i(this,At).call(this,s))}static instantiateClasses(e,s,t){ii(e)&&window.Array.prototype.forEach.call(e,n=>window.customElements.get(n.tag)?c(this,we,ai).call(this,n,s,ei(t)?t:new window.Object):i(this,bt).call(this,n.name))}static initialize(e){ei(e)&&(f(this,gt,lt(e.onDeferredInstantiation,i(this,gt))),f(this,At,lt(e.onInvalidClass,i(this,At))),f(this,yt,lt(e.onMisnamedClass,i(this,yt))),f(this,St,lt(e.onUnregistrableClass,i(this,St))),f(this,bt,lt(e.onUnregisteredClass,i(this,bt))))}};gt=new WeakMap,yt=new WeakMap,At=new WeakMap,St=new WeakMap,bt=new WeakMap,fe=new WeakSet,si=function(e){window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):i(this,St).call(this,e.name)},pe=new WeakSet,ni=function(e){e.name.indexOf("_")>0?(e.tag=vi(e.name),c(this,fe,si).call(this,e)):i(this,yt).call(this,e.name)},me=new WeakSet,ri=function(e,s,t){let n=null;try{n=window.document.querySelector(s)}catch(h){if(lt(t.onBadTarget)(s)===!1)return}finally{n=n||window.document.body}let o=window.document.createElement(e.tag);lt(t.onElementInstantiated)(o,s),n.appendChild(o)},we=new WeakSet,ai=function(e,s,t){let n=()=>c(this,me,ri).call(this,e,s,t);window.document.body?n():i(this,gt).call(this,n)},r(v,fe),r(v,pe),r(v,me),r(v,we),r(v,gt,Bt),r(v,yt,Bt),r(v,At,Bt),r(v,St,Bt),r(v,bt,Bt);var Tt,It,{noop:oi,ensureFunction:hi,isAssignedObject:Di}=u,tt=class{static fetch(e){let s=window.document.getElementById(e);return s===null?i(this,Tt).call(this,e):s.tagName!=="TEMPLATE"?i(this,It).call(this,e):s.innerHTML}static initialize(e){Di(e)&&(f(this,Tt,hi(e.onExtinctTemplate,i(this,Tt))),f(this,It,hi(e.onInvalidTemplate,i(this,It))))}};Tt=new WeakMap,It=new WeakMap,r(tt,Tt,oi),r(tt,It,oi);var Nt,{noop:Li,isOf:Mi,hasObjectKeys:ci,isNonEmptyString:li,isNonEmptyArray:Ui,isAssignedObject:xi,ensureFunction:Fi}=u,{htmlEncode:di}=k,{TEMPLATES_KIND:_i,TEXTNODE_TAG:$i}=b,Ee=class{static initialize(e){xi(e)&&f(this,Nt,Fi(e.onFetchTemplate,i(this,Nt)))}},A=Ee;Nt=new WeakMap,r(A,Nt,Li),d(A,"cacheInvalidator",e=>e.cache=null),d(A,"renderingIncluder",e=>e.rendering=!0),d(A,"renderingExcluder",e=>e.rendering=!1),d(A,"renderRule",(e,s)=>{if(Mi(s.nested,window.Array))return`${s.selector}{${s.nested.map(n=>Ee.renderRule(e,n)).join(`
`)}}`;if(li(s.selector)&&!s.nested){var t="";for(let n in s.properties)t+=`${n}:${s.properties[n]};`;return Ui(s.replacements)&&s.replacements.forEach(n=>t=e(t,n)),`${s.selector}{${t}}`}return null}),d(A,"renderChild",(e,s)=>{var o;if(s.kind===_i)return i(o=Ee,Nt).call(o,s.id);if(s.tag===$i){var t=s.content;return s.replacements.contents.forEach(h=>t=e(t,h)),s.encode?di(t):t}var n=li(s.id)?`<${s.tag} id='${s.id}'`:`<${s.tag}`;if(s.classes.length){var t=s.classes.join(" ");s.replacements.classes.forEach(l=>t=e(t,l)),n+=` class='${t}'`}if(ci(s.style)){var t=" style='";for(let l in s.style)t+=l+": "+s.style[l]+"; ";t+="'",s.replacements.styles.forEach(l=>t=e(t,l)),n+=t}if(ci(s.attributes)){var t="";for(let l in s.attributes)t+=` ${l}=${s.attributes[l]}`;s.replacements.attributes.forEach(l=>t=e(t,l)),n+=t}if(typeof s.content=="string"){var t=s.content;s.replacements.contents.forEach(l=>t=e(t,l)),n+=`>${s.encode?di(t):t}</${s.tag}>`}else n+="/>";return n});var Rt,ye,ui,be,et,fi,Te,pi,Ie,mi,Ne,wi,Oe,Ei,Ct,Ae,Re,Ge,gi,Gt,Ce,zt,_,ge,S,Ht,ve,ut,Vt,Wt,D,vt,Yt,Dt,it,P,O,I,B,E,Lt,H,V,st,G,W,Jt,ft,Y,nt,U,J,X,m,Mt,Xt,pt,j,q,dt,De,yi,Le,Ai,Me,Si,Ue,bi,rt,Ot,qt,ze,Qt,He,Zt,Ve,xe,Ti,te,We,Fe,Ii,ee,Ye,_e,Ni,L,F,ie,Je,Ut,$e,Oi,xt,Se,se,Xe,g,Pe,Q,x,a=class{static get VERSION(){return"0.3.9"}static blockUpdate(e,s){if(u.isOf(e,Function)){a.DEBUG&&a.debug("blocking"),a.RENDERING=!1;try{e(s)}catch(t){throw t}finally{a.RENDERING=!0,a.DEBUG&&a.debug("unblocking")}}}static debug(e){window.console.log("[WUSE:DEBUG]",e)}static register(e){return v.registerClasses(u.isOf(e,window.Array)?e:new window.Array(e))}static instantiate(e,s,t){return v.instantiateClasses(u.isOf(e,window.Array)?e:new window.Array(e),s,t)}static isShadowElement(e){let s=window.Object.getPrototypeOf(e.constructor);return s===a.OpenShadowElement||s===a.ClosedShadowElement}static get elementCount(){return i(a,x).instancesCount}static makeReactiveField(e,s,t,n,o){let h=(N,$)=>window.Object.defineProperty(e,s,{get:N,set:$,enumerable:!0,configurable:!0}),l=()=>delete e[s],w=(N,$)=>a.makeReactiveField(e,s,N,$,o);h(()=>t,N=>{w(N,n),u.isOf(n,window.Function)?n({renderize:$=>o(s,$),automate:()=>w(N,null),freeze:()=>h(()=>N,$=>{}),defreeze:()=>w(N,n),dereact:()=>h(()=>N,$=>{l(),e[s]=$}),remove:()=>l()}):o(s)})}},T=a;g=new WeakMap,Pe=new WeakMap,Q=new WeakMap,x=new WeakMap,d(T,"WebHelpers",k),d(T,"JsHelpers",u),d(T,"PerformanceMeasurement",C),d(T,"tmp",new window.Object),d(T,"DEBUG",!1),d(T,"FATALS",!1),d(T,"MEASURE",!1),d(T,"RENDERING",!0),r(T,g,(Gt=class{static makeStyleNode(e,s){var t=window.document.createElement("style");return u.isNonEmptyString(e)&&t.setAttribute("media",e),u.isNonEmptyString(s)&&t.setAttribute("type",s),t.appendChild(window.document.createTextNode("")),t}static newRule(e,s){let t=u.isOf(e,window.Array)?e.join(","):""+e;return t.length?{selector:t,properties:u.isOf(s,window.Object)?s:i(this,zt).parse(s),cache:null}:null}static newNestedRule(e,s,t){let n=u.isOf(e,window.Array)?e.join(","):""+e,o=u.isOf(s,window.Array)?s.join(","):""+s;return!n.length||!o.length?null:{selector:n,nested:[{selector:o,properties:u.isOf(t,window.Object)?t:i(this,zt).parse(t)}],cache:null}}static tryToJoinRules(e,s){if(e.selector===s.selector){for(let t in s.properties)e.properties[t]=s.properties[t];return e.cache=null,!0}return!1}static tryToJoinNestedRules(e,s){return u.isOf(e.nested,window.Array)&&e.selector===s.selector?(s.nested.forEach(t=>{var n=!1;for(let o in e.nested)if(n=e.nested[o].selector===t.selector){for(let h in t.properties)e.nested[o].properties[h]=t.properties[h];break}n||e.nested.push(t)}),e.cache=null,!0):!1}static makeMainNode(e){var s=window.document.createElement(e.tag);if(e.id.length&&s.setAttribute("id",e.id),e.classes.length&&s.setAttribute("class",e.classes.join(" ")),u.hasObjectKeys(e.style)){var t="";for(let n in e.style)t+=n+": "+e.style[n]+"; ";if(t.length){let n=t.trim();s.setAttribute("style",n.endsWith(";")?n.slice(0,-1):n)}}if(u.hasObjectKeys(e.attributes))for(let n in e.attributes)s.setAttribute(n,e.attributes[n]);return s}static newEvent(e,s){return typeof e=="string"&&typeof s=="boolean"?{kind:e,capture:s}:null}static performValidations(e){if(e.kind===b.TEMPLATES_KIND){if(!window.document.getElementById(e.id))return y.INEXISTENT_TEMPLATE.emit(e.id)}else if(e.kind===b.SLOTS_KIND){if(new String(e.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return y.UNESPECIFIED_SLOT.emit(e.id)}else if(typeof e.id!="string"||e.id!==""&&window.document.getElementById(e.id)!==null)return y.INVALID_ID.emit(e.id);return e}static newChild(e,s){var t=i(this,Ce).parse(e.trimLeft());return t?(t.rules=u.isOf(s,window.Array)?s:new window.Array,t.rendering=!0,t.cache=null,t):y.INVALID_DEFINITION.emit(e)}static newDefinition(){return{kind:b.DEFAULT_KIND,tag:b.DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},Ce=new WeakMap,zt=new WeakMap,d(Gt,"PartsHolder",(ui=class extends window.Array{constructor(s){super();r(this,Rt);d(this,"owner",null);d(this,"last",null);d(this,"version",0);this.owner=s}append(s){u.isOf(s,window.Object)&&(this.push(s),c(this,Rt,ye).call(this,s))}prepend(s){u.isOf(s,window.Object)&&(this.unshift(s),c(this,Rt,ye).call(this,s))}replace(s,t){s>-1&&u.isOf(t,window.Object)&&c(this,Rt,ye).call(this,this[s]=t)}on_version_change(){}persist(){let s=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":s[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let n=window.Object.assign(new window.Object,this[t]);n.cache&&(n.cache=null),s.push(n)}break}}),s}restore(s){window.Object.getOwnPropertyNames(s).forEach(t=>{switch(t){case"length":break;case"version":this[t]=s[t];break;default:if(window.Number.isInteger(Number(t))){let n=window.Object.assign(new window.Object,s[t]);n.cache&&(n.cache=null),this.push(n)}break}})}},Rt=new WeakSet,ye=function(s){this.last=s,this.version++,this.on_version_change()},ui)),r(Gt,Ce,(et=class{static parse(e){if(u.isNonEmptyString(e)){var s=i(a,g).newDefinition();return e.charAt(0)==="%"?e.startsWith(b.TEMPLATES_KIND)?c(this,Ct,Ae).call(this,s,e.replace(s.kind=b.TEMPLATES_KIND,"")):e.startsWith(b.SLOTS_KIND)?c(this,Ct,Ae).call(this,s,e.replace(s.kind=b.SLOTS_KIND,"")):null:c(this,Ct,Ae).call(this,s,e)}return null}},be=new WeakSet,fi=function(e,s){let t=s.indexOf("["),n=s.indexOf("]");if(t>-1&&n>-1&&n>t){let h=s.substr(t,n-t+1),l=h.substr(1,h.length-2).split("|");for(var o in l){let w=l[o].split("=");w[0]==="style"?w[1].split(";").forEach(N=>{let $=N.split(":"),qe=$[0].trim();qe.length&&(e.style[qe]=$[1].trim())}):e.attributes[w[0]]=w[1]}return s.replace(h,"")}return s},Te=new WeakSet,pi=function(e,s){let t=s.indexOf("=");return t>-1?(e.content=s.slice(t+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),s.slice(0,t)):s},Ie=new WeakSet,mi=function(e,s){let t=s.replaceAll("!"," ").split(" ");return t.slice(1).map(n=>{let[o,...h]=n.toLowerCase().split("+"),l=(h||u.EMPTY_ARRAY).indexOf("capture")>-1;e.events.push(i(a,g).newEvent(o,l))}),t[0]},Ne=new WeakSet,wi=function(e,s){let t=s.replaceAll("."," ").split(" ");return e.classes=t.slice(1),t[0]},Oe=new WeakSet,Ei=function(e,s){if(s!==""){let t=s.indexOf("#");t===-1?e.tag=s:(t>0&&(e.tag=s.substr(0,t)),e.id=s.substr(t+1))}return e},Ct=new WeakSet,Ae=function(e,s){return c(this,Oe,Ei).call(this,e,c(this,Ne,wi).call(this,e,c(this,Ie,mi).call(this,e,c(this,Te,pi).call(this,e,c(this,be,fi).call(this,e,s)))))},r(et,be),r(et,Te),r(et,Ie),r(et,Ne),r(et,Oe),r(et,Ct),et)),r(Gt,zt,(Ge=class{static parse(e){let s=new window.Object;return(u.isOf(e,window.Array)?e:u.forcedStringSplit(e,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>u.isNonEmptyString(t)&&c(this,Re,gi).call(this,s,t.trim())),s}},Re=new WeakSet,gi=function(e,s){if(!!s.length&&s.indexOf(":")>-1){let[t,...n]=s.split(":"),o=t.trim();if(o.length){let h=n.join(":").trim();e[o]=h.endsWith(";")?h.slice(0,-1):h}}},r(Ge,Re),Ge)),Gt)),r(T,Pe,new kt),d(T,"hashRoutine",e=>{var s=0;for(let t=0;t<e.length;t++)s=(s=(s<<5)-s+e.charCodeAt(t))&s;return s}),r(T,Q,(D=class{static initialize(s,t){i(this,vt).initialize(s,t),i(this,Dt).initialize(i(this,vt).makeRegExp())}},vt=new WeakMap,Yt=new WeakMap,Dt=new WeakMap,r(D,vt,(_=class{static initialize(t,n){this.begin=t,this.end=n}},d(_,"begin",null),d(_,"end",null),d(_,"enclose",t=>_.begin+t+_.end),d(_,"makeRegExp",()=>new window.RegExp("(?<="+_.begin+").*?(?="+_.end+")","gs")),_)),r(D,Yt,(ge=class{},d(ge,"rules",(s,t)=>u.buildArray(n=>s.forEach(o=>o.replacements.forEach(h=>h.field===t&&n.push(o))))),d(ge,"children",(s,t)=>u.buildArray(n=>{let o=h=>{let l=w=>w.forEach(N=>N.field===t&&n.push(h));["contents","classes","styles","attributes"].forEach(w=>l(h.replacements[w])),h.rules.forEach(w=>w.replacements.forEach(N=>N.field===t&&n.push(h)))};s.forEach(h=>h.rendering&&o(h))})),ge)),r(D,Dt,(S=class{static initialize(t){f(this,Ht,t)}},Ht=new WeakMap,ve=new WeakMap,ut=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,r(S,Ht,null),r(S,ve,(t,n,o)=>t.push({at:n,field:o.trim(),find:i(i(a,Q),vt).enclose(o)})),r(S,ut,(t,n,o)=>u.isNonEmptyString(o)&&(o.match(i(S,Ht))||u.EMPTY_ARRAY).forEach(h=>{var l;return i(l=S,ve).call(l,t,n,h)})),r(S,Vt,(t,n,o)=>{var h;t[n]=new window.Array,i(h=S,ut).call(h,t[n],n,o)}),r(S,Wt,(t,n,o)=>{t[n]=new window.Array,window.Object.keys(o).forEach(h=>{var l,w;i(l=S,ut).call(l,t[n],n,h),i(w=S,ut).call(w,t[n],n,o[h])})}),d(S,"child",t=>u.buildObject(n=>{var o,h,l,w;i(o=S,Vt).call(o,n,"contents",t.content),i(h=S,Vt).call(h,n,"classes",t.classes.join(" ")),i(l=S,Wt).call(l,n,"styles",t.style),i(w=S,Wt).call(w,n,"attributes",t.attributes),t.rules.forEach(N=>N.replacements=S.rule(N))})),d(S,"rule",t=>u.buildArray(n=>{var h;if(u.isOf(t.nested,window.Array))return t.nested.map(l=>S.rule(l));var o="";for(let l in t.properties)o+=l+":"+t.properties[l]+";";i(h=S,ut).call(h,n,"rules",o)})),S)),d(D,"extractReplacementsFromRule",i(D,Dt).rule),d(D,"extractReplacementsFromChild",i(D,Dt).child),d(D,"scanRulesForReplacements",i(D,Yt).rules),d(D,"scanChildrenForReplacements",i(D,Yt).children),D)),r(T,x,(it=class extends window.HTMLElement{constructor(t){super();r(this,q);r(this,De);r(this,Le);r(this,Me);r(this,Ue);r(this,rt);r(this,qt);r(this,Qt);r(this,Zt);r(this,xe);r(this,te);r(this,Fe);r(this,ee);r(this,_e);r(this,L);r(this,ie);r(this,$e);r(this,xt);r(this,se);r(this,P,"");r(this,O,new class extends i(a,g).PartsHolder{on_version_change(){var t;this.last.version=this.version,this.last.replacements=i(a,Q).extractReplacementsFromRule(this.last),a.DEBUG&&c(t=this.owner,q,dt).call(t,`rules list version change: ${this.version}`)}}(this));r(this,I,new class extends i(a,g).PartsHolder{on_version_change(){var t,n;this.last.version=this.version,this.last.replacements=i(a,Q).extractReplacementsFromChild(this.last),f(t=this.owner,V,i(t,V)|this.last.kind===b.SLOTS_KIND),a.DEBUG&&c(n=this.owner,q,dt).call(n,`children list version change: ${this.version}`)}}(this));r(this,B,new class extends i(a,g).PartsHolder{on_version_change(){var t;a.DEBUG&&c(t=this.owner,q,dt).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));r(this,E,{mainDefinition:i(a,g).newDefinition(),styleMedia:b.DEFAULT_STYLE_MEDIA,styleType:b.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});r(this,Lt,new window.Object);r(this,H,!1);r(this,V,!1);r(this,st,void 0);r(this,G,void 0);r(this,W,null);r(this,Jt,a.isShadowElement(this));r(this,ft,!1);r(this,Y,!1);r(this,nt,i(a,Pe));r(this,U,null);r(this,J,"");r(this,X,!1);r(this,m,{root:new class extends ct{on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends ct{on_content_invalidation(t){i(this.owner,G).promote(t)}}(this),main:new class extends ct{on_content_invalidation(t){i(this.owner,st).promote(t)}}(this),renderizers:{rule:t=>i(this,m).style.append(t.cache?t.cache:t.cache=A.renderRule(i(this,Mt),t)),children:{mixed:t=>i(this,Jt)&&t.kind===b.SLOTS_KIND?i(this,m).renderizers.children.slot(t):i(this,m).renderizers.children.normal(t),slot:t=>{t.cache||(i(this,m).root.verify(n=>!0),i(this,m).root.append(t.cache=A.renderChild(i(this,Mt),t)))},normal:t=>{i(this,m).main.append(t.cache?t.cache:t.cache=A.renderChild(i(this,Mt),t)),t.rules.forEach(i(this,m).renderizers.rule)}}},gotModified:()=>i(this,m).root.invalidated||i(this,m).main.invalidated||i(this,m).style.invalidated,getDebugInfo:()=>`updated (root: ${i(this,m).root.invalidated}, main: ${i(this,m).main.invalidated}, style: ${i(this,m).style.invalidated})`});r(this,Mt,(t,n)=>t.replace(n.find,this[n.field]!==void 0?this[n.field]:""));r(this,Xt,{bind:{key:()=>{let t=n=>{u.isNonEmptyString(n)&&(this[n]=c(this,qt,ze).call(this,n))};return i(this,H)&&t(i(this,E).mainDefinition.id),n=>t(n.id)},event:"addEventListener"},unbind:{key:()=>{let t=n=>delete this[n];return i(this,H)&&t(i(this,E).mainDefinition.id),n=>t(n.id)},event:"removeEventListener"}});r(this,pt,{main:new mt(a.hashRoutine),style:new mt(a.hashRoutine)});r(this,j,{attachment:new C.StopWatch,partial:new C.StopWatch,full:new C.StopWatch,dettachment:new C.StopWatch});r(this,Ut,()=>i(a,x).EVENT_NAMES.forEach(t=>i(this,Lt)[t]=typeof this[t]=="function"));d(this,"info",{instanceNumber:++i(a,x).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,W,t!==i(a,x).RootMode.REGULAR?this.attachShadow({mode:t}):this),i(this,Ut).call(this),c(this,L,F).call(this,"on_create"),i(this,E).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),c(this,$e,Oi).call(this)&&i(this,U).generation>1?c(this,L,F).call(this,"on_reconstruct",i(this,U)):c(this,L,F).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return i(this,Y)?c(this,xe,Ti):u.noop}get redraw(){return i(this,Y)?c(this,Fe,Ii):u.noop}connectedCallback(){a.MEASURE&&i(this,j).attachment.start(),i(this,Ut).call(this),c(this,L,F).call(this,"on_connect"),c(this,te,We).call(this,"on_load"),i(this,X)&&this.persistToElementsStore(),a.MEASURE&&i(this,j).attachment.stop(a.DEBUG)}disconnectedCallback(){a.MEASURE&&i(this,j).dettachment.start(),c(this,rt,Ot).call(this,!1),c(this,L,F).call(this,"on_disconnect"),a.MEASURE&&i(this,j).dettachment.stop(a.DEBUG)}getElementsStore(){return i(this,nt)}setElementsStore(t){f(this,nt,t)}hasElementsStoreKey(t){return i(this,X)}getElementsStoreKey(t){return i(this,J)}setElementsStoreKey(t){return f(this,X,u.isNonEmptyString(f(this,J,t))),this}persistToElementsStore(){if(c(this,se,Xe).call(this)){let t=i(this,U);if(t)return i(this,B).snapshot(),t.data=new window.Object({options:i(this,E),html:i(this,P),children:i(this,I).persist(),rules:i(this,O).persist(),fields:i(this,B).persist(),slotted:i(this,V),identified:i(this,H)}),c(this,xt,Se).call(this),!0}return!1}restoreFromElementsStore(t){if(c(this,se,Xe).call(this)){let n=i(this,U);if(n&&n.persisted&&n.data)return f(this,E,n.data.options),f(this,V,n.data.slotted),f(this,H,n.data.identified),f(this,P,n.data.html),i(this,I).restore(n.data.children),i(this,I).owner=this,i(this,O).restore(n.data.rules),i(this,O).owner=this,i(this,B).restore(n.data.fields),i(this,B).owner=this,i(this,B).recall(),t||(delete n.data,c(this,xt,Se).call(this)),!0}return!1}selectChildElement(t){return i(this,W).querySelector(t)}setMainAttribute(t,n){i(this,ft)&&i(this,st).element.setAttribute(t,n)}setMainElement(t){let n=i(a,g).newChild(t);if(i(a,g).performValidations(n)){if(n.content!==""||!!n.events.length)return y.INVALID_DEFINITION.emit(t);f(this,H,!!n.id.length)&&(i(this,E).mainDefinition.id=n.id),n.tag.length&&(i(this,E).mainDefinition.tag=n.tag),n.classes.length&&(i(this,E).mainDefinition.classes=n.classes),n.style&&(i(this,E).mainDefinition.style=n.style),n.attributes&&(i(this,E).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(t,n){return i(this,E).styleMedia=t||"",i(this,E).styleType=n||"",this}setElementsAsKeys(t){return i(this,E).elementKeys=!!t,this}setAttributesAsKeys(t){return i(this,E).attributeKeys=!!t,this}allowRawContent(t){return i(this,E).rawContent=!!t,this}setRawContent(t){return i(this,E).rawContent?f(this,P,t):y.ALLOW_HTML.emit(),this}appendRawContent(t){return i(this,E).rawContent?f(this,P,i(this,P)+t):y.ALLOW_HTML.emit(),this}prependRawContent(t){return i(this,E).rawContent?f(this,P,t+i(this,P)):y.ALLOW_HTML.emit(),this}appendCSSRule(t,n,o){if(o)return this.appendCSSNestedRule(t,n,o);let h=i(this,O).slice(-1),l=i(a,g).newRule(t,n);return(!h.length||!i(a,g).tryToJoinRules(h[0],l))&&i(this,O).append(l),this}prependCSSRule(t,n,o){if(o)return this.prependCSSNestedRule(t,n,o);let h=i(this,O).slice(0,1),l=i(a,g).newRule(t,n);return(!h.length||!i(a,g).tryToJoinRules(h[0],l))&&i(this,O).prepend(l),this}appendCSSNestedRule(t,n,o){let h=i(this,O).slice(-1),l=i(a,g).newNestedRule(t,n,o);return(!h.length||!i(a,g).tryToJoinNestedRules(h[0],l))&&i(this,O).append(l),this}prependCSSNestedRule(t,n,o){let h=i(this,O).slice(0,1),l=i(a,g).newNestedRule(t,n,o);return(!h.length||!i(a,g).tryToJoinNestedRules(h[0],l))&&i(this,O).prepend(l),this}appendChildElement(t,n){return i(this,I).append(i(a,g).performValidations(i(a,g).newChild(t,n))),this}prependChildElement(t,n){return i(this,I).prepend(i(a,g).performValidations(i(a,g).newChild(t,n))),this}replaceChildElement(t,n){return i(this,I).replace(i(this,I).findIndex(o=>o.id===t),i(a,g).newChild(n)),this}appendChildElements(t){return(u.isOf(t,window.Array)?t:u.forcedStringSplit(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(t){return(u.isOf(t,window.Array)?t:u.forcedStringSplit(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}checkChildElementIsIncludedById(t,n,o){let h=l=>u.isOf(l,window.Function)?l():void 0;return i(this,I).some(l=>l.id===t&&l.rendering)?h(n):h(o),this}includeChildElementById(t){return i(this,I).forEach(n=>n.id===t&&A.renderingIncluder(n)),this}excludeChildElementById(t){return i(this,I).forEach(n=>n.id===t&&A.renderingExcluder(n)),this}invalidateChildElementsById(t){return i(this,I).forEach(n=>t.indexOf(n.id)>-1&&A.cacheInvalidator(n)),this}invalidateChildElements(t){return u.isOf(t,window.Array)&&t.forEach(A.cacheInvalidator),this}makeField(t,n){return this[t]=n,i(this,B).append({name:t,value:n}),this}makeReactiveField(t,n,o,h=!0){return c(this,_e,Ni).call(this,t,n,o,h)}makeExternalReactiveField(t,n,o,h,l=!0){return this.makeReactiveField(n,t[n]||o,w=>{t[n]=this[n],h(w)},l)}},P=new WeakMap,O=new WeakMap,I=new WeakMap,B=new WeakMap,E=new WeakMap,Lt=new WeakMap,H=new WeakMap,V=new WeakMap,st=new WeakMap,G=new WeakMap,W=new WeakMap,Jt=new WeakMap,ft=new WeakMap,Y=new WeakMap,nt=new WeakMap,U=new WeakMap,J=new WeakMap,X=new WeakMap,m=new WeakMap,Mt=new WeakMap,Xt=new WeakMap,pt=new WeakMap,j=new WeakMap,q=new WeakSet,dt=function(t){i(this,H)&&a.debug(`#${i(this,E).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},De=new WeakSet,yi=function(){i(this,G)&&i(this,G).affiliate(),i(this,st).affiliate(),f(this,ft,!0)},Le=new WeakSet,Ai=function(){f(this,G,i(this,O).length?new wt(i(this,W),i(a,g).makeStyleNode(i(this,E).styleMedia,i(this,E).styleType)):null),f(this,st,new wt(i(this,W),i(a,g).makeMainNode(i(this,E).mainDefinition))),i(this,I).forEach(A.cacheInvalidator),i(this,O).forEach(A.cacheInvalidator)},Me=new WeakSet,Si=function(){i(this,ft)&&(i(this,st).disaffiliate(),i(this,G)&&i(this,G).disaffiliate(),i(this,V)&&i(this,Jt)&&k.removeChildren(this)),f(this,ft,!1)},Ue=new WeakSet,bi=function(t){return{key:i(this,E).elementKeys&&t.key(),event:(n,o,h)=>{let l=this[`on_${n}_${o}`];if(l){let w=c(this,qt,ze).call(this,n);w&&w[t.event](o,l,h)}},slots:()=>this.on_slot_change&&i(this,W).querySelectorAll("slot").forEach(n=>n[t.event]("slotchange",this.on_slot_change))}},rt=new WeakSet,Ot=function(t){if(i(this,Y)&&!t||!i(this,Y)&&t){let n=c(this,Ue,bi).call(this,t?i(this,Xt).bind:i(this,Xt).unbind);i(this,I).forEach(o=>{!o.rendering&&t||(n.key&&n.key(o),o.events.forEach(h=>h&&n.event(o.id,h.kind,h.capture)))}),i(this,V)&&n.slots(),f(this,Y,t)}},qt=new WeakSet,ze=function(t){return u.isNonEmptyString(t)?i(this,W).querySelector(`#${t}`):void 0},Qt=new WeakSet,He=function(){i(this,m).root.reset(""),i(this,m).style.reset(""),i(this,m).main.reset(i(this,P));let t=i(this,V)?i(this,m).renderizers.children.mixed:i(this,m).renderizers.children.normal;i(this,I).forEach(n=>n.rendering&&t(n)),i(this,O).forEach(i(this,m).renderizers.rule),i(this,m).main.verify(n=>!i(this,pt).main.compute(n)),i(this,m).style.verify(n=>!i(this,pt).style.compute(n))},Zt=new WeakSet,Ve=function(){i(this,m).root.process(),i(this,m).style.process(),i(this,m).main.process(),a.DEBUG&&c(this,q,dt).call(this,i(this,m).getDebugInfo())},xe=new WeakSet,Ti=function(){!a.RENDERING||(a.MEASURE&&i(this,j).partial.start(),c(this,L,F).call(this,"on_prerender"),c(this,Qt,He).call(this),i(this,m).gotModified()?(c(this,rt,Ot).call(this,!1),c(this,Zt,Ve).call(this),c(this,rt,Ot).call(this,!0),this.info.updatedRounds++,c(this,L,F).call(this,"on_update"),c(this,ie,Je).call(this,"on_refresh")):this.info.unmodifiedRounds++,a.DEBUG&&c(this,q,dt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${i(this,pt).main.rounds}, style: ${i(this,pt).style.rounds}) | updated: ${this.info.updatedRounds}`),c(this,L,F).call(this,"on_postrender"),a.MEASURE&&i(this,j).partial.stop(a.DEBUG))},te=new WeakSet,We=function(t){c(this,Le,Ai).call(this),c(this,De,yi).call(this),c(this,L,F).call(this,"on_inject"),c(this,Qt,He).call(this),i(this,m).style.verify(n=>!!i(this,G)),c(this,Zt,Ve).call(this),c(this,rt,Ot).call(this,!0),c(this,L,F).call(this,t)},Fe=new WeakSet,Ii=function(t){a.MEASURE&&i(this,j).full.start(),c(this,rt,Ot).call(this,!1),c(this,Me,Si).call(this),c(this,L,F).call(this,"on_unload"),i(this,Ut).call(this),c(this,te,We).call(this,"on_reload"),c(this,ie,Je).call(this,"on_repaint"),a.MEASURE&&i(this,j).full.stop(a.DEBUG)},ee=new WeakSet,Ye=function(t,n="$none"){if(i(this,Y)){let o=i(a,Q).scanRulesForReplacements(i(this,O),t);o.forEach(A.cacheInvalidator);let h=i(a,Q).scanChildrenForReplacements(i(this,I),t);h.forEach(A.cacheInvalidator),a.DEBUG&&c(this,q,dt).call(this,`reactive render (label: ${n}, field: ${t}, children: ${h.length}, rules: ${o.length})`),(!!o.length||!!h.length)&&(h.some(l=>!!l.kind.length)&&i(this,I).forEach(l=>l.kind===b.SLOTS_KIND?A.cacheInvalidator(l):void 0),this.render())}},_e=new WeakSet,Ni=function(t,n,o,h=!0){return a.makeReactiveField(this,t,n,o,(l,w)=>c(this,ee,Ye).call(this,l,w||"$auto")),i(this,B).append({name:t,value:n}),h&&c(this,ee,Ye).call(this,t,"$init"),this},L=new WeakSet,F=function(t,n){i(this,Lt)[t]&&this[t].call(this,n)},ie=new WeakSet,Je=function(t,n){i(this,X)&&this.persistToElementsStore(),i(this,Lt)[t]&&window.requestAnimationFrame(()=>this[t].call(this,n))},Ut=new WeakMap,$e=new WeakSet,Oi=function(){return i(this,X)?(f(this,U,i(this,nt).hasItem(i(this,J))?i(this,nt).getItem(i(this,J)):{generation:0,persisted:!1}),i(this,U).generation++,c(this,xt,Se).call(this),!0):!1},xt=new WeakSet,Se=function(){a.DEBUG&&(i(this,U).key=i(this,J)),i(this,U).persisted=!!i(this,U).data,i(this,nt).setItem(i(this,J),i(this,U))},se=new WeakSet,Xe=function(){return i(this,X)?!0:(y.INVALID_KEY.emit(),!1)},d(it,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),d(it,"specializeClass",t=>class extends it{constructor(){super(t)}}),d(it,"instancesCount",0),it)),d(T,"NonShadowElement",i(a,x).specializeClass(i(a,x).RootMode.REGULAR)),d(T,"OpenShadowElement",i(a,x).specializeClass(i(a,x).RootMode.OPEN)),d(T,"ClosedShadowElement",i(a,x).specializeClass(i(a,x).RootMode.CLOSED)),(()=>{let e=(s,t)=>!s&&y.UNSUPPORTED_FEATURE.emit(t);try{e(u.isOf(window.document,window.HTMLDocument),"HTML Document"),e(u.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),k.onDOMContentLoaded(()=>e(u.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(s){y.UNKNOWN_ERROR.emit()}C.initialize((s,t)=>a.debug(JSON.stringify(u.buildArray(n=>{switch(n.push({instances:a.elementCount}),n.push(s.getDebugInfo()),t){case"stop":n.push(C.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(C.BrowserRender.overall.getDebugInfo());break}})))),v.initialize({onMisnamedClass:y.MISNAMED_CLASS.emit,onUnregistrableClass:y.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:y.UNREGISTERED_CLASS.emit,onInvalidClass:y.INVALID_CLASS.emit,onDeferredInstantiation:k.onDOMContentLoaded}),tt.initialize({onExtinctTemplate:y.EXTINCT_TEMPLATE.emit,onInvalidTemplate:y.INVALID_TEMPLATE.emit}),A.initialize({onFetchTemplate:tt.fetch}),i(a,Q).initialize(b.DEFAULT_REPLACEMENT_OPEN,b.DEFAULT_REPLACEMENT_CLOSE)})(),window.Wuse=T;})();
