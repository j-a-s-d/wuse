(()=>{var cs=Object.defineProperty;var ls=(p,e,i)=>e in p?cs(p,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):p[e]=i;var d=(p,e,i)=>(ls(p,typeof e!="symbol"?e+"":e,i),i),Ie=(p,e,i)=>{if(!e.has(p))throw TypeError("Cannot "+i)};var s=(p,e,i)=>(Ie(p,e,"read from private field"),i?i.call(p):e.get(p)),a=(p,e,i)=>{if(e.has(p))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(p):e.set(p,i)},f=(p,e,i,t)=>(Ie(p,e,"write to private field"),t?t.call(p,i):e.set(p,i),i);var o=(p,e,i)=>(Ie(p,e,"access private method"),i);var T=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var $=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let i=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",i),100)};window.addEventListener("DOMContentLoaded",i)}}static getUniqueId(e="WUSE"){let i="_"+(e||"")+"_";for(var t;window.document.getElementById(t=i+(""+window.Math.random()).substring(2))!==null;);return t}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(e).filter(n=>n.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var zt,bt,ve,u=class{static get EMPTY_ARRAY(){return s(this,zt)}static isOf(e,i){return e!=null&&(e.constructor===i||i!=null&&e.constructor.name===i.name)}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,i){return typeof e=="string"?e.split(i):new window.Array}static buildArray(e){return o(this,bt,ve).call(this,new window.Array,e)}static buildObject(e){return o(this,bt,ve).call(this,new window.Object,e)}};zt=new WeakMap,bt=new WeakSet,ve=function(e,i){return this.isOf(i,window.Function)&&i(e),e},a(u,bt),a(u,zt,new window.Array);var Yt,N,Ce=class{static get UNKNOWN_ERROR(){return s(this,N).call(this,0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return s(this,N).call(this,1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return s(this,N).call(this,2,e=>`Unregistered class: ${e}.`)}static get INVALID_CLASS(){return s(this,N).call(this,3,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return s(this,N).call(this,4,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return s(this,N).call(this,10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return s(this,N).call(this,11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return s(this,N).call(this,12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return s(this,N).call(this,13,e=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return s(this,N).call(this,20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return s(this,N).call(this,21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return s(this,N).call(this,22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return s(this,N).call(this,30,e=>`Unespecified slot: #${e}.`)}},S=Ce;Yt=new WeakMap,N=new WeakMap,a(S,Yt,"[WUSE:ERROR]"),a(S,N,(e,i)=>({code:e,emit:t=>{let n=`${s(Ce,Yt)} ${e} | ${i(t)}`;if(Wuse.FATALS||e<10)throw new window.Error(n);return window.console.error(n),null}}));var Rt,Nt,Ot,It,ut=class{constructor(e){d(this,"rounds",0);a(this,Rt,0);a(this,Nt,null);a(this,Ot,!1);a(this,It,null);f(this,It,typeof e=="function"?e:()=>{})}compute(e){return this.rounds+=+f(this,Ot,s(this,Rt)==f(this,Nt,s(this,It).call(this,e))),f(this,Rt,s(this,Nt)),s(this,Ot)}};Rt=new WeakMap,Nt=new WeakMap,Ot=new WeakMap,It=new WeakMap;var G,Ct,De,vt=class{constructor(){a(this,Ct);a(this,G,new window.Object)}get length(){return o(this,Ct,De).call(this).length}key(e){return o(this,Ct,De).call(this)[e]||null}getItem(e){return s(this,G)[e]}setItem(e,i){s(this,G)[e]=i}removeItem(e){delete s(this,G)[e]}clear(){f(this,G,new window.Object)}hasItem(e){return s(this,G).hasOwnProperty(e)}};G=new WeakMap,Ct=new WeakSet,De=function(){return window.Object.keys(s(this,G))};var it,j,J,Wt,Be,ft=class{constructor(e,i){a(this,Wt);a(this,it,null);a(this,j,null);a(this,J,null);if(e instanceof Node&&i instanceof Node)f(this,it,e),f(this,j,i),f(this,J,i.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return s(this,j)}affiliate(){s(this,it).appendChild(s(this,j))}disaffiliate(){s(this,it).removeChild(s(this,j))}promote(e){s(this,J).innerHTML=e,s(this,it).replaceChild(s(this,J),s(this,j)),o(this,Wt,Be).call(this)}};it=new WeakMap,j=new WeakMap,J=new WeakMap,Wt=new WeakSet,Be=function(){let e=s(this,J);f(this,J,s(this,j).cloneNode(!1)),f(this,j,e)};var nt,rt,at=class{constructor(e){d(this,"owner",null);a(this,nt,!1);a(this,rt,"");this.owner=e}get invalidated(){return s(this,nt)}reset(e){f(this,nt,!1),f(this,rt,e)}append(e){f(this,rt,s(this,rt)+e)}verify(e){f(this,nt,e(s(this,rt)))}process(){s(this,nt)&&this.on_content_invalidation(s(this,rt))}on_content_invalidation(e){}};nt=new WeakMap,rt=new WeakMap;var te,_e,Ge,Qt,Zt,pt,Xt=p=>p>1e3?(p/1e3).toFixed(2)+"s":p.toFixed(2)+"ms",qt=class{constructor(){d(this,"round",0);d(this,"domTime",window.Number.MAX_SAFE_INTEGER);d(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=Xt(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=Xt(this.renderTime)),e}},Jt=class{constructor(e){d(this,"name","");d(this,"rounds",0);d(this,"time",0);d(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=Xt(this.time),i=Xt(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:i}}},C=class{static initialize(e){typeof e=="function"&&f(C,pt,e),C.DOMUpdate.overall=new Jt("overall-dom-update"),C.BrowserRender.overall=new Jt("overall-browser-render")}},O=C;pt=new WeakMap,a(O,pt,()=>{}),d(O,"StopWatch",(Ge=class{constructor(){a(this,te);d(this,"_begin",0);d(this,"_end",{dom:0,render:0});d(this,"rounds",0);d(this,"last",new qt);d(this,"best",new qt);d(this,"averages",{dom:0,render:0})}start(){(C.DOMUpdate.check||C.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var i;C.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,C.DOMUpdate.overall.compute(this.last.domTime)),C.BrowserRender.check?setTimeout(()=>o(this,te,_e).bind(this)(e)):e&&s(i=C,pt).call(i,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},te=new WeakSet,_e=function(e){var i;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,C.BrowserRender.overall.compute(this.last.renderTime),e&&s(i=C,pt).call(i,this,"finish")},Ge)),d(O,"DOMUpdate",(Qt=class{},d(Qt,"check",!0),d(Qt,"overall",null),Qt)),d(O,"BrowserRender",(Zt=class{},d(Zt,"check",!1),d(Zt,"overall",null),Zt));var Et,se,He,re,Q,Ve,ae,ze,oe,Ye,he,We,ce,Xe,gt,ie,le,Le,qe,Dt,de,Mt,U,ee,g,Ut,ue,ct,xt,Pt,Lt,ot,Z,F,R,b,K,w,yt,_,H,tt,B,V,Ft,lt,z,et,D,Y,W,m,St,kt,dt,k,$t,Me,X,ht,fe,Je,pe,Qe,me,Ze,we,ts,st,wt,jt,Ue,Kt,xe,Bt,Pe,Ee,es,Gt,Fe,ge,ss,_t,ke,ye,is,v,M,Ht,$e,At,Se,ns,Tt,ne,Vt,je,Ae,mt,rs,Te,as,be,os,Re,hs,E,Ne,Oe,I,L,q,r=class{static get VERSION(){return"0.3.6"}static blockUpdate(e,i){if(u.isOf(e,Function)){r.DEBUG&&r.debug("blocking"),r.RENDERING=!1;try{e(i)}catch(t){throw t}finally{r.RENDERING=!0,r.DEBUG&&r.debug("unblocking")}}}static debug(e){window.console.log("[WUSE:DEBUG]",e)}static register(e){return s(r,q).registerClasses(u.isOf(e,window.Array)?e:new window.Array(e))}static instantiate(e,i){return s(r,q).instantiateClasses(u.isOf(e,window.Array)?e:new window.Array(e),i)}static isShadowElement(e){let i=window.Object.getPrototypeOf(e.constructor);return i===r.OpenShadowElement||i===r.ClosedShadowElement}static get elementCount(){return s(r,L).instancesCount}static makeReactiveField(e,i,t,n,h){let c=(x,P)=>window.Object.defineProperty(e,i,{get:x,set:P,enumerable:!0,configurable:!0}),l=()=>delete e[i],y=(x,P)=>r.makeReactiveField(e,i,x,P,h);c(()=>t,x=>{y(x,n),u.isOf(n,window.Function)?n({renderize:P=>h(i,P),automate:()=>y(x,null),freeze:()=>c(()=>x,P=>{}),defreeze:()=>y(x,n),dereact:()=>c(()=>x,P=>{l(),e[i]=P}),remove:()=>l()}):h(i)})}},A=r;E=new WeakMap,Ne=new WeakMap,Oe=new WeakMap,I=new WeakMap,L=new WeakMap,q=new WeakMap,d(A,"WebHelpers",$),d(A,"JsHelpers",u),d(A,"PerformanceMeasurement",O),d(A,"tmp",new window.Object),d(A,"DEBUG",!1),d(A,"FATALS",!1),d(A,"MEASURE",!1),d(A,"RENDERING",!0),a(A,E,(Dt=class{static makeStyleNode(e,i){var t=window.document.createElement("style");return u.isNonEmptyString(e)&&t.setAttribute("media",e),u.isNonEmptyString(i)&&t.setAttribute("type",i),t.appendChild(window.document.createTextNode("")),t}static newRule(e,i){let t=u.isOf(e,window.Array)?e.join(","):""+e;return t.length?{selector:t,properties:u.isOf(i,window.Object)?i:s(this,Mt).parse(i),cache:null}:null}static newNestedRule(e,i,t){let n=u.isOf(e,window.Array)?e.join(","):""+e,h=u.isOf(i,window.Array)?i.join(","):""+i;return!n.length||!h.length?null:{selector:n,nested:[{selector:h,properties:u.isOf(t,window.Object)?t:s(this,Mt).parse(t)}],cache:null}}static tryToJoinRules(e,i){if(e.selector===i.selector){for(let t in i.properties)e.properties[t]=i.properties[t];return e.cache=null,!0}return!1}static tryToJoinNestedRules(e,i){return u.isOf(e.nested,window.Array)&&e.selector===i.selector?(i.nested.forEach(t=>{var n=!1;for(let h in e.nested)if(n=e.nested[h].selector===t.selector){for(let c in t.properties)e.nested[h].properties[c]=t.properties[c];break}n||e.nested.push(t)}),e.cache=null,!0):!1}static makeMainNode(e){var i=window.document.createElement(e.tag);if(e.id.length&&i.setAttribute("id",e.id),e.classes.length&&i.setAttribute("class",e.classes.join(" ")),u.hasObjectKeys(e.style)){var t="";for(let n in e.style)t+=n+": "+e.style[n]+"; ";if(t.length){let n=t.trim();i.setAttribute("style",n.endsWith(";")?n.slice(0,-1):n)}}if(u.hasObjectKeys(e.attributes))for(let n in e.attributes)i.setAttribute(n,e.attributes[n]);return i}static newEvent(e,i){return typeof e=="string"&&typeof i=="boolean"?{kind:e,capture:i}:null}static performValidations(e){if(e.kind===T.TEMPLATES_KIND){if(!window.document.getElementById(e.id))return S.INEXISTENT_TEMPLATE.emit(e.id)}else if(e.kind===T.SLOTS_KIND){if(new String(e.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return S.UNESPECIFIED_SLOT.emit(e.id)}else if(typeof e.id!="string"||e.id!==""&&window.document.getElementById(e.id)!==null)return S.INVALID_ID.emit(e.id);return e}static newChild(e,i){var t=s(this,de).parse(e.trimLeft());return t?(t.rules=u.isOf(i,window.Array)?i:new window.Array,t.rendering=!0,t.cache=null,t):S.INVALID_DEFINITION.emit(e)}static newDefinition(){return{kind:T.DEFAULT_KIND,tag:T.DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},de=new WeakMap,Mt=new WeakMap,d(Dt,"PartsHolder",(He=class extends window.Array{constructor(i){super();a(this,Et);d(this,"owner",null);d(this,"last",null);d(this,"version",0);this.owner=i}append(i){u.isOf(i,window.Object)&&(this.push(i),o(this,Et,se).call(this,i))}prepend(i){u.isOf(i,window.Object)&&(this.unshift(i),o(this,Et,se).call(this,i))}replace(i,t){i>-1&&u.isOf(t,window.Object)&&o(this,Et,se).call(this,this[i]=t)}on_version_change(){}persist(){let i=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":i[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let n=window.Object.assign(new window.Object,this[t]);n.cache&&(n.cache=null),i.push(n)}break}}),i}restore(i){window.Object.getOwnPropertyNames(i).forEach(t=>{switch(t){case"length":break;case"version":this[t]=i[t];break;default:if(window.Number.isInteger(Number(t))){let n=window.Object.assign(new window.Object,i[t]);n.cache&&(n.cache=null),this.push(n)}break}})}},Et=new WeakSet,se=function(i){this.last=i,this.version++,this.on_version_change()},He)),a(Dt,de,(Q=class{static parse(e){if(u.isNonEmptyString(e)){var i=s(r,E).newDefinition();return e.charAt(0)==="%"?e.startsWith(T.TEMPLATES_KIND)?o(this,gt,ie).call(this,i,e.replace(i.kind=T.TEMPLATES_KIND,"")):e.startsWith(T.SLOTS_KIND)?o(this,gt,ie).call(this,i,e.replace(i.kind=T.SLOTS_KIND,"")):null:o(this,gt,ie).call(this,i,e)}return null}},re=new WeakSet,Ve=function(e,i){let t=i.indexOf("["),n=i.indexOf("]");if(t>-1&&n>-1&&n>t){let c=i.substr(t,n-t+1),l=c.substr(1,c.length-2).split("|");for(var h in l){let y=l[h].split("=");y[0]==="style"?y[1].split(";").forEach(x=>{let P=x.split(":"),Ke=P[0].trim();Ke.length&&(e.style[Ke]=P[1].trim())}):e.attributes[y[0]]=y[1]}return i.replace(c,"")}return i},ae=new WeakSet,ze=function(e,i){let t=i.indexOf("=");return t>-1?(e.content=i.slice(t+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),i.slice(0,t)):i},oe=new WeakSet,Ye=function(e,i){let t=i.replaceAll("!"," ").split(" ");return t.slice(1).map(n=>{let[h,...c]=n.toLowerCase().split("+"),l=(c||u.EMPTY_ARRAY).indexOf("capture")>-1;e.events.push(s(r,E).newEvent(h,l))}),t[0]},he=new WeakSet,We=function(e,i){let t=i.replaceAll("."," ").split(" ");return e.classes=t.slice(1),t[0]},ce=new WeakSet,Xe=function(e,i){if(i!==""){let t=i.indexOf("#");t===-1?e.tag=i:(t>0&&(e.tag=i.substr(0,t)),e.id=i.substr(t+1))}return e},gt=new WeakSet,ie=function(e,i){return o(this,ce,Xe).call(this,e,o(this,he,We).call(this,e,o(this,oe,Ye).call(this,e,o(this,ae,ze).call(this,e,o(this,re,Ve).call(this,e,i)))))},a(Q,re),a(Q,ae),a(Q,oe),a(Q,he),a(Q,ce),a(Q,gt),Q)),a(Dt,Mt,(Le=class{static parse(e){let i=new window.Object;return(u.isOf(e,window.Array)?e:u.forcedStringSplit(e,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>u.isNonEmptyString(t)&&o(this,le,qe).call(this,i,t.trim())),i}},le=new WeakSet,qe=function(e,i){if(!!i.length&&i.indexOf(":")>-1){let[t,...n]=i.split(":"),h=t.trim();if(h.length){let c=n.join(":").trim();e[h]=c.endsWith(";")?c.slice(0,-1):c}}},a(Le,le),Le)),Dt)),a(A,Ne,new vt),d(A,"hashRoutine",e=>{var i=0;for(let t=0;t<e.length;t++)i=(i=(i<<5)-i+e.charCodeAt(t))&i;return i}),d(A,"TextReplacements",(Lt=class{},d(Lt,"ReplacementMarkers",(U=class{static initialize(i,t){this.begin=i,this.end=t}},d(U,"begin",null),d(U,"end",null),d(U,"enclose",i=>U.begin+i+U.end),d(U,"makeRegExp",()=>new window.RegExp("(?<="+U.begin+").*?(?="+U.end+")","gs")),U)),d(Lt,"ReplacementsScanners",(ee=class{},d(ee,"rules",(e,i)=>u.buildArray(t=>e.forEach(n=>n.replacements.forEach(h=>h.field===i&&t.push(n))))),d(ee,"children",(e,i)=>u.buildArray(t=>{let n=h=>{let c=l=>l.forEach(y=>y.field===i&&t.push(h));["contents","classes","styles","attributes"].forEach(l=>c(h.replacements[l])),h.rules.forEach(l=>l.replacements.forEach(y=>y.field===i&&t.push(h)))};e.forEach(h=>h.rendering&&n(h))})),ee)),d(Lt,"ReplacementsExtractors",(g=class{static initialize(i){f(this,Ut,i)}},Ut=new WeakMap,ue=new WeakMap,ct=new WeakMap,xt=new WeakMap,Pt=new WeakMap,a(g,Ut,null),a(g,ue,(i,t,n)=>i.push({at:t,field:n.trim(),find:r.TextReplacements.ReplacementMarkers.enclose(n)})),a(g,ct,(i,t,n)=>u.isNonEmptyString(n)&&(n.match(s(g,Ut))||u.EMPTY_ARRAY).forEach(h=>{var c;return s(c=g,ue).call(c,i,t,h)})),a(g,xt,(i,t,n)=>{var h;i[t]=new window.Array,s(h=g,ct).call(h,i[t],t,n)}),a(g,Pt,(i,t,n)=>{i[t]=new window.Array,window.Object.keys(n).forEach(h=>{var c,l;s(c=g,ct).call(c,i[t],t,h),s(l=g,ct).call(l,i[t],t,n[h])})}),d(g,"child",i=>u.buildObject(t=>{var n,h,c,l;s(n=g,xt).call(n,t,"contents",i.content),s(h=g,xt).call(h,t,"classes",i.classes.join(" ")),s(c=g,Pt).call(c,t,"styles",i.style),s(l=g,Pt).call(l,t,"attributes",i.attributes),i.rules.forEach(y=>y.replacements=g.rule(y))})),d(g,"rule",i=>u.buildArray(t=>{var h;if(u.isOf(i.nested,window.Array))return i.nested.map(c=>g.rule(c));var n="";for(let c in i.properties)n+=c+":"+i.properties[c]+";";s(h=g,ct).call(h,t,"rules",n)})),g)),Lt)),a(A,Oe,e=>{let i=window.document.getElementById(e);return i===null?S.EXTINCT_TEMPLATE.emit(e):i.tagName!=="TEMPLATE"?S.INVALID_TEMPLATE.emit(e):i.innerHTML}),a(A,I,(ot=class{},d(ot,"cacheInvalidator",e=>e.cache=null),d(ot,"renderingIncluder",e=>e.rendering=!0),d(ot,"renderingExcluder",e=>e.rendering=!1),d(ot,"renderRule",(e,i)=>{if(u.isOf(i.nested,window.Array))return i.selector+"{"+i.nested.map(n=>s(r,I).renderRule(e,n)).join(`
`)+"}";if(i.selector!==""){var t="";for(let n in i.properties)t+=n+":"+i.properties[n]+";";return u.isOf(i.replacements,window.Array)&&!!i.replacements.length&&i.replacements.forEach(n=>t=e(t,n)),i.selector+"{"+t+"}"}return null}),d(ot,"renderChild",(e,i)=>{var h;if(i.kind===T.TEMPLATES_KIND)return s(h=r,Oe).call(h,i.id);if(i.tag===T.TEXTNODE_TAG){var t=i.content;return i.replacements.contents.forEach(c=>t=e(t,c)),i.encode?$.htmlEncode(t):t}var n=u.isNonEmptyString(i.id)?`<${i.tag} id='${i.id}'`:"<"+i.tag;if(i.classes.length){var t=i.classes.join(" ");i.replacements.classes.forEach(l=>t=e(t,l)),n+=` class='${t}'`}if(u.hasObjectKeys(i.style)){var t=" style='";for(let l in i.style)t+=l+": "+i.style[l]+"; ";t+="'",i.replacements.styles.forEach(l=>t=e(t,l)),n+=t}if(u.hasObjectKeys(i.attributes)){var t="";for(let l in i.attributes)t+=" "+l+"="+i.attributes[l];i.replacements.attributes.forEach(l=>t=e(t,l)),n+=t}if(typeof i.content=="string"){var t=i.content;i.replacements.contents.forEach(l=>t=e(t,l)),n+=`>${i.encode?$.htmlEncode(t):t}</${i.tag}>`}else n+="/>";return n}),ot)),a(A,L,(Z=class extends window.HTMLElement{constructor(t){super();a(this,$t);a(this,X);a(this,fe);a(this,pe);a(this,me);a(this,we);a(this,st);a(this,jt);a(this,Kt);a(this,Bt);a(this,Ee);a(this,Gt);a(this,ge);a(this,_t);a(this,ye);a(this,v);a(this,Ht);a(this,Se);a(this,Tt);a(this,Vt);a(this,F,"");a(this,R,new class extends s(r,E).PartsHolder{on_version_change(){var t;this.last.version=this.version,this.last.replacements=r.TextReplacements.ReplacementsExtractors.rule(this.last),r.DEBUG&&o(t=this.owner,X,ht).call(t,`rules list version change: ${this.version}`)}}(this));a(this,b,new class extends s(r,E).PartsHolder{on_version_change(){var t,n;this.last.version=this.version,this.last.replacements=r.TextReplacements.ReplacementsExtractors.child(this.last),f(t=this.owner,H,s(t,H)|this.last.kind===T.SLOTS_KIND),r.DEBUG&&o(n=this.owner,X,ht).call(n,`children list version change: ${this.version}`)}}(this));a(this,K,new class extends s(r,E).PartsHolder{on_version_change(){var t;r.DEBUG&&o(t=this.owner,X,ht).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));a(this,w,{mainDefinition:s(r,E).newDefinition(),styleMedia:T.DEFAULT_STYLE_MEDIA,styleType:T.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});a(this,yt,new window.Object);a(this,_,!1);a(this,H,!1);a(this,tt,void 0);a(this,B,void 0);a(this,V,null);a(this,Ft,r.isShadowElement(this));a(this,lt,!1);a(this,z,!1);a(this,et,s(r,Ne));a(this,D,null);a(this,Y,"");a(this,W,!1);a(this,m,{root:new class extends at{on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends at{on_content_invalidation(t){s(this.owner,B).promote(t)}}(this),main:new class extends at{on_content_invalidation(t){s(this.owner,tt).promote(t)}}(this),renderizers:{rule:t=>s(this,m).style.append(t.cache?t.cache:t.cache=s(r,I).renderRule(s(this,St),t)),children:{mixed:t=>s(this,Ft)&&t.kind===T.SLOTS_KIND?s(this,m).renderizers.children.slot(t):s(this,m).renderizers.children.normal(t),slot:t=>{t.cache||(s(this,m).root.verify(n=>!0),s(this,m).root.append(t.cache=s(r,I).renderChild(s(this,St),t)))},normal:t=>{s(this,m).main.append(t.cache?t.cache:t.cache=s(r,I).renderChild(s(this,St),t)),t.rules.forEach(s(this,m).renderizers.rule)}}},gotModified:()=>s(this,m).root.invalidated||s(this,m).main.invalidated||s(this,m).style.invalidated,getDebugInfo:()=>`updated (root: ${s(this,m).root.invalidated}, main: ${s(this,m).main.invalidated}, style: ${s(this,m).style.invalidated})`});a(this,St,(t,n)=>t.replace(n.find,this[n.field]!==void 0?this[n.field]:""));a(this,kt,{bind:{key:()=>{let t=n=>{u.isNonEmptyString(n)&&(this[n]=o(this,jt,Ue).call(this,n))};return s(this,_)&&t(s(this,w).mainDefinition.id),n=>t(n.id)},event:"addEventListener"},unbind:{key:()=>{let t=n=>delete this[n];return s(this,_)&&t(s(this,w).mainDefinition.id),n=>t(n.id)},event:"removeEventListener"}});a(this,dt,{main:new ut(r.hashRoutine),style:new ut(r.hashRoutine)});a(this,k,{attachment:new O.StopWatch,partial:new O.StopWatch,full:new O.StopWatch,dettachment:new O.StopWatch});a(this,At,()=>s(r,L).EVENT_NAMES.forEach(t=>s(this,yt)[t]=typeof this[t]=="function"));d(this,"info",{instanceNumber:++s(r,L).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,V,t!==s(r,L).RootMode.REGULAR?this.attachShadow({mode:t}):this),s(this,At).call(this),o(this,v,M).call(this,"on_create"),s(this,w).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),o(this,Se,ns).call(this)&&s(this,D).generation>1?o(this,v,M).call(this,"on_reconstruct",s(this,D)):o(this,v,M).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return s(this,z)?o(this,Ee,es):o(this,$t,Me)}get redraw(){return s(this,z)?o(this,ge,ss):o(this,$t,Me)}connectedCallback(){r.MEASURE&&s(this,k).attachment.start(),s(this,At).call(this),o(this,v,M).call(this,"on_connect"),o(this,Gt,Fe).call(this,"on_load"),s(this,W)&&this.persistToElementsStore(),r.MEASURE&&s(this,k).attachment.stop(r.DEBUG)}disconnectedCallback(){r.MEASURE&&s(this,k).dettachment.start(),o(this,st,wt).call(this,!1),o(this,v,M).call(this,"on_disconnect"),r.MEASURE&&s(this,k).dettachment.stop(r.DEBUG)}getElementsStore(){return s(this,et)}setElementsStore(t){f(this,et,t)}hasElementsStoreKey(t){return s(this,W)}getElementsStoreKey(t){return s(this,Y)}setElementsStoreKey(t){return f(this,W,u.isNonEmptyString(f(this,Y,t))),this}persistToElementsStore(){if(o(this,Vt,je).call(this)){let t=s(this,D);if(t)return s(this,K).snapshot(),t.data=new window.Object({options:s(this,w),html:s(this,F),children:s(this,b).persist(),rules:s(this,R).persist(),fields:s(this,K).persist(),slotted:s(this,H),identified:s(this,_)}),o(this,Tt,ne).call(this),!0}return!1}restoreFromElementsStore(t){if(o(this,Vt,je).call(this)){let n=s(this,D);if(n&&n.persisted&&n.data)return f(this,w,n.data.options),f(this,H,n.data.slotted),f(this,_,n.data.identified),f(this,F,n.data.html),s(this,b).restore(n.data.children),s(this,b).owner=this,s(this,R).restore(n.data.rules),s(this,R).owner=this,s(this,K).restore(n.data.fields),s(this,K).owner=this,s(this,K).recall(),t||(delete n.data,o(this,Tt,ne).call(this)),!0}return!1}selectChildElement(t){return s(this,V).querySelector(t)}setMainAttribute(t,n){s(this,lt)&&s(this,tt).element.setAttribute(t,n)}setMainElement(t){let n=s(r,E).newChild(t);if(s(r,E).performValidations(n)){if(n.content!==""||!!n.events.length)return S.INVALID_DEFINITION.emit(t);f(this,_,!!n.id.length)&&(s(this,w).mainDefinition.id=n.id),n.tag.length&&(s(this,w).mainDefinition.tag=n.tag),n.classes.length&&(s(this,w).mainDefinition.classes=n.classes),n.style&&(s(this,w).mainDefinition.style=n.style),n.attributes&&(s(this,w).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(t,n){return s(this,w).styleMedia=t||"",s(this,w).styleType=n||"",this}setElementsAsKeys(t){return s(this,w).elementKeys=!!t,this}setAttributesAsKeys(t){return s(this,w).attributeKeys=!!t,this}allowRawContent(t){return s(this,w).rawContent=!!t,this}setRawContent(t){return s(this,w).rawContent?f(this,F,t):S.ALLOW_HTML.emit(),this}appendRawContent(t){return s(this,w).rawContent?f(this,F,s(this,F)+t):S.ALLOW_HTML.emit(),this}prependRawContent(t){return s(this,w).rawContent?f(this,F,t+s(this,F)):S.ALLOW_HTML.emit(),this}appendCSSRule(t,n,h){if(h)return this.appendCSSNestedRule(t,n,h);let c=s(this,R).slice(-1),l=s(r,E).newRule(t,n);return(!c.length||!s(r,E).tryToJoinRules(c[0],l))&&s(this,R).append(l),this}prependCSSRule(t,n,h){if(h)return this.prependCSSNestedRule(t,n,h);let c=s(this,R).slice(0,1),l=s(r,E).newRule(t,n);return(!c.length||!s(r,E).tryToJoinRules(c[0],l))&&s(this,R).prepend(l),this}appendCSSNestedRule(t,n,h){let c=s(this,R).slice(-1),l=s(r,E).newNestedRule(t,n,h);return(!c.length||!s(r,E).tryToJoinNestedRules(c[0],l))&&s(this,R).append(l),this}prependCSSNestedRule(t,n,h){let c=s(this,R).slice(0,1),l=s(r,E).newNestedRule(t,n,h);return(!c.length||!s(r,E).tryToJoinNestedRules(c[0],l))&&s(this,R).prepend(l),this}appendChildElement(t,n){return s(this,b).append(s(r,E).performValidations(s(r,E).newChild(t,n))),this}prependChildElement(t,n){return s(this,b).prepend(s(r,E).performValidations(s(r,E).newChild(t,n))),this}replaceChildElement(t,n){return s(this,b).replace(s(this,b).findIndex(h=>h.id===t),s(r,E).newChild(n)),this}appendChildElements(t){return(u.isOf(t,window.Array)?t:u.forcedStringSplit(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(t){return(u.isOf(t,window.Array)?t:u.forcedStringSplit(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}checkChildElementIsIncludedById(t,n,h){let c=l=>u.isOf(l,window.Function)?l():void 0;return s(this,b).some(l=>l.id===t&&l.rendering)?c(n):c(h),this}includeChildElementById(t){return s(this,b).forEach(n=>n.id===t&&s(r,I).renderingIncluder(n)),this}excludeChildElementById(t){return s(this,b).forEach(n=>n.id===t&&s(r,I).renderingExcluder(n)),this}invalidateChildElementsById(t){return s(this,b).forEach(n=>t.indexOf(n.id)>-1&&s(r,I).cacheInvalidator(n)),this}invalidateChildElements(t){return u.isOf(t,window.Array)&&t.forEach(s(r,I).cacheInvalidator),this}makeField(t,n){return this[t]=n,s(this,K).append({name:t,value:n}),this}makeReactiveField(t,n,h,c=!0){return o(this,ye,is).call(this,t,n,h,c)}makeExternalReactiveField(t,n,h,c,l=!0){return this.makeReactiveField(n,t[n]||h,y=>{t[n]=this[n],c(y)},l)}},F=new WeakMap,R=new WeakMap,b=new WeakMap,K=new WeakMap,w=new WeakMap,yt=new WeakMap,_=new WeakMap,H=new WeakMap,tt=new WeakMap,B=new WeakMap,V=new WeakMap,Ft=new WeakMap,lt=new WeakMap,z=new WeakMap,et=new WeakMap,D=new WeakMap,Y=new WeakMap,W=new WeakMap,m=new WeakMap,St=new WeakMap,kt=new WeakMap,dt=new WeakMap,k=new WeakMap,$t=new WeakSet,Me=function(){},X=new WeakSet,ht=function(t){s(this,_)&&r.debug(`#${s(this,w).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},fe=new WeakSet,Je=function(){s(this,B)&&s(this,B).affiliate(),s(this,tt).affiliate(),f(this,lt,!0)},pe=new WeakSet,Qe=function(){f(this,B,s(this,R).length?new ft(s(this,V),s(r,E).makeStyleNode(s(this,w).styleMedia,s(this,w).styleType)):null),f(this,tt,new ft(s(this,V),s(r,E).makeMainNode(s(this,w).mainDefinition))),s(this,b).forEach(s(r,I).cacheInvalidator),s(this,R).forEach(s(r,I).cacheInvalidator)},me=new WeakSet,Ze=function(){s(this,lt)&&(s(this,tt).disaffiliate(),s(this,B)&&s(this,B).disaffiliate(),s(this,H)&&s(this,Ft)&&$.removeChildren(this)),f(this,lt,!1)},we=new WeakSet,ts=function(t){return{key:s(this,w).elementKeys&&t.key(),event:(n,h,c)=>{let l=this[`on_${n}_${h}`];if(l){let y=o(this,jt,Ue).call(this,n);y&&y[t.event](h,l,c)}},slots:()=>this.on_slot_change&&s(this,V).querySelectorAll("slot").forEach(n=>n[t.event]("slotchange",this.on_slot_change))}},st=new WeakSet,wt=function(t){if(s(this,z)&&!t||!s(this,z)&&t){let n=o(this,we,ts).call(this,t?s(this,kt).bind:s(this,kt).unbind);s(this,b).forEach(h=>{!h.rendering&&t||(n.key&&n.key(h),h.events.forEach(c=>c&&n.event(h.id,c.kind,c.capture)))}),s(this,H)&&n.slots(),f(this,z,t)}},jt=new WeakSet,Ue=function(t){return u.isNonEmptyString(t)?s(this,V).querySelector(`#${t}`):void 0},Kt=new WeakSet,xe=function(){s(this,m).root.reset(""),s(this,m).style.reset(""),s(this,m).main.reset(s(this,F));let t=s(this,H)?s(this,m).renderizers.children.mixed:s(this,m).renderizers.children.normal;s(this,b).forEach(n=>n.rendering&&t(n)),s(this,R).forEach(s(this,m).renderizers.rule),s(this,m).main.verify(n=>!s(this,dt).main.compute(n)),s(this,m).style.verify(n=>!s(this,dt).style.compute(n))},Bt=new WeakSet,Pe=function(){s(this,m).root.process(),s(this,m).style.process(),s(this,m).main.process(),r.DEBUG&&o(this,X,ht).call(this,s(this,m).getDebugInfo())},Ee=new WeakSet,es=function(){!r.RENDERING||(r.MEASURE&&s(this,k).partial.start(),o(this,v,M).call(this,"on_prerender"),o(this,Kt,xe).call(this),s(this,m).gotModified()?(o(this,st,wt).call(this,!1),o(this,Bt,Pe).call(this),o(this,st,wt).call(this,!0),this.info.updatedRounds++,o(this,v,M).call(this,"on_update"),o(this,Ht,$e).call(this,"on_refresh")):this.info.unmodifiedRounds++,r.DEBUG&&o(this,X,ht).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${s(this,dt).main.rounds}, style: ${s(this,dt).style.rounds}) | updated: ${this.info.updatedRounds}`),o(this,v,M).call(this,"on_postrender"),r.MEASURE&&s(this,k).partial.stop(r.DEBUG))},Gt=new WeakSet,Fe=function(t){o(this,pe,Qe).call(this),o(this,fe,Je).call(this),o(this,v,M).call(this,"on_inject"),o(this,Kt,xe).call(this),s(this,m).style.verify(n=>!!s(this,B)),o(this,Bt,Pe).call(this),o(this,st,wt).call(this,!0),o(this,v,M).call(this,t)},ge=new WeakSet,ss=function(t){r.MEASURE&&s(this,k).full.start(),o(this,st,wt).call(this,!1),o(this,me,Ze).call(this),o(this,v,M).call(this,"on_unload"),s(this,At).call(this),o(this,Gt,Fe).call(this,"on_reload"),o(this,Ht,$e).call(this,"on_repaint"),r.MEASURE&&s(this,k).full.stop(r.DEBUG)},_t=new WeakSet,ke=function(t,n="$none"){if(s(this,z)){let h=r.TextReplacements.ReplacementsScanners.rules(s(this,R),t);h.forEach(s(r,I).cacheInvalidator);let c=r.TextReplacements.ReplacementsScanners.children(s(this,b),t);c.forEach(s(r,I).cacheInvalidator),r.DEBUG&&o(this,X,ht).call(this,`reactive render (label: ${n}, field: ${t}, children: ${c.length}, rules: ${h.length})`),(!!h.length||!!c.length)&&(c.some(l=>!!l.kind.length)&&s(this,b).forEach(l=>l.kind===T.SLOTS_KIND?s(r,I).cacheInvalidator(l):void 0),this.render())}},ye=new WeakSet,is=function(t,n,h,c=!0){return r.makeReactiveField(this,t,n,h,(l,y)=>o(this,_t,ke).call(this,l,y||"$auto")),s(this,K).append({name:t,value:n}),c&&o(this,_t,ke).call(this,t,"$init"),this},v=new WeakSet,M=function(t,n){s(this,yt)[t]&&this[t].call(this,n)},Ht=new WeakSet,$e=function(t,n){s(this,W)&&this.persistToElementsStore(),s(this,yt)[t]&&window.requestAnimationFrame(()=>this[t].call(this,n))},At=new WeakMap,Se=new WeakSet,ns=function(){return s(this,W)?(f(this,D,s(this,et).hasItem(s(this,Y))?s(this,et).getItem(s(this,Y)):{generation:0,persisted:!1}),s(this,D).generation++,o(this,Tt,ne).call(this),!0):!1},Tt=new WeakSet,ne=function(){r.DEBUG&&(s(this,D).key=s(this,Y)),s(this,D).persisted=!!s(this,D).data,s(this,et).setItem(s(this,Y),s(this,D))},Vt=new WeakSet,je=function(){return s(this,W)?!0:(S.INVALID_KEY.emit(),!1)},d(Z,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),d(Z,"specializeClass",t=>class extends Z{constructor(){super(t)}}),d(Z,"instancesCount",0),Z)),a(A,q,(mt=class{static registerClasses(e){window.Array.prototype.forEach.call(e,o(s(r,q),Te,as))}static instantiateClasses(e,i){window.Array.prototype.forEach.call(e,t=>{var n;return window.customElements.get(t.tag)?o(n=s(r,q),Re,hs).call(n,t,i):S.UNREGISTERED_CLASS.emit(t.name)})}},Ae=new WeakSet,rs=function(e){return e.toLowerCase().replaceAll("_","-")},Te=new WeakSet,as=function(e){var i;u.isNonEmptyString(e.name)&&e.name.indexOf("_")>0?e.tag=o(i=s(r,q),Ae,rs).call(i,e.name):S.MISNAMED_CLASS.emit(e.name),window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):S.INVALID_CLASS.emit(e.name)},be=new WeakSet,os=function(e,i){let t=u.isNonEmptyString(i)?window.document.querySelector(i):window.document.body;t&&t.appendChild(window.document.createElement(e.tag))},Re=new WeakSet,hs=function(e,i){let t=()=>{var n;return o(n=s(r,q),be,os).call(n,e,i)};window.document.body?t():$.onDOMContentLoaded(t)},a(mt,Ae),a(mt,Te),a(mt,be),a(mt,Re),mt)),d(A,"NonShadowElement",s(r,L).specializeClass(s(r,L).RootMode.REGULAR)),d(A,"OpenShadowElement",s(r,L).specializeClass(s(r,L).RootMode.OPEN)),d(A,"ClosedShadowElement",s(r,L).specializeClass(s(r,L).RootMode.CLOSED)),(()=>{let e=(i,t)=>!i&&S.UNSUPPORTED_FEATURE.emit(t);try{e(u.isOf(window.document,window.HTMLDocument),"HTML Document"),e(u.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),$.onDOMContentLoaded(()=>e(u.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(i){S.UNKNOWN_ERROR.emit()}O.initialize((i,t)=>r.debug(JSON.stringify(u.buildArray(n=>{switch(n.push({instances:r.elementCount}),n.push(i.getDebugInfo()),t){case"stop":n.push(O.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(O.BrowserRender.overall.getDebugInfo());break}})))),r.TextReplacements.ReplacementMarkers.initialize(T.DEFAULT_REPLACEMENT_OPEN,T.DEFAULT_REPLACEMENT_CLOSE),r.TextReplacements.ReplacementsExtractors.initialize(r.TextReplacements.ReplacementMarkers.makeRegExp())})(),window.Wuse=A;})();
