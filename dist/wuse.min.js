(()=>{var ns=Object.defineProperty;var rs=(y,s,n)=>s in y?ns(y,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):y[s]=n;var l=(y,s,n)=>(rs(y,typeof s!="symbol"?s+"":s,n),n),Se=(y,s,n)=>{if(!s.has(y))throw TypeError("Cannot "+n)};var e=(y,s,n)=>(Se(y,s,"read from private field"),n?n.call(y):s.get(y)),a=(y,s,n)=>{if(s.has(y))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(y):s.set(y,n)},f=(y,s,n,t)=>(Se(y,s,"write to private field"),t?t.call(y,n):s.set(y,n),n);var c=(y,s,n)=>(Se(y,s,"access private method"),n);var yt=class{static onDOMContentLoaded(s){if(s&&s.constructor===window.Function){let n=()=>{s(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",n),100)};window.addEventListener("DOMContentLoaded",n)}}static getUniqueId(s="WUSE"){let n="_"+(s||"")+"_";for(var t;window.document.getElementById(t=n+(""+window.Math.random()).substring(2))!==null;);return t}static getCSSVendorPrefix(){let s=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(s).filter(i=>i.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var $t,R,be=class{static get UNKNOWN_ERROR(){return e(this,R).call(this,0,s=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return e(this,R).call(this,1,s=>`Unsupported feature: ${s}.`)}static get UNREGISTERED_CLASS(){return e(this,R).call(this,2,s=>`Unregistered class: ${s}.`)}static get INVALID_CLASS(){return e(this,R).call(this,3,s=>`Invalid class: ${s}.`)}static get MISNAMED_CLASS(){return e(this,R).call(this,4,s=>`Misnamed class: ${s}.`)}static get INVALID_DEFINITION(){return e(this,R).call(this,10,s=>`Invalid definition: ${s}.`)}static get INVALID_ID(){return e(this,R).call(this,11,s=>`Invalid id: ${s}.`)}static get INVALID_KEY(){return e(this,R).call(this,12,s=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return e(this,R).call(this,13,s=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return e(this,R).call(this,20,s=>`Inexistent template: #${s}.`)}static get EXTINCT_TEMPLATE(){return e(this,R).call(this,21,s=>`Extinct template: #${s}.`)}static get UNESPECIFIED_SLOT(){return e(this,R).call(this,22,s=>`Unespecified slot: #${s}.`)}},_=be;$t=new WeakMap,R=new WeakMap,a(_,$t,"[WUSE:ERROR]"),a(_,R,(s,n)=>({code:s,emit:t=>{let i=`${e(be,$t)} ${s} | ${n(t)}`;if(Wuse.FATALS||s<10)throw new window.Error(i);return window.console.error(i),null}}));var Xt,Y,Ke,qt,$e,Qt,Be,Zt,Ge,_t,He,ut,Jt,te,Ae,Ve,Bt,ee,bt,K,At,Te,xe,Gt,Ht,Vt,Oe,F,ft,Yt,je,C,zt,g,pt,se,ie,et,Ot,Rt,St,st,x,W,ne,ze,Pe,it,nt,ke,X,M,A,S,j,m,wt,$,B,q,P,G,Tt,rt,at,Q,N,H,V,w,Nt,k,re,ae,ot,ht,U,z,tt,oe,Je,he,Ye,ce,We,le,Xe,Z,dt,vt,Ne,It,ve,Ct,Ie,de,qe,Dt,Ce,ue,Qe,Lt,De,fe,Ze,Mt,Le,T,I,Ut,Me,mt,pe,_e,Et,Wt,Ft,Ue,we,lt,ts,me,es,Ee,ss,ge,is,O,xt,Re,jt,E,ye,ct,Pt,kt,b,Kt,gt,v,J,r=class{static get VERSION(){return"0.3.2"}static blockUpdate(s,n){if(r.isOf(s,Function)){r.DEBUG&&r.debug("blocking"),r.RENDERING=!1;try{s(n)}catch(t){throw t}finally{r.RENDERING=!0,r.DEBUG&&r.debug("unblocking")}}}static debug(s){window.console.log("[WUSE:DEBUG]",s)}static isOf(s,n){return!!(s&&s.constructor===n)}static isNonEmptyString(s){return typeof s=="string"&&!!s.length}static forcedStringSplit(s,n){return typeof s=="string"?s.split(n):new window.Array}static hasObjectKeys(s){return!!window.Object.keys(s).length}static buildArray(s){var n;return c(n=r,xt,Re).call(n,new window.Array,s)}static buildObject(s){var n;return c(n=r,xt,Re).call(n,new window.Object,s)}static register(s){return e(r,J).registerClasses(r.isOf(s,window.Array)?s:new window.Array(s))}static instantiate(s,n){return e(r,J).instantiateClasses(r.isOf(s,window.Array)?s:new window.Array(s),n)}static isShadowElement(s){let n=window.Object.getPrototypeOf(s.constructor);return n===r.OpenShadowElement||n===r.ClosedShadowElement}},p=r;O=new WeakMap,xt=new WeakSet,Re=function(s,n){return r.isOf(n,window.Function)&&n(s),s},jt=new WeakMap,E=new WeakMap,ye=new WeakMap,ct=new WeakMap,Pt=new WeakMap,kt=new WeakMap,b=new WeakMap,Kt=new WeakMap,gt=new WeakMap,v=new WeakMap,J=new WeakMap,a(p,xt),a(p,O,_),l(p,"WebHelpers",yt),l(p,"tmp",new window.Object),l(p,"DEBUG",!1),l(p,"FATALS",!1),l(p,"MEASURE",!1),l(p,"RENDERING",!0),a(p,jt,new window.Array),a(p,E,(Bt=class{static makeStyleNode(s,n){var t=window.document.createElement("style");return r.isNonEmptyString(s)&&t.setAttribute("media",s),r.isNonEmptyString(n)&&t.setAttribute("type",n),t.appendChild(window.document.createTextNode("")),t}static newRule(s,n){let t=r.isOf(s,window.Array)?s.join(","):""+s,i=r.isOf(n,window.Object)?n:e(this,bt).parse(n);return t.length?{selector:t,properties:i,cache:null}:null}static newNestedRule(s,n,t){let i=r.isOf(s,window.Array)?s.join(","):""+s,o=r.isOf(n,window.Array)?n.join(","):""+n,h=r.isOf(t,window.Object)?t:e(this,bt).parse(t);return!i.length||!o.length?null:{selector:i,nested:[{selector:o,properties:h}],cache:null}}static tryToJoinRules(s,n){if(s.selector===n.selector){for(let t in n.properties)s.properties[t]=n.properties[t];return s.cache=null,!0}return!1}static tryToJoinNestedRules(s,n){return r.isOf(s.nested,window.Array)&&s.selector===n.selector?(n.nested.forEach(t=>{var i=!1;for(let o in s.nested)if(i=s.nested[o].selector===t.selector){for(let h in t.properties)s.nested[o].properties[h]=t.properties[h];break}i||s.nested.push(t)}),s.cache=null,!0):!1}static makeMainNode(s){var n=window.document.createElement(s.tag);if(s.id.length&&n.setAttribute("id",s.id),s.classes.length&&n.setAttribute("class",s.classes.join(" ")),r.hasObjectKeys(s.style)){var t="";for(let i in s.style)t+=i+": "+s.style[i]+"; ";if(t.length){let i=t.trim();n.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(r.hasObjectKeys(s.attributes))for(let i in s.attributes)n.setAttribute(i,s.attributes[i]);return n}static newEvent(s,n){return typeof s=="string"&&typeof n=="boolean"?{kind:s,capture:n}:null}static performValidations(s){if(s.kind===e(r,b).TEMPLATES_KIND){if(!window.document.getElementById(s.id))return e(r,O).INEXISTENT_TEMPLATE.emit(s.id)}else if(s.kind===e(r,b).SLOTS_KIND){if(new String(s.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return e(r,O).UNESPECIFIED_SLOT.emit(s.id)}else if(typeof s.id!="string"||s.id!==""&&window.document.getElementById(s.id)!==null)return e(r,O).INVALID_ID.emit(s.id);return s}static newChild(s,n){var t=e(this,ee).parse(s.trimLeft());return t?(t.rules=r.isOf(n,window.Array)?n:new window.Array,t.rendering=!0,t.cache=null,t):e(r,O).INVALID_DEFINITION.emit(s)}static newDefinition(){return{kind:e(r,b).DEFAULT_KIND,tag:e(r,b).DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:""}}},ee=new WeakMap,bt=new WeakMap,a(Bt,ee,(Y=class{static parse(s){if(r.isNonEmptyString(s)){var n=e(r,E).newDefinition();return s.charAt(0)==="%"?s.startsWith(e(r,b).TEMPLATES_KIND)?c(this,ut,Jt).call(this,n,s.replace(n.kind=e(r,b).TEMPLATES_KIND,"")):s.startsWith(e(r,b).SLOTS_KIND)?c(this,ut,Jt).call(this,n,s.replace(n.kind=e(r,b).SLOTS_KIND,"")):null:c(this,ut,Jt).call(this,n,s)}return null}},Xt=new WeakSet,Ke=function(s,n){let t=n.indexOf("["),i=n.indexOf("]");if(t>-1&&i>-1&&i>t){let h=n.substr(t,i-t+1),d=h.substr(1,h.length-2).split("|");for(var o in d){let u=d[o].split("=");u[0]==="style"?u[1].split(";").forEach(D=>{let L=D.split(":"),Fe=L[0].trim();Fe.length&&(s.style[Fe]=L[1].trim())}):s.attributes[u[0]]=u[1]}return n.replace(h,"")}return n},qt=new WeakSet,$e=function(s,n){let t=n.indexOf("=");return t>-1?(s.content=n.slice(t+1),n.slice(0,t)):n},Qt=new WeakSet,Be=function(s,n){let t=n.replaceAll("!"," ").split(" ");return t.slice(1).map(i=>{let[o,...h]=i.toLowerCase().split("+"),d=(h||e(r,jt)).indexOf("capture")>-1;s.events.push(e(r,E).newEvent(o,d))}),t[0]},Zt=new WeakSet,Ge=function(s,n){let t=n.replaceAll("."," ").split(" ");return s.classes=t.slice(1),t[0]},_t=new WeakSet,He=function(s,n){if(n!==""){let t=n.indexOf("#");t===-1?s.tag=n:(t>0&&(s.tag=n.substr(0,t)),s.id=n.substr(t+1))}return s},ut=new WeakSet,Jt=function(s,n){return c(this,_t,He).call(this,s,c(this,Zt,Ge).call(this,s,c(this,Qt,Be).call(this,s,c(this,qt,$e).call(this,s,c(this,Xt,Ke).call(this,s,n)))))},a(Y,Xt),a(Y,qt),a(Y,Qt),a(Y,Zt),a(Y,_t),a(Y,ut),Y)),a(Bt,bt,(Ae=class{static parse(s){let n=new window.Object;return(r.isOf(s,window.Array)?s:r.forcedStringSplit(s,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>r.isNonEmptyString(t)&&c(this,te,Ve).call(this,n,t.trim())),n}},te=new WeakSet,Ve=function(s,n){if(!!n.length&&n.indexOf(":")>-1){let[t,...i]=n.split(":"),o=t.trim();if(o.length){let h=i.join(":").trim();s[o]=h.endsWith(";")?h.slice(0,-1):h}}},a(Ae,te),Ae)),Bt)),l(p,"SimpleStorage",(xe=class{constructor(){a(this,At);a(this,K,new window.Object)}get length(){return c(this,At,Te).call(this).length}key(s){return c(this,At,Te).call(this)[s]||null}getItem(s){return e(this,K)[s]}setItem(s,n){e(this,K)[s]=n}removeItem(s){delete e(this,K)[s]}clear(){f(this,K,new window.Object)}has(s){return e(this,K).hasOwnProperty(s)}},K=new WeakMap,At=new WeakSet,Te=function(){return window.Object.keys(e(this,K))},xe)),a(p,ye,new r.SimpleStorage),a(p,ct,s=>s>1e3?(s/1e3).toFixed(2)+"s":s.toFixed(2)+"ms"),a(p,Pt,class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var n,t;var s=new window.Object;return s.round=this.round,s.domTime=e(n=r,ct).call(n,this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(s.renderTime=e(t=r,ct).call(t,this.renderTime)),s}}),a(p,kt,class{constructor(s){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=s}compute(s){this.rounds++,this.time+=s,this.average=this.time/this.rounds}getDebugInfo(){var t,i;let s=e(t=r,ct).call(t,this.time),n=e(i=r,ct).call(i,this.average);return{name:this.name,rounds:this.rounds,spent:s,average:n}}}),l(p,"StopWatch",(Vt=class{constructor(){l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new(e(r,Pt)));l(this,"best",new(e(r,Pt)));l(this,"averages",{dom:0,render:0})}start(){(r.StopWatch.DOMUpdate.check||r.StopWatch.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(){r.StopWatch.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,r.StopWatch.DOMUpdate.overall.compute(this.last.domTime)),r.StopWatch.BrowserRender.check?setTimeout(this.finish.bind(this)):r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.DOMUpdate.overall.getDebugInfo()))}finish(){this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,r.StopWatch.BrowserRender.overall.compute(this.last.renderTime),r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.BrowserRender.overall.getDebugInfo()))}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages,instances:e(r,v).instancesCount}}},l(Vt,"DOMUpdate",(Gt=class{},l(Gt,"check",!0),l(Gt,"overall",new(e(r,kt))("overall-dom-update")),Gt)),l(Vt,"BrowserRender",(Ht=class{},l(Ht,"check",!1),l(Ht,"overall",new(e(r,kt))("overall-browser-render")),Ht)),Vt)),l(p,"WasteAnalyzer",(Oe=class{constructor(){l(this,"rounds",0);l(this,"last",0);l(this,"hash",0);l(this,"wasted",!1)}compute(s){return this.rounds+=+(this.wasted=this.last===(this.hash=r.WasteAnalyzer.hashRoutine(s))),this.last=this.hash,this.wasted}},l(Oe,"hashRoutine",s=>{var n=0;for(let t=0;t<s.length;t++)n=(n=(n<<5)-n+s.charCodeAt(t))&n;return n}),Oe)),a(p,b,(F=class{},l(F,"TEMPLATES_KIND","%templates%"),l(F,"SLOTS_KIND","%slots%"),l(F,"DEFAULT_KIND",""),l(F,"DEFAULT_TAG","div"),l(F,"DEFAULT_STYLE_MEDIA","screen"),l(F,"DEFAULT_STYLE_TYPE","text/css"),l(F,"DEFAULT_REPLACEMENT_OPEN","~{"),l(F,"DEFAULT_REPLACEMENT_CLOSE","}~"),F)),l(p,"ObjectsArray",(je=class extends window.Array{constructor(n){super();a(this,ft);l(this,"owner",null);l(this,"last",null);l(this,"version",0);this.owner=n}append(n){r.isOf(n,window.Object)&&(this.push(n),c(this,ft,Yt).call(this,n))}prepend(n){r.isOf(n,window.Object)&&(this.unshift(n),c(this,ft,Yt).call(this,n))}replace(n,t){n>-1&&r.isOf(t,window.Object)&&c(this,ft,Yt).call(this,this[n]=t)}on_version_change(){}persist(){let n=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":n[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,this[t]);i.cache&&(i.cache=null),n.push(i)}break}}),n}restore(n){window.Object.getOwnPropertyNames(n).forEach(t=>{switch(t){case"length":break;case"version":this[t]=n[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,n[t]);i.cache&&(i.cache=null),this.push(i)}break}})}},ft=new WeakSet,Yt=function(n){this.last=n,this.version++,this.on_version_change()},je)),l(p,"ReactiveFields",(St=class{static make(s,n,t,i,o){let h=(D,L)=>window.Object.defineProperty(s,n,{get:D,set:L,enumerable:!0,configurable:!0}),d=()=>delete s[n],u=(D,L)=>this.make(s,n,D,L,o);h(()=>t,D=>{u(D,i),r.isOf(i,window.Function)?i({renderize:L=>o(n,L),automate:()=>u(D,null),freeze:()=>h(()=>D,L=>{}),defreeze:()=>u(D,i),dereact:()=>h(()=>D,L=>{d(),s[n]=L}),remove:()=>d()}):o(n)})}},l(St,"ReplacementMarkers",(C=class{},l(C,"begin",e(r,b).DEFAULT_REPLACEMENT_OPEN),l(C,"end",e(r,b).DEFAULT_REPLACEMENT_CLOSE),l(C,"enclose",n=>C.begin+n+C.end),l(C,"makeRegExp",()=>new RegExp("(?<="+C.begin+").*?(?="+C.end+")","gs")),C)),l(St,"ReplacementsScanners",(zt=class{},l(zt,"rules",(s,n)=>r.buildArray(t=>s.forEach(i=>i.replacements.forEach(o=>o.field===n&&t.push(i))))),l(zt,"children",(s,n)=>r.buildArray(t=>{let i=o=>{let h=d=>d.forEach(u=>u.field===n&&t.push(o));["contents","classes","styles","attributes"].forEach(d=>h(o.replacements[d])),o.rules.forEach(d=>d.replacements.forEach(u=>u.field===n&&t.push(o)))};s.forEach(o=>o.rendering&&i(o))})),zt)),l(St,"ReplacementsExtractors",(g=class{},pt=new WeakMap,se=new WeakMap,ie=new WeakMap,et=new WeakMap,Ot=new WeakMap,Rt=new WeakMap,a(g,pt,null),a(g,se,n=>n.match(e(g,pt)?e(g,pt):f(g,pt,r.ReactiveFields.ReplacementMarkers.makeRegExp()))),a(g,ie,(n,t,i)=>n.push({at:t,find:r.ReactiveFields.ReplacementMarkers.enclose(i),field:i.trim()})),a(g,et,(n,t,i)=>{var o;return r.isNonEmptyString(i)&&(e(o=g,se).call(o,i)||e(r,jt)).forEach(h=>{var d;return e(d=g,ie).call(d,n,t,h)})}),a(g,Ot,(n,t,i)=>{var o;n[t]=new window.Array,e(o=g,et).call(o,n[t],t,i)}),a(g,Rt,(n,t,i)=>{n[t]=new window.Array,window.Object.keys(i).forEach(o=>{var h,d;e(h=r.ReactiveFields.ReplacementsExtractors,et).call(h,n[t],t,o),e(d=r.ReactiveFields.ReplacementsExtractors,et).call(d,n[t],t,i[o])})}),l(g,"child",n=>r.buildObject(t=>{var i,o,h,d;e(i=g,Ot).call(i,t,"contents",n.content),e(o=g,Ot).call(o,t,"classes",n.classes.join(" ")),e(h=g,Rt).call(h,t,"styles",n.style),e(d=g,Rt).call(d,t,"attributes",n.attributes),n.rules.forEach(u=>u.replacements=r.ReactiveFields.ReplacementsExtractors.rule(u))})),l(g,"rule",n=>r.buildArray(t=>{var o;if(r.isOf(n.nested,window.Array))return n.nested.map(h=>r.ReactiveFields.ReplacementsExtractors.rule(h));var i="";for(let h in n.properties)i+=h+":"+n.properties[h]+";";e(o=g,et).call(o,t,"rules",i)})),g)),St)),a(p,Kt,(Pe=class{constructor(s,n){a(this,ne);a(this,st,null);a(this,x,null);a(this,W,null);f(this,st,s),f(this,x,n),f(this,W,n.cloneNode(!1))}get element(){return e(this,x)}affiliate(){e(this,st).appendChild(e(this,x))}disaffiliate(s){e(this,st).removeChild(e(this,x))}promote(s){e(this,W).innerHTML=s,e(this,st).replaceChild(e(this,W),e(this,x)),c(this,ne,ze).call(this)}},st=new WeakMap,x=new WeakMap,W=new WeakMap,ne=new WeakSet,ze=function(){let s=e(this,W);f(this,W,e(this,x).cloneNode(!1)),f(this,x,s)},Pe)),a(p,gt,(ke=class{constructor(s){l(this,"owner",null);a(this,it,!1);a(this,nt,"");this.owner=s}reset(s){f(this,it,!1),f(this,nt,s)}append(s){f(this,nt,e(this,nt)+s)}verify(s){r.isOf(s,window.Function)&&f(this,it,s(e(this,nt)))}process(){e(this,it)&&this.on_content_invalidation(e(this,nt))}get invalidated(){return e(this,it)}on_content_invalidation(s){}},it=new WeakMap,nt=new WeakMap,ke)),a(p,v,(X=class extends window.HTMLElement{constructor(t){super();a(this,z);a(this,oe);a(this,he);a(this,ce);a(this,le);a(this,Z);a(this,vt);a(this,It);a(this,Ct);a(this,de);a(this,Dt);a(this,ue);a(this,Lt);a(this,fe);a(this,Mt);a(this,T);a(this,Ut);a(this,pe);a(this,Et);a(this,Ft);a(this,M,"");a(this,A,new class extends r.ObjectsArray{on_version_change(){var t;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.rule(this.last),r.DEBUG&&c(t=this.owner,z,tt).call(t,`rules list version change: ${this.version}`)}}(this));a(this,S,new class extends r.ObjectsArray{on_version_change(){var t,i;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.child(this.last),f(t=this.owner,B,e(t,B)|this.last.kind===e(r,b).SLOTS_KIND),r.DEBUG&&c(i=this.owner,z,tt).call(i,`children list version change: ${this.version}`)}}(this));a(this,j,new class extends r.ObjectsArray{on_version_change(){var t;r.DEBUG&&c(t=this.owner,z,tt).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));a(this,m,{mainDefinition:e(r,E).newDefinition(),styleMedia:e(r,b).DEFAULT_STYLE_MEDIA,styleType:e(r,b).DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});a(this,wt,new window.Object);a(this,$,!1);a(this,B,!1);a(this,q,void 0);a(this,P,void 0);a(this,G,null);a(this,Tt,r.isShadowElement(this));a(this,rt,!1);a(this,at,!1);a(this,Q,e(r,ye));a(this,N,null);a(this,H,"");a(this,V,!1);a(this,w,{root:new class extends e(r,gt){on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends e(r,gt){on_content_invalidation(t){e(this.owner,P).promote(t)}}(this),main:new class extends e(r,gt){on_content_invalidation(t){e(this.owner,q).promote(t)}}(this),renderizers:{rule:t=>e(this,w).style.append(t.cache?t.cache:t.cache=e(this,ot).rule(t)),children:{mixed:t=>e(this,Tt)&&t.kind===e(r,b).SLOTS_KIND?e(this,w).renderizers.children.slot(t):e(this,w).renderizers.children.normal(t),slot:t=>{t.cache||(e(this,w).root.verify(i=>!0),e(this,w).root.append(t.cache=e(this,ot).child(t)))},normal:t=>{e(this,w).main.append(t.cache?t.cache:t.cache=e(this,ot).child(t)),t.rules.forEach(e(this,w).renderizers.rule)}}},gotModified:()=>e(this,w).root.invalidated||e(this,w).main.invalidated||e(this,w).style.invalidated,getDebugInfo:()=>`updated (root: ${e(this,w).root.invalidated}, main: ${e(this,w).main.invalidated}, style: ${e(this,w).style.invalidated})`});a(this,Nt,{bind:{key:()=>{let t=i=>{r.isNonEmptyString(i)&&(this[i]=c(this,vt,Ne).call(this,i))};return e(this,$)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"addEventListener"},unbind:{key:()=>{let t=i=>delete this[i];return e(this,$)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"removeEventListener"}});a(this,k,t=>t.cache=null);a(this,re,t=>t.rendering=!0);a(this,ae,t=>t.rendering=!1);a(this,ot,{rule:t=>{if(r.isOf(t.nested,window.Array))return t.selector+"{"+t.nested.map(o=>e(this,ot).rule(o)).join(`
`)+"}";if(t.selector!==""){var i="";for(let o in t.properties)i+=o+":"+t.properties[o]+";";return r.isOf(t.replacements,window.Array)&&t.replacements.forEach(o=>i=i.replace(o.find,this[o.field]!==void 0?this[o.field]:"")),t.selector+"{"+i+"}"}return null},child:t=>{if(t.kind===e(r,b).TEMPLATES_KIND){let d=window.document.getElementById(t.id);return d!==null?d.innerHTML:e(r,O).EXTINCT_TEMPLATE.emit(t.id)}let i=(d,u)=>d.replace(u.find,this[u.field]!==void 0?this[u.field]:"");var o="<"+t.tag;if(r.isNonEmptyString(t.id)&&(o+=" id='"+t.id+"'"),t.classes.length){var h=t.classes.join(" ");t.replacements.classes.forEach(d=>h=i(h,d)),o+=" class='"+h+"'"}if(r.hasObjectKeys(t.style)){var h=" style='";for(let u in t.style)h+=u+": "+t.style[u]+"; ";h+="'",t.replacements.styles.forEach(u=>h=i(h,u)),o+=h}if(r.hasObjectKeys(t.attributes)){var h="";for(let u in t.attributes)h+=" "+u+"="+t.attributes[u];t.replacements.attributes.forEach(u=>h=i(h,u)),o+=h}if(typeof t.content=="string"){var h=t.content;t.replacements.contents.forEach(u=>h=i(h,u)),o+=">"+h+"</"+t.tag+">"}else o+="/>";return o}});a(this,ht,{main:new r.WasteAnalyzer,style:new r.WasteAnalyzer});a(this,U,{attachment:new r.StopWatch,partial:new r.StopWatch,full:new r.StopWatch,dettachment:new r.StopWatch});a(this,mt,()=>e(r,v).EVENT_NAMES.forEach(t=>e(this,wt)[t]=typeof this[t]=="function"));l(this,"info",{instanceNumber:++e(r,v).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,G,t!==e(r,v).RootMode.REGULAR?this.attachShadow({mode:t}):this),e(this,mt).call(this),c(this,T,I).call(this,"on_create"),e(this,m).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),c(this,pe,_e).call(this)&&e(this,N).generation>1?c(this,T,I).call(this,"on_reconstruct",e(this,N)):c(this,T,I).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}render(){}redraw(){}connectedCallback(){r.MEASURE&&e(this,U).attachment.start(),e(this,mt).call(this),c(this,T,I).call(this,"on_connect"),c(this,Mt,Le).call(this,"render",c(this,de,qe)),c(this,Mt,Le).call(this,"redraw",c(this,ue,Qe)),c(this,Dt,Ce).call(this,"on_load"),e(this,V)&&this.persistToElementsStore(),r.MEASURE&&e(this,U).attachment.stop()}disconnectedCallback(){r.MEASURE&&e(this,U).dettachment.start(),c(this,Z,dt).call(this,!1),c(this,T,I).call(this,"on_disconnect"),r.MEASURE&&e(this,U).dettachment.stop()}getElementsStore(){return e(this,Q)}setElementsStore(t){f(this,Q,t)}hasElementsStoreKey(t){return e(this,V)}getElementsStoreKey(t){return e(this,H)}setElementsStoreKey(t){return f(this,V,r.isNonEmptyString(f(this,H,t))),this}persistToElementsStore(){if(c(this,Ft,Ue).call(this)){let t=e(this,N);if(t)return e(this,j).snapshot(),t.data=new window.Object({options:e(this,m),html:e(this,M),children:e(this,S).persist(),rules:e(this,A).persist(),fields:e(this,j).persist(),slotted:e(this,B),identified:e(this,$)}),c(this,Et,Wt).call(this),!0}return!1}restoreFromElementsStore(t){if(c(this,Ft,Ue).call(this)){let i=e(this,N);if(i&&i.persisted&&i.data)return f(this,m,i.data.options),f(this,B,i.data.slotted),f(this,$,i.data.identified),f(this,M,i.data.html),e(this,S).restore(i.data.children),e(this,S).owner=this,e(this,A).restore(i.data.rules),e(this,A).owner=this,e(this,j).restore(i.data.fields),e(this,j).owner=this,e(this,j).recall(),t||(delete i.data,c(this,Et,Wt).call(this)),!0}return!1}selectChildElement(t){return e(this,G).querySelector(t)}setMainAttribute(t,i){e(this,rt)&&e(this,q).element.setAttribute(t,i)}setMainElement(t){let i=e(r,E).newChild(t);if(e(r,E).performValidations(i)){if(i.content!==""||!!i.events.length)return e(r,O).INVALID_DEFINITION.emit(t);f(this,$,!!i.id.length)&&(e(this,m).mainDefinition.id=i.id),i.tag.length&&(e(this,m).mainDefinition.tag=i.tag),i.classes.length&&(e(this,m).mainDefinition.classes=i.classes),i.style&&(e(this,m).mainDefinition.style=i.style),i.attributes&&(e(this,m).mainDefinition.attributes=i.attributes)}return this}setStyleOptions(t,i){return e(this,m).styleMedia=t||"",e(this,m).styleType=i||"",this}setElementsAsKeys(t){return e(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return e(this,m).attributeKeys=!!t,this}allowRawContent(t){return e(this,m).rawContent=!!t,this}setRawContent(t){return e(this,m).rawContent?f(this,M,t):e(r,O).ALLOW_HTML.emit(),this}appendRawContent(t){return e(this,m).rawContent?f(this,M,e(this,M)+t):e(r,O).ALLOW_HTML.emit(),this}prependRawContent(t){return e(this,m).rawContent?f(this,M,t+e(this,M)):e(r,O).ALLOW_HTML.emit(),this}appendCSSRule(t,i,o){if(o)return this.appendCSSNestedRule(t,i,o);let h=e(this,A).slice(-1),d=e(r,E).newRule(t,i);return(!h.length||!e(r,E).tryToJoinRules(h[0],d))&&e(this,A).append(d),this}prependCSSRule(t,i,o){if(o)return this.prependCSSNestedRule(t,i,o);let h=e(this,A).slice(0,1),d=e(r,E).newRule(t,i);return(!h.length||!e(r,E).tryToJoinRules(h[0],d))&&e(this,A).prepend(d),this}appendCSSNestedRule(t,i,o){let h=e(this,A).slice(-1),d=e(r,E).newNestedRule(t,i,o);return(!h.length||!e(r,E).tryToJoinNestedRules(h[0],d))&&e(this,A).append(d),this}prependCSSNestedRule(t,i,o){let h=e(this,A).slice(0,1),d=e(r,E).newNestedRule(t,i,o);return(!h.length||!e(r,E).tryToJoinNestedRules(h[0],d))&&e(this,A).prepend(d),this}appendChildElement(t,i){return e(this,S).append(e(r,E).performValidations(e(r,E).newChild(t,i))),this}prependChildElement(t,i){return e(this,S).prepend(e(r,E).performValidations(e(r,E).newChild(t,i))),this}replaceChildElement(t,i){return e(this,S).replace(e(this,S).findIndex(o=>o.id===t),e(r,E).newChild(i)),this}appendChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}checkChildElementIsIncludedById(t,i,o){let h=d=>r.isOf(d,window.Function)?d():void 0;return e(this,S).some(d=>d.id===t&&d.rendering)?h(i):h(o),this}includeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,re).call(this,i)),this}excludeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,ae).call(this,i)),this}invalidateChildElementsById(t){return e(this,S).forEach(i=>t.indexOf(i.id)>-1&&e(this,k).call(this,i)),this}invalidateChildElements(t){return r.isOf(t,window.Array)&&t.forEach(e(this,k)),this}makeField(t,i){return this[t]=i,e(this,j).append({name:t,value:i}),this}makeReactiveField(t,i,o,h=!0){return c(this,fe,Ze).call(this,t,i,o,h),e(this,j).append({name:t,value:i}),this}makeExternalReactiveField(t,i,o,h,d=!0){return this.makeReactiveField(i,t[i]||o,u=>{t[i]=this[i],h(u)},d),this}},M=new WeakMap,A=new WeakMap,S=new WeakMap,j=new WeakMap,m=new WeakMap,wt=new WeakMap,$=new WeakMap,B=new WeakMap,q=new WeakMap,P=new WeakMap,G=new WeakMap,Tt=new WeakMap,rt=new WeakMap,at=new WeakMap,Q=new WeakMap,N=new WeakMap,H=new WeakMap,V=new WeakMap,w=new WeakMap,Nt=new WeakMap,k=new WeakMap,re=new WeakMap,ae=new WeakMap,ot=new WeakMap,ht=new WeakMap,U=new WeakMap,z=new WeakSet,tt=function(t){e(this,$)&&r.debug(`#${e(this,m).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},oe=new WeakSet,Je=function(){e(this,P)&&e(this,P).affiliate(),e(this,q).affiliate(),f(this,rt,!0)},he=new WeakSet,Ye=function(){f(this,P,e(this,A).length?new(e(r,Kt))(e(this,G),e(r,E).makeStyleNode(e(this,m).styleMedia,e(this,m).styleType)):null),f(this,q,new(e(r,Kt))(e(this,G),e(r,E).makeMainNode(e(this,m).mainDefinition))),e(this,S).forEach(e(this,k)),e(this,A).forEach(e(this,k))},ce=new WeakSet,We=function(){e(this,rt)&&(e(this,q).disaffiliate(),e(this,P)&&e(this,P).disaffiliate(),e(this,B)&&e(this,Tt)&&(this.innerHTML="")),f(this,rt,!1)},le=new WeakSet,Xe=function(t){return{key:e(this,m).elementKeys&&t.key(),event:(i,o,h)=>{let d=this[`on_${i}_${o}`];if(d){let u=c(this,vt,Ne).call(this,i);u&&u[t.event](o,d,h)}},slots:()=>this.on_slot_change&&e(this,G).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}},Z=new WeakSet,dt=function(t){if(e(this,at)&&!t||!e(this,at)&&t){let i=c(this,le,Xe).call(this,t?e(this,Nt).bind:e(this,Nt).unbind);e(this,S).forEach(o=>{!o.rendering&&t||(i.key&&i.key(o),o.events.forEach(h=>h&&i.event(o.id,h.kind,h.capture)))}),e(this,B)&&i.slots(),f(this,at,t)}},vt=new WeakSet,Ne=function(t){return r.isNonEmptyString(t)?e(this,G).querySelector(`#${t}`):void 0},It=new WeakSet,ve=function(){e(this,w).root.reset(""),e(this,w).style.reset(""),e(this,w).main.reset(e(this,M));let t=e(this,B)?e(this,w).renderizers.children.mixed:e(this,w).renderizers.children.normal;e(this,S).forEach(i=>i.rendering&&t(i)),e(this,A).forEach(e(this,w).renderizers.rule),e(this,w).main.verify(i=>!e(this,ht).main.compute(i)),e(this,w).style.verify(i=>!e(this,ht).style.compute(i))},Ct=new WeakSet,Ie=function(){e(this,w).root.process(),e(this,w).style.process(),e(this,w).main.process(),r.DEBUG&&c(this,z,tt).call(this,e(this,w).getDebugInfo())},de=new WeakSet,qe=function(){!r.RENDERING||(r.MEASURE&&e(this,U).partial.start(),c(this,T,I).call(this,"on_prerender"),c(this,It,ve).call(this),e(this,w).gotModified()?(c(this,Z,dt).call(this,!1),c(this,Ct,Ie).call(this),c(this,Z,dt).call(this,!0),this.info.updatedRounds++,c(this,T,I).call(this,"on_update"),c(this,Ut,Me).call(this,"on_refresh")):this.info.unmodifiedRounds++,r.DEBUG&&c(this,z,tt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${e(this,ht).main.rounds}, style: ${e(this,ht).style.rounds}) | updated: ${this.info.updatedRounds}`),c(this,T,I).call(this,"on_postrender"),r.MEASURE&&e(this,U).partial.stop())},Dt=new WeakSet,Ce=function(t){c(this,he,Ye).call(this),c(this,oe,Je).call(this),c(this,T,I).call(this,"on_inject"),c(this,It,ve).call(this),e(this,w).style.verify(i=>!!e(this,P)),c(this,Ct,Ie).call(this),c(this,Z,dt).call(this,!0),c(this,T,I).call(this,t)},ue=new WeakSet,Qe=function(t){r.MEASURE&&e(this,U).full.start(),c(this,Z,dt).call(this,!1),c(this,ce,We).call(this),c(this,T,I).call(this,"on_unload"),e(this,mt).call(this),c(this,Dt,Ce).call(this,"on_reload"),c(this,Ut,Me).call(this,"on_repaint"),r.MEASURE&&e(this,U).full.stop()},Lt=new WeakSet,De=function(t,i="$none"){if(e(this,at)){let o=r.ReactiveFields.ReplacementsScanners.rules(e(this,A),t);o.forEach(e(this,k));let h=r.ReactiveFields.ReplacementsScanners.children(e(this,S),t);h.forEach(e(this,k)),r.DEBUG&&c(this,z,tt).call(this,`reactive render (label: ${i}, field: ${t}, children: ${h.length}, rules: ${o.length})`),(!!o.length||!!h.length)&&(h.some(d=>!!d.kind.length)&&e(this,S).forEach(d=>d.kind===e(r,b).SLOTS_KIND?e(this,k).call(this,d):void 0),this.render())}},fe=new WeakSet,Ze=function(t,i,o,h=!0){r.ReactiveFields.make(this,t,i,o,(d,u)=>c(this,Lt,De).call(this,d,u||"$auto")),h&&c(this,Lt,De).call(this,t,"$init")},Mt=new WeakSet,Le=function(t,i){delete this[t],window.Object.defineProperty(this,t,{value:i})},T=new WeakSet,I=function(t,i){e(this,wt)[t]&&this[t].call(this,i)},Ut=new WeakSet,Me=function(t,i){e(this,V)&&this.persistToElementsStore(),e(this,wt)[t]&&window.requestAnimationFrame(()=>this[t].call(this,i))},mt=new WeakMap,pe=new WeakSet,_e=function(){return e(this,V)?(f(this,N,e(this,Q).has(e(this,H))?e(this,Q).getItem(e(this,H)):{generation:0,persisted:!1}),e(this,N).generation++,c(this,Et,Wt).call(this),!0):!1},Et=new WeakSet,Wt=function(){r.DEBUG&&(e(this,N).key=e(this,H)),e(this,N).persisted=!!e(this,N).data,e(this,Q).setItem(e(this,H),e(this,N))},Ft=new WeakSet,Ue=function(){return e(this,V)?!0:(e(r,O).INVALID_KEY.emit(),!1)},l(X,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),l(X,"specializeClass",t=>class extends X{constructor(){super(t)}}),l(X,"instancesCount",0),X)),a(p,J,(lt=class{static registerClasses(s){window.Array.prototype.forEach.call(s,c(e(r,J),me,es))}static instantiateClasses(s,n){window.Array.prototype.forEach.call(s,t=>{var i;return window.customElements.get(t.tag)?c(i=e(r,J),ge,is).call(i,t,n):e(r,O).UNREGISTERED_CLASS.emit(t.name)})}},we=new WeakSet,ts=function(s){return s.toLowerCase().replaceAll("_","-")},me=new WeakSet,es=function(s){var n;r.isNonEmptyString(s.name)&&s.name.indexOf("_")>0?s.tag=c(n=e(r,J),we,ts).call(n,s.name):e(r,O).MISNAMED_CLASS.emit(s.name),window.HTMLElement.isPrototypeOf(s)?window.customElements.define(s.tag,s):e(r,O).INVALID_CLASS.emit(s.name)},Ee=new WeakSet,ss=function(s,n){let t=r.isNonEmptyString(n)?window.document.querySelector(n):window.document.body;t&&t.appendChild(window.document.createElement(s.tag))},ge=new WeakSet,is=function(s,n){let t=()=>{var i;return c(i=e(r,J),Ee,ss).call(i,s,n)};window.document.body?t():r.WebHelpers.onDOMContentLoaded(t)},a(lt,we),a(lt,me),a(lt,Ee),a(lt,ge),lt)),l(p,"NonShadowElement",e(r,v).specializeClass(e(r,v).RootMode.REGULAR)),l(p,"OpenShadowElement",e(r,v).specializeClass(e(r,v).RootMode.OPEN)),l(p,"ClosedShadowElement",e(r,v).specializeClass(e(r,v).RootMode.CLOSED)),(()=>{let s=(n,t)=>!n&&e(r,O).UNSUPPORTED_FEATURE.emit(t);try{s(r.isOf(window.document,window.HTMLDocument),"HTML Document"),s(r.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),r.WebHelpers.onDOMContentLoaded(()=>s(r.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){e(r,O).UNKNOWN_ERROR.emit()}})(),window.Wuse=p;})();
