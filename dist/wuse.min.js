(()=>{var _s=Object.defineProperty;var vs=(r,e,t)=>e in r?_s(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var l=(r,e,t)=>(vs(r,typeof e!="symbol"?e+"":e,t),t),gi=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var s=(r,e,t)=>(gi(r,e,"read from private field"),t?t.call(r):e.get(r)),o=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},d=(r,e,t,i)=>(gi(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);var h=(r,e,t)=>(gi(r,e,"access private method"),t);var A=(r,e)=>({code:r,emit:t=>{let i=r<80?"error":"warn",n=`[WUSE:${i.toUpperCase()}] ${r} | ${e(t)}`;if(window.Wuse&&window.Wuse.FATALS||r<10)throw new window.Error(n);return window.console[i](n),null}}),b=class{static get UNKNOWN_ERROR(){return A(0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return A(1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return A(2,e=>`Unregistered class: ${e}.`)}static get UNREGISTRABLE_CLASS(){return A(3,e=>`Unregistrable class: ${e}.`)}static get INVALID_CLASS(){return A(4,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return A(5,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return A(10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return A(11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return A(12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return A(13,e=>"Call first: this.allowRawContent(true).")}static get INVALID_STATE(){return A(14,e=>"Invalid state.")}static get TAKEN_ID(){return A(15,e=>`Taken id: ${e}.`)}static get INEXISTENT_TEMPLATE(){return A(20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return A(21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return A(22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return A(30,e=>`Unespecified slot: #${e}.`)}static get LOCKED_DEFINITION(){return A(40,e=>`Locked definition: #${e}.`)}static get UNKNOWN_TAG(){return A(80,e=>`Unknown tag: ${e}.`)}static get BAD_TARGET(){return A(81,e=>`Bad target: ${e}.`)}static get ALREADY_REGISTERED(){return A(90,e=>`Already registered: ${e}.`)}};var ke,Me,Mi=(r,e)=>(typeof e=="function"&&e(r),r),w=class{static get EMPTY_STRING(){return s(this,ke)}static get EMPTY_ARRAY(){return s(this,Me)}static noop(){}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,t){return typeof e=="string"?e.split(t):new window.Array}static buildArray(e){return Mi(new window.Array,e)}static buildObject(e){return Mi(new window.Object,e)}static ensureFunction(e,t=()=>{}){return typeof e=="function"?e:t}static isOf(e,t){return e!=null&&(e.constructor===t||t!=null&&e.constructor.name===t.name)}static areOf(e,t){var i=!!(e&&e.constructor===window.Array&&!!e.length);if(i)for(var n in e){let a=e[n];if(!(a!=null&&(a.constructor===t||t!=null&&a.constructor.name===t.name))){i=!1;break}}return i}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static cloneObject(e){return window.Object.assign(new window.Object,e)}static forEachOwnProperty(e,t){e&&window.Object.getOwnPropertyNames(e).forEach(t)}static isAssignedObject(e){return typeof e=="object"&&e!==null}static isAssignedArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"}static isNonEmptyArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"&&!!e.length}static isIntegerNumber(e){return(typeof e=="number"||typeof e=="string"&&!!e.length)&&window.Number.isInteger(window.Number(e))}};ke=new WeakMap,Me=new WeakMap,o(w,ke,new window.String().valueOf()),o(w,Me,window.Object.freeze(new window.Array));var Ct,Nt,{noop:xi,ensureFunction:Fi,isAssignedObject:Os}=w,ot=class{static fetch(e){let t=window.document.getElementById(e);return t===null?s(this,Ct).call(this,e):t.tagName!=="TEMPLATE"?s(this,Nt).call(this,e):t.innerHTML}static initialize(e){Os(e)&&(d(this,Ct,Fi(e.onExtinctTemplate,s(this,Ct))),d(this,Nt,Fi(e.onInvalidTemplate,s(this,Nt))))}};Ct=new WeakMap,Nt=new WeakMap,o(ot,Ct,xi),o(ot,Nt,xi);var Rt,Ut,Wt,kt,Mt,xt,Ft,xe,ji,Fe,Hi,se,Ei,$e,Bi,ne,yi,{noop:wt,ensureFunction:at,isAssignedObject:Lt,isAssignedArray:Wn,isNonEmptyArray:$i,isOf:Ki,forEachOwnProperty:kn}=w,Ds=r=>r.toLowerCase().replaceAll("_","-"),I=class{static registerClasses(e){$i(e)&&window.Array.prototype.forEach.call(e,t=>typeof t=="function"?h(this,se,Ei).call(this,t):s(this,kt).call(this,t))}static instantiateClasses(e,t,i,n){$i(e)&&window.Array.prototype.forEach.call(e,a=>h(this,ne,yi).call(this,a,Lt(t)?t:t instanceof window.HTMLElement?{node:t}:{selector:t},Lt(i)?i:new window.Object,n))}static createInstance(e,t,i){if(Lt(e)&&Ki(e.type,window.Function))return e.register===!0&&h(this,se,Ei).call(this,e.type),t=Lt(t)?t:new window.Object,i=Lt(i)?i:new window.Object,h(this,ne,yi).call(this,e.type,t,{on_bad_target:t.on_bad_target,on_element_instantiated:i.on_element_instantiated},i.parameters)}static initialize(e){Lt(e)&&(d(this,Rt,at(e.onBadTarget,s(this,Rt))),d(this,Ut,at(e.onDeferredInstantiation,s(this,Ut))),d(this,kt,at(e.onInvalidClass,s(this,kt))),d(this,Wt,at(e.onMisnamedClass,s(this,Wt))),d(this,Mt,at(e.onUnregistrableClass,s(this,Mt))),d(this,xt,at(e.onUnregisteredClass,s(this,xt))),d(this,Ft,at(e.onAlreadyRegistered,s(this,Ft))))}};Rt=new WeakMap,Ut=new WeakMap,Wt=new WeakMap,kt=new WeakMap,Mt=new WeakMap,xt=new WeakMap,Ft=new WeakMap,xe=new WeakSet,ji=function(e){window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):s(this,Mt).call(this,e.name)},Fe=new WeakSet,Hi=function(e){window.customElements.get(e.tag=Ds(e.name))?s(this,Ft).call(this,e.name):h(this,xe,ji).call(this,e)},se=new WeakSet,Ei=function(e){e.name.indexOf("_")>0?h(this,Fe,Hi).call(this,e):s(this,Wt).call(this,e.name)},$e=new WeakSet,Bi=function(e,t,i,n){let a=t.selector,c=t.node;if(!(c instanceof window.HTMLElement))try{c=window.document.querySelector(a)}catch(v){if(Ki(i.on_bad_target,window.Function)){if(i.on_bad_target(a)===!1)return}else{s(this,Rt).call(this,a);return}}finally{c=c||window.document.body}let u=window.document.createElement(e.tag);return u.parameters=n,at(i.on_element_instantiated)(u,a),c.appendChild(u),u},ne=new WeakSet,yi=function(e,t,i,n){let a=()=>h(this,$e,Bi).call(this,e,t,i,n);return window.customElements.get(e.tag)?window.document.body?a():s(this,Ut).call(this,a):s(this,xt).call(this,e.name)},o(I,xe),o(I,Fe),o(I,se),o(I,$e),o(I,ne),o(I,Rt,wt),o(I,Ut,wt),o(I,Wt,wt),o(I,kt,wt),o(I,Mt,wt),o(I,xt,wt),o(I,Ft,wt);var V=class{static defaultRoutine(e=""){var t=0;for(let i=0;i<e.length;i++)t=(t=(t<<5)-t+e.charCodeAt(i))&t;return t}};var Gi=V.defaultRoutine,Cs=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","content","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","marquee","mark","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","shadow","select","slot","small","source","spacer","span","strike","strong","style","sub","sup","summary","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","xmp","wbr"].map(Gi),M=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let t=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",t),100)};window.addEventListener("DOMContentLoaded",t)}}static getUniqueId(e="WUSE"){let t="_"+(e||"")+"_";for(var i;window.document.getElementById(i=t+(""+window.Math.random()).substring(2))!==null;);return i}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static isHTMLTag(e){return Cs.indexOf(Gi(e))>-1}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),i=window.Array.prototype.slice.call(e).filter(n=>n.charAt(0)==="-");return i.length?"-"+i[0].split("-")[1]+"-":""}};var x=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}static get WUSEKEY_ATTRIBUTE(){return"data-wusekey"}static get WUSENODE_ATTRIBUTE(){return"data-wusenode"}};var{noop:Hn,isOf:Pi,isNonEmptyString:Ns}=w,zi=r=>!Pi(r,window.Function),Ls=(r,e,t,i,n,a,c,u)=>n(()=>e,v=>{a(v,t),zi(t)?i(r):t({renderize:Ot=>i(r,Ot),automate:()=>a(v,null),dereact:()=>n(()=>v,c),remove:()=>u(r)})}),Rs=(r,e,t,i,n,a)=>{let c=(H,Dt)=>{window.Object.defineProperty(r,e,{get:H,set:Dt,enumerable:!0,configurable:!0})},u=zi(a)?H=>delete r[H]:a,v=H=>{u(e),r[e]=H},Ot=(H,Dt)=>Ls(e,H,Dt,n,c,Ot,v,u);return Ot(t,i)},re=class{static createReactiveField(e,t,i,n,a,c){return e&&Ns(t)&&Pi(a,window.Function)?Rs(e,t,i,n,a,c):null}};var oe,Ke,pt,ae,le,{EMPTY_ARRAY:Us,buildArray:bi,buildObject:Ws,isNonEmptyString:ks,isAssignedArray:Ms}=w,Kt=class{static initialize(e,t){this.begin=e,this.end=t}},q=Kt;l(q,"begin",null),l(q,"end",null),l(q,"enclose",e=>Kt.begin+e+Kt.end),l(q,"makeRegExp",()=>new window.RegExp(`(?<=${Kt.begin}).*?(?=${Kt.end})`,"gs"));var xs=["contents","classes","styles","attributes"],$t=class{};l($t,"rules",(e,t)=>bi(i=>e.forEach(n=>n.replacements.forEach(a=>a.field===t&&i.push(n))))),l($t,"children",(e,t)=>bi(i=>{let n=a=>{let c=u=>u.forEach(v=>v.field===t&&i.push(a));xs.forEach(u=>c(a.replacements[u])),a.rules.forEach(u=>u.replacements.forEach(v=>v.field===t&&i.push(a)))};e.forEach(a=>a.included&&n(a))}));var C=class{static initialize(e){d(this,oe,e)}},U=C;oe=new WeakMap,Ke=new WeakMap,pt=new WeakMap,ae=new WeakMap,le=new WeakMap,o(U,oe,null),o(U,Ke,(e,t,i)=>e.push({at:t,field:i.trim(),find:q.enclose(i)})),o(U,pt,(e,t,i)=>ks(i)&&(i.match(s(C,oe))||Us).forEach(n=>{var a;return s(a=C,Ke).call(a,e,t,n)})),o(U,ae,(e,t,i)=>{var n;e[t]=new window.Array,s(n=C,pt).call(n,e[t],t,i)}),o(U,le,(e,t,i)=>{e[t]=new window.Array,window.Object.keys(i).forEach(n=>{var a,c;s(a=C,pt).call(a,e[t],t,n),s(c=C,pt).call(c,e[t],t,i[n])})}),l(U,"child",e=>Ws(t=>{var i,n,a,c;s(i=C,ae).call(i,t,"contents",e.content),s(n=C,ae).call(n,t,"classes",e.classes.join(" ")),s(a=C,le).call(a,t,"styles",e.style),s(c=C,le).call(c,t,"attributes",e.attributes),e.rules.forEach(u=>u.replacements=C.rule(u))})),l(U,"rule",e=>bi(t=>{var n;if(Ms(e.nested))return e.nested.map(a=>C.rule(a));var i="";for(let a in e.properties)i+=`${a}:${e.properties[a]};`;s(n=C,pt).call(n,t,"rules",i)}));var N=class{static initialize(e,t){q.initialize(e,t),U.initialize(q.makeRegExp())}};l(N,"extractReplacementsFromRule",U.rule),l(N,"extractReplacementsFromChild",U.child),l(N,"scanRulesForReplacements",$t.rules),l(N,"scanChildrenForReplacements",$t.children);var jt,{noop:Fs,isAssignedArray:$s,hasObjectKeys:Ji,isNonEmptyString:Yi,isNonEmptyArray:Ks,isAssignedObject:js,ensureFunction:Hs}=w,{htmlEncode:Vi}=M,{SLOTS_KIND:Bs,TEMPLATES_KIND:Gs,TEXTNODE_TAG:Ps}=x,de=class{static initialize(e){js(e)&&d(this,jt,Hs(e.onFetchTemplate,s(this,jt)))}},T=de;jt=new WeakMap,o(T,jt,Fs),l(T,"cacheInvalidator",e=>e.cache=null),l(T,"slotsInvalidator",e=>e.kind===Bs?de.cacheInvalidator(e):void 0),l(T,"renderingIncluder",e=>e.included=!0),l(T,"renderingExcluder",e=>e.included=!1),l(T,"renderRule",(e,t)=>{if($s(t.nested))return`${t.selector}{${t.nested.map(n=>de.renderRule(e,n)).join(`
`)}}`;if(Yi(t.selector)&&!t.nested){var i=new window.String;for(let n in t.properties)i+=`${n}:${t.properties[n]};`;return Ks(t.replacements)&&t.replacements.forEach(n=>i=e(i,n)),`${t.selector}{${i}}`}return null}),l(T,"renderChild",(e,t)=>{var a;if(t.kind===Gs)return s(a=de,jt).call(a,t.id);if(t.tag===Ps){var i=t.content;return t.replacements.contents.forEach(c=>i=e(i,c)),t.encode?Vi(i):i}var n=Yi(t.id)?`<${t.tag} id='${t.id}'`:`<${t.tag}`;if(t.classes.length){var i=t.classes.join(" ");t.replacements.classes.forEach(u=>i=e(i,u)),n+=` class='${i}'`}if(Ji(t.style)){var i=" style='";for(let u in t.style)i+=`${u}: ${t.style[u]}; `;i+="'",t.replacements.styles.forEach(u=>i=e(i,u)),n+=i}if(Ji(t.attributes)){var i=new window.String;for(let u in t.attributes)i+=` ${u}=${t.attributes[u]}`;t.replacements.attributes.forEach(u=>i=e(i,u)),n+=i}if(typeof t.content=="string"){var i=t.content;t.replacements.contents.forEach(u=>i=e(i,u)),n+=`>${t.encode?Vi(i):i}</${t.tag}>`}else n+="/>";return n});var he,ce,ue,fe,{ensureFunction:zs}=w,Ht=class{constructor(e){l(this,"rounds",0);o(this,he,0);o(this,ce,null);o(this,ue,!1);o(this,fe,null);d(this,fe,zs(e))}compute(e){return this.rounds+=+d(this,ue,s(this,he)==d(this,ce,s(this,fe).call(this,e))),d(this,he,s(this,ce)),s(this,ue)}};he=new WeakMap,ce=new WeakMap,ue=new WeakMap,fe=new WeakMap;var gt,lt,Bt,we,pe,O,X,Et,Gt,He,{ensureFunction:Ti,isNonEmptyString:Js,isAssignedObject:je}=w,me=class{constructor(e,t,i,n={}){o(this,Gt);o(this,gt,new window.String);o(this,lt,!1);o(this,Bt,null);o(this,we,null);o(this,pe,null);o(this,O,null);o(this,X,null);o(this,Et,new class extends window.Set{name(e,t){let i=`${e}_${t}`;for(var n=0;this.has(i);)i=`${e}_${t}_${++n}`;return this.add(i),i}});d(this,Bt,Ti(e)),d(this,we,Ti(t)),d(this,pe,Ti(i)),d(this,X,n)}getStore(){return s(this,X)}setStore(e){d(this,X,e)}get state(){return s(this,O)}get key(){return s(this,gt)}set key(e){return d(this,lt,Js(d(this,gt,e)))}hasKey(){return s(this,lt)}validateKey(){return s(this,lt)?!0:(this.on_invalid_key(),!1)}nameFiliatedKey(e){return s(this,Et).name(s(this,gt),e)}rememberFiliatedKey(e){s(this,Et).add(e)}hasFiliatedKey(e){return s(this,Et).has(e)}initializeState(){if(s(this,Et).clear(),s(this,lt)){let e=s(this,X).hasItem(this.key)?s(this,X).getItem(this.key):s(this,Bt).call(this);if(je(e))d(this,O,e),s(this,O).generation++,h(this,Gt,He).call(this);else return this.on_invalid_state(),-1}else d(this,O,s(this,Bt).call(this)),s(this,O).generation++;return s(this,O).generation}writeState(){let e=s(this,O);return je(e)?(e.data=s(this,pe).call(this),h(this,Gt,He).call(this),!0):!1}readState(){let e=s(this,O);return je(e)&&e.persisted?(s(this,we).call(this,e.data),!0):!1}eraseState(){let e=s(this,O);return je(e)&&e.persisted&&e.data?(delete e.data,h(this,Gt,He).call(this),!0):!1}on_invalid_state(){}on_invalid_key(){}};gt=new WeakMap,lt=new WeakMap,Bt=new WeakMap,we=new WeakMap,pe=new WeakMap,O=new WeakMap,X=new WeakMap,Et=new WeakMap,Gt=new WeakSet,He=function(){s(this,lt)&&(s(this,O).persisted=!!s(this,O).data,s(this,X).setItem(s(this,gt),s(this,O)))};var Q,B,dt,Be,Xi,Ge,Qi,{WUSENODE_ATTRIBUTE:qi}=x,Pt=class{constructor(e,t){o(this,Be);o(this,Ge);o(this,Q,null);o(this,B,null);o(this,dt,null);if(e instanceof window.Node&&t instanceof window.Node)d(this,Q,e),this.element=t;else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}set element(e){h(this,Be,Xi).call(this,e.getAttribute(qi)),d(this,B,e),d(this,dt,e.cloneNode(!1))}get element(){return s(this,B)}affiliate(){s(this,Q).appendChild(s(this,B))}disaffiliate(){s(this,Q).removeChild(s(this,B))}promote(e){s(this,dt).innerHTML=e,s(this,Q).replaceChild(s(this,dt),s(this,B)),h(this,Ge,Qi).call(this)}};Q=new WeakMap,B=new WeakMap,dt=new WeakMap,Be=new WeakSet,Xi=function(e){let t=s(this,Q).querySelector(`[${qi}='${e}']`);t&&s(this,Q).removeChild(t)},Ge=new WeakSet,Qi=function(){let e=s(this,dt);d(this,dt,s(this,B).cloneNode(!1)),d(this,B,e)};var yt,bt,{isOf:Zi}=w,Tt=class{constructor(e,t){o(this,yt,!1);o(this,bt,"");Zi(e,window.Function)&&(this.on_content_invalidation=e),Zi(t,window.Function)&&(this.on_content_verification=t)}get invalidated(){return s(this,yt)}reset(e){d(this,yt,!1),d(this,bt,e)}append(e){d(this,bt,s(this,bt)+e)}verify(){d(this,yt,this.on_content_verification(s(this,bt)))}process(e){(e||s(this,yt))&&this.on_content_invalidation(s(this,bt))}on_content_verification(e){}on_content_invalidation(e){}};yt=new WeakMap,bt=new WeakMap;var ht,zt,{isIntegerNumber:Ys,isAssignedObject:Ii,cloneObject:Vs,forEachOwnProperty:qs,buildArray:Xs}=w,ts=(r,e,t)=>qs(r,i=>{switch(i){case"owner":case"last":case"length":break;case"version":case"locked":t(i);break;default:Ys(i)&&e(i)}}),es=(r,e,t)=>{t(e);let i=Vs(e);i.cache=null,r.push(i)},It=class extends window.Array{constructor(t){super();o(this,ht);l(this,"owner",null);l(this,"last",null);l(this,"version",0);l(this,"locked",!1);this.owner=t}append(t){this.locked?this.on_forbidden_change():Ii(t)&&(this.push(t),h(this,ht,zt).call(this,t))}prepend(t){this.locked?this.on_forbidden_change():Ii(t)&&(this.unshift(t),h(this,ht,zt).call(this,t))}replace(t,i){this.locked?this.on_forbidden_change():t>-1&&Ii(i)&&h(this,ht,zt).call(this,this[t]=i)}remove(t){if(this.locked)this.on_forbidden_change();else if(t>-1){let i=this.splice(t,1);h(this,ht,zt).call(this,i.length?i[0]:null)}}clear(){this.locked?this.on_forbidden_change():(this.length=0,h(this,ht,zt).call(this,null))}persist(){return Xs(t=>ts(this,i=>es(t,this[i],this.on_snapshot_part),i=>t[i]=this[i]))}restore(t,i){this.owner=t,ts(i,n=>es(this,i[n],this.on_recall_part),n=>this[n]=i[n])}getIndexOf(t,i){for(let n=0;n<this.length;n++)if(this[n][t]===i)return n;return-1}on_snapshot_part(){}on_recall_part(){}on_version_change(){}on_forbidden_change(){}};ht=new WeakSet,zt=function(t){this.last=t,this.version++,this.on_version_change()};var Je,as,Ye,ls,Ve,ds,qe,hs,Xe,cs,Yt,ze,Qe,us,{isHTMLTag:Qs}=M,{EMPTY_STRING:W,EMPTY_ARRAY:Zs,noop:ge,buildArray:dr,buildObject:tn,isAssignedObject:Pe,isAssignedArray:Jt,ensureFunction:Ee,hasObjectKeys:is,isNonEmptyString:ct,forcedStringSplit:en}=w,{WUSENODE_ATTRIBUTE:ss,DEFAULT_TAG:sn,DEFAULT_KIND:ns,TEMPLATES_KIND:Ai,SLOTS_KIND:Si,TEXTNODE_TAG:cr}=x,nn=V.defaultRoutine,G={onInvalidDefinition:ge,onInexistentTemplate:ge,onUnespecifiedSlot:ge,onInvalidId:ge,onUnknownTag:ge},rn=r=>r.indexOf("-")>0&&!Qs(r),Z=class{static parse(e){if(ct(e)){let t=e.trimLeft(),i=rs();return t.charAt(0)==="%"?t.startsWith(Ai)?h(this,Yt,ze).call(this,i,t.replace(i.kind=Ai,W)):t.startsWith(Si)?h(this,Yt,ze).call(this,i,t.replace(i.kind=Si,W)):null:h(this,Yt,ze).call(this,i,t)}return null}};Je=new WeakSet,as=function(e,t){let i=t.indexOf("["),n=t.indexOf("]");if(i>-1&&n>-1&&n>i){let a=t.substr(i,n-i+1),c=a.substr(1,a.length-2).split("|");for(let u in c){let v=c[u].split("=");v[0]==="style"?v[1].split(";").forEach(Ot=>{let H=Ot.split(":"),Dt=H[0].trim();Dt.length&&(e.style[Dt]=H[1].trim())}):e.attributes[v[0]]=v[1]||""}return t.replace(a,W)}return t},Ye=new WeakSet,ls=function(e,t){let i=t.indexOf("=");return i>-1?(e.content=t.slice(i+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),t.slice(0,i)):t},Ve=new WeakSet,ds=function(e,t){let i=t.replaceAll("!"," ").split(" ");return i.slice(1).map(n=>{let[a,...c]=n.toLowerCase().split("+"),u=(c||Zs).indexOf("capture")>-1;e.events.push(os(a,u))}),i[0]},qe=new WeakSet,hs=function(e,t){let i=t.replaceAll("."," ").split(" ");return e.classes=i.slice(1),i[0]},Xe=new WeakSet,cs=function(e,t){if(ct(t)){let i=t.indexOf("#");i===-1?e.tag=t:(i>0&&(e.tag=t.substr(0,i)),e.id=t.substr(i+1))}return e},Yt=new WeakSet,ze=function(e,t){return h(this,Xe,cs).call(this,e,h(this,qe,hs).call(this,e,h(this,Ve,ds).call(this,e,h(this,Ye,ls).call(this,e,h(this,Je,as).call(this,e,t)))))},o(Z,Je),o(Z,Ye),o(Z,Ve),o(Z,qe),o(Z,Xe),o(Z,Yt);var ye=class{static parse(e){return tn(t=>(Jt(e)?e:en(e,`
`).map(i=>i.trim()).join(W).split(";")).forEach(i=>ct(i)&&h(this,Qe,us).call(this,t,i.trim())))}};Qe=new WeakSet,us=function(e,t){if(!!t.length&&t.indexOf(":")>-1){let[i,...n]=t.split(":"),a=i.trim();if(a.length){let c=n.join(":").trim();e[a]=c.endsWith(";")?c.slice(0,-1):c}}},o(ye,Qe);var rs=()=>({kind:ns,tag:sn,id:W,classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:W,encode:!1}),on=()=>({generation:0,persisted:!1}),os=(r,e)=>typeof r=="string"&&typeof e=="boolean"?{kind:r,capture:e}:null,an=(r,e)=>{let t=Z.parse(r);return t?(t.custom=t.kind===ns&&rn(t.tag),t.hash=nn(r),t.rules=Jt(e)?e:new window.Array,t.included=!0,t.cache=null,t):G.onInvalidDefinition(r)},ln=r=>{if(r!==null)if(r.kind===Ai){if(!window.document.getElementById(r.id))return G.onInexistentTemplate(r.id)}else if(r.kind===Si){if(new window.String(r.attributes.slot).replaceAll('"',W).replaceAll("'",W).length===0)return G.onUnespecifiedSlot(r.id)}else{if(typeof r.id!="string")return G.onInvalidId(r.id);r.custom&&!window.customElements.get(r.tag)&&G.onUnknownTag(r.tag)}return r},dn=r=>{if(!Pe(r))return null;let e=window.document.createElement(r.tag);if(r.id.length&&e.setAttribute("id",r.id),r.classes.length&&e.setAttribute("class",r.classes.join(" ")),is(r.style)){var t=new window.String;for(let i in r.style)t+=`${i}: ${r.style[i]}; `;if(t.length){let i=t.trim();e.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(is(r.attributes))for(let i in r.attributes)e.setAttribute(i,r.attributes[i]);return e.setAttribute(ss,"main"),e},hn=(r,e)=>{let t=window.document.createElement("style");return ct(r)&&t.setAttribute("media",r),ct(e)&&t.setAttribute("type",e),t.setAttribute(ss,"style"),t.appendChild(window.document.createTextNode(W)),t},cn=(r,e)=>{let t=Jt(r)?r.join(","):ct(r)?r:W;return t.length?{selector:t,properties:Pe(e)?e:ye.parse(e),cache:null}:null},un=(r,e,t)=>{let i=Jt(r)?r.join(","):ct(r)?r:W,n=Jt(e)?e.join(","):ct(e)?e:W;return!i.length||!n.length?null:{selector:i,nested:[{selector:n,properties:Pe(t)?t:ye.parse(t)}],cache:null}},fn=(r,e)=>{if(r.selector===e.selector){for(let t in e.properties)r.properties[t]=e.properties[t];return r.cache=null,!0}return!1},mn=(r,e)=>Jt(r.nested)&&r.selector===e.selector?(e.nested.forEach(t=>{var i=!1;for(let n in r.nested)if(i=r.nested[n].selector===t.selector){for(let a in t.properties)r.nested[n].properties[a]=t.properties[a];break}i||r.nested.push(t)}),r.cache=null,!0):!1,f=class{static initialize(e){Pe(e)&&(G.onInvalidDefinition=Ee(e.onInvalidDefinition),G.onInexistentTemplate=Ee(e.onInexistentTemplate),G.onUnespecifiedSlot=Ee(e.onUnespecifiedSlot),G.onInvalidId=Ee(e.onInvalidId),G.onUnknownTag=Ee(e.onUnknownTag))}};l(f,"makeStyleNode",hn),l(f,"newRule",cn),l(f,"newNestedRule",un),l(f,"tryToJoinRules",fn),l(f,"tryToJoinNestedRules",mn),l(f,"performValidations",ln),l(f,"makeMainNode",dn),l(f,"newChild",an),l(f,"newDefinition",rs),l(f,"newEvent",os),l(f,"newState",on);var L=class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}};l(L,"specializeClass",(e,t)=>class extends e{constructor(){super(t)}});var tt,Vt,wn=["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"],be=class{constructor(e){o(this,tt,null);o(this,Vt,new window.Object);d(this,tt,e)}detect(){wn.forEach(e=>s(this,Vt)[e]=typeof s(this,tt)[e]=="function")}immediateTrigger(e,t){s(this,Vt)[e]&&s(this,tt)[e].call(s(this,tt),t)}committedTrigger(e,t){s(this,Vt)[e]&&window.requestAnimationFrame(()=>s(this,tt)[e].call(s(this,tt),t))}};tt=new WeakMap,Vt=new WeakMap;var F,g,p,D,m,Ie,k,Ae,S,P,St,Zt,z,ut,J,Y,it,ft,Se,si,ni,y,st,$,_t,K,_e,vi,ri,ps,oi,gs,mt,Qt,te,ii,ai,Es,ve,Oi,Oe,Di,li,ys,De,Ci,di,bs,Ce,Ni,Ne,Li,Le,Ri,Re,Ui,{EMPTY_STRING:Te,noop:qt,ensureFunction:Xt,isOf:pn,isAssignedObject:Ze,isAssignedArray:_i,isNonEmptyArray:fs,isNonEmptyString:At,forcedStringSplit:ms,forEachOwnProperty:gn}=w,{removeChildren:En}=M,{WUSEKEY_ATTRIBUTE:ti,DEFAULT_STYLE_TYPE:yn,DEFAULT_STYLE_MEDIA:bn,DEFAULT_REPLACEMENT_OPEN:Tn,DEFAULT_REPLACEMENT_CLOSE:In,SLOTS_KIND:ws}=x,{createReactiveField:An}=re,_={onInvalidState:qt,onInvalidKey:qt,onInvalidDefinition:qt,onLockedDefinition:qt,onTakenId:qt,onAllowHTML:qt},et=(r,e)=>window.Wuse.debug(`#${r.id} (${r.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`),ei=(r,e)=>f.performValidations(f.newChild(r,e)),Sn=()=>({mainDefinition:f.newDefinition(),styleMedia:bn,styleType:yn,rawContent:!1,attributeKeys:!1,elementKeys:!0,autokeyChildren:!0}),_n=()=>({attachment:new window.Wuse.PerformanceMeasurement.StopWatch,partial:new window.Wuse.PerformanceMeasurement.StopWatch,full:new window.Wuse.PerformanceMeasurement.StopWatch,dettachment:new window.Wuse.PerformanceMeasurement.StopWatch}),vn=()=>({main:new Ht(window.Wuse.hashRoutine),style:new Ht(window.Wuse.hashRoutine)}),Wi=class extends window.HTMLElement{constructor(t){super();o(this,_e);o(this,ri);o(this,oi);o(this,mt);o(this,te);o(this,ai);o(this,ve);o(this,Oe);o(this,li);o(this,De);o(this,di);o(this,Ce);o(this,Ne);o(this,Le);o(this,Re);o(this,F,new window.String);o(this,g,new class extends It{constructor(){super(...arguments);l(this,"getIndexOf",i=>super.getIndexOf("selector",i));l(this,"on_version_change",()=>{this.last!==null&&(this.last.version=this.version,this.last.replacements=N.extractReplacementsFromRule(this.last)),window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,`rules list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,"rules list is locked and can not be changed"),_.onLockedDefinition(s(this.owner,m).mainDefinition.id)})}}(this));o(this,p,new class extends It{constructor(){super(...arguments);l(this,"getIndexOf",i=>super.getIndexOf("id",i));l(this,"on_version_change",()=>{var i;this.last!==null&&(this.last.version=this.version,this.last.replacements=N.extractReplacementsFromChild(this.last)),s(this.owner,P)||d(i=this.owner,P,s(i,P)|this.some(n=>n.kind===ws)),window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,`children list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,"children list is locked and can not be changed"),_.onLockedDefinition(s(this.owner,m).mainDefinition.id)});l(this,"on_recall_part",i=>s(this.owner,Se).tryToRemember(i))}}(this));o(this,D,new class extends It{constructor(){super(...arguments);l(this,"getIndexOf",i=>super.getIndexOf("name",i));l(this,"on_version_change",()=>{window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,`fields list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,S)&&et(this.owner,"fields list is locked and can not be changed"),_.onLockedDefinition(s(this.owner,m).mainDefinition.id)});l(this,"on_snapshot_part",i=>i.value=this.owner[i.name]);l(this,"on_recall_part",i=>this.owner[i.name]=i.value)}}(this));o(this,m,Sn());o(this,Ie,void 0);o(this,k,new be(this));o(this,Ae,!1);o(this,S,!1);o(this,P,!1);o(this,St,!1);o(this,Zt,window.Wuse.isShadowElement(this));o(this,z,void 0);o(this,ut,void 0);o(this,J,null);o(this,Y,!1);o(this,it,!1);o(this,ft,!0);o(this,Se,{tryToName:t=>{t.attributes[ti]||(t.attributes[ti]=s(this,y).nameFiliatedKey(t.hash))},tryToRemember:t=>{let i=t.attributes[ti];i&&s(this,y).rememberFiliatedKey(i)}});o(this,si,t=>{t&&(d(this,m,t.options),d(this,P,t.slotted),d(this,S,t.identified),d(this,F,t.html),s(this,p).restore(this,t.children),s(this,g).restore(this,t.rules),s(this,D).restore(this,t.fields))});o(this,ni,()=>({options:s(this,m),html:s(this,F),children:s(this,p).persist(),rules:s(this,g).persist(),fields:s(this,D).persist(),slotted:s(this,P),identified:s(this,S)}));o(this,y,new class extends me{on_invalid_state(){_.onInvalidState()}on_invalid_key(){_.onInvalidKey()}}(f.newState,s(this,si),s(this,ni),window.Wuse.elementsStorage));o(this,st,{binder:t=>At(t)&&(this[t]=h(this,te,ii).call(this,t)),unbinder:t=>delete this[t],makePerformers:(t,i)=>({event:t,key:()=>(s(this,S)&&i(s(this,m).mainDefinition.id),n=>i(n.id))}),makeHandlers:t=>({key:s(this,m).elementKeys&&t.key(),event:(i,n,a)=>{let c=this[`on_${i}_${n}`];if(c){let u=h(this,te,ii).call(this,i);u&&u[t.event](n,c,a)}},slots:()=>this.on_slot_change&&s(this,J).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}),getHandlers:t=>s(this,st).makeHandlers(t?s(this,st).makePerformers("addEventListener",s(this,st).binder):s(this,st).makePerformers("removeEventListener",s(this,st).unbinder))});o(this,$,{root:new Tt(t=>this.innerHTML=t,t=>!0),style:new Tt(t=>s(this,ut)&&s(this,ut).promote(t),t=>!s(this,_t).style.compute(t)),main:new Tt(t=>s(this,z).promote(t),t=>!s(this,_t).main.compute(t)),renderizers:{replacer:(t,i)=>t.replace(i.find,this[i.field]!==void 0?this[i.field]:Te),rule:t=>{let i=s(this,$);return i.style.append(t.cache?t.cache:t.cache=T.renderRule(i.renderizers.replacer,t))},children:{mixed:t=>t.kind===ws?s(this,$).renderizers.children.slot(t):s(this,$).renderizers.children.normal(t),slot:t=>{if(!t.cache){let i=s(this,$);return i.root.append(t.cache=T.renderChild(i.renderizers.replacer,t),i.root.verify())}},normal:t=>{let i=s(this,$);i.main.append(t.cache?t.cache:t.cache=T.renderChild(i.renderizers.replacer,t)),t.rules.length&&t.rules.forEach(i.renderizers.rule)}}}});o(this,_t,vn());o(this,K,_n());l(this,"info",{instanceNumber:++Wi.instancesCount,unmodifiedRounds:0,updatedRounds:0});d(this,J,t===L.REGULAR?this:this.shadowRoot||this.attachShadow({mode:t})),s(this,k).detect(),s(this,k).immediateTrigger("on_create"),s(this,m).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),this.dataset.wusekey&&this.setElementsStoreKey(this.dataset.wusekey),s(this,k).immediateTrigger(s(this,y).initializeState()>1?"on_reconstruct":"on_construct",s(this,y).state),d(this,Ae,!0)}get parameters(){return s(this,Ie)}set parameters(t){Ze(d(this,Ie,t))&&gn(t,i=>this[i]=t[i])}render(){window.Wuse.RENDERING&&s(this,ft)&&s(this,it)&&h(this,li,ys).call(this)}redraw(){window.Wuse.RENDERING&&s(this,ft)&&s(this,it)&&h(this,di,bs).call(this)}connectedCallback(){window.Wuse.MEASURE&&s(this,K).attachment.start(),s(this,k).detect(),s(this,k).immediateTrigger("on_connect"),h(this,De,Ci).call(this,"on_load"),window.Wuse.MEASURE&&s(this,K).attachment.stop(window.Wuse.DEBUG)}disconnectedCallback(){window.Wuse.MEASURE&&s(this,K).dettachment.start(),h(this,mt,Qt).call(this,!1),s(this,k).immediateTrigger("on_disconnect"),s(this,y).writeState(),window.Wuse.MEASURE&&s(this,K).dettachment.stop(window.Wuse.DEBUG)}getElementsStore(){return s(this,y).getStore()}setElementsStore(t){return s(this,y).setStore(t),this}hasElementsStoreKey(){return s(this,y).hasKey()}getElementsStoreKey(t){return s(this,y).key}setElementsStoreKey(t){return(s(this,y).key=t)&&(this.setAttribute(ti,t),s(this,y).writeState()),this}deriveChildrenStoreKey(t){s(this,m).autokeyChildren=t}persistToElementsStore(){return s(this,y).validateKey()&&s(this,y).writeState()}restoreFromElementsStore(){return s(this,y).validateKey()&&s(this,y).readState()}removeFromElementsStore(){return s(this,y).validateKey()&&s(this,y).eraseState()}selectChildElement(t){return s(this,J).querySelector(t)}getMainAttribute(t){return t==="id"&&s(this,S)?s(this,m).mainDefinition.id:s(this,m).mainDefinition.attributes[t]}setMainAttribute(t,i){return s(this,m).mainDefinition.attributes[t]=i,s(this,Y)&&s(this,z).element.setAttribute(t,i),this}addMainClass(t){let i=s(this,m).mainDefinition.classes;return i.indexOf(t)===-1&&(i.push(t),s(this,Y)&&s(this,z).element.classList.add(t)),this}removeMainClass(t){let i=s(this,m).mainDefinition.classes,n=i.indexOf(t);return n>-1&&(i.splice(n,1),s(this,Y)&&s(this,z).element.classList.remove(t)),this}toggleMainClass(t){let i=s(this,m).mainDefinition.classes,n=i.indexOf(t);return n>-1?i.splice(n,1):i.push(t),s(this,Y)&&s(this,z).element.classList.toggle(t),this}setMainElement(t){let i=ei(t);if(i!==null){if(At(i.content)||fs(i.events))return _.onInvalidDefinition(t);let n=s(this,m).mainDefinition;d(this,S,At(i.id))&&(n.id=i.id),At(i.tag)&&(n.tag=i.tag),fs(i.classes)&&(n.classes=i.classes),Ze(i.style)&&(n.style=i.style),Ze(i.attributes)&&(n.attributes=i.attributes)}return this}setStyleOptions(t,i){return s(this,m).styleMedia=At(t)?t:Te,s(this,m).styleType=At(i)?i:Te,this}setElementsAsKeys(t){return s(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return s(this,m).attributeKeys=!!t,this}allowRawContent(t){return s(this,m).rawContent=!!t,this}setRawContent(t){return s(this,m).rawContent?d(this,F,t):_.onAllowHTML(),this}appendRawContent(t){return s(this,m).rawContent?d(this,F,s(this,F)+t):_.onAllowHTML(),this}prependRawContent(t){return s(this,m).rawContent?d(this,F,t+s(this,F)):_.onAllowHTML(),this}lockCSSRules(){return s(this,g).locked=!0,this}unlockCSSRules(){return s(this,g).locked=!1,this}appendCSSRule(t,i,n){if(n)return this.appendCSSNestedRule(t,i,n);let a=s(this,g).slice(-1),c=f.newRule(t,i);return(!a.length||!f.tryToJoinRules(a[0],c))&&s(this,g).append(c),this}prependCSSRule(t,i,n){if(n)return this.prependCSSNestedRule(t,i,n);let a=s(this,g).slice(0,1),c=f.newRule(t,i);return(!a.length||!f.tryToJoinRules(a[0],c))&&s(this,g).prepend(c),this}appendCSSNestedRule(t,i,n){let a=s(this,g).slice(-1),c=f.newNestedRule(t,i,n);return(!a.length||!f.tryToJoinNestedRules(a[0],c))&&s(this,g).append(c),this}prependCSSNestedRule(t,i,n){let a=s(this,g).slice(0,1),c=f.newNestedRule(t,i,n);return(!a.length||!f.tryToJoinNestedRules(a[0],c))&&s(this,g).prepend(c),this}hasCSSRuleBySelector(t){return s(this,g).getIndexOf(t)>-1}replaceCSSRuleBySelector(t,i){let n=s(this,g).getIndexOf(t);return n>-1&&(s(this,g)[n]=f.newRule(t,i)),this}removeCSSRuleBySelector(t){let i=s(this,g).getIndexOf(t);return i>-1&&s(this,g).splice(i,1),this}removeAllCSSRules(){return s(this,g).clear(),this}lockChildElements(){return s(this,p).locked=!0,this}unlockChildElements(){return s(this,p).locked=!1,this}appendChildElement(t,i){let n=h(this,Re,Ui).call(this,ei(t,i));return n!==null&&s(this,p).append(n),this}prependChildElement(t,i){let n=h(this,Re,Ui).call(this,ei(t,i));return n!==null&&s(this,p).prepend(n),this}appendChildElements(t){return(_i(t)?t:ms(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(_i(window.Array)?t:ms(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}replaceChildElementById(t,i,n){let a=s(this,p).getIndexOf(t);if(a>-1){let c=ei(i,n);c!==null&&s(this,p).replace(a,c)}return this}removeChildElementById(t){let i=s(this,p).getIndexOf(t);return i>-1&&s(this,p).remove(i),this}removeAllChildElements(){return s(this,p).clear(),this}checkChildElementIsIncludedById(t,i,n){let a=c=>pn(c,window.Function)?c():void 0;return s(this,p).some(c=>c.id===t&&c.included)?a(i):a(n),this}includeChildElementById(t){return s(this,p).length&&s(this,p).forEach(i=>i.id===t&&T.renderingIncluder(i)),this}excludeChildElementById(t){return s(this,p).length&&s(this,p).forEach(i=>i.id===t&&T.renderingExcluder(i)),this}invalidateChildElementsById(t){return s(this,p).length&&s(this,p).forEach(i=>t.indexOf(i.id)>-1&&T.cacheInvalidator(i)),this}invalidateChildElements(t){return _i(t)&&t.forEach(T.cacheInvalidator),this}lockInstanceFields(){return s(this,D).locked=!0,this}unlockInstanceFields(){return s(this,D).locked=!1,this}makeField(t,i){return h(this,Le,Ri).call(this,t,i,!0)}makeReadonlyField(t,i){return h(this,Le,Ri).call(this,t,i,!1)}makeReactiveField(t,i,n,a=!0){return An(this,t,i,n,(c,u)=>h(this,Ce,Ni).call(this,c,u||"$auto"),c=>this.dropField(c)),h(this,Ne,Li).call(this,t,i),a&&h(this,Ce,Ni).call(this,t,"$init"),this}makeExternalReactiveField(t,i,n,a,c=!0){return this.makeReactiveField(i,t[i]||n,u=>{t[i]=this[i],a(u)},c)}hasField(t){return s(this,D).getIndexOf(t)>-1}dropField(t){let i=s(this,D).getIndexOf(t);return i>-1?(this.hasOwnProperty(t)&&delete this[t],s(this,D).splice(i,1),s(this,y).writeState(),!0):!1}dropAllFields(){let t=[];return s(this,D).forEach(i=>this.hasOwnProperty(i.name)&&t.push(i.name)),s(this,D).clear(),t.forEach(i=>delete this[i]),s(this,y).writeState(),this}suspendRender(){return d(this,ft,!1),this}resumeRender(t=!0){return d(this,ft,!0),t&&this.render(),this}isRenderSuspended(){return!s(this,ft)}static initialize(t){N.initialize(Tn,In),Ze(t)&&(T.initialize({onFetchTemplate:t.onFetchTemplate}),f.initialize({onInvalidDefinition:t.onInvalidDefinition,onInexistentTemplate:t.onInexistentTemplate,onUnespecifiedSlot:t.onUnespecifiedSlot,onInvalidId:t.onInvalidId,onUnknownTag:t.onUnknownTag}),_.onAllowHTML=Xt(t.onAllowHTML),_.onInvalidKey=Xt(t.onInvalidKey),_.onInvalidState=Xt(t.onInvalidState),_.onInvalidDefinition=Xt(t.onInvalidDefinition),_.onLockedDefinition=Xt(t.onLockedDefinition),_.onTakenId=Xt(t.onTakenId))}static register(){return Wuse.register(this)}static create(t,i="body"){let n=i instanceof window.HTMLElement?{node:i}:typeof i=="string"?{selector:i}:i;return Wuse.create({element:{type:this},target:n,instance:{parameters:t}})}},j=Wi;F=new WeakMap,g=new WeakMap,p=new WeakMap,D=new WeakMap,m=new WeakMap,Ie=new WeakMap,k=new WeakMap,Ae=new WeakMap,S=new WeakMap,P=new WeakMap,St=new WeakMap,Zt=new WeakMap,z=new WeakMap,ut=new WeakMap,J=new WeakMap,Y=new WeakMap,it=new WeakMap,ft=new WeakMap,Se=new WeakMap,si=new WeakMap,ni=new WeakMap,y=new WeakMap,st=new WeakMap,$=new WeakMap,_t=new WeakMap,K=new WeakMap,_e=new WeakSet,vi=function(){d(this,St,d(this,ut,s(this,g).length?new Pt(s(this,J),f.makeStyleNode(s(this,m).styleMedia,s(this,m).styleType)):null))&&s(this,ut).affiliate()},ri=new WeakSet,ps=function(){d(this,z,new Pt(s(this,J),f.makeMainNode(s(this,m).mainDefinition))).affiliate()},oi=new WeakSet,gs=function(){s(this,z).disaffiliate(),s(this,St)&&s(this,ut).disaffiliate(),s(this,P)&&s(this,Zt)&&En(s(this,J))},mt=new WeakSet,Qt=function(t){if(s(this,it)&&!t||!s(this,it)&&t){let i=s(this,st).getHandlers(t);s(this,p).length&&s(this,p).forEach(n=>{!n.included&&t||(i.key&&i.key(n),n.events.length&&n.events.forEach(a=>a&&i.event(n.id,a.kind,a.capture)))}),s(this,P)&&s(this,Zt)&&i.slots(),d(this,it,t)}},te=new WeakSet,ii=function(t){return At(t)?s(this,J).querySelector(`#${t}`):void 0},ai=new WeakSet,Es=function(){s(this,p).length&&s(this,p).forEach(T.cacheInvalidator),s(this,g).length&&s(this,g).forEach(T.cacheInvalidator)},ve=new WeakSet,Oi=function(){let t=s(this,$);t.root.reset(Te),t.style.reset(Te),t.main.reset(s(this,F));let i=s(this,P)&&s(this,Zt)?t.renderizers.children.mixed:t.renderizers.children.normal;s(this,p).length&&s(this,p).forEach(n=>n.included&&i(n)),s(this,g).length&&s(this,g).forEach(t.renderizers.rule),t.main.verify(),t.style.verify()},Oe=new WeakSet,Di=function(t,i,n){let a=s(this,$);a.root.process(t),a.style.process(i),a.main.process(n),window.Wuse.DEBUG&&s(this,S)&&et(this,`updated (root: ${a.root.invalidated}, main: ${a.main.invalidated}, style: ${a.style.invalidated})`)},li=new WeakSet,ys=function(){window.Wuse.MEASURE&&s(this,K).partial.start(),s(this,St)||h(this,_e,vi).call(this);let t=s(this,k);t.immediateTrigger("on_prerender"),h(this,ve,Oi).call(this);let i=s(this,$);i.root.invalidated||i.main.invalidated||i.style.invalidated?(h(this,mt,Qt).call(this,!1),h(this,Oe,Di).call(this,!1,!1,!1),h(this,mt,Qt).call(this,!0),this.info.updatedRounds++,t.immediateTrigger("on_update"),s(this,y).writeState(),t.committedTrigger("on_refresh")):this.info.unmodifiedRounds++,window.Wuse.DEBUG&&s(this,S)&&et(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${s(this,_t).main.rounds}, style: ${s(this,_t).style.rounds}) | updated: ${this.info.updatedRounds}`),t.immediateTrigger("on_postrender"),window.Wuse.MEASURE&&s(this,K).partial.stop(window.Wuse.DEBUG)},De=new WeakSet,Ci=function(t){h(this,ai,Es).call(this),h(this,_e,vi).call(this),h(this,ri,ps).call(this),d(this,Y,!0);let i=s(this,k);i.immediateTrigger("on_inject"),h(this,ve,Oi).call(this),h(this,Oe,Di).call(this,!1,s(this,St),!0),h(this,mt,Qt).call(this,!0),i.immediateTrigger(t),s(this,y).writeState()},di=new WeakSet,bs=function(){window.Wuse.MEASURE&&s(this,K).full.start(),h(this,mt,Qt).call(this,!1),s(this,Y)&&(h(this,oi,gs).call(this),d(this,Y,!1));let t=s(this,k);t.immediateTrigger("on_unload"),t.detect(),h(this,De,Ci).call(this,"on_reload"),t.committedTrigger("on_repaint"),window.Wuse.MEASURE&&s(this,K).full.stop(window.Wuse.DEBUG)},Ce=new WeakSet,Ni=function(t,i="$none"){if(s(this,it)){let n=N.scanRulesForReplacements(s(this,g),t);n.forEach(T.cacheInvalidator);let a=N.scanChildrenForReplacements(s(this,p),t);a.forEach(T.cacheInvalidator),window.Wuse.DEBUG&&s(this,S)&&et(this,`reactive render (label: ${i}, field: ${t}, children: ${a.length}, rules: ${n.length})`),(!!n.length||!!a.length)&&(a.some(c=>!!c.kind.length)&&s(this,p).forEach(T.slotsInvalidator),this.render())}},Ne=new WeakSet,Li=function(t,i){let n=s(this,D).getIndexOf(t);n>-1?s(this,D)[n].value=i:s(this,D).append({name:t,value:i})},Le=new WeakSet,Ri=function(t,i,n){return window.Object.defineProperty(this,t,{value:i,writable:n}),h(this,Ne,Li).call(this,t,i),this},Re=new WeakSet,Ui=function(t){if(t!==null){if(s(this,Ae)&&h(this,te,ii).call(this,t.id))return _.onTakenId(t.id);t.custom&&s(this,m).autokeyChildren&&s(this,y).hasKey()&&s(this,Se).tryToName(t)}return t},l(j,"instancesCount",0);var Ts=(r,e)=>window.Object.getOwnPropertyNames(e).forEach(t=>Object.defineProperty(r,t,{value:e[t],writable:!1,configurable:!1,enumerable:!1})),vt=class{static detectFeatures(e){let t=(i,n)=>!i&&b.UNSUPPORTED_FEATURE.emit(n);try{t(e.JsHelpers.isOf(window.document,window.HTMLDocument),"HTML Document"),t(e.JsHelpers.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),e.WebHelpers.onDOMContentLoaded(()=>t(e.JsHelpers.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(i){b.UNKNOWN_ERROR.emit()}}static initializeModules(e){e.PerformanceMeasurement.initialize((t,i)=>e.debug(JSON.stringify(e.JsHelpers.buildArray(n=>{switch(n.push({instances:e.elementCount}),n.push(t.getDebugInfo()),i){case"stop":n.push(e.PerformanceMeasurement.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(e.PerformanceMeasurement.BrowserRender.overall.getDebugInfo());break}})))),ot.initialize({onExtinctTemplate:b.EXTINCT_TEMPLATE.emit,onInvalidTemplate:b.INVALID_TEMPLATE.emit}),I.initialize({onBadTarget:b.BAD_TARGET.emit,onMisnamedClass:b.MISNAMED_CLASS.emit,onUnregistrableClass:b.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:b.UNREGISTERED_CLASS.emit,onAlreadyRegistered:b.ALREADY_REGISTERED.emit,onInvalidClass:b.INVALID_CLASS.emit,onDeferredInstantiation:e.WebHelpers.onDOMContentLoaded}),j.initialize({onAllowHTML:b.ALLOW_HTML.emit,onInvalidKey:b.INVALID_KEY.emit,onInvalidDefinition:b.INVALID_DEFINITION.emit,onLockedDefinition:b.LOCKED_DEFINITION.emit,onInexistentTemplate:b.INEXISTENT_TEMPLATE.emit,onUnespecifiedSlot:b.UNESPECIFIED_SLOT.emit,onUnknownTag:b.UNKNOWN_TAG.emit,onInvalidId:b.INVALID_ID.emit,onTakenId:b.TAKEN_ID.emit,onInvalidState:b.INVALID_STATE.emit,onFetchTemplate:ot.fetch})}static declareUnwritableMembers(e,t){Ts(e,t.fields),Ts(e,t.methods)}};var wi,As,Is,fi,mi,ee,hi=r=>r>1e3?(r/1e3).toFixed(2)+"s":r.toFixed(2)+"ms",ci=class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=hi(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=hi(this.renderTime)),e}},ui=class{constructor(e){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=hi(this.time),t=hi(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:t}}},R=class{static initialize(e){typeof e=="function"&&d(R,ee,e),R.DOMUpdate.overall=new ui("overall-dom-update"),R.BrowserRender.overall=new ui("overall-browser-render")}},nt=R;ee=new WeakMap,o(nt,ee,()=>{}),l(nt,"StopWatch",(Is=class{constructor(){o(this,wi);l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new ci);l(this,"best",new ci);l(this,"averages",{dom:0,render:0})}start(){(R.DOMUpdate.check||R.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var t;R.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,R.DOMUpdate.overall.compute(this.last.domTime)),R.BrowserRender.check?setTimeout(()=>h(this,wi,As).bind(this)(e)):e&&s(t=R,ee).call(t,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},wi=new WeakSet,As=function(e){var t;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,R.BrowserRender.overall.compute(this.last.renderTime),e&&s(t=R,ee).call(t,this,"finish")},Is)),l(nt,"DOMUpdate",(fi=class{},l(fi,"check",!0),l(fi,"overall",null),fi)),l(nt,"BrowserRender",(mi=class{},l(mi,"check",!1),l(mi,"overall",null),mi));var rt,We,ki,Ue=class{constructor(){o(this,We);o(this,rt,new window.Object)}get length(){return h(this,We,ki).call(this).length}key(e){return h(this,We,ki).call(this)[e]||null}getItem(e){return s(this,rt)[e]}setItem(e,t){s(this,rt)[e]=t}removeItem(e){delete s(this,rt)[e]}clear(){d(this,rt,new window.Object)}hasItem(e){return s(this,rt).hasOwnProperty(e)}};rt=new WeakMap,We=new WeakSet,ki=function(){return window.Object.keys(s(this,rt))};var Ss="0.7.3";var E,{noop:ie,isOf:pi}=w;window.Wuse=window.Wuse||(E=class{static get VERSION(){return Ss}static get elementCount(){return j.instancesCount}},l(E,"DEBUG",!1),l(E,"FATALS",!1),l(E,"MEASURE",!1),l(E,"RENDERING",!0),l(E,"hashRoutine",V.defaultRoutine),l(E,"elementsStorage",new Ue),l(E,"tmp",null),l(E,"WebHelpers",null),l(E,"JsHelpers",null),l(E,"PerformanceMeasurement",null),l(E,"NonShadowElement",null),l(E,"OpenShadowElement",null),l(E,"ClosedShadowElement",null),l(E,"debug",ie),l(E,"blockUpdate",ie),l(E,"register",ie),l(E,"instantiate",ie),l(E,"create",ie),l(E,"isShadowElement",ie),(()=>{vt.declareUnwritableMembers(E,{fields:{tmp:new window.Object,WebHelpers:M,JsHelpers:w,PerformanceMeasurement:nt,NonShadowElement:L.specializeClass(j,L.REGULAR),OpenShadowElement:L.specializeClass(j,L.OPEN),ClosedShadowElement:L.specializeClass(j,L.CLOSED)},methods:{debug:e=>window.console.log("[WUSE:DEBUG]",e),blockUpdate:(e,t)=>{if(pi(e,Function)){window.Wuse.DEBUG&&window.Wuse.debug("blocking"),window.Wuse.RENDERING=!1;try{e(t)}catch(i){throw i}finally{window.Wuse.RENDERING=!0,window.Wuse.DEBUG&&window.Wuse.debug("unblocking")}}},isShadowElement:e=>{let t=window.Object.getPrototypeOf(e.constructor);return t===window.Wuse.OpenShadowElement||t===window.Wuse.ClosedShadowElement},register:e=>I.registerClasses(pi(e,window.Array)?e:new window.Array(e)),instantiate:(e,t,i)=>I.instantiateClasses(pi(e,window.Array)?e:new window.Array(e),t,i),create:(e,t)=>pi(e,window.Object)?I.createInstance(e.element,e.target,e.instance):void 0}}),vt.detectFeatures(E),vt.initializeModules(E)})(),E);})();
