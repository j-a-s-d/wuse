(()=>{var rn=Object.defineProperty;var on=(r,e,t)=>e in r?rn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var a=(r,e,t)=>(on(r,typeof e!="symbol"?e+"":e,t),t),ti=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var i=(r,e,t)=>(ti(r,e,"read from private field"),t?t.call(r):e.get(r)),o=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},d=(r,e,t,n)=>(ti(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);var h=(r,e,t)=>(ti(r,e,"access private method"),t);var A=(r,e)=>({code:r,emit:t=>{let n=r<80?"error":"warn",s=`[WUSE:${n.toUpperCase()}] ${r} | ${e(t)}`;if(window.Wuse&&window.Wuse.FATALS||r<10)throw new window.Error(s);return window.console[n](s),null}}),b=class{static get UNKNOWN_ERROR(){return A(0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return A(1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return A(2,e=>`Unregistered class: ${e}.`)}static get UNREGISTRABLE_CLASS(){return A(3,e=>`Unregistrable class: ${e}.`)}static get INVALID_CLASS(){return A(4,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return A(5,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return A(10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return A(11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return A(12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return A(13,e=>"Call first: this.allowRawContent(true).")}static get INVALID_STATE(){return A(14,e=>"Invalid state.")}static get INEXISTENT_TEMPLATE(){return A(20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return A(21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return A(22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return A(30,e=>`Unespecified slot: #${e}.`)}static get LOCKED_DEFINITION(){return A(40,e=>`Locked definition: #${e}.`)}static get UNKNOWN_TAG(){return A(80,e=>`Unknown tag: ${e}.`)}static get BAD_TARGET(){return A(81,e=>`Bad target: ${e}.`)}static get ALREADY_REGISTERED(){return A(90,e=>`Already registered: ${e}.`)}};var Te,Se,pi=(r,e)=>(typeof e=="function"&&e(r),r),g=class{static get EMPTY_STRING(){return i(this,Te)}static get EMPTY_ARRAY(){return i(this,Se)}static noop(){}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,t){return typeof e=="string"?e.split(t):new window.Array}static buildArray(e){return pi(new window.Array,e)}static buildObject(e){return pi(new window.Object,e)}static ensureFunction(e,t=()=>{}){return typeof e=="function"?e:t}static isOf(e,t){return e!=null&&(e.constructor===t||t!=null&&e.constructor.name===t.name)}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static cloneObject(e){return window.Object.assign(new window.Object,e)}static forEachOwnProperty(e,t){e&&window.Object.getOwnPropertyNames(e).forEach(t)}static isAssignedObject(e){return typeof e=="object"&&e!==null}static isAssignedArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"}static isNonEmptyArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"&&!!e.length}};Te=new WeakMap,Se=new WeakMap,o(g,Te,new window.String().valueOf()),o(g,Se,window.Object.freeze(new window.Array));var Dt,Nt,{noop:gi,ensureFunction:Ei,isAssignedObject:an}=g,lt=class{static fetch(e){let t=window.document.getElementById(e);return t===null?i(this,Dt).call(this,e):t.tagName!=="TEMPLATE"?i(this,Nt).call(this,e):t.innerHTML}static initialize(e){an(e)&&(d(this,Dt,Ei(e.onExtinctTemplate,i(this,Dt))),d(this,Nt,Ei(e.onInvalidTemplate,i(this,Nt))))}};Dt=new WeakMap,Nt=new WeakMap,o(lt,Dt,gi),o(lt,Nt,gi);var Ot,Ct,Lt,Ut,Rt,Wt,kt,Ie,Ti,Ae,Si,ve,Ii,_e,Ai,De,vi,{noop:mt,ensureFunction:dt,isAssignedObject:yi,isAssignedArray:Xn,isNonEmptyArray:bi,isOf:ln}=g,dn=r=>r.toLowerCase().replaceAll("_","-"),I=class{static registerClasses(e){bi(e)&&window.Array.prototype.forEach.call(e,t=>typeof t=="function"?h(this,ve,Ii).call(this,t):i(this,Ut).call(this,t))}static instantiateClasses(e,t,n){bi(e)&&window.Array.prototype.forEach.call(e,s=>window.customElements.get(s.tag)?h(this,De,vi).call(this,s,t,yi(n)?n:new window.Object):i(this,Wt).call(this,s.name))}static initialize(e){yi(e)&&(d(this,Ot,dt(e.onBadTarget,i(this,Ot))),d(this,Ct,dt(e.onDeferredInstantiation,i(this,Ct))),d(this,Ut,dt(e.onInvalidClass,i(this,Ut))),d(this,Lt,dt(e.onMisnamedClass,i(this,Lt))),d(this,Rt,dt(e.onUnregistrableClass,i(this,Rt))),d(this,Wt,dt(e.onUnregisteredClass,i(this,Wt))),d(this,kt,dt(e.onAlreadyRegistered,i(this,kt))))}};Ot=new WeakMap,Ct=new WeakMap,Lt=new WeakMap,Ut=new WeakMap,Rt=new WeakMap,Wt=new WeakMap,kt=new WeakMap,Ie=new WeakSet,Ti=function(e){window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):i(this,Rt).call(this,e.name)},Ae=new WeakSet,Si=function(e){window.customElements.get(e.tag=dn(e.name))?i(this,kt).call(this,e.name):h(this,Ie,Ti).call(this,e)},ve=new WeakSet,Ii=function(e){e.name.indexOf("_")>0?h(this,Ae,Si).call(this,e):i(this,Lt).call(this,e.name)},_e=new WeakSet,Ai=function(e,t,n){let s=null;try{s=window.document.querySelector(t)}catch(c){if(ln(n.on_bad_target,window.Function)){if(n.on_bad_target(t)===!1)return}else{i(this,Ot).call(this,t);return}}finally{s=s||window.document.body}let l=window.document.createElement(e.tag);dt(n.on_element_instantiated)(l,t),s.appendChild(l)},De=new WeakSet,vi=function(e,t,n){let s=()=>h(this,_e,Ai).call(this,e,t,n);window.document.body?s():i(this,Ct).call(this,s)},o(I,Ie),o(I,Ae),o(I,ve),o(I,_e),o(I,De),o(I,Ot,mt),o(I,Ct,mt),o(I,Lt,mt),o(I,Ut,mt),o(I,Rt,mt),o(I,Wt,mt),o(I,kt,mt);var N=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}static get WUSEKEY_ATTRIBUTE(){return"data-wusekey"}static get WUSENODE_ATTRIBUTE(){return"data-wusenode"}};var Vt,Ne,pt,qt,Xt,{EMPTY_ARRAY:hn,buildArray:ei,buildObject:cn,isNonEmptyString:un,isOf:fn}=g,Ft=class{static initialize(e,t){this.begin=e,this.end=t}},V=Ft;a(V,"begin",null),a(V,"end",null),a(V,"enclose",e=>Ft.begin+e+Ft.end),a(V,"makeRegExp",()=>new window.RegExp(`(?<=${Ft.begin}).*?(?=${Ft.end})`,"gs"));var wn=["contents","classes","styles","attributes"],Mt=class{};a(Mt,"rules",(e,t)=>ei(n=>e.forEach(s=>s.replacements.forEach(l=>l.field===t&&n.push(s))))),a(Mt,"children",(e,t)=>ei(n=>{let s=l=>{let c=u=>u.forEach(v=>v.field===t&&n.push(l));wn.forEach(u=>c(l.replacements[u])),l.rules.forEach(u=>u.replacements.forEach(v=>v.field===t&&n.push(l)))};e.forEach(l=>l.included&&s(l))}));var L=class{static initialize(e){d(this,Vt,e)}},F=L;Vt=new WeakMap,Ne=new WeakMap,pt=new WeakMap,qt=new WeakMap,Xt=new WeakMap,o(F,Vt,null),o(F,Ne,(e,t,n)=>e.push({at:t,field:n.trim(),find:V.enclose(n)})),o(F,pt,(e,t,n)=>un(n)&&(n.match(i(L,Vt))||hn).forEach(s=>{var l;return i(l=L,Ne).call(l,e,t,s)})),o(F,qt,(e,t,n)=>{var s;e[t]=new window.Array,i(s=L,pt).call(s,e[t],t,n)}),o(F,Xt,(e,t,n)=>{e[t]=new window.Array,window.Object.keys(n).forEach(s=>{var l,c;i(l=L,pt).call(l,e[t],t,s),i(c=L,pt).call(c,e[t],t,n[s])})}),a(F,"child",e=>cn(t=>{var n,s,l,c;i(n=L,qt).call(n,t,"contents",e.content),i(s=L,qt).call(s,t,"classes",e.classes.join(" ")),i(l=L,Xt).call(l,t,"styles",e.style),i(c=L,Xt).call(c,t,"attributes",e.attributes),e.rules.forEach(u=>u.replacements=L.rule(u))})),a(F,"rule",e=>ei(t=>{var s;if(fn(e.nested,window.Array))return e.nested.map(l=>L.rule(l));var n="";for(let l in e.properties)n+=`${l}:${e.properties[l]};`;i(s=L,pt).call(s,t,"rules",n)}));var W=class{static initialize(e,t){V.initialize(e,t),F.initialize(V.makeRegExp())}};a(W,"extractReplacementsFromRule",F.rule),a(W,"extractReplacementsFromChild",F.child),a(W,"scanRulesForReplacements",Mt.rules),a(W,"scanChildrenForReplacements",Mt.children);var gt=class{static defaultRoutine(e=""){var t=0;for(let n=0;n<e.length;n++)t=(t=(t<<5)-t+e.charCodeAt(n))&t;return t}};var _i=gt.defaultRoutine,mn=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","content","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","marquee","mark","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","shadow","select","slot","small","source","spacer","span","strike","strong","style","sub","sup","summary","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","xmp","wbr"].map(_i),q=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let t=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",t),100)};window.addEventListener("DOMContentLoaded",t)}}static getUniqueId(e="WUSE"){let t="_"+(e||"")+"_";for(var n;window.document.getElementById(n=t+(""+window.Math.random()).substring(2))!==null;);return n}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static isHTMLTag(e){return mn.indexOf(_i(e))>-1}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),n=window.Array.prototype.slice.call(e).filter(s=>s.charAt(0)==="-");return n.length?"-"+n[0].split("-")[1]+"-":""}};var xt,{noop:pn,isOf:gn,hasObjectKeys:Di,isNonEmptyString:Ni,isNonEmptyArray:En,isAssignedObject:yn,ensureFunction:bn}=g,{htmlEncode:Oi}=q,{SLOTS_KIND:Tn,TEMPLATES_KIND:Sn,TEXTNODE_TAG:In}=N,Qt=class{static initialize(e){yn(e)&&d(this,xt,bn(e.onFetchTemplate,i(this,xt)))}},y=Qt;xt=new WeakMap,o(y,xt,pn),a(y,"cacheInvalidator",e=>e.cache=null),a(y,"slotsInvalidator",e=>e.kind===Tn?Qt.cacheInvalidator(e):void 0),a(y,"renderingIncluder",e=>e.included=!0),a(y,"renderingExcluder",e=>e.included=!1),a(y,"renderRule",(e,t)=>{if(gn(t.nested,window.Array))return`${t.selector}{${t.nested.map(s=>Qt.renderRule(e,s)).join(`
`)}}`;if(Ni(t.selector)&&!t.nested){var n=new window.String;for(let s in t.properties)n+=`${s}:${t.properties[s]};`;return En(t.replacements)&&t.replacements.forEach(s=>n=e(n,s)),`${t.selector}{${n}}`}return null}),a(y,"renderChild",(e,t)=>{var l;if(t.kind===Sn)return i(l=Qt,xt).call(l,t.id);if(t.tag===In){var n=t.content;return t.replacements.contents.forEach(c=>n=e(n,c)),t.encode?Oi(n):n}var s=Ni(t.id)?`<${t.tag} id='${t.id}'`:`<${t.tag}`;if(t.classes.length){var n=t.classes.join(" ");t.replacements.classes.forEach(u=>n=e(n,u)),s+=` class='${n}'`}if(Di(t.style)){var n=" style='";for(let u in t.style)n+=`${u}: ${t.style[u]}; `;n+="'",t.replacements.styles.forEach(u=>n=e(n,u)),s+=n}if(Di(t.attributes)){var n=new window.String;for(let u in t.attributes)n+=` ${u}=${t.attributes[u]}`;t.replacements.attributes.forEach(u=>n=e(n,u)),s+=n}if(typeof t.content=="string"){var n=t.content;t.replacements.contents.forEach(u=>n=e(n,u)),s+=`>${t.encode?Oi(n):n}</${t.tag}>`}else s+="/>";return s});var Zt,te,ee,ie,{ensureFunction:An}=g,$t=class{constructor(e){a(this,"rounds",0);o(this,Zt,0);o(this,te,null);o(this,ee,!1);o(this,ie,null);d(this,ie,An(e))}compute(e){return this.rounds+=+d(this,ee,i(this,Zt)==d(this,te,i(this,ie).call(this,e))),d(this,Zt,i(this,te)),i(this,ee)}};Zt=new WeakMap,te=new WeakMap,ee=new WeakMap,ie=new WeakMap;var jt,ht,Bt,se,re,O,X,Kt,Ce,{ensureFunction:ii,isNonEmptyString:vn,isOf:Oe}=g,ne=class{constructor(e,t,n,s={}){o(this,Kt);o(this,jt,new window.String);o(this,ht,!1);o(this,Bt,null);o(this,se,null);o(this,re,null);o(this,O,null);o(this,X,null);d(this,Bt,ii(e)),d(this,se,ii(t)),d(this,re,ii(n)),d(this,X,s)}getStore(){return i(this,X)}setStore(e){d(this,X,e)}get state(){return i(this,O)}get key(){return i(this,jt)}set key(e){return d(this,ht,vn(d(this,jt,e)))}hasKey(){return i(this,ht)}validateKey(){return i(this,ht)?!0:(this.on_invalid_key(),!1)}initializeState(){if(i(this,ht)){let e=i(this,X).hasItem(this.key)?i(this,X).getItem(this.key):i(this,Bt).call(this);if(Oe(e,window.Object))d(this,O,e),i(this,O).generation++,h(this,Kt,Ce).call(this);else return this.on_invalid_state(),-1}else d(this,O,i(this,Bt).call(this)),i(this,O).generation++;return i(this,O).generation}writeState(){let e=i(this,O);return Oe(e,window.Object)?(e.data=i(this,re).call(this),h(this,Kt,Ce).call(this),!0):!1}readState(){let e=i(this,O);return Oe(e,window.Object)&&e.persisted?(i(this,se).call(this,e.data),!0):!1}eraseState(){let e=i(this,O);return Oe(e,window.Object)&&e.persisted&&e.data?(delete e.data,h(this,Kt,Ce).call(this),!0):!1}on_invalid_state(){}on_invalid_key(){}};jt=new WeakMap,ht=new WeakMap,Bt=new WeakMap,se=new WeakMap,re=new WeakMap,O=new WeakMap,X=new WeakMap,Kt=new WeakSet,Ce=function(){i(this,ht)&&(i(this,O).persisted=!!i(this,O).data,i(this,X).setItem(i(this,jt),i(this,O)))};var Q,z,ct,Le,Li,Ue,Ui,{WUSENODE_ATTRIBUTE:Ci}=N,Gt=class{constructor(e,t){o(this,Le);o(this,Ue);o(this,Q,null);o(this,z,null);o(this,ct,null);if(e instanceof Node&&t instanceof Node)d(this,Q,e),h(this,Le,Li).call(this,t.getAttribute(Ci)),d(this,z,t),d(this,ct,t.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return i(this,z)}affiliate(){i(this,Q).appendChild(i(this,z))}disaffiliate(){i(this,Q).removeChild(i(this,z))}promote(e){i(this,ct).innerHTML=e,i(this,Q).replaceChild(i(this,ct),i(this,z)),h(this,Ue,Ui).call(this)}};Q=new WeakMap,z=new WeakMap,ct=new WeakMap,Le=new WeakSet,Li=function(e){let t=i(this,Q).querySelector(`[${Ci}='${e}']`);t&&i(this,Q).removeChild(t)},Ue=new WeakSet,Ui=function(){let e=i(this,ct);d(this,ct,i(this,z).cloneNode(!1)),d(this,z,e)};var Et,yt,bt=class{constructor(e){a(this,"owner",null);o(this,Et,!1);o(this,yt,"");this.owner=e}get invalidated(){return i(this,Et)}reset(e){d(this,Et,!1),d(this,yt,e)}append(e){d(this,yt,i(this,yt)+e)}verify(e){d(this,Et,e(i(this,yt)))}process(e){(e||i(this,Et))&&this.on_content_invalidation(i(this,yt))}on_content_invalidation(e){}};Et=new WeakMap,yt=new WeakMap;var Tt,oe,{isOf:ni,cloneObject:Ri,forEachOwnProperty:Wi,buildArray:_n}=g,St=class extends window.Array{constructor(t){super();o(this,Tt);a(this,"owner",null);a(this,"last",null);a(this,"version",0);a(this,"locked",!1);this.owner=t}append(t){this.locked?this.on_forbidden_change():ni(t,window.Object)&&(this.push(t),h(this,Tt,oe).call(this,t))}prepend(t){this.locked?this.on_forbidden_change():ni(t,window.Object)&&(this.unshift(t),h(this,Tt,oe).call(this,t))}replace(t,n){this.locked?this.on_forbidden_change():t>-1&&ni(n,window.Object)&&h(this,Tt,oe).call(this,this[t]=n)}remove(t){if(this.locked)this.on_forbidden_change();else if(t>-1){let n=this.splice(t,1);h(this,Tt,oe).call(this,n.length?n[0]:null)}}persist(){return _n(t=>Wi(this,n=>{switch(n){case"owner":case"last":case"length":break;case"version":case"locked":t[n]=this[n];break;default:if(window.Number.isInteger(window.Number(n))){let s=Ri(this[n]);s.cache&&(s.cache=null),t.push(s)}break}}))}restore(t){Wi(t,n=>{switch(n){case"length":break;case"version":case"locked":this[n]=t[n];break;default:if(window.Number.isInteger(window.Number(n))){let s=Ri(t[n]);s.cache&&(s.cache=null),this.push(s)}break}})}on_version_change(){}on_forbidden_change(){}};Tt=new WeakSet,oe=function(t){this.last=t,this.version++,this.on_version_change()};var We,$i,ke,ji,Me,Bi,Fe,Ki,xe,Gi,Ht,Re,$e,Hi,{isHTMLTag:Dn}=q,{EMPTY_STRING:x,EMPTY_ARRAY:Nn,noop:ae,buildArray:bs,buildObject:On,isOf:C,hasObjectKeys:ki,isNonEmptyString:ut,forcedStringSplit:Cn}=g,{WUSENODE_ATTRIBUTE:Mi,DEFAULT_TAG:Ln,DEFAULT_KIND:Un,TEMPLATES_KIND:si,SLOTS_KIND:ri,TEXTNODE_TAG:Rn}=N,P={onInvalidDefinition:ae,onInexistentTemplate:ae,onUnespecifiedSlot:ae,onInvalidId:ae,onUnknownTag:ae},Z=class{static parse(e){if(ut(e)){let t=e.trimLeft(),n=Fi();return t.charAt(0)==="%"?t.startsWith(si)?h(this,Ht,Re).call(this,n,t.replace(n.kind=si,x)):t.startsWith(ri)?h(this,Ht,Re).call(this,n,t.replace(n.kind=ri,x)):null:h(this,Ht,Re).call(this,n,t)}return null}};We=new WeakSet,$i=function(e,t){let n=t.indexOf("["),s=t.indexOf("]");if(n>-1&&s>-1&&s>n){let l=t.substr(n,s-n+1),c=l.substr(1,l.length-2).split("|");for(let u in c){let v=c[u].split("=");v[0]==="style"?v[1].split(";").forEach(H=>{let wi=H.split(":"),mi=wi[0].trim();mi.length&&(e.style[mi]=wi[1].trim())}):e.attributes[v[0]]=v[1]}return t.replace(l,x)}return t},ke=new WeakSet,ji=function(e,t){let n=t.indexOf("=");return n>-1?(e.content=t.slice(n+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),t.slice(0,n)):t},Me=new WeakSet,Bi=function(e,t){let n=t.replaceAll("!"," ").split(" ");return n.slice(1).map(s=>{let[l,...c]=s.toLowerCase().split("+"),u=(c||Nn).indexOf("capture")>-1;e.events.push(xi(l,u))}),n[0]},Fe=new WeakSet,Ki=function(e,t){let n=t.replaceAll("."," ").split(" ");return e.classes=n.slice(1),n[0]},xe=new WeakSet,Gi=function(e,t){if(ut(t)){let n=t.indexOf("#");n===-1?e.tag=t:(n>0&&(e.tag=t.substr(0,n)),e.id=t.substr(n+1))}return e},Ht=new WeakSet,Re=function(e,t){return h(this,xe,Gi).call(this,e,h(this,Fe,Ki).call(this,e,h(this,Me,Bi).call(this,e,h(this,ke,ji).call(this,e,h(this,We,$i).call(this,e,t)))))},o(Z,We),o(Z,ke),o(Z,Me),o(Z,Fe),o(Z,xe),o(Z,Ht);var le=class{static parse(e){return On(t=>(C(e,window.Array)?e:Cn(e,`
`).map(n=>n.trim()).join(x).split(";")).forEach(n=>ut(n)&&h(this,$e,Hi).call(this,t,n.trim())))}};$e=new WeakSet,Hi=function(e,t){if(!!t.length&&t.indexOf(":")>-1){let[n,...s]=t.split(":"),l=n.trim();if(l.length){let c=s.join(":").trim();e[l]=c.endsWith(";")?c.slice(0,-1):c}}},o(le,$e);var Fi=()=>({kind:Un,tag:Ln,id:x,classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:x,encode:!1}),Wn=()=>({generation:0,persisted:!1}),xi=(r,e)=>typeof r=="string"&&typeof e=="boolean"?{kind:r,capture:e}:null,kn=(r,e)=>{let t=Z.parse(r);return t?(t.rules=C(e,window.Array)?e:new window.Array,t.included=!0,t.cache=null,t):P.onInvalidDefinition(r)},Mn=r=>{if(r!==null)if(r.kind===si){if(!window.document.getElementById(r.id))return P.onInexistentTemplate(r.id)}else if(r.kind===ri){if(new window.String(r.attributes.slot).replaceAll('"',x).replaceAll("'",x).length===0)return P.onUnespecifiedSlot(r.id)}else{if(r.tag.indexOf("-")===-1?!Dn(r.tag)&&r.tag!==Rn:!window.customElements.get(r.tag))return P.onUnknownTag(r.tag);if(typeof r.id!="string")return P.onInvalidId(r.id)}return r},Fn=r=>{if(!C(r,window.Object))return null;let e=window.document.createElement(r.tag);if(r.id.length&&e.setAttribute("id",r.id),r.classes.length&&e.setAttribute("class",r.classes.join(" ")),ki(r.style)){var t=new window.String;for(let n in r.style)t+=`${n}: ${r.style[n]}; `;if(t.length){let n=t.trim();e.setAttribute("style",n.endsWith(";")?n.slice(0,-1):n)}}if(ki(r.attributes))for(let n in r.attributes)e.setAttribute(n,r.attributes[n]);return e.setAttribute(Mi,"main"),e},xn=(r,e)=>{let t=window.document.createElement("style");return ut(r)&&t.setAttribute("media",r),ut(e)&&t.setAttribute("type",e),t.setAttribute(Mi,"style"),t.appendChild(window.document.createTextNode(x)),t},$n=(r,e)=>{let t=C(r,window.Array)?r.join(","):ut(r)?r:x;return t.length?{selector:t,properties:C(e,window.Object)?e:le.parse(e),cache:null}:null},jn=(r,e,t)=>{let n=C(r,window.Array)?r.join(","):ut(r)?r:x,s=C(e,window.Array)?e.join(","):ut(e)?e:x;return!n.length||!s.length?null:{selector:n,nested:[{selector:s,properties:C(t,window.Object)?t:le.parse(t)}],cache:null}},Bn=(r,e)=>{if(r.selector===e.selector){for(let t in e.properties)r.properties[t]=e.properties[t];return r.cache=null,!0}return!1},Kn=(r,e)=>C(r.nested,window.Array)&&r.selector===e.selector?(e.nested.forEach(t=>{var n=!1;for(let s in r.nested)if(n=r.nested[s].selector===t.selector){for(let l in t.properties)r.nested[s].properties[l]=t.properties[l];break}n||r.nested.push(t)}),r.cache=null,!0):!1,f=class{static initialize(e){C(e,window.Object)&&(C(e.onInvalidDefinition,window.Function)&&(P.onInvalidDefinition=e.onInvalidDefinition),C(e.onInexistentTemplate,window.Function)&&(P.onInexistentTemplate=e.onInexistentTemplate),C(e.onUnespecifiedSlot,window.Function)&&(P.onUnespecifiedSlot=e.onUnespecifiedSlot),C(e.onInvalidId,window.Function)&&(P.onInvalidId=e.onInvalidId),C(e.onUnknownTag,window.Function)&&(P.onUnknownTag=e.onUnknownTag))}};a(f,"makeStyleNode",xn),a(f,"newRule",$n),a(f,"newNestedRule",jn),a(f,"tryToJoinRules",Bn),a(f,"tryToJoinNestedRules",Kn),a(f,"performValidations",Mn),a(f,"makeMainNode",Fn),a(f,"newChild",kn),a(f,"newDefinition",Fi),a(f,"newEvent",xi),a(f,"newState",Wn);var k=class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}};a(k,"specializeClass",(e,t)=>class extends e{constructor(){super(t)}});var tt,zt,Gn=["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"],de=class{constructor(e){o(this,tt,null);o(this,zt,new window.Object);d(this,tt,e)}detect(){Gn.forEach(e=>i(this,zt)[e]=typeof i(this,tt)[e]=="function")}immediateTrigger(e,t){i(this,zt)[e]&&i(this,tt)[e].call(i(this,tt),t)}committedTrigger(e,t){i(this,zt)[e]&&window.requestAnimationFrame(()=>i(this,tt)[e].call(i(this,tt),t))}};tt=new WeakMap,zt=new WeakMap;var B,p,T,R,m,D,et,it,ce,nt,Y,st,ft,rt,At,je,Be,S,w,Jt,ue,vt,K,j,J,Ke,Yi,Ge,Vi,He,qi,ze,Xi,wt,Pt,fe,oi,we,ai,me,li,Pe,Qi,pe,di,Je,Zi,ge,hi,{EMPTY_STRING:he,noop:$,isOf:_,isNonEmptyArray:zi,isNonEmptyString:It,forcedStringSplit:Pi}=g;function Ji(r,e,t,n,s){let l=(v,H)=>window.Object.defineProperty(r,e,{get:v,set:H,enumerable:!0,configurable:!0}),c=()=>delete r[e],u=(v,H)=>Ji(r,e,v,H,s);l(()=>t,v=>{u(v,n),_(n,window.Function)?n({renderize:H=>s(e,H),automate:()=>u(v,null),freeze:()=>l(()=>v,H=>{}),defreeze:()=>u(v,n),dereact:()=>l(()=>v,H=>{c(),r[e]=H}),remove:()=>c()}):s(e)})}var U={onInvalidState:$,onInvalidKey:$,onInvalidDefinition:$,onLockedDefinition:$,onAllowHTML:$},ci=class extends window.HTMLElement{constructor(t){super();o(this,j);o(this,Ke);o(this,Ge);o(this,He);o(this,ze);o(this,wt);o(this,fe);o(this,we);o(this,me);o(this,Pe);o(this,pe);o(this,Je);o(this,ge);o(this,B,new window.String);o(this,p,new class extends St{on_version_change(){var t;this.last!==null&&(this.last.version=this.version,this.last.replacements=W.extractReplacementsFromRule(this.last)),window.Wuse.DEBUG&&h(t=this.owner,j,J).call(t,`rules list version change: ${this.version}`)}on_forbidden_change(){var t;window.Wuse.DEBUG&&h(t=this.owner,j,J).call(t,"rules list is locked and can not be changed"),U.onLockedDefinition(i(this,m).mainDefinition.id)}}(this));o(this,T,new class extends St{on_version_change(){var t,n;this.last!==null&&(this.last.version=this.version,this.last.replacements=W.extractReplacementsFromChild(this.last),d(t=this.owner,it,i(t,it)|this.last.kind===N.SLOTS_KIND)),window.Wuse.DEBUG&&h(n=this.owner,j,J).call(n,`children list version change: ${this.version}`)}on_forbidden_change(){var t;window.Wuse.DEBUG&&h(t=this.owner,j,J).call(t,"children list is locked and can not be changed"),U.onLockedDefinition(i(this,m).mainDefinition.id)}}(this));o(this,R,new class extends St{on_version_change(){var t;window.Wuse.DEBUG&&h(t=this.owner,j,J).call(t,`fields list version change: ${this.version}`)}on_forbidden_change(){var t;window.Wuse.DEBUG&&h(t=this.owner,j,J).call(t,"fields list is locked and can not be changed"),U.onLockedDefinition(i(this,m).mainDefinition.id)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));o(this,m,{mainDefinition:f.newDefinition(),styleMedia:N.DEFAULT_STYLE_MEDIA,styleType:N.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});o(this,D,new de(this));o(this,et,!1);o(this,it,!1);o(this,ce,window.Wuse.isShadowElement(this));o(this,nt,void 0);o(this,Y,void 0);o(this,st,null);o(this,ft,!1);o(this,rt,!1);o(this,At,!0);o(this,je,t=>{t&&(d(this,m,t.options),d(this,it,t.slotted),d(this,et,t.identified),d(this,B,t.html),i(this,T).restore(t.children),i(this,T).owner=this,i(this,p).restore(t.rules),i(this,p).owner=this,i(this,R).restore(t.fields),i(this,R).owner=this,i(this,R).recall())});o(this,Be,()=>(i(this,R).snapshot(),{options:i(this,m),html:i(this,B),children:i(this,T).persist(),rules:i(this,p).persist(),fields:i(this,R).persist(),slotted:i(this,it),identified:i(this,et)}));o(this,S,new class extends ne{on_invalid_state(){U.onInvalidState()}on_invalid_key(){U.onInvalidKey()}}(f.newState,i(this,je),i(this,Be),window.Wuse.elementsStorage));o(this,w,{root:new class extends bt{on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends bt{on_content_invalidation(t){i(this.owner,Y).promote(t)}}(this),main:new class extends bt{on_content_invalidation(t){i(this.owner,nt).promote(t)}}(this),verifiers:{main:t=>!i(this,vt).main.compute(t),style:t=>!i(this,vt).style.compute(t)},renderizers:{rule:t=>i(this,w).style.append(t.cache?t.cache:t.cache=y.renderRule(i(this,Jt),t)),children:{mixed:t=>i(this,ce)&&t.kind===N.SLOTS_KIND?i(this,w).renderizers.children.slot(t):i(this,w).renderizers.children.normal(t),slot:t=>{t.cache||(i(this,w).root.verify(n=>!0),i(this,w).root.append(t.cache=y.renderChild(i(this,Jt),t)))},normal:t=>{i(this,w).main.append(t.cache?t.cache:t.cache=y.renderChild(i(this,Jt),t)),t.rules.forEach(i(this,w).renderizers.rule)}}},gotModified:()=>i(this,w).root.invalidated||i(this,w).main.invalidated||i(this,w).style.invalidated,getDebugInfo:()=>`updated (root: ${i(this,w).root.invalidated}, main: ${i(this,w).main.invalidated}, style: ${i(this,w).style.invalidated})`});o(this,Jt,(t,n)=>t.replace(n.find,this[n.field]!==void 0?this[n.field]:he));o(this,ue,{bind:{key:()=>{let t=n=>{It(n)&&(this[n]=h(this,fe,oi).call(this,n))};return i(this,et)&&t(i(this,m).mainDefinition.id),n=>t(n.id)},event:"addEventListener"},unbind:{key:()=>{let t=n=>delete this[n];return i(this,et)&&t(i(this,m).mainDefinition.id),n=>t(n.id)},event:"removeEventListener"}});o(this,vt,{main:new $t(window.Wuse.hashRoutine),style:new $t(window.Wuse.hashRoutine)});o(this,K,{attachment:new window.Wuse.PerformanceMeasurement.StopWatch,partial:new window.Wuse.PerformanceMeasurement.StopWatch,full:new window.Wuse.PerformanceMeasurement.StopWatch,dettachment:new window.Wuse.PerformanceMeasurement.StopWatch});a(this,"info",{instanceNumber:++ci.instancesCount,unmodifiedRounds:0,updatedRounds:0});d(this,st,t!==k.REGULAR?this.attachShadow({mode:t}):this),i(this,D).detect(),i(this,D).immediateTrigger("on_create"),i(this,m).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),this.dataset.wusekey&&this.setElementsStoreKey(this.dataset.wusekey),i(this,D).immediateTrigger(i(this,S).initializeState()>1?"on_reconstruct":"on_construct",i(this,S).state)}get render(){return i(this,rt)?h(this,Pe,Qi):$}get redraw(){return i(this,rt)?h(this,Je,Zi):$}connectedCallback(){window.Wuse.MEASURE&&i(this,K).attachment.start(),i(this,D).detect(),i(this,D).immediateTrigger("on_connect"),h(this,pe,di).call(this,"on_load"),i(this,S).writeState(),window.Wuse.MEASURE&&i(this,K).attachment.stop(window.Wuse.DEBUG)}disconnectedCallback(){window.Wuse.MEASURE&&i(this,K).dettachment.start(),h(this,wt,Pt).call(this,!1),i(this,D).immediateTrigger("on_disconnect"),i(this,S).writeState(),window.Wuse.MEASURE&&i(this,K).dettachment.stop(window.Wuse.DEBUG)}getElementsStore(){return i(this,S).getStore()}setElementsStore(t){return i(this,S).setStore(t),this}hasElementsStoreKey(){return i(this,S).hasKey()}getElementsStoreKey(t){return i(this,S).key}setElementsStoreKey(t){return(i(this,S).key=t)&&(this.setAttribute(N.WUSEKEY_ATTRIBUTE,t),i(this,S).writeState()),this}persistToElementsStore(){return i(this,S).validateKey()&&i(this,S).writeState()}restoreFromElementsStore(){return i(this,S).validateKey()&&i(this,S).readState()}removeFromElementsStore(){return i(this,S).validateKey()&&i(this,S).eraseState()}selectChildElement(t){return i(this,st).querySelector(t)}getMainAttribute(t){return i(this,ft)?i(this,nt).element.setAttribute(t):void 0}setMainAttribute(t,n){return i(this,ft)&&i(this,nt).element.setAttribute(t,n),this}setMainElement(t){let n=f.performValidations(f.newChild(t));if(n!==null){if(It(n.content)||zi(n.events))return U.onInvalidDefinition(t);d(this,et,It(n.id))&&(i(this,m).mainDefinition.id=n.id),It(n.tag)&&(i(this,m).mainDefinition.tag=n.tag),zi(n.classes)&&(i(this,m).mainDefinition.classes=n.classes),_(n.style,window.Object)&&(i(this,m).mainDefinition.style=n.style),_(n.attributes,window.Array)&&(i(this,m).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(t,n){return i(this,m).styleMedia=It(t)?t:he,i(this,m).styleType=It(n)?n:he,this}setElementsAsKeys(t){return i(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return i(this,m).attributeKeys=!!t,this}allowRawContent(t){return i(this,m).rawContent=!!t,this}setRawContent(t){return i(this,m).rawContent?d(this,B,t):U.onAllowHTML(),this}appendRawContent(t){return i(this,m).rawContent?d(this,B,i(this,B)+t):U.onAllowHTML(),this}prependRawContent(t){return i(this,m).rawContent?d(this,B,t+i(this,B)):U.onAllowHTML(),this}lockCSSRules(){return i(this,p).locked=!0,this}unlockCSSRules(){return i(this,p).locked=!1,this}appendCSSRule(t,n,s){if(s)return this.appendCSSNestedRule(t,n,s);let l=i(this,p).slice(-1),c=f.newRule(t,n);return(!l.length||!f.tryToJoinRules(l[0],c))&&i(this,p).append(c),this}prependCSSRule(t,n,s){if(s)return this.prependCSSNestedRule(t,n,s);let l=i(this,p).slice(0,1),c=f.newRule(t,n);return(!l.length||!f.tryToJoinRules(l[0],c))&&i(this,p).prepend(c),this}appendCSSNestedRule(t,n,s){let l=i(this,p).slice(-1),c=f.newNestedRule(t,n,s);return(!l.length||!f.tryToJoinNestedRules(l[0],c))&&i(this,p).append(c),this}prependCSSNestedRule(t,n,s){let l=i(this,p).slice(0,1),c=f.newNestedRule(t,n,s);return(!l.length||!f.tryToJoinNestedRules(l[0],c))&&i(this,p).prepend(c),this}hasCSSRuleBySelector(t){for(let n=0;n<i(this,p).length;n++)if(i(this,p)[n].selector===t)return!0;return!1}replaceCSSRuleBySelector(t,n){for(let s=0;s<i(this,p).length;s++)if(i(this,p)[s].selector===t){i(this,p)[s]=f.newRule(t,n);break}return this}removeCSSRuleBySelector(t){for(let n=0;n<i(this,p).length;n++)if(i(this,p)[n].selector===t){i(this,p).splice(n,1);break}return this}lockChildElements(){return i(this,T).locked=!0,this}unlockChildElements(){return i(this,T).locked=!1,this}appendChildElement(t,n){let s=f.performValidations(f.newChild(t,n));return s!==null&&i(this,T).append(s),this}prependChildElement(t,n){let s=f.performValidations(f.newChild(t,n));return s!==null&&i(this,T).prepend(s),this}appendChildElements(t){return(_(t,window.Array)?t:Pi(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(t){return(_(t,window.Array)?t:Pi(t,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}replaceChildElementById(t,n,s){let l=f.newChild(n,s);return l!==null&&i(this,T).replace(i(this,T).findIndex(c=>c.id===t),l),this}removeChildElementById(t){return i(this,T).remove(i(this,T).findIndex(n=>n.id===t)),this}checkChildElementIsIncludedById(t,n,s){let l=c=>_(c,window.Function)?c():void 0;return i(this,T).some(c=>c.id===t&&c.included)?l(n):l(s),this}includeChildElementById(t){return i(this,T).forEach(n=>n.id===t&&y.renderingIncluder(n)),this}excludeChildElementById(t){return i(this,T).forEach(n=>n.id===t&&y.renderingExcluder(n)),this}invalidateChildElementsById(t){return i(this,T).forEach(n=>t.indexOf(n.id)>-1&&y.cacheInvalidator(n)),this}invalidateChildElements(t){return _(t,window.Array)&&t.forEach(y.cacheInvalidator),this}lockInstanceFields(){return i(this,R).locked=!0,this}unlockInstanceFields(){return i(this,R).locked=!1,this}makeField(t,n){return this[t]=n,i(this,R).append({name:t,value:n}),this}makeReactiveField(t,n,s,l=!0){return Ji(this,t,n,s,(c,u)=>h(this,ge,hi).call(this,c,u||"$auto")),i(this,R).append({name:t,value:n}),l&&h(this,ge,hi).call(this,t,"$init"),this}makeExternalReactiveField(t,n,s,l,c=!0){return this.makeReactiveField(n,t[n]||s,u=>{t[n]=this[n],l(u)},c)}hasField(t){for(let n=0;n<i(this,R).length;n++)if(i(this,R)[n].name===t)return!0;return!1}suspendRender(){return d(this,At,!1),this}resumeRender(t=!0){return d(this,At,!0),t&&this.render(),this}isRenderSuspended(){return!i(this,At)}static initialize(t){if(W.initialize(N.DEFAULT_REPLACEMENT_OPEN,N.DEFAULT_REPLACEMENT_CLOSE),_(t,window.Object)){_(t.onFetchTemplate,window.Function)&&y.initialize({onFetchTemplate:t.onFetchTemplate}),_(t.onAllowHTML,window.Function)&&(U.onAllowHTML=t.onAllowHTML),_(t.onInvalidKey,window.Function)&&(U.onInvalidKey=t.onInvalidKey),_(t.onInvalidState,window.Function)&&(U.onInvalidState=t.onInvalidState),_(t.onLockedDefinition,window.Function)&&(U.onLockedDefinition=t.onLockedDefinition);let n={onInvalidDefinition:$,onInexistentTemplate:$,onUnespecifiedSlot:$,onInvalidId:$,onUnknownTag:$};_(t.onInvalidDefinition,window.Function)&&(U.onInvalidDefinition=t.onInvalidDefinition,n.onInvalidDefinition=t.onInvalidDefinition),_(t.onInexistentTemplate,window.Function)&&(n.onInexistentTemplate=t.onInexistentTemplate),_(t.onUnespecifiedSlot,window.Function)&&(n.onUnespecifiedSlot=t.onUnespecifiedSlot),_(t.onInvalidId,window.Function)&&(n.onInvalidId=t.onInvalidId),_(t.onUnknownTag,window.Function)&&(n.onUnknownTag=t.onUnknownTag),f.initialize(n)}}},G=ci;B=new WeakMap,p=new WeakMap,T=new WeakMap,R=new WeakMap,m=new WeakMap,D=new WeakMap,et=new WeakMap,it=new WeakMap,ce=new WeakMap,nt=new WeakMap,Y=new WeakMap,st=new WeakMap,ft=new WeakMap,rt=new WeakMap,At=new WeakMap,je=new WeakMap,Be=new WeakMap,S=new WeakMap,w=new WeakMap,Jt=new WeakMap,ue=new WeakMap,vt=new WeakMap,K=new WeakMap,j=new WeakSet,J=function(t){i(this,et)&&window.Wuse.debug(`#${i(this,m).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},Ke=new WeakSet,Yi=function(){i(this,Y)&&i(this,Y).affiliate(),i(this,nt).affiliate(),d(this,ft,!0)},Ge=new WeakSet,Vi=function(){d(this,Y,i(this,p).length?new Gt(i(this,st),f.makeStyleNode(i(this,m).styleMedia,i(this,m).styleType)):null),d(this,nt,new Gt(i(this,st),f.makeMainNode(i(this,m).mainDefinition))),i(this,T).forEach(y.cacheInvalidator),i(this,p).forEach(y.cacheInvalidator)},He=new WeakSet,qi=function(){i(this,ft)&&(i(this,nt).disaffiliate(),i(this,Y)&&i(this,Y).disaffiliate(),i(this,it)&&i(this,ce)&&window.Wuse.WebHelpers.removeChildren(this)),d(this,ft,!1)},ze=new WeakSet,Xi=function(t){return{key:i(this,m).elementKeys&&t.key(),event:(n,s,l)=>{let c=this[`on_${n}_${s}`];if(c){let u=h(this,fe,oi).call(this,n);u&&u[t.event](s,c,l)}},slots:()=>this.on_slot_change&&i(this,st).querySelectorAll("slot").forEach(n=>n[t.event]("slotchange",this.on_slot_change))}},wt=new WeakSet,Pt=function(t){if(i(this,rt)&&!t||!i(this,rt)&&t){let n=h(this,ze,Xi).call(this,t?i(this,ue).bind:i(this,ue).unbind);i(this,T).forEach(s=>{!s.included&&t||(n.key&&n.key(s),s.events.forEach(l=>l&&n.event(s.id,l.kind,l.capture)))}),i(this,it)&&n.slots(),d(this,rt,t)}},fe=new WeakSet,oi=function(t){return It(t)?i(this,st).querySelector(`#${t}`):void 0},we=new WeakSet,ai=function(){i(this,w).root.reset(he),i(this,w).style.reset(he),i(this,w).main.reset(i(this,B));let t=i(this,it)?i(this,w).renderizers.children.mixed:i(this,w).renderizers.children.normal;i(this,T).forEach(n=>n.included&&t(n)),i(this,p).forEach(i(this,w).renderizers.rule),i(this,w).main.verify(i(this,w).verifiers.main),i(this,w).style.verify(i(this,w).verifiers.style)},me=new WeakSet,li=function(t,n,s){i(this,w).root.process(t),i(this,w).style.process(n),i(this,w).main.process(s),window.Wuse.DEBUG&&h(this,j,J).call(this,i(this,w).getDebugInfo())},Pe=new WeakSet,Qi=function(){!window.Wuse.RENDERING||!i(this,At)||(window.Wuse.MEASURE&&i(this,K).partial.start(),i(this,D).immediateTrigger("on_prerender"),h(this,we,ai).call(this),i(this,w).gotModified()?(h(this,wt,Pt).call(this,!1),h(this,me,li).call(this,!1,!1,!1),h(this,wt,Pt).call(this,!0),this.info.updatedRounds++,i(this,D).immediateTrigger("on_update"),i(this,S).writeState(),i(this,D).committedTrigger("on_refresh")):this.info.unmodifiedRounds++,window.Wuse.DEBUG&&h(this,j,J).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${i(this,vt).main.rounds}, style: ${i(this,vt).style.rounds}) | updated: ${this.info.updatedRounds}`),i(this,D).immediateTrigger("on_postrender"),window.Wuse.MEASURE&&i(this,K).partial.stop(window.Wuse.DEBUG))},pe=new WeakSet,di=function(t){h(this,Ge,Vi).call(this),h(this,Ke,Yi).call(this),i(this,D).immediateTrigger("on_inject"),h(this,we,ai).call(this),h(this,me,li).call(this,!1,!!i(this,Y),!0),h(this,wt,Pt).call(this,!0),i(this,D).immediateTrigger(t)},Je=new WeakSet,Zi=function(){window.Wuse.MEASURE&&i(this,K).full.start(),h(this,wt,Pt).call(this,!1),h(this,He,qi).call(this),i(this,D).immediateTrigger("on_unload"),i(this,D).detect(),h(this,pe,di).call(this,"on_reload"),i(this,S).writeState(),i(this,D).committedTrigger("on_repaint"),window.Wuse.MEASURE&&i(this,K).full.stop(window.Wuse.DEBUG)},ge=new WeakSet,hi=function(t,n="$none"){if(i(this,rt)){let s=W.scanRulesForReplacements(i(this,p),t);s.forEach(y.cacheInvalidator);let l=W.scanChildrenForReplacements(i(this,T),t);l.forEach(y.cacheInvalidator),window.Wuse.DEBUG&&h(this,j,J).call(this,`reactive render (label: ${n}, field: ${t}, children: ${l.length}, rules: ${s.length})`),(!!s.length||!!l.length)&&(l.some(c=>!!c.kind.length)&&i(this,T).forEach(y.slotsInvalidator),this.render())}},a(G,"instancesCount",0);var tn=(r,e)=>window.Object.getOwnPropertyNames(e).forEach(t=>Object.defineProperty(r,t,{value:e[t],writable:!1,configurable:!1,enumerable:!1})),_t=class{static detectFeatures(e){let t=(n,s)=>!n&&b.UNSUPPORTED_FEATURE.emit(s);try{t(e.JsHelpers.isOf(window.document,window.HTMLDocument),"HTML Document"),t(e.JsHelpers.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),e.WebHelpers.onDOMContentLoaded(()=>t(e.JsHelpers.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){b.UNKNOWN_ERROR.emit()}}static initializeModules(e){e.PerformanceMeasurement.initialize((t,n)=>e.debug(JSON.stringify(e.JsHelpers.buildArray(s=>{switch(s.push({instances:e.elementCount}),s.push(t.getDebugInfo()),n){case"stop":s.push(e.PerformanceMeasurement.DOMUpdate.overall.getDebugInfo());break;case"finish":s.push(e.PerformanceMeasurement.BrowserRender.overall.getDebugInfo());break}})))),lt.initialize({onExtinctTemplate:b.EXTINCT_TEMPLATE.emit,onInvalidTemplate:b.INVALID_TEMPLATE.emit}),I.initialize({onBadTarget:b.BAD_TARGET.emit,onMisnamedClass:b.MISNAMED_CLASS.emit,onUnregistrableClass:b.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:b.UNREGISTERED_CLASS.emit,onAlreadyRegistered:b.ALREADY_REGISTERED.emit,onInvalidClass:b.INVALID_CLASS.emit,onDeferredInstantiation:e.WebHelpers.onDOMContentLoaded}),G.initialize({onAllowHTML:b.ALLOW_HTML.emit,onInvalidKey:b.INVALID_KEY.emit,onInvalidDefinition:b.INVALID_DEFINITION.emit,onLockedDefinition:b.LOCKED_DEFINITION.emit,onInexistentTemplate:b.INEXISTENT_TEMPLATE.emit,onUnespecifiedSlot:b.UNESPECIFIED_SLOT.emit,onUnknownTag:b.UNKNOWN_TAG.emit,onInvalidId:b.INVALID_ID.emit,onInvalidState:b.INVALID_STATE.emit,onFetchTemplate:lt.fetch})}static declareUnwritableMembers(e,t){tn(e,t.fields),tn(e,t.methods)}};var Ze,nn,en,Xe,Qe,Yt,Ye=r=>r>1e3?(r/1e3).toFixed(2)+"s":r.toFixed(2)+"ms",Ve=class{constructor(){a(this,"round",0);a(this,"domTime",window.Number.MAX_SAFE_INTEGER);a(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=Ye(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=Ye(this.renderTime)),e}},qe=class{constructor(e){a(this,"name","");a(this,"rounds",0);a(this,"time",0);a(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=Ye(this.time),t=Ye(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:t}}},M=class{static initialize(e){typeof e=="function"&&d(M,Yt,e),M.DOMUpdate.overall=new qe("overall-dom-update"),M.BrowserRender.overall=new qe("overall-browser-render")}},ot=M;Yt=new WeakMap,o(ot,Yt,()=>{}),a(ot,"StopWatch",(en=class{constructor(){o(this,Ze);a(this,"_begin",0);a(this,"_end",{dom:0,render:0});a(this,"rounds",0);a(this,"last",new Ve);a(this,"best",new Ve);a(this,"averages",{dom:0,render:0})}start(){(M.DOMUpdate.check||M.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var t;M.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,M.DOMUpdate.overall.compute(this.last.domTime)),M.BrowserRender.check?setTimeout(()=>h(this,Ze,nn).bind(this)(e)):e&&i(t=M,Yt).call(t,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},Ze=new WeakSet,nn=function(e){var t;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,M.BrowserRender.overall.compute(this.last.renderTime),e&&i(t=M,Yt).call(t,this,"finish")},en)),a(ot,"DOMUpdate",(Xe=class{},a(Xe,"check",!0),a(Xe,"overall",null),Xe)),a(ot,"BrowserRender",(Qe=class{},a(Qe,"check",!1),a(Qe,"overall",null),Qe));var at,ye,ui,Ee=class{constructor(){o(this,ye);o(this,at,new window.Object)}get length(){return h(this,ye,ui).call(this).length}key(e){return h(this,ye,ui).call(this)[e]||null}getItem(e){return i(this,at)[e]}setItem(e,t){i(this,at)[e]=t}removeItem(e){delete i(this,at)[e]}clear(){d(this,at,new window.Object)}hasItem(e){return i(this,at).hasOwnProperty(e)}};at=new WeakMap,ye=new WeakSet,ui=function(){return window.Object.keys(i(this,at))};var sn="0.6.4";var E,{noop:be,isOf:fi}=g;window.Wuse=window.Wuse||(E=class{static get VERSION(){return sn}static get elementCount(){return G.instancesCount}},a(E,"DEBUG",!1),a(E,"FATALS",!1),a(E,"MEASURE",!1),a(E,"RENDERING",!0),a(E,"hashRoutine",gt.defaultRoutine),a(E,"elementsStorage",new Ee),a(E,"tmp",null),a(E,"WebHelpers",null),a(E,"JsHelpers",null),a(E,"PerformanceMeasurement",null),a(E,"NonShadowElement",null),a(E,"OpenShadowElement",null),a(E,"ClosedShadowElement",null),a(E,"debug",be),a(E,"blockUpdate",be),a(E,"register",be),a(E,"instantiate",be),a(E,"isShadowElement",be),(()=>{_t.declareUnwritableMembers(E,{fields:{tmp:new window.Object,WebHelpers:q,JsHelpers:g,PerformanceMeasurement:ot,NonShadowElement:k.specializeClass(G,k.REGULAR),OpenShadowElement:k.specializeClass(G,k.OPEN),ClosedShadowElement:k.specializeClass(G,k.CLOSED)},methods:{debug:e=>window.console.log("[WUSE:DEBUG]",e),blockUpdate:(e,t)=>{if(fi(e,Function)){window.Wuse.DEBUG&&window.Wuse.debug("blocking"),window.Wuse.RENDERING=!1;try{e(t)}catch(n){throw n}finally{window.Wuse.RENDERING=!0,window.Wuse.DEBUG&&window.Wuse.debug("unblocking")}}},register:e=>I.registerClasses(fi(e,window.Array)?e:new window.Array(e)),instantiate:(e,t,n)=>I.instantiateClasses(fi(e,window.Array)?e:new window.Array(e),t,n),isShadowElement:e=>{let t=window.Object.getPrototypeOf(e.constructor);return t===window.Wuse.OpenShadowElement||t===window.Wuse.ClosedShadowElement}}}),_t.detectFeatures(E),_t.initializeModules(E)})(),E);})();
