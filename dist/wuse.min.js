(()=>{var cs=Object.defineProperty;var ls=(y,s,n)=>s in y?cs(y,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):y[s]=n;var l=(y,s,n)=>(ls(y,typeof s!="symbol"?s+"":s,n),n),Re=(y,s,n)=>{if(!s.has(y))throw TypeError("Cannot "+n)};var e=(y,s,n)=>(Re(y,s,"read from private field"),n?n.call(y):s.get(y)),o=(y,s,n)=>{if(s.has(y))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(y):s.set(y,n)},f=(y,s,n,t)=>(Re(y,s,"write to private field"),t?t.call(y,n):s.set(y,n),n);var c=(y,s,n)=>(Re(y,s,"access private method"),n);var yt=class{static onDOMContentLoaded(s){if(s&&s.constructor===window.Function){let n=()=>{s(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",n),100)};window.addEventListener("DOMContentLoaded",n)}}static getUniqueId(s="WUSE"){let n="_"+(s||"")+"_";for(var t;window.document.getElementById(t=n+(""+window.Math.random()).substring(2))!==null;);return t}static removeChildren(s){if(s)for(;s.firstChild;)s.removeChild(s.firstChild)}static htmlEncode(s=""){return typeof s=="string"?s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):null}static getCSSVendorPrefix(){let s=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(s).filter(i=>i.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var Vt,T,Ne=class{static get UNKNOWN_ERROR(){return e(this,T).call(this,0,s=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return e(this,T).call(this,1,s=>`Unsupported feature: ${s}.`)}static get UNREGISTERED_CLASS(){return e(this,T).call(this,2,s=>`Unregistered class: ${s}.`)}static get INVALID_CLASS(){return e(this,T).call(this,3,s=>`Invalid class: ${s}.`)}static get MISNAMED_CLASS(){return e(this,T).call(this,4,s=>`Misnamed class: ${s}.`)}static get INVALID_DEFINITION(){return e(this,T).call(this,10,s=>`Invalid definition: ${s}.`)}static get INVALID_ID(){return e(this,T).call(this,11,s=>`Invalid id: ${s}.`)}static get INVALID_KEY(){return e(this,T).call(this,12,s=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return e(this,T).call(this,13,s=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return e(this,T).call(this,20,s=>`Inexistent template: #${s}.`)}static get EXTINCT_TEMPLATE(){return e(this,T).call(this,21,s=>`Extinct template: #${s}.`)}static get INVALID_TEMPLATE(){return e(this,T).call(this,22,s=>`Invalid template: #${s}.`)}static get UNESPECIFIED_SLOT(){return e(this,T).call(this,30,s=>`Unespecified slot: #${s}.`)}},_=Ne;Vt=new WeakMap,T=new WeakMap,o(_,Vt,"[WUSE:ERROR]"),o(_,T,(s,n)=>({code:s,emit:t=>{let i=`${e(Ne,Vt)} ${s} | ${n(t)}`;if(Wuse.FATALS||s<10)throw new window.Error(i);return window.console.error(i),null}}));var _t,J,Ve,te,ze,ee,qe,se,Je,ie,Ye,ut,Xt,ne,ve,We,zt,re,bt,K,At,Ce,Ke,qt,Jt,Yt,Ot,Tt,Rt,Nt,$e,F,ft,Qt,Be,C,Wt,g,pt,ae,oe,et,vt,It,St,st,x,Y,he,Xe,Ge,it,nt,He,W,M,O,S,P,m,wt,$,B,X,j,G,Ct,rt,at,Q,N,H,V,w,Dt,ce,k,le,de,ot,ht,U,z,tt,ue,Qe,fe,Ze,pe,_e,we,ts,Z,dt,Lt,De,Mt,Le,Ut,Me,me,es,Ft,Ue,Ee,ss,xt,Fe,ge,is,Pt,xe,R,I,jt,Pe,mt,ye,ns,Et,Zt,kt,je,Se,lt,rs,be,as,Ae,os,Oe,hs,b,Kt,Ie,$t,E,Te,ct,Bt,Gt,A,Ht,gt,v,q,r=class{static get VERSION(){return"0.3.3"}static blockUpdate(s,n){if(r.isOf(s,Function)){r.DEBUG&&r.debug("blocking"),r.RENDERING=!1;try{s(n)}catch(t){throw t}finally{r.RENDERING=!0,r.DEBUG&&r.debug("unblocking")}}}static debug(s){window.console.log("[WUSE:DEBUG]",s)}static isOf(s,n){return!!(s&&s.constructor===n)}static isNonEmptyString(s){return typeof s=="string"&&!!s.length}static forcedStringSplit(s,n){return typeof s=="string"?s.split(n):new window.Array}static hasObjectKeys(s){return!!window.Object.keys(s).length}static buildArray(s){var n;return c(n=r,Kt,Ie).call(n,new window.Array,s)}static buildObject(s){var n;return c(n=r,Kt,Ie).call(n,new window.Object,s)}static register(s){return e(r,q).registerClasses(r.isOf(s,window.Array)?s:new window.Array(s))}static instantiate(s,n){return e(r,q).instantiateClasses(r.isOf(s,window.Array)?s:new window.Array(s),n)}static isShadowElement(s){let n=window.Object.getPrototypeOf(s.constructor);return n===r.OpenShadowElement||n===r.ClosedShadowElement}},p=r;b=new WeakMap,Kt=new WeakSet,Ie=function(s,n){return r.isOf(n,window.Function)&&n(s),s},$t=new WeakMap,E=new WeakMap,Te=new WeakMap,ct=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,A=new WeakMap,Ht=new WeakMap,gt=new WeakMap,v=new WeakMap,q=new WeakMap,o(p,Kt),o(p,b,_),l(p,"WebHelpers",yt),l(p,"tmp",new window.Object),l(p,"DEBUG",!1),l(p,"FATALS",!1),l(p,"MEASURE",!1),l(p,"RENDERING",!0),o(p,$t,new window.Array),o(p,E,(zt=class{static makeStyleNode(s,n){var t=window.document.createElement("style");return r.isNonEmptyString(s)&&t.setAttribute("media",s),r.isNonEmptyString(n)&&t.setAttribute("type",n),t.appendChild(window.document.createTextNode("")),t}static newRule(s,n){let t=r.isOf(s,window.Array)?s.join(","):""+s,i=r.isOf(n,window.Object)?n:e(this,bt).parse(n);return t.length?{selector:t,properties:i,cache:null}:null}static newNestedRule(s,n,t){let i=r.isOf(s,window.Array)?s.join(","):""+s,a=r.isOf(n,window.Array)?n.join(","):""+n,h=r.isOf(t,window.Object)?t:e(this,bt).parse(t);return!i.length||!a.length?null:{selector:i,nested:[{selector:a,properties:h}],cache:null}}static tryToJoinRules(s,n){if(s.selector===n.selector){for(let t in n.properties)s.properties[t]=n.properties[t];return s.cache=null,!0}return!1}static tryToJoinNestedRules(s,n){return r.isOf(s.nested,window.Array)&&s.selector===n.selector?(n.nested.forEach(t=>{var i=!1;for(let a in s.nested)if(i=s.nested[a].selector===t.selector){for(let h in t.properties)s.nested[a].properties[h]=t.properties[h];break}i||s.nested.push(t)}),s.cache=null,!0):!1}static makeMainNode(s){var n=window.document.createElement(s.tag);if(s.id.length&&n.setAttribute("id",s.id),s.classes.length&&n.setAttribute("class",s.classes.join(" ")),r.hasObjectKeys(s.style)){var t="";for(let i in s.style)t+=i+": "+s.style[i]+"; ";if(t.length){let i=t.trim();n.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(r.hasObjectKeys(s.attributes))for(let i in s.attributes)n.setAttribute(i,s.attributes[i]);return n}static newEvent(s,n){return typeof s=="string"&&typeof n=="boolean"?{kind:s,capture:n}:null}static performValidations(s){if(s.kind===e(r,A).TEMPLATES_KIND){if(!window.document.getElementById(s.id))return e(r,b).INEXISTENT_TEMPLATE.emit(s.id)}else if(s.kind===e(r,A).SLOTS_KIND){if(new String(s.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return e(r,b).UNESPECIFIED_SLOT.emit(s.id)}else if(typeof s.id!="string"||s.id!==""&&window.document.getElementById(s.id)!==null)return e(r,b).INVALID_ID.emit(s.id);return s}static newChild(s,n){var t=e(this,re).parse(s.trimLeft());return t?(t.rules=r.isOf(n,window.Array)?n:new window.Array,t.rendering=!0,t.cache=null,t):e(r,b).INVALID_DEFINITION.emit(s)}static newDefinition(){return{kind:e(r,A).DEFAULT_KIND,tag:e(r,A).DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},re=new WeakMap,bt=new WeakMap,o(zt,re,(J=class{static parse(s){if(r.isNonEmptyString(s)){var n=e(r,E).newDefinition();return s.charAt(0)==="%"?s.startsWith(e(r,A).TEMPLATES_KIND)?c(this,ut,Xt).call(this,n,s.replace(n.kind=e(r,A).TEMPLATES_KIND,"")):s.startsWith(e(r,A).SLOTS_KIND)?c(this,ut,Xt).call(this,n,s.replace(n.kind=e(r,A).SLOTS_KIND,"")):null:c(this,ut,Xt).call(this,n,s)}return null}},_t=new WeakSet,Ve=function(s,n){let t=n.indexOf("["),i=n.indexOf("]");if(t>-1&&i>-1&&i>t){let h=n.substr(t,i-t+1),d=h.substr(1,h.length-2).split("|");for(var a in d){let u=d[a].split("=");u[0]==="style"?u[1].split(";").forEach(D=>{let L=D.split(":"),ke=L[0].trim();ke.length&&(s.style[ke]=L[1].trim())}):s.attributes[u[0]]=u[1]}return n.replace(h,"")}return n},te=new WeakSet,ze=function(s,n){let t=n.indexOf("=");return t>-1?(s.content=n.slice(t+1),!!s.content.length&&s.content.charAt(0)==="&"&&(s.content=s.content.slice(1),s.encode=!!s.content.length&&s.content.charAt(0)!=="&"),n.slice(0,t)):n},ee=new WeakSet,qe=function(s,n){let t=n.replaceAll("!"," ").split(" ");return t.slice(1).map(i=>{let[a,...h]=i.toLowerCase().split("+"),d=(h||e(r,$t)).indexOf("capture")>-1;s.events.push(e(r,E).newEvent(a,d))}),t[0]},se=new WeakSet,Je=function(s,n){let t=n.replaceAll("."," ").split(" ");return s.classes=t.slice(1),t[0]},ie=new WeakSet,Ye=function(s,n){if(n!==""){let t=n.indexOf("#");t===-1?s.tag=n:(t>0&&(s.tag=n.substr(0,t)),s.id=n.substr(t+1))}return s},ut=new WeakSet,Xt=function(s,n){return c(this,ie,Ye).call(this,s,c(this,se,Je).call(this,s,c(this,ee,qe).call(this,s,c(this,te,ze).call(this,s,c(this,_t,Ve).call(this,s,n)))))},o(J,_t),o(J,te),o(J,ee),o(J,se),o(J,ie),o(J,ut),J)),o(zt,bt,(ve=class{static parse(s){let n=new window.Object;return(r.isOf(s,window.Array)?s:r.forcedStringSplit(s,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>r.isNonEmptyString(t)&&c(this,ne,We).call(this,n,t.trim())),n}},ne=new WeakSet,We=function(s,n){if(!!n.length&&n.indexOf(":")>-1){let[t,...i]=n.split(":"),a=t.trim();if(a.length){let h=i.join(":").trim();s[a]=h.endsWith(";")?h.slice(0,-1):h}}},o(ve,ne),ve)),zt)),l(p,"SimpleStorage",(Ke=class{constructor(){o(this,At);o(this,K,new window.Object)}get length(){return c(this,At,Ce).call(this).length}key(s){return c(this,At,Ce).call(this)[s]||null}getItem(s){return e(this,K)[s]}setItem(s,n){e(this,K)[s]=n}removeItem(s){delete e(this,K)[s]}clear(){f(this,K,new window.Object)}has(s){return e(this,K).hasOwnProperty(s)}},K=new WeakMap,At=new WeakSet,Ce=function(){return window.Object.keys(e(this,K))},Ke)),o(p,Te,new r.SimpleStorage),o(p,ct,s=>s>1e3?(s/1e3).toFixed(2)+"s":s.toFixed(2)+"ms"),o(p,Bt,class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var n,t;var s=new window.Object;return s.round=this.round,s.domTime=e(n=r,ct).call(n,this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(s.renderTime=e(t=r,ct).call(t,this.renderTime)),s}}),o(p,Gt,class{constructor(s){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=s}compute(s){this.rounds++,this.time+=s,this.average=this.time/this.rounds}getDebugInfo(){var t,i;let s=e(t=r,ct).call(t,this.time),n=e(i=r,ct).call(i,this.average);return{name:this.name,rounds:this.rounds,spent:s,average:n}}}),l(p,"StopWatch",(Yt=class{constructor(){l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new(e(r,Bt)));l(this,"best",new(e(r,Bt)));l(this,"averages",{dom:0,render:0})}start(){(r.StopWatch.DOMUpdate.check||r.StopWatch.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(){r.StopWatch.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,r.StopWatch.DOMUpdate.overall.compute(this.last.domTime)),r.StopWatch.BrowserRender.check?setTimeout(this.finish.bind(this)):r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.DOMUpdate.overall.getDebugInfo()))}finish(){this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,r.StopWatch.BrowserRender.overall.compute(this.last.renderTime),r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.BrowserRender.overall.getDebugInfo()))}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages,instances:e(r,v).instancesCount}}},l(Yt,"DOMUpdate",(qt=class{},l(qt,"check",!0),l(qt,"overall",new(e(r,Gt))("overall-dom-update")),qt)),l(Yt,"BrowserRender",(Jt=class{},l(Jt,"check",!1),l(Jt,"overall",new(e(r,Gt))("overall-browser-render")),Jt)),Yt)),l(p,"hashRoutine",s=>{var n=0;for(let t=0;t<s.length;t++)n=(n=(n<<5)-n+s.charCodeAt(t))&n;return n}),l(p,"EqualityAnalyzer",($e=class{constructor(s){l(this,"rounds",0);o(this,Ot,0);o(this,Tt,null);o(this,Rt,!1);o(this,Nt,null);f(this,Nt,s)}compute(s){return this.rounds+=+f(this,Rt,e(this,Ot)==f(this,Tt,e(this,Nt).call(this,s))),f(this,Ot,e(this,Tt)),e(this,Rt)}},Ot=new WeakMap,Tt=new WeakMap,Rt=new WeakMap,Nt=new WeakMap,$e)),o(p,A,(F=class{},l(F,"TEMPLATES_KIND","%templates%"),l(F,"SLOTS_KIND","%slots%"),l(F,"DEFAULT_KIND",""),l(F,"DEFAULT_TAG","div"),l(F,"DEFAULT_STYLE_MEDIA","screen"),l(F,"DEFAULT_STYLE_TYPE","text/css"),l(F,"DEFAULT_REPLACEMENT_OPEN","~{"),l(F,"DEFAULT_REPLACEMENT_CLOSE","}~"),F)),l(p,"ObjectsArray",(Be=class extends window.Array{constructor(n){super();o(this,ft);l(this,"owner",null);l(this,"last",null);l(this,"version",0);this.owner=n}append(n){r.isOf(n,window.Object)&&(this.push(n),c(this,ft,Qt).call(this,n))}prepend(n){r.isOf(n,window.Object)&&(this.unshift(n),c(this,ft,Qt).call(this,n))}replace(n,t){n>-1&&r.isOf(t,window.Object)&&c(this,ft,Qt).call(this,this[n]=t)}on_version_change(){}persist(){let n=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":n[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,this[t]);i.cache&&(i.cache=null),n.push(i)}break}}),n}restore(n){window.Object.getOwnPropertyNames(n).forEach(t=>{switch(t){case"length":break;case"version":this[t]=n[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,n[t]);i.cache&&(i.cache=null),this.push(i)}break}})}},ft=new WeakSet,Qt=function(n){this.last=n,this.version++,this.on_version_change()},Be)),l(p,"ReactiveFields",(St=class{static make(s,n,t,i,a){let h=(D,L)=>window.Object.defineProperty(s,n,{get:D,set:L,enumerable:!0,configurable:!0}),d=()=>delete s[n],u=(D,L)=>this.make(s,n,D,L,a);h(()=>t,D=>{u(D,i),r.isOf(i,window.Function)?i({renderize:L=>a(n,L),automate:()=>u(D,null),freeze:()=>h(()=>D,L=>{}),defreeze:()=>u(D,i),dereact:()=>h(()=>D,L=>{d(),s[n]=L}),remove:()=>d()}):a(n)})}},l(St,"ReplacementMarkers",(C=class{},l(C,"begin",e(r,A).DEFAULT_REPLACEMENT_OPEN),l(C,"end",e(r,A).DEFAULT_REPLACEMENT_CLOSE),l(C,"enclose",n=>C.begin+n+C.end),l(C,"makeRegExp",()=>new RegExp("(?<="+C.begin+").*?(?="+C.end+")","gs")),C)),l(St,"ReplacementsScanners",(Wt=class{},l(Wt,"rules",(s,n)=>r.buildArray(t=>s.forEach(i=>i.replacements.forEach(a=>a.field===n&&t.push(i))))),l(Wt,"children",(s,n)=>r.buildArray(t=>{let i=a=>{let h=d=>d.forEach(u=>u.field===n&&t.push(a));["contents","classes","styles","attributes"].forEach(d=>h(a.replacements[d])),a.rules.forEach(d=>d.replacements.forEach(u=>u.field===n&&t.push(a)))};s.forEach(a=>a.rendering&&i(a))})),Wt)),l(St,"ReplacementsExtractors",(g=class{},pt=new WeakMap,ae=new WeakMap,oe=new WeakMap,et=new WeakMap,vt=new WeakMap,It=new WeakMap,o(g,pt,null),o(g,ae,n=>n.match(e(g,pt)?e(g,pt):f(g,pt,r.ReactiveFields.ReplacementMarkers.makeRegExp()))),o(g,oe,(n,t,i)=>n.push({at:t,find:r.ReactiveFields.ReplacementMarkers.enclose(i),field:i.trim()})),o(g,et,(n,t,i)=>{var a;return r.isNonEmptyString(i)&&(e(a=g,ae).call(a,i)||e(r,$t)).forEach(h=>{var d;return e(d=g,oe).call(d,n,t,h)})}),o(g,vt,(n,t,i)=>{var a;n[t]=new window.Array,e(a=g,et).call(a,n[t],t,i)}),o(g,It,(n,t,i)=>{n[t]=new window.Array,window.Object.keys(i).forEach(a=>{var h,d;e(h=r.ReactiveFields.ReplacementsExtractors,et).call(h,n[t],t,a),e(d=r.ReactiveFields.ReplacementsExtractors,et).call(d,n[t],t,i[a])})}),l(g,"child",n=>r.buildObject(t=>{var i,a,h,d;e(i=g,vt).call(i,t,"contents",n.content),e(a=g,vt).call(a,t,"classes",n.classes.join(" ")),e(h=g,It).call(h,t,"styles",n.style),e(d=g,It).call(d,t,"attributes",n.attributes),n.rules.forEach(u=>u.replacements=r.ReactiveFields.ReplacementsExtractors.rule(u))})),l(g,"rule",n=>r.buildArray(t=>{var a;if(r.isOf(n.nested,window.Array))return n.nested.map(h=>r.ReactiveFields.ReplacementsExtractors.rule(h));var i="";for(let h in n.properties)i+=h+":"+n.properties[h]+";";e(a=g,et).call(a,t,"rules",i)})),g)),St)),o(p,Ht,(Ge=class{constructor(s,n){o(this,he);o(this,st,null);o(this,x,null);o(this,Y,null);f(this,st,s),f(this,x,n),f(this,Y,n.cloneNode(!1))}get element(){return e(this,x)}affiliate(){e(this,st).appendChild(e(this,x))}disaffiliate(s){e(this,st).removeChild(e(this,x))}promote(s){e(this,Y).innerHTML=s,e(this,st).replaceChild(e(this,Y),e(this,x)),c(this,he,Xe).call(this)}},st=new WeakMap,x=new WeakMap,Y=new WeakMap,he=new WeakSet,Xe=function(){let s=e(this,Y);f(this,Y,e(this,x).cloneNode(!1)),f(this,x,s)},Ge)),o(p,gt,(He=class{constructor(s){l(this,"owner",null);o(this,it,!1);o(this,nt,"");this.owner=s}reset(s){f(this,it,!1),f(this,nt,s)}append(s){f(this,nt,e(this,nt)+s)}verify(s){r.isOf(s,window.Function)&&f(this,it,s(e(this,nt)))}process(){e(this,it)&&this.on_content_invalidation(e(this,nt))}get invalidated(){return e(this,it)}on_content_invalidation(s){}},it=new WeakMap,nt=new WeakMap,He)),o(p,v,(W=class extends window.HTMLElement{constructor(t){super();o(this,z);o(this,ue);o(this,fe);o(this,pe);o(this,we);o(this,Z);o(this,Lt);o(this,Mt);o(this,Ut);o(this,me);o(this,Ft);o(this,Ee);o(this,xt);o(this,ge);o(this,Pt);o(this,R);o(this,jt);o(this,ye);o(this,Et);o(this,kt);o(this,M,"");o(this,O,new class extends r.ObjectsArray{on_version_change(){var t;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.rule(this.last),r.DEBUG&&c(t=this.owner,z,tt).call(t,`rules list version change: ${this.version}`)}}(this));o(this,S,new class extends r.ObjectsArray{on_version_change(){var t,i;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.child(this.last),f(t=this.owner,B,e(t,B)|this.last.kind===e(r,A).SLOTS_KIND),r.DEBUG&&c(i=this.owner,z,tt).call(i,`children list version change: ${this.version}`)}}(this));o(this,P,new class extends r.ObjectsArray{on_version_change(){var t;r.DEBUG&&c(t=this.owner,z,tt).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));o(this,m,{mainDefinition:e(r,E).newDefinition(),styleMedia:e(r,A).DEFAULT_STYLE_MEDIA,styleType:e(r,A).DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});o(this,wt,new window.Object);o(this,$,!1);o(this,B,!1);o(this,X,void 0);o(this,j,void 0);o(this,G,null);o(this,Ct,r.isShadowElement(this));o(this,rt,!1);o(this,at,!1);o(this,Q,e(r,Te));o(this,N,null);o(this,H,"");o(this,V,!1);o(this,w,{root:new class extends e(r,gt){on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends e(r,gt){on_content_invalidation(t){e(this.owner,j).promote(t)}}(this),main:new class extends e(r,gt){on_content_invalidation(t){e(this.owner,X).promote(t)}}(this),renderizers:{rule:t=>e(this,w).style.append(t.cache?t.cache:t.cache=e(this,ot).rule(t)),children:{mixed:t=>e(this,Ct)&&t.kind===e(r,A).SLOTS_KIND?e(this,w).renderizers.children.slot(t):e(this,w).renderizers.children.normal(t),slot:t=>{t.cache||(e(this,w).root.verify(i=>!0),e(this,w).root.append(t.cache=e(this,ot).child(t)))},normal:t=>{e(this,w).main.append(t.cache?t.cache:t.cache=e(this,ot).child(t)),t.rules.forEach(e(this,w).renderizers.rule)}}},gotModified:()=>e(this,w).root.invalidated||e(this,w).main.invalidated||e(this,w).style.invalidated,getDebugInfo:()=>`updated (root: ${e(this,w).root.invalidated}, main: ${e(this,w).main.invalidated}, style: ${e(this,w).style.invalidated})`});o(this,Dt,{bind:{key:()=>{let t=i=>{r.isNonEmptyString(i)&&(this[i]=c(this,Lt,De).call(this,i))};return e(this,$)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"addEventListener"},unbind:{key:()=>{let t=i=>delete this[i];return e(this,$)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"removeEventListener"}});o(this,ce,t=>{let i=window.document.getElementById(t);return i===null?e(r,b).EXTINCT_TEMPLATE.emit(t):i.tagName!=="TEMPLATE"?e(r,b).INVALID_TEMPLATE.emit(t):i.innerHTML});o(this,k,t=>t.cache=null);o(this,le,t=>t.rendering=!0);o(this,de,t=>t.rendering=!1);o(this,ot,{rule:t=>{if(r.isOf(t.nested,window.Array))return t.selector+"{"+t.nested.map(a=>e(this,ot).rule(a)).join(`
`)+"}";if(t.selector!==""){var i="";for(let a in t.properties)i+=a+":"+t.properties[a]+";";return r.isOf(t.replacements,window.Array)&&t.replacements.forEach(a=>i=i.replace(a.find,this[a.field]!==void 0?this[a.field]:"")),t.selector+"{"+i+"}"}return null},child:t=>{if(t.kind===e(r,A).TEMPLATES_KIND)return e(this,ce).call(this,t.id);let i=(d,u)=>d.replace(u.find,this[u.field]!==void 0?this[u.field]:"");if(t.tag==="^text^"){var a=t.content;return t.replacements.contents.forEach(d=>a=i(a,d)),t.encode?r.WebHelpers.htmlEncode(a):a}var h="<"+t.tag;if(r.isNonEmptyString(t.id)&&(h+=" id='"+t.id+"'"),t.classes.length){var a=t.classes.join(" ");t.replacements.classes.forEach(u=>a=i(a,u)),h+=" class='"+a+"'"}if(r.hasObjectKeys(t.style)){var a=" style='";for(let u in t.style)a+=u+": "+t.style[u]+"; ";a+="'",t.replacements.styles.forEach(u=>a=i(a,u)),h+=a}if(r.hasObjectKeys(t.attributes)){var a="";for(let u in t.attributes)a+=" "+u+"="+t.attributes[u];t.replacements.attributes.forEach(u=>a=i(a,u)),h+=a}if(typeof t.content=="string"){var a=t.content;t.replacements.contents.forEach(u=>a=i(a,u)),h+=">"+(t.encode?r.WebHelpers.htmlEncode(a):a)+"</"+t.tag+">"}else h+="/>";return h}});o(this,ht,{main:new r.EqualityAnalyzer(r.hashRoutine),style:new r.EqualityAnalyzer(r.hashRoutine)});o(this,U,{attachment:new r.StopWatch,partial:new r.StopWatch,full:new r.StopWatch,dettachment:new r.StopWatch});o(this,mt,()=>e(r,v).EVENT_NAMES.forEach(t=>e(this,wt)[t]=typeof this[t]=="function"));l(this,"info",{instanceNumber:++e(r,v).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,G,t!==e(r,v).RootMode.REGULAR?this.attachShadow({mode:t}):this),e(this,mt).call(this),c(this,R,I).call(this,"on_create"),e(this,m).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),c(this,ye,ns).call(this)&&e(this,N).generation>1?c(this,R,I).call(this,"on_reconstruct",e(this,N)):c(this,R,I).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}render(){}redraw(){}connectedCallback(){r.MEASURE&&e(this,U).attachment.start(),e(this,mt).call(this),c(this,R,I).call(this,"on_connect"),c(this,Pt,xe).call(this,"render",c(this,me,es)),c(this,Pt,xe).call(this,"redraw",c(this,Ee,ss)),c(this,Ft,Ue).call(this,"on_load"),e(this,V)&&this.persistToElementsStore(),r.MEASURE&&e(this,U).attachment.stop()}disconnectedCallback(){r.MEASURE&&e(this,U).dettachment.start(),c(this,Z,dt).call(this,!1),c(this,R,I).call(this,"on_disconnect"),r.MEASURE&&e(this,U).dettachment.stop()}getElementsStore(){return e(this,Q)}setElementsStore(t){f(this,Q,t)}hasElementsStoreKey(t){return e(this,V)}getElementsStoreKey(t){return e(this,H)}setElementsStoreKey(t){return f(this,V,r.isNonEmptyString(f(this,H,t))),this}persistToElementsStore(){if(c(this,kt,je).call(this)){let t=e(this,N);if(t)return e(this,P).snapshot(),t.data=new window.Object({options:e(this,m),html:e(this,M),children:e(this,S).persist(),rules:e(this,O).persist(),fields:e(this,P).persist(),slotted:e(this,B),identified:e(this,$)}),c(this,Et,Zt).call(this),!0}return!1}restoreFromElementsStore(t){if(c(this,kt,je).call(this)){let i=e(this,N);if(i&&i.persisted&&i.data)return f(this,m,i.data.options),f(this,B,i.data.slotted),f(this,$,i.data.identified),f(this,M,i.data.html),e(this,S).restore(i.data.children),e(this,S).owner=this,e(this,O).restore(i.data.rules),e(this,O).owner=this,e(this,P).restore(i.data.fields),e(this,P).owner=this,e(this,P).recall(),t||(delete i.data,c(this,Et,Zt).call(this)),!0}return!1}selectChildElement(t){return e(this,G).querySelector(t)}setMainAttribute(t,i){e(this,rt)&&e(this,X).element.setAttribute(t,i)}setMainElement(t){let i=e(r,E).newChild(t);if(e(r,E).performValidations(i)){if(i.content!==""||!!i.events.length)return e(r,b).INVALID_DEFINITION.emit(t);f(this,$,!!i.id.length)&&(e(this,m).mainDefinition.id=i.id),i.tag.length&&(e(this,m).mainDefinition.tag=i.tag),i.classes.length&&(e(this,m).mainDefinition.classes=i.classes),i.style&&(e(this,m).mainDefinition.style=i.style),i.attributes&&(e(this,m).mainDefinition.attributes=i.attributes)}return this}setStyleOptions(t,i){return e(this,m).styleMedia=t||"",e(this,m).styleType=i||"",this}setElementsAsKeys(t){return e(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return e(this,m).attributeKeys=!!t,this}allowRawContent(t){return e(this,m).rawContent=!!t,this}setRawContent(t){return e(this,m).rawContent?f(this,M,t):e(r,b).ALLOW_HTML.emit(),this}appendRawContent(t){return e(this,m).rawContent?f(this,M,e(this,M)+t):e(r,b).ALLOW_HTML.emit(),this}prependRawContent(t){return e(this,m).rawContent?f(this,M,t+e(this,M)):e(r,b).ALLOW_HTML.emit(),this}appendCSSRule(t,i,a){if(a)return this.appendCSSNestedRule(t,i,a);let h=e(this,O).slice(-1),d=e(r,E).newRule(t,i);return(!h.length||!e(r,E).tryToJoinRules(h[0],d))&&e(this,O).append(d),this}prependCSSRule(t,i,a){if(a)return this.prependCSSNestedRule(t,i,a);let h=e(this,O).slice(0,1),d=e(r,E).newRule(t,i);return(!h.length||!e(r,E).tryToJoinRules(h[0],d))&&e(this,O).prepend(d),this}appendCSSNestedRule(t,i,a){let h=e(this,O).slice(-1),d=e(r,E).newNestedRule(t,i,a);return(!h.length||!e(r,E).tryToJoinNestedRules(h[0],d))&&e(this,O).append(d),this}prependCSSNestedRule(t,i,a){let h=e(this,O).slice(0,1),d=e(r,E).newNestedRule(t,i,a);return(!h.length||!e(r,E).tryToJoinNestedRules(h[0],d))&&e(this,O).prepend(d),this}appendChildElement(t,i){return e(this,S).append(e(r,E).performValidations(e(r,E).newChild(t,i))),this}prependChildElement(t,i){return e(this,S).prepend(e(r,E).performValidations(e(r,E).newChild(t,i))),this}replaceChildElement(t,i){return e(this,S).replace(e(this,S).findIndex(a=>a.id===t),e(r,E).newChild(i)),this}appendChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}checkChildElementIsIncludedById(t,i,a){let h=d=>r.isOf(d,window.Function)?d():void 0;return e(this,S).some(d=>d.id===t&&d.rendering)?h(i):h(a),this}includeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,le).call(this,i)),this}excludeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,de).call(this,i)),this}invalidateChildElementsById(t){return e(this,S).forEach(i=>t.indexOf(i.id)>-1&&e(this,k).call(this,i)),this}invalidateChildElements(t){return r.isOf(t,window.Array)&&t.forEach(e(this,k)),this}makeField(t,i){return this[t]=i,e(this,P).append({name:t,value:i}),this}makeReactiveField(t,i,a,h=!0){return c(this,ge,is).call(this,t,i,a,h),e(this,P).append({name:t,value:i}),this}makeExternalReactiveField(t,i,a,h,d=!0){return this.makeReactiveField(i,t[i]||a,u=>{t[i]=this[i],h(u)},d),this}},M=new WeakMap,O=new WeakMap,S=new WeakMap,P=new WeakMap,m=new WeakMap,wt=new WeakMap,$=new WeakMap,B=new WeakMap,X=new WeakMap,j=new WeakMap,G=new WeakMap,Ct=new WeakMap,rt=new WeakMap,at=new WeakMap,Q=new WeakMap,N=new WeakMap,H=new WeakMap,V=new WeakMap,w=new WeakMap,Dt=new WeakMap,ce=new WeakMap,k=new WeakMap,le=new WeakMap,de=new WeakMap,ot=new WeakMap,ht=new WeakMap,U=new WeakMap,z=new WeakSet,tt=function(t){e(this,$)&&r.debug(`#${e(this,m).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},ue=new WeakSet,Qe=function(){e(this,j)&&e(this,j).affiliate(),e(this,X).affiliate(),f(this,rt,!0)},fe=new WeakSet,Ze=function(){f(this,j,e(this,O).length?new(e(r,Ht))(e(this,G),e(r,E).makeStyleNode(e(this,m).styleMedia,e(this,m).styleType)):null),f(this,X,new(e(r,Ht))(e(this,G),e(r,E).makeMainNode(e(this,m).mainDefinition))),e(this,S).forEach(e(this,k)),e(this,O).forEach(e(this,k))},pe=new WeakSet,_e=function(){e(this,rt)&&(e(this,X).disaffiliate(),e(this,j)&&e(this,j).disaffiliate(),e(this,B)&&e(this,Ct)&&r.WebHelpers.removeChildren(this)),f(this,rt,!1)},we=new WeakSet,ts=function(t){return{key:e(this,m).elementKeys&&t.key(),event:(i,a,h)=>{let d=this[`on_${i}_${a}`];if(d){let u=c(this,Lt,De).call(this,i);u&&u[t.event](a,d,h)}},slots:()=>this.on_slot_change&&e(this,G).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}},Z=new WeakSet,dt=function(t){if(e(this,at)&&!t||!e(this,at)&&t){let i=c(this,we,ts).call(this,t?e(this,Dt).bind:e(this,Dt).unbind);e(this,S).forEach(a=>{!a.rendering&&t||(i.key&&i.key(a),a.events.forEach(h=>h&&i.event(a.id,h.kind,h.capture)))}),e(this,B)&&i.slots(),f(this,at,t)}},Lt=new WeakSet,De=function(t){return r.isNonEmptyString(t)?e(this,G).querySelector(`#${t}`):void 0},Mt=new WeakSet,Le=function(){e(this,w).root.reset(""),e(this,w).style.reset(""),e(this,w).main.reset(e(this,M));let t=e(this,B)?e(this,w).renderizers.children.mixed:e(this,w).renderizers.children.normal;e(this,S).forEach(i=>i.rendering&&t(i)),e(this,O).forEach(e(this,w).renderizers.rule),e(this,w).main.verify(i=>!e(this,ht).main.compute(i)),e(this,w).style.verify(i=>!e(this,ht).style.compute(i))},Ut=new WeakSet,Me=function(){e(this,w).root.process(),e(this,w).style.process(),e(this,w).main.process(),r.DEBUG&&c(this,z,tt).call(this,e(this,w).getDebugInfo())},me=new WeakSet,es=function(){!r.RENDERING||(r.MEASURE&&e(this,U).partial.start(),c(this,R,I).call(this,"on_prerender"),c(this,Mt,Le).call(this),e(this,w).gotModified()?(c(this,Z,dt).call(this,!1),c(this,Ut,Me).call(this),c(this,Z,dt).call(this,!0),this.info.updatedRounds++,c(this,R,I).call(this,"on_update"),c(this,jt,Pe).call(this,"on_refresh")):this.info.unmodifiedRounds++,r.DEBUG&&c(this,z,tt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${e(this,ht).main.rounds}, style: ${e(this,ht).style.rounds}) | updated: ${this.info.updatedRounds}`),c(this,R,I).call(this,"on_postrender"),r.MEASURE&&e(this,U).partial.stop())},Ft=new WeakSet,Ue=function(t){c(this,fe,Ze).call(this),c(this,ue,Qe).call(this),c(this,R,I).call(this,"on_inject"),c(this,Mt,Le).call(this),e(this,w).style.verify(i=>!!e(this,j)),c(this,Ut,Me).call(this),c(this,Z,dt).call(this,!0),c(this,R,I).call(this,t)},Ee=new WeakSet,ss=function(t){r.MEASURE&&e(this,U).full.start(),c(this,Z,dt).call(this,!1),c(this,pe,_e).call(this),c(this,R,I).call(this,"on_unload"),e(this,mt).call(this),c(this,Ft,Ue).call(this,"on_reload"),c(this,jt,Pe).call(this,"on_repaint"),r.MEASURE&&e(this,U).full.stop()},xt=new WeakSet,Fe=function(t,i="$none"){if(e(this,at)){let a=r.ReactiveFields.ReplacementsScanners.rules(e(this,O),t);a.forEach(e(this,k));let h=r.ReactiveFields.ReplacementsScanners.children(e(this,S),t);h.forEach(e(this,k)),r.DEBUG&&c(this,z,tt).call(this,`reactive render (label: ${i}, field: ${t}, children: ${h.length}, rules: ${a.length})`),(!!a.length||!!h.length)&&(h.some(d=>!!d.kind.length)&&e(this,S).forEach(d=>d.kind===e(r,A).SLOTS_KIND?e(this,k).call(this,d):void 0),this.render())}},ge=new WeakSet,is=function(t,i,a,h=!0){r.ReactiveFields.make(this,t,i,a,(d,u)=>c(this,xt,Fe).call(this,d,u||"$auto")),h&&c(this,xt,Fe).call(this,t,"$init")},Pt=new WeakSet,xe=function(t,i){delete this[t],window.Object.defineProperty(this,t,{value:i})},R=new WeakSet,I=function(t,i){e(this,wt)[t]&&this[t].call(this,i)},jt=new WeakSet,Pe=function(t,i){e(this,V)&&this.persistToElementsStore(),e(this,wt)[t]&&window.requestAnimationFrame(()=>this[t].call(this,i))},mt=new WeakMap,ye=new WeakSet,ns=function(){return e(this,V)?(f(this,N,e(this,Q).has(e(this,H))?e(this,Q).getItem(e(this,H)):{generation:0,persisted:!1}),e(this,N).generation++,c(this,Et,Zt).call(this),!0):!1},Et=new WeakSet,Zt=function(){r.DEBUG&&(e(this,N).key=e(this,H)),e(this,N).persisted=!!e(this,N).data,e(this,Q).setItem(e(this,H),e(this,N))},kt=new WeakSet,je=function(){return e(this,V)?!0:(e(r,b).INVALID_KEY.emit(),!1)},l(W,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),l(W,"specializeClass",t=>class extends W{constructor(){super(t)}}),l(W,"instancesCount",0),W)),o(p,q,(lt=class{static registerClasses(s){window.Array.prototype.forEach.call(s,c(e(r,q),be,as))}static instantiateClasses(s,n){window.Array.prototype.forEach.call(s,t=>{var i;return window.customElements.get(t.tag)?c(i=e(r,q),Oe,hs).call(i,t,n):e(r,b).UNREGISTERED_CLASS.emit(t.name)})}},Se=new WeakSet,rs=function(s){return s.toLowerCase().replaceAll("_","-")},be=new WeakSet,as=function(s){var n;r.isNonEmptyString(s.name)&&s.name.indexOf("_")>0?s.tag=c(n=e(r,q),Se,rs).call(n,s.name):e(r,b).MISNAMED_CLASS.emit(s.name),window.HTMLElement.isPrototypeOf(s)?window.customElements.define(s.tag,s):e(r,b).INVALID_CLASS.emit(s.name)},Ae=new WeakSet,os=function(s,n){let t=r.isNonEmptyString(n)?window.document.querySelector(n):window.document.body;t&&t.appendChild(window.document.createElement(s.tag))},Oe=new WeakSet,hs=function(s,n){let t=()=>{var i;return c(i=e(r,q),Ae,os).call(i,s,n)};window.document.body?t():r.WebHelpers.onDOMContentLoaded(t)},o(lt,Se),o(lt,be),o(lt,Ae),o(lt,Oe),lt)),l(p,"NonShadowElement",e(r,v).specializeClass(e(r,v).RootMode.REGULAR)),l(p,"OpenShadowElement",e(r,v).specializeClass(e(r,v).RootMode.OPEN)),l(p,"ClosedShadowElement",e(r,v).specializeClass(e(r,v).RootMode.CLOSED)),(()=>{let s=(n,t)=>!n&&e(r,b).UNSUPPORTED_FEATURE.emit(t);try{s(r.isOf(window.document,window.HTMLDocument),"HTML Document"),s(r.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),r.WebHelpers.onDOMContentLoaded(()=>s(r.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){e(r,b).UNKNOWN_ERROR.emit()}})(),window.Wuse=p;})();
