(()=>{var Ti=Object.defineProperty;var Ri=(m,i,n)=>i in m?Ti(m,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[i]=n;var d=(m,i,n)=>(Ri(m,typeof i!="symbol"?i+"":i,n),n),ke=(m,i,n)=>{if(!i.has(m))throw TypeError("Cannot "+n)};var e=(m,i,n)=>(ke(m,i,"read from private field"),n?n.call(m):i.get(m)),r=(m,i,n)=>{if(i.has(m))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(m):i.set(m,n)},f=(m,i,n,t)=>(ke(m,i,"write to private field"),t?t.call(m,n):i.set(m,n),n);var c=(m,i,n)=>(ke(m,i,"access private method"),n);var S=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var K=class{static onDOMContentLoaded(i){if(i&&i.constructor===window.Function){let n=()=>{i(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",n),100)};window.addEventListener("DOMContentLoaded",n)}}static getUniqueId(i="WUSE"){let n="_"+(i||"")+"_";for(var t;window.document.getElementById(t=n+(""+window.Math.random()).substring(2))!==null;);return t}static removeChildren(i){if(i)for(;i.firstChild;)i.removeChild(i.firstChild)}static htmlEncode(i=""){return typeof i!="string"?null:i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let i=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(i).filter(s=>s.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var re,Ft,_e,l=class{static get EMPTY_ARRAY(){return e(this,re)}static noop(){}static isNonEmptyString(i){return typeof i=="string"&&!!i.length}static forcedStringSplit(i,n){return typeof i=="string"?i.split(n):new window.Array}static buildArray(i){return c(this,Ft,_e).call(this,new window.Array,i)}static buildObject(i){return c(this,Ft,_e).call(this,new window.Object,i)}static ensureFunction(i,n=()=>{}){return typeof i=="function"?i:n}static isOf(i,n){return i!=null&&(i.constructor===n||n!=null&&i.constructor.name===n.name)}static hasObjectKeys(i){return!!(i&&!!window.Object.keys(i).length)}static isAssignedObject(i){return typeof i=="object"&&i!==null}static isAssignedArray(i){return typeof i=="object"&&i!==null&&i.constructor.name==="Array"}static isNonEmptyArray(i){return typeof i=="object"&&i!==null&&i.constructor.name==="Array"&&!!i.length}};re=new WeakMap,Ft=new WeakSet,_e=function(i,n){return this.isOf(n,window.Function)&&n(i),i},r(l,Ft),r(l,re,new window.Array);var ae,O,Ke=class{static get UNKNOWN_ERROR(){return e(this,O).call(this,0,i=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return e(this,O).call(this,1,i=>`Unsupported feature: ${i}.`)}static get UNREGISTERED_CLASS(){return e(this,O).call(this,2,i=>`Unregistered class: ${i}.`)}static get UNREGISTRABLE_CLASS(){return e(this,O).call(this,3,i=>`Unregistrable class: ${i}.`)}static get INVALID_CLASS(){return e(this,O).call(this,4,i=>`Invalid class: ${i}.`)}static get MISNAMED_CLASS(){return e(this,O).call(this,5,i=>`Misnamed class: ${i}.`)}static get INVALID_DEFINITION(){return e(this,O).call(this,10,i=>`Invalid definition: ${i}.`)}static get INVALID_ID(){return e(this,O).call(this,11,i=>`Invalid id: ${i}.`)}static get INVALID_KEY(){return e(this,O).call(this,12,i=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return e(this,O).call(this,13,i=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return e(this,O).call(this,20,i=>`Inexistent template: #${i}.`)}static get EXTINCT_TEMPLATE(){return e(this,O).call(this,21,i=>`Extinct template: #${i}.`)}static get INVALID_TEMPLATE(){return e(this,O).call(this,22,i=>`Invalid template: #${i}.`)}static get UNESPECIFIED_SLOT(){return e(this,O).call(this,30,i=>`Unespecified slot: #${i}.`)}},y=Ke;ae=new WeakMap,O=new WeakMap,r(y,ae,"[WUSE:ERROR]"),r(y,O,(i,n)=>({code:i,emit:t=>{let s=`${e(Ke,ae)} ${i} | ${n(t)}`;if(Wuse.FATALS||i<10)throw new window.Error(s);return window.console.error(s),null}}));var Pt,jt,$t,kt,mt=class{constructor(i){d(this,"rounds",0);r(this,Pt,0);r(this,jt,null);r(this,$t,!1);r(this,kt,null);f(this,kt,typeof i=="function"?i:()=>{})}compute(i){return this.rounds+=+f(this,$t,e(this,Pt)==f(this,jt,e(this,kt).call(this,i))),f(this,Pt,e(this,jt)),e(this,$t)}};Pt=new WeakMap,jt=new WeakMap,$t=new WeakMap,kt=new WeakMap;var H,Kt,Be,_t=class{constructor(){r(this,Kt);r(this,H,new window.Object)}get length(){return c(this,Kt,Be).call(this).length}key(i){return c(this,Kt,Be).call(this)[i]||null}getItem(i){return e(this,H)[i]}setItem(i,n){e(this,H)[i]=n}removeItem(i){delete e(this,H)[i]}clear(){f(this,H,new window.Object)}hasItem(i){return e(this,H).hasOwnProperty(i)}};H=new WeakMap,Kt=new WeakSet,Be=function(){return window.Object.keys(e(this,H))};var ot,B,tt,oe,Qe,wt=class{constructor(i,n){r(this,oe);r(this,ot,null);r(this,B,null);r(this,tt,null);if(i instanceof Node&&n instanceof Node)f(this,ot,i),f(this,B,n),f(this,tt,n.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return e(this,B)}affiliate(){e(this,ot).appendChild(e(this,B))}disaffiliate(){e(this,ot).removeChild(e(this,B))}promote(i){e(this,tt).innerHTML=i,e(this,ot).replaceChild(e(this,tt),e(this,B)),c(this,oe,Qe).call(this)}};ot=new WeakMap,B=new WeakMap,tt=new WeakMap,oe=new WeakSet,Qe=function(){let i=e(this,tt);f(this,tt,e(this,B).cloneNode(!1)),f(this,B,i)};var ht,ct,lt=class{constructor(i){d(this,"owner",null);r(this,ht,!1);r(this,ct,"");this.owner=i}get invalidated(){return e(this,ht)}reset(i){f(this,ht,!1),f(this,ct,i)}append(i){f(this,ct,e(this,ct)+i)}verify(i){f(this,ht,i(e(this,ct)))}process(){e(this,ht)&&this.on_content_invalidation(e(this,ct))}on_content_invalidation(i){}};ht=new WeakMap,ct=new WeakMap;var fe,ti,Ze,de,ue,Et,he=m=>m>1e3?(m/1e3).toFixed(2)+"s":m.toFixed(2)+"ms",ce=class{constructor(){d(this,"round",0);d(this,"domTime",window.Number.MAX_SAFE_INTEGER);d(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var i=new window.Object;return i.round=this.round,i.domTime=he(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(i.renderTime=he(this.renderTime)),i}},le=class{constructor(i){d(this,"name","");d(this,"rounds",0);d(this,"time",0);d(this,"average",0);this.name=i}compute(i){this.rounds++,this.time+=i,this.average=this.time/this.rounds}getDebugInfo(){let i=he(this.time),n=he(this.average);return{name:this.name,rounds:this.rounds,spent:i,average:n}}},M=class{static initialize(i){typeof i=="function"&&f(M,Et,i),M.DOMUpdate.overall=new le("overall-dom-update"),M.BrowserRender.overall=new le("overall-browser-render")}},C=M;Et=new WeakMap,r(C,Et,()=>{}),d(C,"StopWatch",(Ze=class{constructor(){r(this,fe);d(this,"_begin",0);d(this,"_end",{dom:0,render:0});d(this,"rounds",0);d(this,"last",new ce);d(this,"best",new ce);d(this,"averages",{dom:0,render:0})}start(){(M.DOMUpdate.check||M.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(i){var n;M.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,M.DOMUpdate.overall.compute(this.last.domTime)),M.BrowserRender.check?setTimeout(()=>c(this,fe,ti).bind(this)(i)):i&&e(n=M,Et).call(n,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},fe=new WeakSet,ti=function(i){var n;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,M.BrowserRender.overall.compute(this.last.renderTime),i&&e(n=M,Et).call(n,this,"finish")},Ze)),d(C,"DOMUpdate",(de=class{},d(de,"check",!0),d(de,"overall",null),de)),d(C,"BrowserRender",(ue=class{},d(ue,"check",!1),d(ue,"overall",null),ue));var gt,yt,At,St,bt,pe,ii,me,si,we,ni,Ee,ri,{noop:Bt,ensureFunction:Gt,isAssignedObject:Ii,isAssignedArray:Bi,isNonEmptyArray:ei}=l,Oi=m=>m.toLowerCase().replaceAll("_","-"),v=class{static registerClasses(i){ei(i)&&window.Array.prototype.forEach.call(i,n=>typeof n=="function"?c(this,me,si).call(this,n):e(this,At).call(this,n))}static instantiateClasses(i,n){ei(i)&&window.Array.prototype.forEach.call(i,t=>window.customElements.get(t.tag)?c(this,Ee,ri).call(this,t,n):e(this,bt).call(this,t.name))}static initialize(i){Ii(i)&&(f(this,gt,Gt(i.onDeferredInstantiation,e(this,gt))),f(this,At,Gt(i.onInvalidClass,e(this,At))),f(this,yt,Gt(i.onMisnamedClass,e(this,yt))),f(this,St,Gt(i.onUnregistrableClass,e(this,St))),f(this,bt,Gt(i.onUnregisteredClass,e(this,bt))))}};gt=new WeakMap,yt=new WeakMap,At=new WeakMap,St=new WeakMap,bt=new WeakMap,pe=new WeakSet,ii=function(i){window.HTMLElement.isPrototypeOf(i)?window.customElements.define(i.tag,i):e(this,St).call(this,i.name)},me=new WeakSet,si=function(i){i.name.indexOf("_")>0?(i.tag=Oi(i.name),c(this,pe,ii).call(this,i)):e(this,yt).call(this,i.name)},we=new WeakSet,ni=function(i,n){let t=null;try{t=window.document.querySelector(n)}finally{t=t||window.document.body}t.appendChild(window.document.createElement(i.tag))},Ee=new WeakSet,ri=function(i,n){let t=()=>c(this,we,ni).call(this,i,n);window.document.body?t():e(this,gt).call(this,t)},r(v,pe),r(v,me),r(v,we),r(v,Ee),r(v,gt,Bt),r(v,yt,Bt),r(v,At,Bt),r(v,St,Bt),r(v,bt,Bt);var Tt,Rt,{noop:ai,ensureFunction:oi,isAssignedObject:Ni}=l,et=class{static fetch(i){let n=window.document.getElementById(i);return n===null?e(this,Tt).call(this,i):n.tagName!=="TEMPLATE"?e(this,Rt).call(this,i):n.innerHTML}static initialize(i){Ni(i)&&(f(this,Tt,oi(i.onExtinctTemplate,e(this,Tt))),f(this,Rt,oi(i.onInvalidTemplate,e(this,Rt))))}};Tt=new WeakMap,Rt=new WeakMap,r(et,Tt,ai),r(et,Rt,ai);var Ot,ye,hi,be,it,ci,Te,li,Re,di,Ie,ui,Oe,fi,Nt,Ae,Ne,Ge,pi,zt,Ce,Ht,P,ge,A,Vt,ve,ut,Wt,Yt,D,Ct,Jt,vt,$,Dt,st,k,I,T,G,E,Lt,V,W,nt,z,Y,Xt,ft,J,rt,U,X,q,w,Mt,qt,pt,_,Q,dt,De,mi,Le,wi,Me,Ei,Ue,gi,at,It,Qt,ze,Zt,He,te,Ve,xe,yi,ee,We,Fe,Ai,ie,Ye,Pe,Si,L,F,se,Je,Ut,je,bi,xt,Se,ne,Xe,g,$e,Z,N,x,a=class{static get VERSION(){return"0.3.8"}static blockUpdate(i,n){if(l.isOf(i,Function)){a.DEBUG&&a.debug("blocking"),a.RENDERING=!1;try{i(n)}catch(t){throw t}finally{a.RENDERING=!0,a.DEBUG&&a.debug("unblocking")}}}static debug(i){window.console.log("[WUSE:DEBUG]",i)}static register(i){return v.registerClasses(l.isOf(i,window.Array)?i:new window.Array(i))}static instantiate(i,n){return v.instantiateClasses(l.isOf(i,window.Array)?i:new window.Array(i),n)}static isShadowElement(i){let n=window.Object.getPrototypeOf(i.constructor);return n===a.OpenShadowElement||n===a.ClosedShadowElement}static get elementCount(){return e(a,x).instancesCount}static makeReactiveField(i,n,t,s,o){let h=(R,j)=>window.Object.defineProperty(i,n,{get:R,set:j,enumerable:!0,configurable:!0}),u=()=>delete i[n],p=(R,j)=>a.makeReactiveField(i,n,R,j,o);h(()=>t,R=>{p(R,s),l.isOf(s,window.Function)?s({renderize:j=>o(n,j),automate:()=>p(R,null),freeze:()=>h(()=>R,j=>{}),defreeze:()=>p(R,s),dereact:()=>h(()=>R,j=>{u(),i[n]=j}),remove:()=>u()}):o(n)})}},b=a;g=new WeakMap,$e=new WeakMap,Z=new WeakMap,N=new WeakMap,x=new WeakMap,d(b,"WebHelpers",K),d(b,"JsHelpers",l),d(b,"PerformanceMeasurement",C),d(b,"tmp",new window.Object),d(b,"DEBUG",!1),d(b,"FATALS",!1),d(b,"MEASURE",!1),d(b,"RENDERING",!0),r(b,g,(zt=class{static makeStyleNode(i,n){var t=window.document.createElement("style");return l.isNonEmptyString(i)&&t.setAttribute("media",i),l.isNonEmptyString(n)&&t.setAttribute("type",n),t.appendChild(window.document.createTextNode("")),t}static newRule(i,n){let t=l.isOf(i,window.Array)?i.join(","):""+i;return t.length?{selector:t,properties:l.isOf(n,window.Object)?n:e(this,Ht).parse(n),cache:null}:null}static newNestedRule(i,n,t){let s=l.isOf(i,window.Array)?i.join(","):""+i,o=l.isOf(n,window.Array)?n.join(","):""+n;return!s.length||!o.length?null:{selector:s,nested:[{selector:o,properties:l.isOf(t,window.Object)?t:e(this,Ht).parse(t)}],cache:null}}static tryToJoinRules(i,n){if(i.selector===n.selector){for(let t in n.properties)i.properties[t]=n.properties[t];return i.cache=null,!0}return!1}static tryToJoinNestedRules(i,n){return l.isOf(i.nested,window.Array)&&i.selector===n.selector?(n.nested.forEach(t=>{var s=!1;for(let o in i.nested)if(s=i.nested[o].selector===t.selector){for(let h in t.properties)i.nested[o].properties[h]=t.properties[h];break}s||i.nested.push(t)}),i.cache=null,!0):!1}static makeMainNode(i){var n=window.document.createElement(i.tag);if(i.id.length&&n.setAttribute("id",i.id),i.classes.length&&n.setAttribute("class",i.classes.join(" ")),l.hasObjectKeys(i.style)){var t="";for(let s in i.style)t+=s+": "+i.style[s]+"; ";if(t.length){let s=t.trim();n.setAttribute("style",s.endsWith(";")?s.slice(0,-1):s)}}if(l.hasObjectKeys(i.attributes))for(let s in i.attributes)n.setAttribute(s,i.attributes[s]);return n}static newEvent(i,n){return typeof i=="string"&&typeof n=="boolean"?{kind:i,capture:n}:null}static performValidations(i){if(i.kind===S.TEMPLATES_KIND){if(!window.document.getElementById(i.id))return y.INEXISTENT_TEMPLATE.emit(i.id)}else if(i.kind===S.SLOTS_KIND){if(new String(i.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return y.UNESPECIFIED_SLOT.emit(i.id)}else if(typeof i.id!="string"||i.id!==""&&window.document.getElementById(i.id)!==null)return y.INVALID_ID.emit(i.id);return i}static newChild(i,n){var t=e(this,Ce).parse(i.trimLeft());return t?(t.rules=l.isOf(n,window.Array)?n:new window.Array,t.rendering=!0,t.cache=null,t):y.INVALID_DEFINITION.emit(i)}static newDefinition(){return{kind:S.DEFAULT_KIND,tag:S.DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},Ce=new WeakMap,Ht=new WeakMap,d(zt,"PartsHolder",(hi=class extends window.Array{constructor(n){super();r(this,Ot);d(this,"owner",null);d(this,"last",null);d(this,"version",0);this.owner=n}append(n){l.isOf(n,window.Object)&&(this.push(n),c(this,Ot,ye).call(this,n))}prepend(n){l.isOf(n,window.Object)&&(this.unshift(n),c(this,Ot,ye).call(this,n))}replace(n,t){n>-1&&l.isOf(t,window.Object)&&c(this,Ot,ye).call(this,this[n]=t)}on_version_change(){}persist(){let n=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":n[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let s=window.Object.assign(new window.Object,this[t]);s.cache&&(s.cache=null),n.push(s)}break}}),n}restore(n){window.Object.getOwnPropertyNames(n).forEach(t=>{switch(t){case"length":break;case"version":this[t]=n[t];break;default:if(window.Number.isInteger(Number(t))){let s=window.Object.assign(new window.Object,n[t]);s.cache&&(s.cache=null),this.push(s)}break}})}},Ot=new WeakSet,ye=function(n){this.last=n,this.version++,this.on_version_change()},hi)),r(zt,Ce,(it=class{static parse(i){if(l.isNonEmptyString(i)){var n=e(a,g).newDefinition();return i.charAt(0)==="%"?i.startsWith(S.TEMPLATES_KIND)?c(this,Nt,Ae).call(this,n,i.replace(n.kind=S.TEMPLATES_KIND,"")):i.startsWith(S.SLOTS_KIND)?c(this,Nt,Ae).call(this,n,i.replace(n.kind=S.SLOTS_KIND,"")):null:c(this,Nt,Ae).call(this,n,i)}return null}},be=new WeakSet,ci=function(i,n){let t=n.indexOf("["),s=n.indexOf("]");if(t>-1&&s>-1&&s>t){let h=n.substr(t,s-t+1),u=h.substr(1,h.length-2).split("|");for(var o in u){let p=u[o].split("=");p[0]==="style"?p[1].split(";").forEach(R=>{let j=R.split(":"),qe=j[0].trim();qe.length&&(i.style[qe]=j[1].trim())}):i.attributes[p[0]]=p[1]}return n.replace(h,"")}return n},Te=new WeakSet,li=function(i,n){let t=n.indexOf("=");return t>-1?(i.content=n.slice(t+1),!!i.content.length&&i.content.charAt(0)==="&"&&(i.content=i.content.slice(1),i.encode=!!i.content.length&&i.content.charAt(0)!=="&"),n.slice(0,t)):n},Re=new WeakSet,di=function(i,n){let t=n.replaceAll("!"," ").split(" ");return t.slice(1).map(s=>{let[o,...h]=s.toLowerCase().split("+"),u=(h||l.EMPTY_ARRAY).indexOf("capture")>-1;i.events.push(e(a,g).newEvent(o,u))}),t[0]},Ie=new WeakSet,ui=function(i,n){let t=n.replaceAll("."," ").split(" ");return i.classes=t.slice(1),t[0]},Oe=new WeakSet,fi=function(i,n){if(n!==""){let t=n.indexOf("#");t===-1?i.tag=n:(t>0&&(i.tag=n.substr(0,t)),i.id=n.substr(t+1))}return i},Nt=new WeakSet,Ae=function(i,n){return c(this,Oe,fi).call(this,i,c(this,Ie,ui).call(this,i,c(this,Re,di).call(this,i,c(this,Te,li).call(this,i,c(this,be,ci).call(this,i,n)))))},r(it,be),r(it,Te),r(it,Re),r(it,Ie),r(it,Oe),r(it,Nt),it)),r(zt,Ht,(Ge=class{static parse(i){let n=new window.Object;return(l.isOf(i,window.Array)?i:l.forcedStringSplit(i,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>l.isNonEmptyString(t)&&c(this,Ne,pi).call(this,n,t.trim())),n}},Ne=new WeakSet,pi=function(i,n){if(!!n.length&&n.indexOf(":")>-1){let[t,...s]=n.split(":"),o=t.trim();if(o.length){let h=s.join(":").trim();i[o]=h.endsWith(";")?h.slice(0,-1):h}}},r(Ge,Ne),Ge)),zt)),r(b,$e,new _t),d(b,"hashRoutine",i=>{var n=0;for(let t=0;t<i.length;t++)n=(n=(n<<5)-n+i.charCodeAt(t))&n;return n}),r(b,Z,(D=class{static initialize(n,t){e(this,Ct).initialize(n,t),e(this,vt).initialize(e(this,Ct).makeRegExp())}},Ct=new WeakMap,Jt=new WeakMap,vt=new WeakMap,r(D,Ct,(P=class{static initialize(t,s){this.begin=t,this.end=s}},d(P,"begin",null),d(P,"end",null),d(P,"enclose",t=>P.begin+t+P.end),d(P,"makeRegExp",()=>new window.RegExp("(?<="+P.begin+").*?(?="+P.end+")","gs")),P)),r(D,Jt,(ge=class{},d(ge,"rules",(n,t)=>l.buildArray(s=>n.forEach(o=>o.replacements.forEach(h=>h.field===t&&s.push(o))))),d(ge,"children",(n,t)=>l.buildArray(s=>{let o=h=>{let u=p=>p.forEach(R=>R.field===t&&s.push(h));["contents","classes","styles","attributes"].forEach(p=>u(h.replacements[p])),h.rules.forEach(p=>p.replacements.forEach(R=>R.field===t&&s.push(h)))};n.forEach(h=>h.rendering&&o(h))})),ge)),r(D,vt,(A=class{static initialize(t){f(this,Vt,t)}},Vt=new WeakMap,ve=new WeakMap,ut=new WeakMap,Wt=new WeakMap,Yt=new WeakMap,r(A,Vt,null),r(A,ve,(t,s,o)=>t.push({at:s,field:o.trim(),find:e(e(a,Z),Ct).enclose(o)})),r(A,ut,(t,s,o)=>l.isNonEmptyString(o)&&(o.match(e(A,Vt))||l.EMPTY_ARRAY).forEach(h=>{var u;return e(u=A,ve).call(u,t,s,h)})),r(A,Wt,(t,s,o)=>{var h;t[s]=new window.Array,e(h=A,ut).call(h,t[s],s,o)}),r(A,Yt,(t,s,o)=>{t[s]=new window.Array,window.Object.keys(o).forEach(h=>{var u,p;e(u=A,ut).call(u,t[s],s,h),e(p=A,ut).call(p,t[s],s,o[h])})}),d(A,"child",t=>l.buildObject(s=>{var o,h,u,p;e(o=A,Wt).call(o,s,"contents",t.content),e(h=A,Wt).call(h,s,"classes",t.classes.join(" ")),e(u=A,Yt).call(u,s,"styles",t.style),e(p=A,Yt).call(p,s,"attributes",t.attributes),t.rules.forEach(R=>R.replacements=A.rule(R))})),d(A,"rule",t=>l.buildArray(s=>{var h;if(l.isOf(t.nested,window.Array))return t.nested.map(u=>A.rule(u));var o="";for(let u in t.properties)o+=u+":"+t.properties[u]+";";e(h=A,ut).call(h,s,"rules",o)})),A)),d(D,"extractReplacementsFromRule",e(D,vt).rule),d(D,"extractReplacementsFromChild",e(D,vt).child),d(D,"scanRulesForReplacements",e(D,Jt).rules),d(D,"scanChildrenForReplacements",e(D,Jt).children),D)),r(b,N,($=class{static initialize(n){l.isAssignedObject(n)&&f(this,Dt,l.ensureFunction(n.onFetchTemplate,e(this,Dt)))}},Dt=new WeakMap,r($,Dt,l.noop),d($,"cacheInvalidator",n=>n.cache=null),d($,"renderingIncluder",n=>n.rendering=!0),d($,"renderingExcluder",n=>n.rendering=!1),d($,"renderRule",(n,t)=>{if(l.isOf(t.nested,window.Array))return t.selector+"{"+t.nested.map(o=>e(a,N).renderRule(n,o)).join(`
`)+"}";if(t.selector!==""){var s="";for(let o in t.properties)s+=o+":"+t.properties[o]+";";return l.isOf(t.replacements,window.Array)&&!!t.replacements.length&&t.replacements.forEach(o=>s=n(s,o)),t.selector+"{"+s+"}"}return null}),d($,"renderChild",(n,t)=>{var h;if(t.kind===S.TEMPLATES_KIND)return e(h=$,Dt).call(h,t.id);if(t.tag===S.TEXTNODE_TAG){var s=t.content;return t.replacements.contents.forEach(u=>s=n(s,u)),t.encode?K.htmlEncode(s):s}var o=l.isNonEmptyString(t.id)?`<${t.tag} id='${t.id}'`:"<"+t.tag;if(t.classes.length){var s=t.classes.join(" ");t.replacements.classes.forEach(p=>s=n(s,p)),o+=` class='${s}'`}if(l.hasObjectKeys(t.style)){var s=" style='";for(let p in t.style)s+=p+": "+t.style[p]+"; ";s+="'",t.replacements.styles.forEach(p=>s=n(s,p)),o+=s}if(l.hasObjectKeys(t.attributes)){var s="";for(let p in t.attributes)s+=" "+p+"="+t.attributes[p];t.replacements.attributes.forEach(p=>s=n(s,p)),o+=s}if(typeof t.content=="string"){var s=t.content;t.replacements.contents.forEach(p=>s=n(s,p)),o+=`>${t.encode?K.htmlEncode(s):s}</${t.tag}>`}else o+="/>";return o}),$)),r(b,x,(st=class extends window.HTMLElement{constructor(t){super();r(this,Q);r(this,De);r(this,Le);r(this,Me);r(this,Ue);r(this,at);r(this,Qt);r(this,Zt);r(this,te);r(this,xe);r(this,ee);r(this,Fe);r(this,ie);r(this,Pe);r(this,L);r(this,se);r(this,je);r(this,xt);r(this,ne);r(this,k,"");r(this,I,new class extends e(a,g).PartsHolder{on_version_change(){var t;this.last.version=this.version,this.last.replacements=e(a,Z).extractReplacementsFromRule(this.last),a.DEBUG&&c(t=this.owner,Q,dt).call(t,`rules list version change: ${this.version}`)}}(this));r(this,T,new class extends e(a,g).PartsHolder{on_version_change(){var t,s;this.last.version=this.version,this.last.replacements=e(a,Z).extractReplacementsFromChild(this.last),f(t=this.owner,W,e(t,W)|this.last.kind===S.SLOTS_KIND),a.DEBUG&&c(s=this.owner,Q,dt).call(s,`children list version change: ${this.version}`)}}(this));r(this,G,new class extends e(a,g).PartsHolder{on_version_change(){var t;a.DEBUG&&c(t=this.owner,Q,dt).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));r(this,E,{mainDefinition:e(a,g).newDefinition(),styleMedia:S.DEFAULT_STYLE_MEDIA,styleType:S.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});r(this,Lt,new window.Object);r(this,V,!1);r(this,W,!1);r(this,nt,void 0);r(this,z,void 0);r(this,Y,null);r(this,Xt,a.isShadowElement(this));r(this,ft,!1);r(this,J,!1);r(this,rt,e(a,$e));r(this,U,null);r(this,X,"");r(this,q,!1);r(this,w,{root:new class extends lt{on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends lt{on_content_invalidation(t){e(this.owner,z).promote(t)}}(this),main:new class extends lt{on_content_invalidation(t){e(this.owner,nt).promote(t)}}(this),renderizers:{rule:t=>e(this,w).style.append(t.cache?t.cache:t.cache=e(a,N).renderRule(e(this,Mt),t)),children:{mixed:t=>e(this,Xt)&&t.kind===S.SLOTS_KIND?e(this,w).renderizers.children.slot(t):e(this,w).renderizers.children.normal(t),slot:t=>{t.cache||(e(this,w).root.verify(s=>!0),e(this,w).root.append(t.cache=e(a,N).renderChild(e(this,Mt),t)))},normal:t=>{e(this,w).main.append(t.cache?t.cache:t.cache=e(a,N).renderChild(e(this,Mt),t)),t.rules.forEach(e(this,w).renderizers.rule)}}},gotModified:()=>e(this,w).root.invalidated||e(this,w).main.invalidated||e(this,w).style.invalidated,getDebugInfo:()=>`updated (root: ${e(this,w).root.invalidated}, main: ${e(this,w).main.invalidated}, style: ${e(this,w).style.invalidated})`});r(this,Mt,(t,s)=>t.replace(s.find,this[s.field]!==void 0?this[s.field]:""));r(this,qt,{bind:{key:()=>{let t=s=>{l.isNonEmptyString(s)&&(this[s]=c(this,Qt,ze).call(this,s))};return e(this,V)&&t(e(this,E).mainDefinition.id),s=>t(s.id)},event:"addEventListener"},unbind:{key:()=>{let t=s=>delete this[s];return e(this,V)&&t(e(this,E).mainDefinition.id),s=>t(s.id)},event:"removeEventListener"}});r(this,pt,{main:new mt(a.hashRoutine),style:new mt(a.hashRoutine)});r(this,_,{attachment:new C.StopWatch,partial:new C.StopWatch,full:new C.StopWatch,dettachment:new C.StopWatch});r(this,Ut,()=>e(a,x).EVENT_NAMES.forEach(t=>e(this,Lt)[t]=typeof this[t]=="function"));d(this,"info",{instanceNumber:++e(a,x).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,Y,t!==e(a,x).RootMode.REGULAR?this.attachShadow({mode:t}):this),e(this,Ut).call(this),c(this,L,F).call(this,"on_create"),e(this,E).attributeKeys&&this.getAttributeNames().forEach(s=>this[s]=this.getAttribute(s)),c(this,je,bi).call(this)&&e(this,U).generation>1?c(this,L,F).call(this,"on_reconstruct",e(this,U)):c(this,L,F).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return e(this,J)?c(this,xe,yi):l.noop}get redraw(){return e(this,J)?c(this,Fe,Ai):l.noop}connectedCallback(){a.MEASURE&&e(this,_).attachment.start(),e(this,Ut).call(this),c(this,L,F).call(this,"on_connect"),c(this,ee,We).call(this,"on_load"),e(this,q)&&this.persistToElementsStore(),a.MEASURE&&e(this,_).attachment.stop(a.DEBUG)}disconnectedCallback(){a.MEASURE&&e(this,_).dettachment.start(),c(this,at,It).call(this,!1),c(this,L,F).call(this,"on_disconnect"),a.MEASURE&&e(this,_).dettachment.stop(a.DEBUG)}getElementsStore(){return e(this,rt)}setElementsStore(t){f(this,rt,t)}hasElementsStoreKey(t){return e(this,q)}getElementsStoreKey(t){return e(this,X)}setElementsStoreKey(t){return f(this,q,l.isNonEmptyString(f(this,X,t))),this}persistToElementsStore(){if(c(this,ne,Xe).call(this)){let t=e(this,U);if(t)return e(this,G).snapshot(),t.data=new window.Object({options:e(this,E),html:e(this,k),children:e(this,T).persist(),rules:e(this,I).persist(),fields:e(this,G).persist(),slotted:e(this,W),identified:e(this,V)}),c(this,xt,Se).call(this),!0}return!1}restoreFromElementsStore(t){if(c(this,ne,Xe).call(this)){let s=e(this,U);if(s&&s.persisted&&s.data)return f(this,E,s.data.options),f(this,W,s.data.slotted),f(this,V,s.data.identified),f(this,k,s.data.html),e(this,T).restore(s.data.children),e(this,T).owner=this,e(this,I).restore(s.data.rules),e(this,I).owner=this,e(this,G).restore(s.data.fields),e(this,G).owner=this,e(this,G).recall(),t||(delete s.data,c(this,xt,Se).call(this)),!0}return!1}selectChildElement(t){return e(this,Y).querySelector(t)}setMainAttribute(t,s){e(this,ft)&&e(this,nt).element.setAttribute(t,s)}setMainElement(t){let s=e(a,g).newChild(t);if(e(a,g).performValidations(s)){if(s.content!==""||!!s.events.length)return y.INVALID_DEFINITION.emit(t);f(this,V,!!s.id.length)&&(e(this,E).mainDefinition.id=s.id),s.tag.length&&(e(this,E).mainDefinition.tag=s.tag),s.classes.length&&(e(this,E).mainDefinition.classes=s.classes),s.style&&(e(this,E).mainDefinition.style=s.style),s.attributes&&(e(this,E).mainDefinition.attributes=s.attributes)}return this}setStyleOptions(t,s){return e(this,E).styleMedia=t||"",e(this,E).styleType=s||"",this}setElementsAsKeys(t){return e(this,E).elementKeys=!!t,this}setAttributesAsKeys(t){return e(this,E).attributeKeys=!!t,this}allowRawContent(t){return e(this,E).rawContent=!!t,this}setRawContent(t){return e(this,E).rawContent?f(this,k,t):y.ALLOW_HTML.emit(),this}appendRawContent(t){return e(this,E).rawContent?f(this,k,e(this,k)+t):y.ALLOW_HTML.emit(),this}prependRawContent(t){return e(this,E).rawContent?f(this,k,t+e(this,k)):y.ALLOW_HTML.emit(),this}appendCSSRule(t,s,o){if(o)return this.appendCSSNestedRule(t,s,o);let h=e(this,I).slice(-1),u=e(a,g).newRule(t,s);return(!h.length||!e(a,g).tryToJoinRules(h[0],u))&&e(this,I).append(u),this}prependCSSRule(t,s,o){if(o)return this.prependCSSNestedRule(t,s,o);let h=e(this,I).slice(0,1),u=e(a,g).newRule(t,s);return(!h.length||!e(a,g).tryToJoinRules(h[0],u))&&e(this,I).prepend(u),this}appendCSSNestedRule(t,s,o){let h=e(this,I).slice(-1),u=e(a,g).newNestedRule(t,s,o);return(!h.length||!e(a,g).tryToJoinNestedRules(h[0],u))&&e(this,I).append(u),this}prependCSSNestedRule(t,s,o){let h=e(this,I).slice(0,1),u=e(a,g).newNestedRule(t,s,o);return(!h.length||!e(a,g).tryToJoinNestedRules(h[0],u))&&e(this,I).prepend(u),this}appendChildElement(t,s){return e(this,T).append(e(a,g).performValidations(e(a,g).newChild(t,s))),this}prependChildElement(t,s){return e(this,T).prepend(e(a,g).performValidations(e(a,g).newChild(t,s))),this}replaceChildElement(t,s){return e(this,T).replace(e(this,T).findIndex(o=>o.id===t),e(a,g).newChild(s)),this}appendChildElements(t){return(l.isOf(t,window.Array)?t:l.forcedStringSplit(t,`
`)).forEach(s=>typeof s=="string"&&!!s.trim().length&&this.appendChildElement(s)),this}prependChildElements(t){return(l.isOf(t,window.Array)?t:l.forcedStringSplit(t,`
`)).forEach(s=>typeof s=="string"&&!!s.trim().length&&this.prependChildElement(s)),this}checkChildElementIsIncludedById(t,s,o){let h=u=>l.isOf(u,window.Function)?u():void 0;return e(this,T).some(u=>u.id===t&&u.rendering)?h(s):h(o),this}includeChildElementById(t){return e(this,T).forEach(s=>s.id===t&&e(a,N).renderingIncluder(s)),this}excludeChildElementById(t){return e(this,T).forEach(s=>s.id===t&&e(a,N).renderingExcluder(s)),this}invalidateChildElementsById(t){return e(this,T).forEach(s=>t.indexOf(s.id)>-1&&e(a,N).cacheInvalidator(s)),this}invalidateChildElements(t){return l.isOf(t,window.Array)&&t.forEach(e(a,N).cacheInvalidator),this}makeField(t,s){return this[t]=s,e(this,G).append({name:t,value:s}),this}makeReactiveField(t,s,o,h=!0){return c(this,Pe,Si).call(this,t,s,o,h)}makeExternalReactiveField(t,s,o,h,u=!0){return this.makeReactiveField(s,t[s]||o,p=>{t[s]=this[s],h(p)},u)}},k=new WeakMap,I=new WeakMap,T=new WeakMap,G=new WeakMap,E=new WeakMap,Lt=new WeakMap,V=new WeakMap,W=new WeakMap,nt=new WeakMap,z=new WeakMap,Y=new WeakMap,Xt=new WeakMap,ft=new WeakMap,J=new WeakMap,rt=new WeakMap,U=new WeakMap,X=new WeakMap,q=new WeakMap,w=new WeakMap,Mt=new WeakMap,qt=new WeakMap,pt=new WeakMap,_=new WeakMap,Q=new WeakSet,dt=function(t){e(this,V)&&a.debug(`#${e(this,E).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},De=new WeakSet,mi=function(){e(this,z)&&e(this,z).affiliate(),e(this,nt).affiliate(),f(this,ft,!0)},Le=new WeakSet,wi=function(){f(this,z,e(this,I).length?new wt(e(this,Y),e(a,g).makeStyleNode(e(this,E).styleMedia,e(this,E).styleType)):null),f(this,nt,new wt(e(this,Y),e(a,g).makeMainNode(e(this,E).mainDefinition))),e(this,T).forEach(e(a,N).cacheInvalidator),e(this,I).forEach(e(a,N).cacheInvalidator)},Me=new WeakSet,Ei=function(){e(this,ft)&&(e(this,nt).disaffiliate(),e(this,z)&&e(this,z).disaffiliate(),e(this,W)&&e(this,Xt)&&K.removeChildren(this)),f(this,ft,!1)},Ue=new WeakSet,gi=function(t){return{key:e(this,E).elementKeys&&t.key(),event:(s,o,h)=>{let u=this[`on_${s}_${o}`];if(u){let p=c(this,Qt,ze).call(this,s);p&&p[t.event](o,u,h)}},slots:()=>this.on_slot_change&&e(this,Y).querySelectorAll("slot").forEach(s=>s[t.event]("slotchange",this.on_slot_change))}},at=new WeakSet,It=function(t){if(e(this,J)&&!t||!e(this,J)&&t){let s=c(this,Ue,gi).call(this,t?e(this,qt).bind:e(this,qt).unbind);e(this,T).forEach(o=>{!o.rendering&&t||(s.key&&s.key(o),o.events.forEach(h=>h&&s.event(o.id,h.kind,h.capture)))}),e(this,W)&&s.slots(),f(this,J,t)}},Qt=new WeakSet,ze=function(t){return l.isNonEmptyString(t)?e(this,Y).querySelector(`#${t}`):void 0},Zt=new WeakSet,He=function(){e(this,w).root.reset(""),e(this,w).style.reset(""),e(this,w).main.reset(e(this,k));let t=e(this,W)?e(this,w).renderizers.children.mixed:e(this,w).renderizers.children.normal;e(this,T).forEach(s=>s.rendering&&t(s)),e(this,I).forEach(e(this,w).renderizers.rule),e(this,w).main.verify(s=>!e(this,pt).main.compute(s)),e(this,w).style.verify(s=>!e(this,pt).style.compute(s))},te=new WeakSet,Ve=function(){e(this,w).root.process(),e(this,w).style.process(),e(this,w).main.process(),a.DEBUG&&c(this,Q,dt).call(this,e(this,w).getDebugInfo())},xe=new WeakSet,yi=function(){!a.RENDERING||(a.MEASURE&&e(this,_).partial.start(),c(this,L,F).call(this,"on_prerender"),c(this,Zt,He).call(this),e(this,w).gotModified()?(c(this,at,It).call(this,!1),c(this,te,Ve).call(this),c(this,at,It).call(this,!0),this.info.updatedRounds++,c(this,L,F).call(this,"on_update"),c(this,se,Je).call(this,"on_refresh")):this.info.unmodifiedRounds++,a.DEBUG&&c(this,Q,dt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${e(this,pt).main.rounds}, style: ${e(this,pt).style.rounds}) | updated: ${this.info.updatedRounds}`),c(this,L,F).call(this,"on_postrender"),a.MEASURE&&e(this,_).partial.stop(a.DEBUG))},ee=new WeakSet,We=function(t){c(this,Le,wi).call(this),c(this,De,mi).call(this),c(this,L,F).call(this,"on_inject"),c(this,Zt,He).call(this),e(this,w).style.verify(s=>!!e(this,z)),c(this,te,Ve).call(this),c(this,at,It).call(this,!0),c(this,L,F).call(this,t)},Fe=new WeakSet,Ai=function(t){a.MEASURE&&e(this,_).full.start(),c(this,at,It).call(this,!1),c(this,Me,Ei).call(this),c(this,L,F).call(this,"on_unload"),e(this,Ut).call(this),c(this,ee,We).call(this,"on_reload"),c(this,se,Je).call(this,"on_repaint"),a.MEASURE&&e(this,_).full.stop(a.DEBUG)},ie=new WeakSet,Ye=function(t,s="$none"){if(e(this,J)){let o=e(a,Z).scanRulesForReplacements(e(this,I),t);o.forEach(e(a,N).cacheInvalidator);let h=e(a,Z).scanChildrenForReplacements(e(this,T),t);h.forEach(e(a,N).cacheInvalidator),a.DEBUG&&c(this,Q,dt).call(this,`reactive render (label: ${s}, field: ${t}, children: ${h.length}, rules: ${o.length})`),(!!o.length||!!h.length)&&(h.some(u=>!!u.kind.length)&&e(this,T).forEach(u=>u.kind===S.SLOTS_KIND?e(a,N).cacheInvalidator(u):void 0),this.render())}},Pe=new WeakSet,Si=function(t,s,o,h=!0){return a.makeReactiveField(this,t,s,o,(u,p)=>c(this,ie,Ye).call(this,u,p||"$auto")),e(this,G).append({name:t,value:s}),h&&c(this,ie,Ye).call(this,t,"$init"),this},L=new WeakSet,F=function(t,s){e(this,Lt)[t]&&this[t].call(this,s)},se=new WeakSet,Je=function(t,s){e(this,q)&&this.persistToElementsStore(),e(this,Lt)[t]&&window.requestAnimationFrame(()=>this[t].call(this,s))},Ut=new WeakMap,je=new WeakSet,bi=function(){return e(this,q)?(f(this,U,e(this,rt).hasItem(e(this,X))?e(this,rt).getItem(e(this,X)):{generation:0,persisted:!1}),e(this,U).generation++,c(this,xt,Se).call(this),!0):!1},xt=new WeakSet,Se=function(){a.DEBUG&&(e(this,U).key=e(this,X)),e(this,U).persisted=!!e(this,U).data,e(this,rt).setItem(e(this,X),e(this,U))},ne=new WeakSet,Xe=function(){return e(this,q)?!0:(y.INVALID_KEY.emit(),!1)},d(st,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),d(st,"specializeClass",t=>class extends st{constructor(){super(t)}}),d(st,"instancesCount",0),st)),d(b,"NonShadowElement",e(a,x).specializeClass(e(a,x).RootMode.REGULAR)),d(b,"OpenShadowElement",e(a,x).specializeClass(e(a,x).RootMode.OPEN)),d(b,"ClosedShadowElement",e(a,x).specializeClass(e(a,x).RootMode.CLOSED)),(()=>{let i=(n,t)=>!n&&y.UNSUPPORTED_FEATURE.emit(t);try{i(l.isOf(window.document,window.HTMLDocument),"HTML Document"),i(l.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),K.onDOMContentLoaded(()=>i(l.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){y.UNKNOWN_ERROR.emit()}C.initialize((n,t)=>a.debug(JSON.stringify(l.buildArray(s=>{switch(s.push({instances:a.elementCount}),s.push(n.getDebugInfo()),t){case"stop":s.push(C.DOMUpdate.overall.getDebugInfo());break;case"finish":s.push(C.BrowserRender.overall.getDebugInfo());break}})))),v.initialize({onMisnamedClass:y.MISNAMED_CLASS.emit,onUnregistrableClass:y.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:y.UNREGISTERED_CLASS.emit,onInvalidClass:y.INVALID_CLASS.emit,onDeferredInstantiation:K.onDOMContentLoaded}),et.initialize({onExtinctTemplate:y.EXTINCT_TEMPLATE.emit,onInvalidTemplate:y.INVALID_TEMPLATE.emit}),e(a,N).initialize({onFetchTemplate:et.fetch}),e(a,Z).initialize(S.DEFAULT_REPLACEMENT_OPEN,S.DEFAULT_REPLACEMENT_CLOSE)})(),window.Wuse=b;})();
