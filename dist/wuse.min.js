var _e=Object.defineProperty;var ts=(g,s,n)=>s in g?_e(g,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[s]=n;var d=(g,s,n)=>(ts(g,typeof s!="symbol"?s+"":s,n),n),we=(g,s,n)=>{if(!s.has(g))throw TypeError("Cannot "+n)};var e=(g,s,n)=>(we(g,s,"read from private field"),n?n.call(g):s.get(g)),o=(g,s,n)=>{if(s.has(g))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(g):s.set(g,n)},u=(g,s,n,t)=>(we(g,s,"write to private field"),t?t.call(g,n):s.set(g,n),n);var c=(g,s,n)=>(we(g,s,"access private method"),n);var Vt,Y,Fe,zt,xe,Yt,je,Jt,Pe,Xt,ke,lt,Gt,qt,me,Ke,jt,Wt,gt,k,yt,Se,Ce,Pt,kt,Kt,Ee,v,ge,R,dt,Bt,Le,D,$t,m,ut,Qt,Zt,_,St,At,Et,tt,F,J,_t,$e,Me,et,st,Ue,X,M,A,S,x,p,ft,K,$,q,j,G,bt,it,nt,W,T,B,H,f,Rt,P,te,ee,rt,at,U,V,Z,se,Ge,ie,Be,ne,He,re,Ve,Q,ct,Ot,Ae,Tt,be,Nt,Re,ae,ze,vt,Oe,oe,Ye,It,Te,he,Je,Dt,Ne,O,I,Ct,ve,pt,ce,Xe,wt,Ht,Lt,Ie,le,ht,qe,de,We,ue,Qe,fe,Ze,Mt,ye,w,pe,ot,Ut,Ft,y,b,xt,mt,N,z;const r=class{static get VERSION(){return"0.3.1"}static blockUpdate(s,n){if(r.isOf(s,Function)){r.DEBUG&&r.debug("blocking"),r.RENDERING=!1;try{s(n)}catch(t){throw t}finally{r.RENDERING=!0,r.DEBUG&&r.debug("unblocking")}}}static debug(s){window.console.log(e(r,y).DEBUG_TAG,s)}static isOf(s,n){return!!(s&&s.constructor===n)}static isNonEmptyString(s){return typeof s=="string"&&!!s.length}static forcedStringSplit(s,n){return typeof s=="string"?s.split(n):new window.Array}static hasObjectKeys(s){return!!window.Object.keys(s).length}static buildArray(s){var n;return c(n=r,Mt,ye).call(n,new window.Array,s)}static buildObject(s){var n;return c(n=r,Mt,ye).call(n,new window.Object,s)}static register(s){return e(r,z).registerClasses(r.isOf(s,window.Array)?s:new window.Array(s))}static instantiate(s,n){return e(r,z).instantiateClasses(r.isOf(s,window.Array)?s:new window.Array(s),n)}static isShadowElement(s){const n=window.Object.getPrototypeOf(s.constructor);return n===r.OpenShadowElement||n===r.ClosedShadowElement}};let Wuse=r;Mt=new WeakSet,ye=function(s,n){return r.isOf(n,window.Function)&&n(s),s},w=new WeakMap,pe=new WeakMap,ot=new WeakMap,Ut=new WeakMap,Ft=new WeakMap,y=new WeakMap,b=new WeakMap,xt=new WeakMap,mt=new WeakMap,N=new WeakMap,z=new WeakMap,o(Wuse,Mt),d(Wuse,"tmp",new window.Object),d(Wuse,"DEBUG",!1),d(Wuse,"FATALS",!1),d(Wuse,"MEASURE",!1),d(Wuse,"RENDERING",!0),d(Wuse,"EMPTY_ARRAY",new window.Array),d(Wuse,"WebHelpers",class{static onDOMContentLoaded(s){if(r.isOf(s,window.Function)){const n=()=>{s(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",n),100)};window.addEventListener("DOMContentLoaded",n)}}static getUniqueId(s="WUSE"){for(var n,t="_"+(s||"")+"_";window.document.getElementById(n=t+(""+window.Math.random()).substring(2))!==null;);return n}static getCSSVendorPrefix(){const s=window.getComputedStyle(window.document.body,""),t=Array.prototype.slice.call(s).filter(i=>i.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}}),o(Wuse,w,(jt=class{static makeStyleNode(s,n){var t=window.document.createElement("style");return r.isNonEmptyString(s)&&t.setAttribute("media",s),r.isNonEmptyString(n)&&t.setAttribute("type",n),t.appendChild(window.document.createTextNode("")),t}static newRule(s,n){const t=r.isOf(s,window.Array)?s.join(","):""+s,i=r.isOf(n,window.Object)?n:e(this,gt).parse(n);return t.length?{selector:t,properties:i,cache:null}:null}static newNestedRule(s,n,t){const i=r.isOf(s,window.Array)?s.join(","):""+s,a=r.isOf(n,window.Array)?n.join(","):""+n,h=r.isOf(t,window.Object)?t:e(this,gt).parse(t);return!i.length||!a.length?null:{selector:i,nested:[{selector:a,properties:h}],cache:null}}static tryToJoinRules(s,n){if(s.selector===n.selector){for(const t in n.properties)s.properties[t]=n.properties[t];return s.cache=null,!0}return!1}static tryToJoinNestedRules(s,n){return r.isOf(s.nested,window.Array)&&s.selector===n.selector?(n.nested.forEach(t=>{var i=!1;for(const a in s.nested)if(i=s.nested[a].selector===t.selector){for(const h in t.properties)s.nested[a].properties[h]=t.properties[h];break}i||s.nested.push(t)}),s.cache=null,!0):!1}static makeMainNode(s){var n=window.document.createElement(s.tag);if(s.id.length&&n.setAttribute("id",s.id),s.classes.length&&n.setAttribute("class",s.classes.join(" ")),r.hasObjectKeys(s.style)){var t="";for(const i in s.style)t+=i+": "+s.style[i]+"; ";if(t.length){const i=t.trim();n.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(r.hasObjectKeys(s.attributes))for(const i in s.attributes)n.setAttribute(i,s.attributes[i]);return n}static newEvent(s,n){return typeof s=="string"&&typeof n=="boolean"?{kind:s,capture:n}:null}static performValidations(s){if(s.kind===e(r,y).TEMPLATES_KIND){if(!window.document.getElementById(s.id))return e(r,b).INEXISTENT_TEMPLATE.emit(s.id)}else if(s.kind===e(r,y).SLOTS_KIND){if(new String(s.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return e(r,b).UNESPECIFIED_SLOT.emit(s.id)}else if(typeof s.id!="string"||s.id!==""&&window.document.getElementById(s.id)!==null)return e(r,b).INVALID_ID.emit(s.id);return s}static newChild(s,n){var t=e(this,Wt).parse(s.trimLeft());return t?(t.rules=r.isOf(n,window.Array)?n:new window.Array,t.rendering=!0,t.cache=null,t):e(r,b).INVALID_DEFINITION.emit(s)}static newDefinition(){return{kind:e(r,y).DEFAULT_KIND,tag:e(r,y).DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:""}}},Wt=new WeakMap,gt=new WeakMap,o(jt,Wt,(Y=class{static parse(s){if(r.isNonEmptyString(s)){var n=e(r,w).newDefinition();return s.charAt(0)==="%"?s.startsWith(e(r,y).TEMPLATES_KIND)?c(this,lt,Gt).call(this,n,s.replace(n.kind=e(r,y).TEMPLATES_KIND,"")):s.startsWith(e(r,y).SLOTS_KIND)?c(this,lt,Gt).call(this,n,s.replace(n.kind=e(r,y).SLOTS_KIND,"")):null:c(this,lt,Gt).call(this,n,s)}return null}},Vt=new WeakSet,Fe=function(s,n){const t=n.indexOf("["),i=n.indexOf("]");if(t>-1&&i>-1&&i>t){const h=n.substr(t,i-t+1),l=h.substr(1,h.length-2).split("|");for(var a in l){const E=l[a].split("=");E[0]==="style"?E[1].split(";").forEach(C=>{const L=C.split(":"),De=L[0].trim();De.length&&(s.style[De]=L[1].trim())}):s.attributes[E[0]]=E[1]}return n.replace(h,"")}return n},zt=new WeakSet,xe=function(s,n){const t=n.indexOf("=");return t>-1?(s.content=n.slice(t+1),n.slice(0,t)):n},Yt=new WeakSet,je=function(s,n){const t=n.replaceAll("!"," ").split(" ");return t.slice(1).map(i=>{const[a,...h]=i.toLowerCase().split("+"),l=(h||r.EMPTY_ARRAY).indexOf("capture")>-1;s.events.push(e(r,w).newEvent(a,l))}),t[0]},Jt=new WeakSet,Pe=function(s,n){const t=n.replaceAll("."," ").split(" ");return s.classes=t.slice(1),t[0]},Xt=new WeakSet,ke=function(s,n){if(n!==""){const t=n.indexOf("#");t===-1?s.tag=n:(t>0&&(s.tag=n.substr(0,t)),s.id=n.substr(t+1))}return s},lt=new WeakSet,Gt=function(s,n){return c(this,Xt,ke).call(this,s,c(this,Jt,Pe).call(this,s,c(this,Yt,je).call(this,s,c(this,zt,xe).call(this,s,c(this,Vt,Fe).call(this,s,n)))))},o(Y,Vt),o(Y,zt),o(Y,Yt),o(Y,Jt),o(Y,Xt),o(Y,lt),Y)),o(jt,gt,(me=class{static parse(s){let n=new window.Object;return(r.isOf(s,window.Array)?s:r.forcedStringSplit(s,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>r.isNonEmptyString(t)&&c(this,qt,Ke).call(this,n,t.trim())),n}},qt=new WeakSet,Ke=function(s,n){if(!!n.length&&n.indexOf(":")>-1){const[t,...i]=n.split(":"),a=t.trim();if(a.length){const h=i.join(":").trim();s[a]=h.endsWith(";")?h.slice(0,-1):h}}},o(me,qt),me)),jt)),d(Wuse,"SimpleStorage",(Ce=class{constructor(){o(this,yt);o(this,k,new window.Object)}get length(){return c(this,yt,Se).call(this).length}key(s){return c(this,yt,Se).call(this)[s]||null}getItem(s){return e(this,k)[s]}setItem(s,n){e(this,k)[s]=n}removeItem(s){delete e(this,k)[s]}clear(){u(this,k,new window.Object)}has(s){return e(this,k).hasOwnProperty(s)}},k=new WeakMap,yt=new WeakSet,Se=function(){return window.Object.keys(e(this,k))},Ce)),o(Wuse,pe,new r.SimpleStorage),o(Wuse,ot,s=>s>1e3?(s/1e3).toFixed(2)+"s":s.toFixed(2)+"ms"),o(Wuse,Ut,class{constructor(){d(this,"round",0);d(this,"domTime",window.Number.MAX_SAFE_INTEGER);d(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var n,t;var s=new window.Object;return s.round=this.round,s.domTime=e(n=r,ot).call(n,this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(s.renderTime=e(t=r,ot).call(t,this.renderTime)),s}}),o(Wuse,Ft,class{constructor(s){d(this,"name","");d(this,"rounds",0);d(this,"time",0);d(this,"average",0);this.name=s}compute(s){this.rounds++,this.time+=s,this.average=this.time/this.rounds}getDebugInfo(){var t,i;const s=e(t=r,ot).call(t,this.time),n=e(i=r,ot).call(i,this.average);return{name:this.name,rounds:this.rounds,spent:s,average:n}}}),d(Wuse,"StopWatch",(Kt=class{constructor(){d(this,"_begin",0);d(this,"_end",{dom:0,render:0});d(this,"rounds",0);d(this,"last",new(e(r,Ut)));d(this,"best",new(e(r,Ut)));d(this,"averages",{dom:0,render:0})}start(){(r.StopWatch.DOMUpdate.check||r.StopWatch.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(){r.StopWatch.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,r.StopWatch.DOMUpdate.overall.compute(this.last.domTime)),r.StopWatch.BrowserRender.check?setTimeout(this.finish.bind(this)):r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.DOMUpdate.overall.getDebugInfo()))}finish(){this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,r.StopWatch.BrowserRender.overall.compute(this.last.renderTime),r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.BrowserRender.overall.getDebugInfo()))}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages,instances:e(r,N).instancesCount}}},d(Kt,"DOMUpdate",(Pt=class{},d(Pt,"check",!0),d(Pt,"overall",new(e(r,Ft))("overall-dom-update")),Pt)),d(Kt,"BrowserRender",(kt=class{},d(kt,"check",!1),d(kt,"overall",new(e(r,Ft))("overall-browser-render")),kt)),Kt)),d(Wuse,"WasteAnalyzer",(Ee=class{constructor(){d(this,"rounds",0);d(this,"last",0);d(this,"hash",0);d(this,"wasted",!1)}compute(s){return this.rounds+=+(this.wasted=this.last===(this.hash=r.WasteAnalyzer.hashRoutine(s))),this.last=this.hash,this.wasted}},d(Ee,"hashRoutine",s=>{var n=0;for(let t=0;t<s.length;t++)n=(n=(n<<5)-n+s.charCodeAt(t))&n;return n}),Ee)),o(Wuse,y,(v=class{},d(v,"ERROR_TAG","[WUSE:ERROR]"),d(v,"DEBUG_TAG","[WUSE:DEBUG]"),d(v,"TEMPLATES_KIND","%templates%"),d(v,"SLOTS_KIND","%slots%"),d(v,"DEFAULT_KIND",""),d(v,"DEFAULT_TAG","div"),d(v,"DEFAULT_STYLE_MEDIA","screen"),d(v,"DEFAULT_STYLE_TYPE","text/css"),d(v,"DEFAULT_REPLACEMENT_OPEN","~{"),d(v,"DEFAULT_REPLACEMENT_CLOSE","}~"),v)),o(Wuse,b,(ge=class{static get UNKNOWN_ERROR(){return e(this,R).call(this,0,s=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return e(this,R).call(this,1,s=>`Unsupported feature: ${s}.`)}static get UNREGISTERED_CLASS(){return e(this,R).call(this,2,s=>`Unregistered class: ${s}.`)}static get INVALID_CLASS(){return e(this,R).call(this,3,s=>`Invalid class: ${s}.`)}static get MISNAMED_CLASS(){return e(this,R).call(this,4,s=>`Misnamed class: ${s}.`)}static get INVALID_DEFINITION(){return e(this,R).call(this,10,s=>`Invalid definition: ${s}.`)}static get INVALID_ID(){return e(this,R).call(this,11,s=>`Invalid id: ${s}.`)}static get INVALID_KEY(){return e(this,R).call(this,12,s=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return e(this,R).call(this,13,s=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return e(this,R).call(this,20,s=>`Inexistent template: #${s}.`)}static get EXTINCT_TEMPLATE(){return e(this,R).call(this,21,s=>`Extinct template: #${s}.`)}static get UNESPECIFIED_SLOT(){return e(this,R).call(this,22,s=>`Unespecified slot: #${s}.`)}},R=new WeakMap,o(ge,R,(s,n)=>({code:s,emit:t=>{const i=`${e(r,y).ERROR_TAG} ${s} | ${n(t)}`;if(r.FATALS||s<10)throw new window.Error(i);return window.console.error(i),null}})),ge)),d(Wuse,"ObjectsArray",(Le=class extends window.Array{constructor(n){super();o(this,dt);d(this,"owner",null);d(this,"last",null);d(this,"version",0);this.owner=n}append(n){r.isOf(n,window.Object)&&(this.push(n),c(this,dt,Bt).call(this,n))}prepend(n){r.isOf(n,window.Object)&&(this.unshift(n),c(this,dt,Bt).call(this,n))}replace(n,t){n>-1&&r.isOf(t,window.Object)&&c(this,dt,Bt).call(this,this[n]=t)}on_version_change(){}persist(){let n=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":n[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){const i=window.Object.assign(new window.Object,this[t]);i.cache&&(i.cache=null),n.push(i)}break}}),n}restore(n){window.Object.getOwnPropertyNames(n).forEach(t=>{switch(t){case"length":break;case"version":this[t]=n[t];break;default:if(window.Number.isInteger(Number(t))){const i=window.Object.assign(new window.Object,n[t]);i.cache&&(i.cache=null),this.push(i)}break}})}},dt=new WeakSet,Bt=function(n){this.last=n,this.version++,this.on_version_change()},Le)),d(Wuse,"ReactiveFields",(Et=class{static make(s,n,t,i,a){const h=(C,L)=>window.Object.defineProperty(s,n,{get:C,set:L,enumerable:!0,configurable:!0}),l=()=>delete s[n],E=(C,L)=>this.make(s,n,C,L,a);h(()=>t,C=>{E(C,i),r.isOf(i,window.Function)?i({renderize:L=>a(n,L),automate:()=>E(C,null),freeze:()=>h(()=>C,L=>{}),defreeze:()=>E(C,i),dereact:()=>h(()=>C,L=>{l(),s[n]=L}),remove:()=>l()}):a(n)})}},d(Et,"ReplacementMarkers",(D=class{},d(D,"begin",e(r,y).DEFAULT_REPLACEMENT_OPEN),d(D,"end",e(r,y).DEFAULT_REPLACEMENT_CLOSE),d(D,"enclose",n=>D.begin+n+D.end),d(D,"makeRegExp",()=>new RegExp("(?<="+D.begin+").*?(?="+D.end+")","gs")),D)),d(Et,"ReplacementsScanners",($t=class{},d($t,"rules",(s,n)=>r.buildArray(t=>s.forEach(i=>i.replacements.forEach(a=>a.field===n&&t.push(i))))),d($t,"children",(s,n)=>r.buildArray(t=>{const i=a=>{const h=l=>l.forEach(E=>E.field===n&&t.push(a));["contents","classes","styles","attributes"].forEach(l=>h(a.replacements[l])),a.rules.forEach(l=>l.replacements.forEach(E=>E.field===n&&t.push(a)))};s.forEach(a=>a.rendering&&i(a))})),$t)),d(Et,"ReplacementsExtractors",(m=class{},ut=new WeakMap,Qt=new WeakMap,Zt=new WeakMap,_=new WeakMap,St=new WeakMap,At=new WeakMap,o(m,ut,null),o(m,Qt,n=>n.match(e(m,ut)?e(m,ut):u(m,ut,r.ReactiveFields.ReplacementMarkers.makeRegExp()))),o(m,Zt,(n,t,i)=>n.push({at:t,find:r.ReactiveFields.ReplacementMarkers.enclose(i),field:i.trim()})),o(m,_,(n,t,i)=>{var a;return r.isNonEmptyString(i)&&(e(a=m,Qt).call(a,i)||r.EMPTY_ARRAY).forEach(h=>{var l;return e(l=m,Zt).call(l,n,t,h)})}),o(m,St,(n,t,i)=>{var a;n[t]=new window.Array,e(a=m,_).call(a,n[t],t,i)}),o(m,At,(n,t,i)=>{n[t]=new window.Array,window.Object.keys(i).forEach(a=>{var h,l;e(h=r.ReactiveFields.ReplacementsExtractors,_).call(h,n[t],t,a),e(l=r.ReactiveFields.ReplacementsExtractors,_).call(l,n[t],t,i[a])})}),d(m,"child",n=>r.buildObject(t=>{var i,a,h,l;e(i=m,St).call(i,t,"contents",n.content),e(a=m,St).call(a,t,"classes",n.classes.join(" ")),e(h=m,At).call(h,t,"styles",n.style),e(l=m,At).call(l,t,"attributes",n.attributes),n.rules.forEach(E=>E.replacements=r.ReactiveFields.ReplacementsExtractors.rule(E))})),d(m,"rule",n=>r.buildArray(t=>{var a;if(r.isOf(n.nested,window.Array))return n.nested.map(h=>r.ReactiveFields.ReplacementsExtractors.rule(h));var i="";for(const h in n.properties)i+=h+":"+n.properties[h]+";";e(a=m,_).call(a,t,"rules",i)})),m)),Et)),o(Wuse,xt,(Me=class{constructor(s,n){o(this,_t);o(this,tt,null);o(this,F,null);o(this,J,null);u(this,tt,s),u(this,F,n),u(this,J,n.cloneNode(!1))}get element(){return e(this,F)}affiliate(){e(this,tt).appendChild(e(this,F))}disaffiliate(s){e(this,tt).removeChild(e(this,F))}promote(s){e(this,J).innerHTML=s,e(this,tt).replaceChild(e(this,J),e(this,F)),c(this,_t,$e).call(this)}},tt=new WeakMap,F=new WeakMap,J=new WeakMap,_t=new WeakSet,$e=function(){const s=e(this,J);u(this,J,e(this,F).cloneNode(!1)),u(this,F,s)},Me)),o(Wuse,mt,(Ue=class{constructor(s){d(this,"owner",null);o(this,et,!1);o(this,st,"");this.owner=s}reset(s){u(this,et,!1),u(this,st,s)}append(s){u(this,st,e(this,st)+s)}verify(s){r.isOf(s,window.Function)&&u(this,et,s(e(this,st)))}process(){e(this,et)&&this.on_content_invalidation(e(this,st))}get invalidated(){return e(this,et)}on_content_invalidation(s){}},et=new WeakMap,st=new WeakMap,Ue)),o(Wuse,N,(X=class extends window.HTMLElement{constructor(t){super();o(this,V);o(this,se);o(this,ie);o(this,ne);o(this,re);o(this,Q);o(this,Ot);o(this,Tt);o(this,Nt);o(this,ae);o(this,vt);o(this,oe);o(this,It);o(this,he);o(this,Dt);o(this,O);o(this,Ct);o(this,ce);o(this,wt);o(this,Lt);o(this,M,"");o(this,A,new class extends r.ObjectsArray{on_version_change(){var t;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.rule(this.last),r.DEBUG&&c(t=this.owner,V,Z).call(t,`rules list version change: ${this.version}`)}}(this));o(this,S,new class extends r.ObjectsArray{on_version_change(){var t,i;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.child(this.last),u(t=this.owner,$,e(t,$)|this.last.kind===e(r,y).SLOTS_KIND),r.DEBUG&&c(i=this.owner,V,Z).call(i,`children list version change: ${this.version}`)}}(this));o(this,x,new class extends r.ObjectsArray{on_version_change(){var t;r.DEBUG&&c(t=this.owner,V,Z).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));o(this,p,{mainDefinition:e(r,w).newDefinition(),styleMedia:e(r,y).DEFAULT_STYLE_MEDIA,styleType:e(r,y).DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});o(this,ft,new window.Object);o(this,K,!1);o(this,$,!1);o(this,q,void 0);o(this,j,void 0);o(this,G,null);o(this,bt,r.isShadowElement(this));o(this,it,!1);o(this,nt,!1);o(this,W,e(r,pe));o(this,T,null);o(this,B,"");o(this,H,!1);o(this,f,{root:new class extends e(r,mt){on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends e(r,mt){on_content_invalidation(t){e(this.owner,j).promote(t)}}(this),main:new class extends e(r,mt){on_content_invalidation(t){e(this.owner,q).promote(t)}}(this),renderizers:{rule:t=>e(this,f).style.append(t.cache?t.cache:t.cache=e(this,rt).rule(t)),children:{mixed:t=>e(this,bt)&&t.kind===e(r,y).SLOTS_KIND?e(this,f).renderizers.children.slot(t):e(this,f).renderizers.children.normal(t),slot:t=>{t.cache||(e(this,f).root.verify(i=>!0),e(this,f).root.append(t.cache=e(this,rt).child(t)))},normal:t=>{e(this,f).main.append(t.cache?t.cache:t.cache=e(this,rt).child(t)),t.rules.forEach(e(this,f).renderizers.rule)}}},gotModified:()=>e(this,f).root.invalidated||e(this,f).main.invalidated||e(this,f).style.invalidated,getDebugInfo:()=>`updated (root: ${e(this,f).root.invalidated}, main: ${e(this,f).main.invalidated}, style: ${e(this,f).style.invalidated})`});o(this,Rt,{bind:{key:()=>{const t=i=>{r.isNonEmptyString(i)&&(this[i]=c(this,Ot,Ae).call(this,i))};return e(this,K)&&t(e(this,p).mainDefinition.id),i=>t(i.id)},event:"addEventListener"},unbind:{key:()=>{const t=i=>delete this[i];return e(this,K)&&t(e(this,p).mainDefinition.id),i=>t(i.id)},event:"removeEventListener"}});o(this,P,t=>t.cache=null);o(this,te,t=>t.rendering=!0);o(this,ee,t=>t.rendering=!1);o(this,rt,{rule:t=>{if(r.isOf(t.nested,window.Array))return t.selector+"{"+t.nested.map(a=>e(this,rt).rule(a)).join(`
`)+"}";if(t.selector!==""){var i="";for(const a in t.properties)i+=a+":"+t.properties[a]+";";return r.isOf(t.replacements,window.Array)&&t.replacements.forEach(a=>i=i.replace(a.find,this[a.field]!==void 0?this[a.field]:"")),t.selector+"{"+i+"}"}return null},child:t=>{if(t.kind===e(r,y).TEMPLATES_KIND){const h=window.document.getElementById(t.id);return h!==null?h.innerHTML:e(r,b).EXTINCT_TEMPLATE.emit(t.id)}var i="<"+t.tag;if(r.isNonEmptyString(t.id)&&(i+=" id='"+t.id+"'"),t.classes.length){var a=t.classes.join(" ");t.replacements.classes.forEach(h=>a=a.replace(h.find,this[h.field]!==void 0?this[h.field]:"")),i+=" class='"+a+"'"}if(r.hasObjectKeys(t.style)){var a=" style='";for(const l in t.style)a+=l+": "+t.style[l]+"; ";a+="'",t.replacements.styles.forEach(l=>a=a.replace(l.find,this[l.field]!==void 0?this[l.field]:"")),i+=a}if(r.hasObjectKeys(t.attributes)){var a="";for(const l in t.attributes)a+=" "+l+"="+t.attributes[l];t.replacements.attributes.forEach(l=>a=a.replace(l.find,this[l.field]!==void 0?this[l.field]:"")),i+=a}if(typeof t.content=="string"){var a=t.content;t.replacements.contents.forEach(l=>a=a.replace(l.find,this[l.field]!==void 0?this[l.field]:"")),i+=">"+a+"</"+t.tag+">"}else i+="/>";return i}});o(this,at,{main:new r.WasteAnalyzer,style:new r.WasteAnalyzer});o(this,U,{attachment:new r.StopWatch,partial:new r.StopWatch,full:new r.StopWatch,dettachment:new r.StopWatch});o(this,pt,()=>e(r,N).EVENT_NAMES.forEach(t=>e(this,ft)[t]=typeof this[t]=="function"));d(this,"info",{instanceNumber:++e(r,N).instancesCount,unmodifiedRounds:0,updatedRounds:0});u(this,G,t!==e(r,N).RootMode.REGULAR?this.attachShadow({mode:t}):this),e(this,pt).call(this),c(this,O,I).call(this,"on_create"),e(this,p).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),c(this,ce,Xe).call(this)&&e(this,T).generation>1?c(this,O,I).call(this,"on_reconstruct",e(this,T)):c(this,O,I).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}render(){}redraw(){}connectedCallback(){r.MEASURE&&e(this,U).attachment.start(),e(this,pt).call(this),c(this,O,I).call(this,"on_connect"),c(this,Dt,Ne).call(this,"render",c(this,ae,ze)),c(this,Dt,Ne).call(this,"redraw",c(this,oe,Ye)),c(this,vt,Oe).call(this,"on_load"),e(this,H)&&this.persistToElementsStore(),r.MEASURE&&e(this,U).attachment.stop()}disconnectedCallback(){r.MEASURE&&e(this,U).dettachment.start(),c(this,Q,ct).call(this,!1),c(this,O,I).call(this,"on_disconnect"),r.MEASURE&&e(this,U).dettachment.stop()}getElementsStore(){return e(this,W)}setElementsStore(t){u(this,W,t)}hasElementsStoreKey(t){return e(this,H)}getElementsStoreKey(t){return e(this,B)}setElementsStoreKey(t){return u(this,H,r.isNonEmptyString(u(this,B,t))),this}persistToElementsStore(){if(c(this,Lt,Ie).call(this)){const t=e(this,T);if(t)return e(this,x).snapshot(),t.data=new window.Object({options:e(this,p),html:e(this,M),children:e(this,S).persist(),rules:e(this,A).persist(),fields:e(this,x).persist(),slotted:e(this,$),identified:e(this,K)}),c(this,wt,Ht).call(this),!0}return!1}restoreFromElementsStore(t){if(c(this,Lt,Ie).call(this)){const i=e(this,T);if(i&&i.persisted&&i.data)return u(this,p,i.data.options),u(this,$,i.data.slotted),u(this,K,i.data.identified),u(this,M,i.data.html),e(this,S).restore(i.data.children),e(this,S).owner=this,e(this,A).restore(i.data.rules),e(this,A).owner=this,e(this,x).restore(i.data.fields),e(this,x).owner=this,e(this,x).recall(),t||(delete i.data,c(this,wt,Ht).call(this)),!0}return!1}selectChildElement(t){return e(this,G).querySelector(t)}setMainAttribute(t,i){e(this,it)&&e(this,q).element.setAttribute(t,i)}setMainElement(t){const i=e(r,w).newChild(t);if(e(r,w).performValidations(i)){if(i.content!==""||!!i.events.length)return e(r,b).INVALID_DEFINITION.emit(t);u(this,K,!!i.id.length)&&(e(this,p).mainDefinition.id=i.id),i.tag.length&&(e(this,p).mainDefinition.tag=i.tag),i.classes.length&&(e(this,p).mainDefinition.classes=i.classes),i.style&&(e(this,p).mainDefinition.style=i.style),i.attributes&&(e(this,p).mainDefinition.attributes=i.attributes)}return this}setStyleOptions(t,i){return e(this,p).styleMedia=t||"",e(this,p).styleType=i||"",this}setElementsAsKeys(t){return e(this,p).elementKeys=!!t,this}setAttributesAsKeys(t){return e(this,p).attributeKeys=!!t,this}allowRawContent(t){return e(this,p).rawContent=!!t,this}setRawContent(t){return e(this,p).rawContent?u(this,M,t):e(r,b).ALLOW_HTML.emit(),this}appendRawContent(t){return e(this,p).rawContent?u(this,M,e(this,M)+t):e(r,b).ALLOW_HTML.emit(),this}prependRawContent(t){return e(this,p).rawContent?u(this,M,t+e(this,M)):e(r,b).ALLOW_HTML.emit(),this}appendCSSRule(t,i,a){if(a)return this.appendCSSNestedRule(t,i,a);const h=e(this,A).slice(-1),l=e(r,w).newRule(t,i);return(!h.length||!e(r,w).tryToJoinRules(h[0],l))&&e(this,A).append(l),this}prependCSSRule(t,i,a){if(a)return this.prependCSSNestedRule(t,i,a);const h=e(this,A).slice(0,1),l=e(r,w).newRule(t,i);return(!h.length||!e(r,w).tryToJoinRules(h[0],l))&&e(this,A).prepend(l),this}appendCSSNestedRule(t,i,a){const h=e(this,A).slice(-1),l=e(r,w).newNestedRule(t,i,a);return(!h.length||!e(r,w).tryToJoinNestedRules(h[0],l))&&e(this,A).append(l),this}prependCSSNestedRule(t,i,a){const h=e(this,A).slice(0,1),l=e(r,w).newNestedRule(t,i,a);return(!h.length||!e(r,w).tryToJoinNestedRules(h[0],l))&&e(this,A).prepend(l),this}appendChildElement(t,i){return e(this,S).append(e(r,w).performValidations(e(r,w).newChild(t,i))),this}prependChildElement(t,i){return e(this,S).prepend(e(r,w).performValidations(e(r,w).newChild(t,i))),this}replaceChildElement(t,i){return e(this,S).replace(e(this,S).findIndex(a=>a.id===t),e(r,w).newChild(i)),this}appendChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}checkChildElementIsIncludedById(t,i,a){const h=l=>r.isOf(l,window.Function)?l():void 0;return e(this,S).some(l=>l.id===t&&l.rendering)?h(i):h(a),this}includeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,te).call(this,i)),this}excludeChildElementById(t){return e(this,S).forEach(i=>i.id===t&&e(this,ee).call(this,i)),this}invalidateChildElementsById(t){return e(this,S).forEach(i=>t.indexOf(i.id)>-1&&e(this,P).call(this,i)),this}invalidateChildElements(t){return r.isOf(t,window.Array)&&t.forEach(e(this,P)),this}makeField(t,i){return this[t]=i,e(this,x).append({name:t,value:i}),this}makeReactiveField(t,i,a,h=!0){return c(this,he,Je).call(this,t,i,a,h),e(this,x).append({name:t,value:i}),this}makeExternalReactiveField(t,i,a,h,l=!0){return this.makeReactiveField(i,t[i]||a,E=>{t[i]=this[i],h(E)},l),this}},M=new WeakMap,A=new WeakMap,S=new WeakMap,x=new WeakMap,p=new WeakMap,ft=new WeakMap,K=new WeakMap,$=new WeakMap,q=new WeakMap,j=new WeakMap,G=new WeakMap,bt=new WeakMap,it=new WeakMap,nt=new WeakMap,W=new WeakMap,T=new WeakMap,B=new WeakMap,H=new WeakMap,f=new WeakMap,Rt=new WeakMap,P=new WeakMap,te=new WeakMap,ee=new WeakMap,rt=new WeakMap,at=new WeakMap,U=new WeakMap,V=new WeakSet,Z=function(t){e(this,K)&&r.debug(`#${e(this,p).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},se=new WeakSet,Ge=function(){e(this,j)&&e(this,j).affiliate(),e(this,q).affiliate(),u(this,it,!0)},ie=new WeakSet,Be=function(){u(this,j,e(this,A).length?new(e(r,xt))(e(this,G),e(r,w).makeStyleNode(e(this,p).styleMedia,e(this,p).styleType)):null),u(this,q,new(e(r,xt))(e(this,G),e(r,w).makeMainNode(e(this,p).mainDefinition))),e(this,S).forEach(e(this,P)),e(this,A).forEach(e(this,P))},ne=new WeakSet,He=function(){e(this,it)&&(e(this,q).disaffiliate(),e(this,j)&&e(this,j).disaffiliate(),e(this,$)&&e(this,bt)&&(this.innerHTML="")),u(this,it,!1)},re=new WeakSet,Ve=function(t){return{key:e(this,p).elementKeys&&t.key(),event:(i,a,h)=>{const l=this[`on_${i}_${a}`];if(l){const E=c(this,Ot,Ae).call(this,i);E&&E[t.event](a,l,h)}},slots:()=>this.on_slot_change&&e(this,G).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}},Q=new WeakSet,ct=function(t){if(e(this,nt)&&!t||!e(this,nt)&&t){const i=c(this,re,Ve).call(this,t?e(this,Rt).bind:e(this,Rt).unbind);e(this,S).forEach(a=>{!a.rendering&&t||(i.key&&i.key(a),a.events.forEach(h=>h&&i.event(a.id,h.kind,h.capture)))}),e(this,$)&&i.slots(),u(this,nt,t)}},Ot=new WeakSet,Ae=function(t){return r.isNonEmptyString(t)?e(this,G).querySelector(`#${t}`):void 0},Tt=new WeakSet,be=function(){e(this,f).root.reset(""),e(this,f).style.reset(""),e(this,f).main.reset(e(this,M));const t=e(this,$)?e(this,f).renderizers.children.mixed:e(this,f).renderizers.children.normal;e(this,S).forEach(i=>i.rendering&&t(i)),e(this,A).forEach(e(this,f).renderizers.rule),e(this,f).main.verify(i=>!e(this,at).main.compute(i)),e(this,f).style.verify(i=>!e(this,at).style.compute(i))},Nt=new WeakSet,Re=function(){e(this,f).root.process(),e(this,f).style.process(),e(this,f).main.process(),r.DEBUG&&c(this,V,Z).call(this,e(this,f).getDebugInfo())},ae=new WeakSet,ze=function(){!r.RENDERING||(r.MEASURE&&e(this,U).partial.start(),c(this,O,I).call(this,"on_prerender"),c(this,Tt,be).call(this),e(this,f).gotModified()?(c(this,Q,ct).call(this,!1),c(this,Nt,Re).call(this),c(this,Q,ct).call(this,!0),this.info.updatedRounds++,c(this,O,I).call(this,"on_update"),c(this,Ct,ve).call(this,"on_refresh")):this.info.unmodifiedRounds++,r.DEBUG&&c(this,V,Z).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${e(this,at).main.rounds}, style: ${e(this,at).style.rounds}) | updated: ${this.info.updatedRounds}`),c(this,O,I).call(this,"on_postrender"),r.MEASURE&&e(this,U).partial.stop())},vt=new WeakSet,Oe=function(t){c(this,ie,Be).call(this),c(this,se,Ge).call(this),c(this,O,I).call(this,"on_inject"),c(this,Tt,be).call(this),e(this,f).style.verify(i=>!!e(this,j)),c(this,Nt,Re).call(this),c(this,Q,ct).call(this,!0),c(this,O,I).call(this,t)},oe=new WeakSet,Ye=function(t){r.MEASURE&&e(this,U).full.start(),c(this,Q,ct).call(this,!1),c(this,ne,He).call(this),c(this,O,I).call(this,"on_unload"),e(this,pt).call(this),c(this,vt,Oe).call(this,"on_reload"),c(this,Ct,ve).call(this,"on_repaint"),r.MEASURE&&e(this,U).full.stop()},It=new WeakSet,Te=function(t,i="$none"){if(e(this,nt)){const a=r.ReactiveFields.ReplacementsScanners.rules(e(this,A),t);a.forEach(e(this,P));const h=r.ReactiveFields.ReplacementsScanners.children(e(this,S),t);h.forEach(e(this,P)),r.DEBUG&&c(this,V,Z).call(this,`reactive render (label: ${i}, field: ${t}, children: ${h.length}, rules: ${a.length})`),(!!a.length||!!h.length)&&(h.some(l=>!!l.kind.length)&&e(this,S).forEach(l=>l.kind===e(r,y).SLOTS_KIND?e(this,P).call(this,l):void 0),this.render())}},he=new WeakSet,Je=function(t,i,a,h=!0){r.ReactiveFields.make(this,t,i,a,(l,E)=>c(this,It,Te).call(this,l,E||"$auto")),h&&c(this,It,Te).call(this,t,"$init")},Dt=new WeakSet,Ne=function(t,i){delete this[t],window.Object.defineProperty(this,t,{value:i})},O=new WeakSet,I=function(t,i){e(this,ft)[t]&&this[t].call(this,i)},Ct=new WeakSet,ve=function(t,i){e(this,H)&&this.persistToElementsStore(),e(this,ft)[t]&&window.requestAnimationFrame(()=>this[t].call(this,i))},pt=new WeakMap,ce=new WeakSet,Xe=function(){return e(this,H)?(u(this,T,e(this,W).has(e(this,B))?e(this,W).getItem(e(this,B)):{generation:0,persisted:!1}),e(this,T).generation++,c(this,wt,Ht).call(this),!0):!1},wt=new WeakSet,Ht=function(){r.DEBUG&&(e(this,T).key=e(this,B)),e(this,T).persisted=!!e(this,T).data,e(this,W).setItem(e(this,B),e(this,T))},Lt=new WeakSet,Ie=function(){return e(this,H)?!0:(e(r,b).INVALID_KEY.emit(),!1)},d(X,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),d(X,"specializeClass",t=>class extends X{constructor(){super(t)}}),d(X,"instancesCount",0),X)),o(Wuse,z,(ht=class{static registerClasses(s){window.Array.prototype.forEach.call(s,c(e(r,z),de,We))}static instantiateClasses(s,n){window.Array.prototype.forEach.call(s,t=>{var i;return window.customElements.get(t.tag)?c(i=e(r,z),fe,Ze).call(i,t,n):e(r,b).UNREGISTERED_CLASS.emit(t.name)})}},le=new WeakSet,qe=function(s){return s.toLowerCase().replaceAll("_","-")},de=new WeakSet,We=function(s){var n;r.isNonEmptyString(s.name)&&s.name.indexOf("_")>0?s.tag=c(n=e(r,z),le,qe).call(n,s.name):e(r,b).MISNAMED_CLASS.emit(s.name),window.HTMLElement.isPrototypeOf(s)?window.customElements.define(s.tag,s):e(r,b).INVALID_CLASS.emit(s.name)},ue=new WeakSet,Qe=function(s,n){const t=r.isNonEmptyString(n)?window.document.querySelector(n):window.document.body;t&&t.appendChild(window.document.createElement(s.tag))},fe=new WeakSet,Ze=function(s,n){const t=()=>{var i;return c(i=e(r,z),ue,Qe).call(i,s,n)};window.document.body?t():r.WebHelpers.onDOMContentLoaded(t)},o(ht,le),o(ht,de),o(ht,ue),o(ht,fe),ht)),d(Wuse,"NonShadowElement",e(r,N).specializeClass(e(r,N).RootMode.REGULAR)),d(Wuse,"OpenShadowElement",e(r,N).specializeClass(e(r,N).RootMode.OPEN)),d(Wuse,"ClosedShadowElement",e(r,N).specializeClass(e(r,N).RootMode.CLOSED)),(()=>{const s=(n,t)=>!n&&e(r,b).UNSUPPORTED_FEATURE.emit(t);try{s(r.isOf(window.document,window.HTMLDocument),"HTML Document"),s(r.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),r.WebHelpers.onDOMContentLoaded(()=>s(r.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){e(r,b).UNKNOWN_ERROR.emit()}})();
