(()=>{var Ni=Object.defineProperty;var Oi=(p,t,s)=>t in p?Ni(p,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[t]=s;var l=(p,t,s)=>(Oi(p,typeof t!="symbol"?t+"":t,s),s),Pe=(p,t,s)=>{if(!t.has(p))throw TypeError("Cannot "+s)};var i=(p,t,s)=>(Pe(p,t,"read from private field"),s?s.call(p):t.get(p)),r=(p,t,s)=>{if(t.has(p))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(p):t.set(p,s)},u=(p,t,s,e)=>(Pe(p,t,"write to private field"),e?e.call(p,s):t.set(p,s),s);var a=(p,t,s)=>(Pe(p,t,"access private method"),s);var A=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var K=class{static onDOMContentLoaded(t){if(t&&t.constructor===window.Function){let s=()=>{t(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",s),100)};window.addEventListener("DOMContentLoaded",s)}}static getUniqueId(t="WUSE"){let s="_"+(t||"")+"_";for(var e;window.document.getElementById(e=s+(""+window.Math.random()).substring(2))!==null;);return e}static removeChildren(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}static htmlEncode(t=""){return typeof t!="string"?null:t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let t=window.getComputedStyle(window.document.body,""),e=window.Array.prototype.slice.call(t).filter(n=>n.charAt(0)==="-");return e.length?"-"+e[0].split("-")[1]+"-":""}};var ie,Je=(p,t)=>(typeof t=="function"&&t(p),p),f=class{static get EMPTY_ARRAY(){return i(this,ie)}static noop(){}static isNonEmptyString(t){return typeof t=="string"&&!!t.length}static forcedStringSplit(t,s){return typeof t=="string"?t.split(s):new window.Array}static buildArray(t){return Je(new window.Array,t)}static buildObject(t){return Je(new window.Object,t)}static ensureFunction(t,s=()=>{}){return typeof t=="function"?t:s}static isOf(t,s){return t!=null&&(t.constructor===s||s!=null&&t.constructor.name===s.name)}static hasObjectKeys(t){return!!(t&&!!window.Object.keys(t).length)}static isAssignedObject(t){return typeof t=="object"&&t!==null}static isAssignedArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"}static isNonEmptyArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"&&!!t.length}};ie=new WeakMap,r(f,ie,new window.Array);var se,N,je=class{static get UNKNOWN_ERROR(){return i(this,N).call(this,0,t=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return i(this,N).call(this,1,t=>`Unsupported feature: ${t}.`)}static get UNREGISTERED_CLASS(){return i(this,N).call(this,2,t=>`Unregistered class: ${t}.`)}static get UNREGISTRABLE_CLASS(){return i(this,N).call(this,3,t=>`Unregistrable class: ${t}.`)}static get INVALID_CLASS(){return i(this,N).call(this,4,t=>`Invalid class: ${t}.`)}static get MISNAMED_CLASS(){return i(this,N).call(this,5,t=>`Misnamed class: ${t}.`)}static get INVALID_DEFINITION(){return i(this,N).call(this,10,t=>`Invalid definition: ${t}.`)}static get INVALID_ID(){return i(this,N).call(this,11,t=>`Invalid id: ${t}.`)}static get INVALID_KEY(){return i(this,N).call(this,12,t=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return i(this,N).call(this,13,t=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return i(this,N).call(this,20,t=>`Inexistent template: #${t}.`)}static get EXTINCT_TEMPLATE(){return i(this,N).call(this,21,t=>`Extinct template: #${t}.`)}static get INVALID_TEMPLATE(){return i(this,N).call(this,22,t=>`Invalid template: #${t}.`)}static get UNESPECIFIED_SLOT(){return i(this,N).call(this,30,t=>`Unespecified slot: #${t}.`)}},g=je;se=new WeakMap,N=new WeakMap,r(g,se,"[WUSE:ERROR]"),r(g,N,(t,s)=>({code:t,emit:e=>{let n=`${i(je,se)} ${t} | ${s(e)}`;if(Wuse.FATALS||t<10)throw new window.Error(n);return window.console.error(n),null}}));var $t,Pt,jt,_t,wt=class{constructor(t){l(this,"rounds",0);r(this,$t,0);r(this,Pt,null);r(this,jt,!1);r(this,_t,null);u(this,_t,typeof t=="function"?t:()=>{})}compute(t){return this.rounds+=+u(this,jt,i(this,$t)==u(this,Pt,i(this,_t).call(this,t))),u(this,$t,i(this,Pt)),i(this,jt)}};$t=new WeakMap,Pt=new WeakMap,jt=new WeakMap,_t=new WeakMap;var z,Kt,_e,xt=class{constructor(){r(this,Kt);r(this,z,new window.Object)}get length(){return a(this,Kt,_e).call(this).length}key(t){return a(this,Kt,_e).call(this)[t]||null}getItem(t){return i(this,z)[t]}setItem(t,s){i(this,z)[t]=s}removeItem(t){delete i(this,z)[t]}clear(){u(this,z,new window.Object)}hasItem(t){return i(this,z).hasOwnProperty(t)}};z=new WeakMap,Kt=new WeakSet,_e=function(){return window.Object.keys(i(this,z))};var ot,B,Z,ne,Xe,mt=class{constructor(t,s){r(this,ne);r(this,ot,null);r(this,B,null);r(this,Z,null);if(t instanceof Node&&s instanceof Node)u(this,ot,t),u(this,B,s),u(this,Z,s.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return i(this,B)}affiliate(){i(this,ot).appendChild(i(this,B))}disaffiliate(){i(this,ot).removeChild(i(this,B))}promote(t){i(this,Z).innerHTML=t,i(this,ot).replaceChild(i(this,Z),i(this,B)),a(this,ne,Xe).call(this)}};ot=new WeakMap,B=new WeakMap,Z=new WeakMap,ne=new WeakSet,Xe=function(){let t=i(this,Z);u(this,Z,i(this,B).cloneNode(!1)),u(this,B,t)};var at,ht,lt=class{constructor(t){l(this,"owner",null);r(this,at,!1);r(this,ht,"");this.owner=t}get invalidated(){return i(this,at)}reset(t){u(this,at,!1),u(this,ht,t)}append(t){u(this,ht,i(this,ht)+t)}verify(t){u(this,at,t(i(this,ht)))}process(){i(this,at)&&this.on_content_invalidation(i(this,ht))}on_content_invalidation(t){}};at=new WeakMap,ht=new WeakMap;var ce,Qe,qe,he,le,Et,re=p=>p>1e3?(p/1e3).toFixed(2)+"s":p.toFixed(2)+"ms",oe=class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var t=new window.Object;return t.round=this.round,t.domTime=re(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(t.renderTime=re(this.renderTime)),t}},ae=class{constructor(t){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=t}compute(t){this.rounds++,this.time+=t,this.average=this.time/this.rounds}getDebugInfo(){let t=re(this.time),s=re(this.average);return{name:this.name,rounds:this.rounds,spent:t,average:s}}},L=class{static initialize(t){typeof t=="function"&&u(L,Et,t),L.DOMUpdate.overall=new ae("overall-dom-update"),L.BrowserRender.overall=new ae("overall-browser-render")}},O=L;Et=new WeakMap,r(O,Et,()=>{}),l(O,"StopWatch",(qe=class{constructor(){r(this,ce);l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new oe);l(this,"best",new oe);l(this,"averages",{dom:0,render:0})}start(){(L.DOMUpdate.check||L.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(t){var s;L.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,L.DOMUpdate.overall.compute(this.last.domTime)),L.BrowserRender.check?setTimeout(()=>a(this,ce,Qe).bind(this)(t)):t&&i(s=L,Et).call(s,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},ce=new WeakSet,Qe=function(t){var s;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,L.BrowserRender.overall.compute(this.last.renderTime),t&&i(s=L,Et).call(s,this,"finish")},qe)),l(O,"DOMUpdate",(he=class{},l(he,"check",!0),l(he,"overall",null),he)),l(O,"BrowserRender",(le=class{},l(le,"check",!1),l(le,"overall",null),le));var gt,yt,At,St,bt,de,ei,ue,ii,fe,si,pe,ni,{noop:Bt,ensureFunction:ct,isAssignedObject:Ze,isAssignedArray:es,isNonEmptyArray:ti}=f,Ci=p=>p.toLowerCase().replaceAll("_","-"),C=class{static registerClasses(t){ti(t)&&window.Array.prototype.forEach.call(t,s=>typeof s=="function"?a(this,ue,ii).call(this,s):i(this,At).call(this,s))}static instantiateClasses(t,s,e){ti(t)&&window.Array.prototype.forEach.call(t,n=>window.customElements.get(n.tag)?a(this,pe,ni).call(this,n,s,Ze(e)?e:new window.Object):i(this,bt).call(this,n.name))}static initialize(t){Ze(t)&&(u(this,gt,ct(t.onDeferredInstantiation,i(this,gt))),u(this,At,ct(t.onInvalidClass,i(this,At))),u(this,yt,ct(t.onMisnamedClass,i(this,yt))),u(this,St,ct(t.onUnregistrableClass,i(this,St))),u(this,bt,ct(t.onUnregisteredClass,i(this,bt))))}};gt=new WeakMap,yt=new WeakMap,At=new WeakMap,St=new WeakMap,bt=new WeakMap,de=new WeakSet,ei=function(t){window.HTMLElement.isPrototypeOf(t)?window.customElements.define(t.tag,t):i(this,St).call(this,t.name)},ue=new WeakSet,ii=function(t){t.name.indexOf("_")>0?(t.tag=Ci(t.name),a(this,de,ei).call(this,t)):i(this,yt).call(this,t.name)},fe=new WeakSet,si=function(t,s,e){let n=null;try{n=window.document.querySelector(s)}catch(d){if(ct(e.onBadTarget)(s)===!1)return}finally{n=n||window.document.body}let o=window.document.createElement(t.tag);ct(e.onElementInstantiated)(o,s),n.appendChild(o)},pe=new WeakSet,ni=function(t,s,e){let n=()=>a(this,fe,si).call(this,t,s,e);window.document.body?n():i(this,gt).call(this,n)},r(C,de),r(C,ue),r(C,fe),r(C,pe),r(C,gt,Bt),r(C,yt,Bt),r(C,At,Bt),r(C,St,Bt),r(C,bt,Bt);var Tt,It,{noop:ri,ensureFunction:oi,isAssignedObject:vi}=f,tt=class{static fetch(t){let s=window.document.getElementById(t);return s===null?i(this,Tt).call(this,t):s.tagName!=="TEMPLATE"?i(this,It).call(this,t):s.innerHTML}static initialize(t){vi(t)&&(u(this,Tt,oi(t.onExtinctTemplate,i(this,Tt))),u(this,It,oi(t.onInvalidTemplate,i(this,It))))}};Tt=new WeakMap,It=new WeakMap,r(tt,Tt,ri),r(tt,It,ri);var Nt,{noop:Di,isOf:Li,hasObjectKeys:ai,isNonEmptyString:hi,isNonEmptyArray:Ri,isAssignedObject:Ui,ensureFunction:Mi}=f,{htmlEncode:li}=K,{TEMPLATES_KIND:Fi,TEXTNODE_TAG:$i}=A,we=class{static initialize(t){Ui(t)&&u(this,Nt,Mi(t.onFetchTemplate,i(this,Nt)))}},y=we;Nt=new WeakMap,r(y,Nt,Di),l(y,"cacheInvalidator",t=>t.cache=null),l(y,"renderingIncluder",t=>t.rendering=!0),l(y,"renderingExcluder",t=>t.rendering=!1),l(y,"renderRule",(t,s)=>{if(Li(s.nested,window.Array))return`${s.selector}{${s.nested.map(n=>we.renderRule(t,n)).join(`
`)}}`;if(hi(s.selector)&&!s.nested){var e="";for(let n in s.properties)e+=`${n}:${s.properties[n]};`;return Ri(s.replacements)&&s.replacements.forEach(n=>e=t(e,n)),`${s.selector}{${e}}`}return null}),l(y,"renderChild",(t,s)=>{var o;if(s.kind===Fi)return i(o=we,Nt).call(o,s.id);if(s.tag===$i){var e=s.content;return s.replacements.contents.forEach(d=>e=t(e,d)),s.encode?li(e):e}var n=hi(s.id)?`<${s.tag} id='${s.id}'`:`<${s.tag}`;if(s.classes.length){var e=s.classes.join(" ");s.replacements.classes.forEach(c=>e=t(e,c)),n+=` class='${e}'`}if(ai(s.style)){var e=" style='";for(let c in s.style)e+=c+": "+s.style[c]+"; ";e+="'",s.replacements.styles.forEach(c=>e=t(e,c)),n+=e}if(ai(s.attributes)){var e="";for(let c in s.attributes)e+=` ${c}=${s.attributes[c]}`;s.replacements.attributes.forEach(c=>e=t(e,c)),n+=e}if(typeof s.content=="string"){var e=s.content;s.replacements.contents.forEach(c=>e=t(e,c)),n+=`>${s.encode?li(e):e}</${s.tag}>`}else n+="/>";return n});var Gt,me,dt,kt,zt,{EMPTY_ARRAY:Pi,buildArray:xe,buildObject:ji,isNonEmptyString:_i,isOf:xi}=f,Ct=class{static initialize(t,s){this.begin=t,this.end=s}},H=Ct;l(H,"begin",null),l(H,"end",null),l(H,"enclose",t=>Ct.begin+t+Ct.end),l(H,"makeRegExp",()=>new window.RegExp("(?<="+Ct.begin+").*?(?="+Ct.end+")","gs"));var Ki=["contents","classes","styles","attributes"],Ot=class{};l(Ot,"rules",(t,s)=>xe(e=>t.forEach(n=>n.replacements.forEach(o=>o.field===s&&e.push(n))))),l(Ot,"children",(t,s)=>xe(e=>{let n=o=>{let d=c=>c.forEach(S=>S.field===s&&e.push(o));Ki.forEach(c=>d(o.replacements[c])),o.rules.forEach(c=>c.replacements.forEach(S=>S.field===s&&e.push(o)))};t.forEach(o=>o.rendering&&n(o))}));var v=class{static initialize(t){u(this,Gt,t)}},F=v;Gt=new WeakMap,me=new WeakMap,dt=new WeakMap,kt=new WeakMap,zt=new WeakMap,r(F,Gt,null),r(F,me,(t,s,e)=>t.push({at:s,field:e.trim(),find:H.enclose(e)})),r(F,dt,(t,s,e)=>_i(e)&&(e.match(i(v,Gt))||Pi).forEach(n=>{var o;return i(o=v,me).call(o,t,s,n)})),r(F,kt,(t,s,e)=>{var n;t[s]=new window.Array,i(n=v,dt).call(n,t[s],s,e)}),r(F,zt,(t,s,e)=>{t[s]=new window.Array,window.Object.keys(e).forEach(n=>{var o,d;i(o=v,dt).call(o,t[s],s,n),i(d=v,dt).call(d,t[s],s,e[n])})}),l(F,"child",t=>ji(s=>{var e,n,o,d;i(e=v,kt).call(e,s,"contents",t.content),i(n=v,kt).call(n,s,"classes",t.classes.join(" ")),i(o=v,zt).call(o,s,"styles",t.style),i(d=v,zt).call(d,s,"attributes",t.attributes),t.rules.forEach(c=>c.replacements=v.rule(c))})),l(F,"rule",t=>xe(s=>{var n;if(xi(t.nested,window.Array))return t.nested.map(o=>v.rule(o));var e="";for(let o in t.properties)e+=`${o}:${t.properties[o]};`;i(n=v,dt).call(n,s,"rules",e)}));var R=class{static initialize(t,s){H.initialize(t,s),F.initialize(H.makeRegExp())}};l(R,"extractReplacementsFromRule",F.rule),l(R,"extractReplacementsFromChild",F.child),l(R,"scanRulesForReplacements",Ot.rules),l(R,"scanChildrenForReplacements",Ot.children);var Dt,Ee,ci,Ae,et,di,Se,ui,be,fi,Te,pi,Ie,wi,Lt,ge,Ne,Ke,mi,Ht,Oe,Wt,it,_,I,b,G,m,Rt,W,V,st,k,Y,Vt,ft,J,nt,U,X,q,w,Ut,Yt,pt,x,Q,ut,Ce,Ei,ve,gi,De,yi,Le,Ai,rt,vt,Jt,Be,Xt,Ge,qt,ke,Re,Si,Qt,ze,Ue,bi,Zt,He,Me,Ti,D,$,te,We,Mt,Fe,Ii,Ft,ye,ee,Ve,E,$e,M,h=class{static get VERSION(){return"0.4.0"}static blockUpdate(t,s){if(f.isOf(t,Function)){h.DEBUG&&h.debug("blocking"),h.RENDERING=!1;try{t(s)}catch(e){throw e}finally{h.RENDERING=!0,h.DEBUG&&h.debug("unblocking")}}}static debug(t){window.console.log("[WUSE:DEBUG]",t)}static register(t){return C.registerClasses(f.isOf(t,window.Array)?t:new window.Array(t))}static instantiate(t,s,e){return C.instantiateClasses(f.isOf(t,window.Array)?t:new window.Array(t),s,e)}static isShadowElement(t){let s=window.Object.getPrototypeOf(t.constructor);return s===h.OpenShadowElement||s===h.ClosedShadowElement}static get elementCount(){return i(h,M).instancesCount}static makeReactiveField(t,s,e,n,o){let d=(P,j)=>window.Object.defineProperty(t,s,{get:P,set:j,enumerable:!0,configurable:!0}),c=()=>delete t[s],S=(P,j)=>h.makeReactiveField(t,s,P,j,o);d(()=>e,P=>{S(P,n),f.isOf(n,window.Function)?n({renderize:j=>o(s,j),automate:()=>S(P,null),freeze:()=>d(()=>P,j=>{}),defreeze:()=>S(P,n),dereact:()=>d(()=>P,j=>{c(),t[s]=j}),remove:()=>c()}):o(s)})}},T=h;E=new WeakMap,$e=new WeakMap,M=new WeakMap,l(T,"WebHelpers",K),l(T,"JsHelpers",f),l(T,"PerformanceMeasurement",O),l(T,"tmp",new window.Object),l(T,"DEBUG",!1),l(T,"FATALS",!1),l(T,"MEASURE",!1),l(T,"RENDERING",!0),r(T,E,(Ht=class{static makeStyleNode(t,s){var e=window.document.createElement("style");return f.isNonEmptyString(t)&&e.setAttribute("media",t),f.isNonEmptyString(s)&&e.setAttribute("type",s),e.appendChild(window.document.createTextNode("")),e}static newRule(t,s){let e=f.isOf(t,window.Array)?t.join(","):""+t;return e.length?{selector:e,properties:f.isOf(s,window.Object)?s:i(this,Wt).parse(s),cache:null}:null}static newNestedRule(t,s,e){let n=f.isOf(t,window.Array)?t.join(","):""+t,o=f.isOf(s,window.Array)?s.join(","):""+s;return!n.length||!o.length?null:{selector:n,nested:[{selector:o,properties:f.isOf(e,window.Object)?e:i(this,Wt).parse(e)}],cache:null}}static tryToJoinRules(t,s){if(t.selector===s.selector){for(let e in s.properties)t.properties[e]=s.properties[e];return t.cache=null,!0}return!1}static tryToJoinNestedRules(t,s){return f.isOf(t.nested,window.Array)&&t.selector===s.selector?(s.nested.forEach(e=>{var n=!1;for(let o in t.nested)if(n=t.nested[o].selector===e.selector){for(let d in e.properties)t.nested[o].properties[d]=e.properties[d];break}n||t.nested.push(e)}),t.cache=null,!0):!1}static makeMainNode(t){var s=window.document.createElement(t.tag);if(t.id.length&&s.setAttribute("id",t.id),t.classes.length&&s.setAttribute("class",t.classes.join(" ")),f.hasObjectKeys(t.style)){var e="";for(let n in t.style)e+=n+": "+t.style[n]+"; ";if(e.length){let n=e.trim();s.setAttribute("style",n.endsWith(";")?n.slice(0,-1):n)}}if(f.hasObjectKeys(t.attributes))for(let n in t.attributes)s.setAttribute(n,t.attributes[n]);return s}static newEvent(t,s){return typeof t=="string"&&typeof s=="boolean"?{kind:t,capture:s}:null}static performValidations(t){if(t.kind===A.TEMPLATES_KIND){if(!window.document.getElementById(t.id))return g.INEXISTENT_TEMPLATE.emit(t.id)}else if(t.kind===A.SLOTS_KIND){if(new String(t.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return g.UNESPECIFIED_SLOT.emit(t.id)}else if(typeof t.id!="string"||t.id!==""&&window.document.getElementById(t.id)!==null)return g.INVALID_ID.emit(t.id);return t}static newChild(t,s){var e=i(this,Oe).parse(t.trimLeft());return e?(e.rules=f.isOf(s,window.Array)?s:new window.Array,e.rendering=!0,e.cache=null,e):g.INVALID_DEFINITION.emit(t)}static newDefinition(){return{kind:A.DEFAULT_KIND,tag:A.DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},Oe=new WeakMap,Wt=new WeakMap,l(Ht,"PartsHolder",(ci=class extends window.Array{constructor(s){super();r(this,Dt);l(this,"owner",null);l(this,"last",null);l(this,"version",0);this.owner=s}append(s){f.isOf(s,window.Object)&&(this.push(s),a(this,Dt,Ee).call(this,s))}prepend(s){f.isOf(s,window.Object)&&(this.unshift(s),a(this,Dt,Ee).call(this,s))}replace(s,e){s>-1&&f.isOf(e,window.Object)&&a(this,Dt,Ee).call(this,this[s]=e)}on_version_change(){}persist(){let s=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(e=>{switch(e){case"owner":case"last":case"length":break;case"version":s[e]=this[e];break;default:if(window.Number.isInteger(Number(e))){let n=window.Object.assign(new window.Object,this[e]);n.cache&&(n.cache=null),s.push(n)}break}}),s}restore(s){window.Object.getOwnPropertyNames(s).forEach(e=>{switch(e){case"length":break;case"version":this[e]=s[e];break;default:if(window.Number.isInteger(Number(e))){let n=window.Object.assign(new window.Object,s[e]);n.cache&&(n.cache=null),this.push(n)}break}})}},Dt=new WeakSet,Ee=function(s){this.last=s,this.version++,this.on_version_change()},ci)),r(Ht,Oe,(et=class{static parse(t){if(f.isNonEmptyString(t)){var s=i(h,E).newDefinition();return t.charAt(0)==="%"?t.startsWith(A.TEMPLATES_KIND)?a(this,Lt,ge).call(this,s,t.replace(s.kind=A.TEMPLATES_KIND,"")):t.startsWith(A.SLOTS_KIND)?a(this,Lt,ge).call(this,s,t.replace(s.kind=A.SLOTS_KIND,"")):null:a(this,Lt,ge).call(this,s,t)}return null}},Ae=new WeakSet,di=function(t,s){let e=s.indexOf("["),n=s.indexOf("]");if(e>-1&&n>-1&&n>e){let d=s.substr(e,n-e+1),c=d.substr(1,d.length-2).split("|");for(var o in c){let S=c[o].split("=");S[0]==="style"?S[1].split(";").forEach(P=>{let j=P.split(":"),Ye=j[0].trim();Ye.length&&(t.style[Ye]=j[1].trim())}):t.attributes[S[0]]=S[1]}return s.replace(d,"")}return s},Se=new WeakSet,ui=function(t,s){let e=s.indexOf("=");return e>-1?(t.content=s.slice(e+1),!!t.content.length&&t.content.charAt(0)==="&"&&(t.content=t.content.slice(1),t.encode=!!t.content.length&&t.content.charAt(0)!=="&"),s.slice(0,e)):s},be=new WeakSet,fi=function(t,s){let e=s.replaceAll("!"," ").split(" ");return e.slice(1).map(n=>{let[o,...d]=n.toLowerCase().split("+"),c=(d||f.EMPTY_ARRAY).indexOf("capture")>-1;t.events.push(i(h,E).newEvent(o,c))}),e[0]},Te=new WeakSet,pi=function(t,s){let e=s.replaceAll("."," ").split(" ");return t.classes=e.slice(1),e[0]},Ie=new WeakSet,wi=function(t,s){if(s!==""){let e=s.indexOf("#");e===-1?t.tag=s:(e>0&&(t.tag=s.substr(0,e)),t.id=s.substr(e+1))}return t},Lt=new WeakSet,ge=function(t,s){return a(this,Ie,wi).call(this,t,a(this,Te,pi).call(this,t,a(this,be,fi).call(this,t,a(this,Se,ui).call(this,t,a(this,Ae,di).call(this,t,s)))))},r(et,Ae),r(et,Se),r(et,be),r(et,Te),r(et,Ie),r(et,Lt),et)),r(Ht,Wt,(Ke=class{static parse(t){let s=new window.Object;return(f.isOf(t,window.Array)?t:f.forcedStringSplit(t,`
`).map(e=>e.trim()).join("").split(";")).forEach(e=>f.isNonEmptyString(e)&&a(this,Ne,mi).call(this,s,e.trim())),s}},Ne=new WeakSet,mi=function(t,s){if(!!s.length&&s.indexOf(":")>-1){let[e,...n]=s.split(":"),o=e.trim();if(o.length){let d=n.join(":").trim();t[o]=d.endsWith(";")?d.slice(0,-1):d}}},r(Ke,Ne),Ke)),Ht)),r(T,$e,new xt),l(T,"hashRoutine",t=>{var s=0;for(let e=0;e<t.length;e++)s=(s=(s<<5)-s+t.charCodeAt(e))&s;return s}),r(T,M,(it=class extends window.HTMLElement{constructor(e){super();r(this,Q);r(this,Ce);r(this,ve);r(this,De);r(this,Le);r(this,rt);r(this,Jt);r(this,Xt);r(this,qt);r(this,Re);r(this,Qt);r(this,Ue);r(this,Zt);r(this,Me);r(this,D);r(this,te);r(this,Fe);r(this,Ft);r(this,ee);r(this,_,"");r(this,I,new class extends i(h,E).PartsHolder{on_version_change(){var e;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromRule(this.last),h.DEBUG&&a(e=this.owner,Q,ut).call(e,`rules list version change: ${this.version}`)}}(this));r(this,b,new class extends i(h,E).PartsHolder{on_version_change(){var e,n;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromChild(this.last),u(e=this.owner,V,i(e,V)|this.last.kind===A.SLOTS_KIND),h.DEBUG&&a(n=this.owner,Q,ut).call(n,`children list version change: ${this.version}`)}}(this));r(this,G,new class extends i(h,E).PartsHolder{on_version_change(){var e;h.DEBUG&&a(e=this.owner,Q,ut).call(e,`fields list version change: ${this.version}`)}snapshot(){this.forEach(e=>e.value=this.owner[e.name])}recall(){this.forEach(e=>this.owner[e.name]=e.value)}}(this));r(this,m,{mainDefinition:i(h,E).newDefinition(),styleMedia:A.DEFAULT_STYLE_MEDIA,styleType:A.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});r(this,Rt,new window.Object);r(this,W,!1);r(this,V,!1);r(this,st,void 0);r(this,k,void 0);r(this,Y,null);r(this,Vt,h.isShadowElement(this));r(this,ft,!1);r(this,J,!1);r(this,nt,i(h,$e));r(this,U,null);r(this,X,"");r(this,q,!1);r(this,w,{root:new class extends lt{on_content_invalidation(e){this.owner.innerHTML=e}}(this),style:new class extends lt{on_content_invalidation(e){i(this.owner,k).promote(e)}}(this),main:new class extends lt{on_content_invalidation(e){i(this.owner,st).promote(e)}}(this),renderizers:{rule:e=>i(this,w).style.append(e.cache?e.cache:e.cache=y.renderRule(i(this,Ut),e)),children:{mixed:e=>i(this,Vt)&&e.kind===A.SLOTS_KIND?i(this,w).renderizers.children.slot(e):i(this,w).renderizers.children.normal(e),slot:e=>{e.cache||(i(this,w).root.verify(n=>!0),i(this,w).root.append(e.cache=y.renderChild(i(this,Ut),e)))},normal:e=>{i(this,w).main.append(e.cache?e.cache:e.cache=y.renderChild(i(this,Ut),e)),e.rules.forEach(i(this,w).renderizers.rule)}}},gotModified:()=>i(this,w).root.invalidated||i(this,w).main.invalidated||i(this,w).style.invalidated,getDebugInfo:()=>`updated (root: ${i(this,w).root.invalidated}, main: ${i(this,w).main.invalidated}, style: ${i(this,w).style.invalidated})`});r(this,Ut,(e,n)=>e.replace(n.find,this[n.field]!==void 0?this[n.field]:""));r(this,Yt,{bind:{key:()=>{let e=n=>{f.isNonEmptyString(n)&&(this[n]=a(this,Jt,Be).call(this,n))};return i(this,W)&&e(i(this,m).mainDefinition.id),n=>e(n.id)},event:"addEventListener"},unbind:{key:()=>{let e=n=>delete this[n];return i(this,W)&&e(i(this,m).mainDefinition.id),n=>e(n.id)},event:"removeEventListener"}});r(this,pt,{main:new wt(h.hashRoutine),style:new wt(h.hashRoutine)});r(this,x,{attachment:new O.StopWatch,partial:new O.StopWatch,full:new O.StopWatch,dettachment:new O.StopWatch});r(this,Mt,()=>i(h,M).EVENT_NAMES.forEach(e=>i(this,Rt)[e]=typeof this[e]=="function"));l(this,"info",{instanceNumber:++i(h,M).instancesCount,unmodifiedRounds:0,updatedRounds:0});u(this,Y,e!==i(h,M).RootMode.REGULAR?this.attachShadow({mode:e}):this),i(this,Mt).call(this),a(this,D,$).call(this,"on_create"),i(this,m).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),a(this,Fe,Ii).call(this)&&i(this,U).generation>1?a(this,D,$).call(this,"on_reconstruct",i(this,U)):a(this,D,$).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return i(this,J)?a(this,Re,Si):f.noop}get redraw(){return i(this,J)?a(this,Ue,bi):f.noop}connectedCallback(){h.MEASURE&&i(this,x).attachment.start(),i(this,Mt).call(this),a(this,D,$).call(this,"on_connect"),a(this,Qt,ze).call(this,"on_load"),i(this,q)&&this.persistToElementsStore(),h.MEASURE&&i(this,x).attachment.stop(h.DEBUG)}disconnectedCallback(){h.MEASURE&&i(this,x).dettachment.start(),a(this,rt,vt).call(this,!1),a(this,D,$).call(this,"on_disconnect"),h.MEASURE&&i(this,x).dettachment.stop(h.DEBUG)}getElementsStore(){return i(this,nt)}setElementsStore(e){u(this,nt,e)}hasElementsStoreKey(e){return i(this,q)}getElementsStoreKey(e){return i(this,X)}setElementsStoreKey(e){return u(this,q,f.isNonEmptyString(u(this,X,e))),this}persistToElementsStore(){if(a(this,ee,Ve).call(this)){let e=i(this,U);if(e)return i(this,G).snapshot(),e.data=new window.Object({options:i(this,m),html:i(this,_),children:i(this,b).persist(),rules:i(this,I).persist(),fields:i(this,G).persist(),slotted:i(this,V),identified:i(this,W)}),a(this,Ft,ye).call(this),!0}return!1}restoreFromElementsStore(e){if(a(this,ee,Ve).call(this)){let n=i(this,U);if(n&&n.persisted&&n.data)return u(this,m,n.data.options),u(this,V,n.data.slotted),u(this,W,n.data.identified),u(this,_,n.data.html),i(this,b).restore(n.data.children),i(this,b).owner=this,i(this,I).restore(n.data.rules),i(this,I).owner=this,i(this,G).restore(n.data.fields),i(this,G).owner=this,i(this,G).recall(),e||(delete n.data,a(this,Ft,ye).call(this)),!0}return!1}selectChildElement(e){return i(this,Y).querySelector(e)}setMainAttribute(e,n){i(this,ft)&&i(this,st).element.setAttribute(e,n)}setMainElement(e){let n=i(h,E).newChild(e);if(i(h,E).performValidations(n)){if(n.content!==""||!!n.events.length)return g.INVALID_DEFINITION.emit(e);u(this,W,!!n.id.length)&&(i(this,m).mainDefinition.id=n.id),n.tag.length&&(i(this,m).mainDefinition.tag=n.tag),n.classes.length&&(i(this,m).mainDefinition.classes=n.classes),n.style&&(i(this,m).mainDefinition.style=n.style),n.attributes&&(i(this,m).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(e,n){return i(this,m).styleMedia=e||"",i(this,m).styleType=n||"",this}setElementsAsKeys(e){return i(this,m).elementKeys=!!e,this}setAttributesAsKeys(e){return i(this,m).attributeKeys=!!e,this}allowRawContent(e){return i(this,m).rawContent=!!e,this}setRawContent(e){return i(this,m).rawContent?u(this,_,e):g.ALLOW_HTML.emit(),this}appendRawContent(e){return i(this,m).rawContent?u(this,_,i(this,_)+e):g.ALLOW_HTML.emit(),this}prependRawContent(e){return i(this,m).rawContent?u(this,_,e+i(this,_)):g.ALLOW_HTML.emit(),this}appendCSSRule(e,n,o){if(o)return this.appendCSSNestedRule(e,n,o);let d=i(this,I).slice(-1),c=i(h,E).newRule(e,n);return(!d.length||!i(h,E).tryToJoinRules(d[0],c))&&i(this,I).append(c),this}prependCSSRule(e,n,o){if(o)return this.prependCSSNestedRule(e,n,o);let d=i(this,I).slice(0,1),c=i(h,E).newRule(e,n);return(!d.length||!i(h,E).tryToJoinRules(d[0],c))&&i(this,I).prepend(c),this}appendCSSNestedRule(e,n,o){let d=i(this,I).slice(-1),c=i(h,E).newNestedRule(e,n,o);return(!d.length||!i(h,E).tryToJoinNestedRules(d[0],c))&&i(this,I).append(c),this}prependCSSNestedRule(e,n,o){let d=i(this,I).slice(0,1),c=i(h,E).newNestedRule(e,n,o);return(!d.length||!i(h,E).tryToJoinNestedRules(d[0],c))&&i(this,I).prepend(c),this}appendChildElement(e,n){return i(this,b).append(i(h,E).performValidations(i(h,E).newChild(e,n))),this}prependChildElement(e,n){return i(this,b).prepend(i(h,E).performValidations(i(h,E).newChild(e,n))),this}replaceChildElement(e,n){return i(this,b).replace(i(this,b).findIndex(o=>o.id===e),i(h,E).newChild(n)),this}appendChildElements(e){return(f.isOf(e,window.Array)?e:f.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(e){return(f.isOf(e,window.Array)?e:f.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}checkChildElementIsIncludedById(e,n,o){let d=c=>f.isOf(c,window.Function)?c():void 0;return i(this,b).some(c=>c.id===e&&c.rendering)?d(n):d(o),this}includeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingIncluder(n)),this}excludeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingExcluder(n)),this}invalidateChildElementsById(e){return i(this,b).forEach(n=>e.indexOf(n.id)>-1&&y.cacheInvalidator(n)),this}invalidateChildElements(e){return f.isOf(e,window.Array)&&e.forEach(y.cacheInvalidator),this}makeField(e,n){return this[e]=n,i(this,G).append({name:e,value:n}),this}makeReactiveField(e,n,o,d=!0){return a(this,Me,Ti).call(this,e,n,o,d)}makeExternalReactiveField(e,n,o,d,c=!0){return this.makeReactiveField(n,e[n]||o,S=>{e[n]=this[n],d(S)},c)}},_=new WeakMap,I=new WeakMap,b=new WeakMap,G=new WeakMap,m=new WeakMap,Rt=new WeakMap,W=new WeakMap,V=new WeakMap,st=new WeakMap,k=new WeakMap,Y=new WeakMap,Vt=new WeakMap,ft=new WeakMap,J=new WeakMap,nt=new WeakMap,U=new WeakMap,X=new WeakMap,q=new WeakMap,w=new WeakMap,Ut=new WeakMap,Yt=new WeakMap,pt=new WeakMap,x=new WeakMap,Q=new WeakSet,ut=function(e){i(this,W)&&h.debug(`#${i(this,m).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`)},Ce=new WeakSet,Ei=function(){i(this,k)&&i(this,k).affiliate(),i(this,st).affiliate(),u(this,ft,!0)},ve=new WeakSet,gi=function(){u(this,k,i(this,I).length?new mt(i(this,Y),i(h,E).makeStyleNode(i(this,m).styleMedia,i(this,m).styleType)):null),u(this,st,new mt(i(this,Y),i(h,E).makeMainNode(i(this,m).mainDefinition))),i(this,b).forEach(y.cacheInvalidator),i(this,I).forEach(y.cacheInvalidator)},De=new WeakSet,yi=function(){i(this,ft)&&(i(this,st).disaffiliate(),i(this,k)&&i(this,k).disaffiliate(),i(this,V)&&i(this,Vt)&&K.removeChildren(this)),u(this,ft,!1)},Le=new WeakSet,Ai=function(e){return{key:i(this,m).elementKeys&&e.key(),event:(n,o,d)=>{let c=this[`on_${n}_${o}`];if(c){let S=a(this,Jt,Be).call(this,n);S&&S[e.event](o,c,d)}},slots:()=>this.on_slot_change&&i(this,Y).querySelectorAll("slot").forEach(n=>n[e.event]("slotchange",this.on_slot_change))}},rt=new WeakSet,vt=function(e){if(i(this,J)&&!e||!i(this,J)&&e){let n=a(this,Le,Ai).call(this,e?i(this,Yt).bind:i(this,Yt).unbind);i(this,b).forEach(o=>{!o.rendering&&e||(n.key&&n.key(o),o.events.forEach(d=>d&&n.event(o.id,d.kind,d.capture)))}),i(this,V)&&n.slots(),u(this,J,e)}},Jt=new WeakSet,Be=function(e){return f.isNonEmptyString(e)?i(this,Y).querySelector(`#${e}`):void 0},Xt=new WeakSet,Ge=function(){i(this,w).root.reset(""),i(this,w).style.reset(""),i(this,w).main.reset(i(this,_));let e=i(this,V)?i(this,w).renderizers.children.mixed:i(this,w).renderizers.children.normal;i(this,b).forEach(n=>n.rendering&&e(n)),i(this,I).forEach(i(this,w).renderizers.rule),i(this,w).main.verify(n=>!i(this,pt).main.compute(n)),i(this,w).style.verify(n=>!i(this,pt).style.compute(n))},qt=new WeakSet,ke=function(){i(this,w).root.process(),i(this,w).style.process(),i(this,w).main.process(),h.DEBUG&&a(this,Q,ut).call(this,i(this,w).getDebugInfo())},Re=new WeakSet,Si=function(){!h.RENDERING||(h.MEASURE&&i(this,x).partial.start(),a(this,D,$).call(this,"on_prerender"),a(this,Xt,Ge).call(this),i(this,w).gotModified()?(a(this,rt,vt).call(this,!1),a(this,qt,ke).call(this),a(this,rt,vt).call(this,!0),this.info.updatedRounds++,a(this,D,$).call(this,"on_update"),a(this,te,We).call(this,"on_refresh")):this.info.unmodifiedRounds++,h.DEBUG&&a(this,Q,ut).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${i(this,pt).main.rounds}, style: ${i(this,pt).style.rounds}) | updated: ${this.info.updatedRounds}`),a(this,D,$).call(this,"on_postrender"),h.MEASURE&&i(this,x).partial.stop(h.DEBUG))},Qt=new WeakSet,ze=function(e){a(this,ve,gi).call(this),a(this,Ce,Ei).call(this),a(this,D,$).call(this,"on_inject"),a(this,Xt,Ge).call(this),i(this,w).style.verify(n=>!!i(this,k)),a(this,qt,ke).call(this),a(this,rt,vt).call(this,!0),a(this,D,$).call(this,e)},Ue=new WeakSet,bi=function(){h.MEASURE&&i(this,x).full.start(),a(this,rt,vt).call(this,!1),a(this,De,yi).call(this),a(this,D,$).call(this,"on_unload"),i(this,Mt).call(this),a(this,Qt,ze).call(this,"on_reload"),a(this,te,We).call(this,"on_repaint"),h.MEASURE&&i(this,x).full.stop(h.DEBUG)},Zt=new WeakSet,He=function(e,n="$none"){if(i(this,J)){let o=R.scanRulesForReplacements(i(this,I),e);o.forEach(y.cacheInvalidator);let d=R.scanChildrenForReplacements(i(this,b),e);d.forEach(y.cacheInvalidator),h.DEBUG&&a(this,Q,ut).call(this,`reactive render (label: ${n}, field: ${e}, children: ${d.length}, rules: ${o.length})`),(!!o.length||!!d.length)&&(d.some(c=>!!c.kind.length)&&i(this,b).forEach(c=>c.kind===A.SLOTS_KIND?y.cacheInvalidator(c):void 0),this.render())}},Me=new WeakSet,Ti=function(e,n,o,d=!0){return h.makeReactiveField(this,e,n,o,(c,S)=>a(this,Zt,He).call(this,c,S||"$auto")),i(this,G).append({name:e,value:n}),d&&a(this,Zt,He).call(this,e,"$init"),this},D=new WeakSet,$=function(e,n){i(this,Rt)[e]&&this[e].call(this,n)},te=new WeakSet,We=function(e,n){i(this,q)&&this.persistToElementsStore(),i(this,Rt)[e]&&window.requestAnimationFrame(()=>this[e].call(this,n))},Mt=new WeakMap,Fe=new WeakSet,Ii=function(){return i(this,q)?(u(this,U,i(this,nt).hasItem(i(this,X))?i(this,nt).getItem(i(this,X)):{generation:0,persisted:!1}),i(this,U).generation++,a(this,Ft,ye).call(this),!0):!1},Ft=new WeakSet,ye=function(){h.DEBUG&&(i(this,U).key=i(this,X)),i(this,U).persisted=!!i(this,U).data,i(this,nt).setItem(i(this,X),i(this,U))},ee=new WeakSet,Ve=function(){return i(this,q)?!0:(g.INVALID_KEY.emit(),!1)},l(it,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),l(it,"specializeClass",e=>class extends it{constructor(){super(e)}}),l(it,"instancesCount",0),it)),l(T,"NonShadowElement",i(h,M).specializeClass(i(h,M).RootMode.REGULAR)),l(T,"OpenShadowElement",i(h,M).specializeClass(i(h,M).RootMode.OPEN)),l(T,"ClosedShadowElement",i(h,M).specializeClass(i(h,M).RootMode.CLOSED)),(()=>{let t=(s,e)=>!s&&g.UNSUPPORTED_FEATURE.emit(e);try{t(f.isOf(window.document,window.HTMLDocument),"HTML Document"),t(f.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),K.onDOMContentLoaded(()=>t(f.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(s){g.UNKNOWN_ERROR.emit()}O.initialize((s,e)=>h.debug(JSON.stringify(f.buildArray(n=>{switch(n.push({instances:h.elementCount}),n.push(s.getDebugInfo()),e){case"stop":n.push(O.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(O.BrowserRender.overall.getDebugInfo());break}})))),C.initialize({onMisnamedClass:g.MISNAMED_CLASS.emit,onUnregistrableClass:g.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:g.UNREGISTERED_CLASS.emit,onInvalidClass:g.INVALID_CLASS.emit,onDeferredInstantiation:K.onDOMContentLoaded}),tt.initialize({onExtinctTemplate:g.EXTINCT_TEMPLATE.emit,onInvalidTemplate:g.INVALID_TEMPLATE.emit}),y.initialize({onFetchTemplate:tt.fetch}),R.initialize(A.DEFAULT_REPLACEMENT_OPEN,A.DEFAULT_REPLACEMENT_CLOSE)})(),window.Wuse=T;})();
