(()=>{var ds=Object.defineProperty;var us=(E,s,n)=>s in E?ds(E,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):E[s]=n;var l=(E,s,n)=>(us(E,typeof s!="symbol"?s+"":s,n),n),Ce=(E,s,n)=>{if(!s.has(E))throw TypeError("Cannot "+n)};var e=(E,s,n)=>(Ce(E,s,"read from private field"),n?n.call(E):s.get(E)),o=(E,s,n)=>{if(s.has(E))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(E):s.set(E,n)},f=(E,s,n,t)=>(Ce(E,s,"write to private field"),t?t.call(E,n):s.set(E,n),n);var h=(E,s,n)=>(Ce(E,s,"access private method"),n);var bt=class{static onDOMContentLoaded(s){if(s&&s.constructor===window.Function){let n=()=>{s(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",n),100)};window.addEventListener("DOMContentLoaded",n)}}static getUniqueId(s="WUSE"){let n="_"+(s||"")+"_";for(var t;window.document.getElementById(t=n+(""+window.Math.random()).substring(2))!==null;);return t}static removeChildren(s){if(s)for(;s.firstChild;)s.removeChild(s.firstChild)}static htmlEncode(s=""){return typeof s=="string"?s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):null}static getCSSVendorPrefix(){let s=window.getComputedStyle(window.document.body,""),t=window.Array.prototype.slice.call(s).filter(i=>i.charAt(0)==="-");return t.length?"-"+t[0].split("-")[1]+"-":""}};var Yt,O,De=class{static get UNKNOWN_ERROR(){return e(this,O).call(this,0,s=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return e(this,O).call(this,1,s=>`Unsupported feature: ${s}.`)}static get UNREGISTERED_CLASS(){return e(this,O).call(this,2,s=>`Unregistered class: ${s}.`)}static get INVALID_CLASS(){return e(this,O).call(this,3,s=>`Invalid class: ${s}.`)}static get MISNAMED_CLASS(){return e(this,O).call(this,4,s=>`Misnamed class: ${s}.`)}static get INVALID_DEFINITION(){return e(this,O).call(this,10,s=>`Invalid definition: ${s}.`)}static get INVALID_ID(){return e(this,O).call(this,11,s=>`Invalid id: ${s}.`)}static get INVALID_KEY(){return e(this,O).call(this,12,s=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return e(this,O).call(this,13,s=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return e(this,O).call(this,20,s=>`Inexistent template: #${s}.`)}static get EXTINCT_TEMPLATE(){return e(this,O).call(this,21,s=>`Extinct template: #${s}.`)}static get INVALID_TEMPLATE(){return e(this,O).call(this,22,s=>`Invalid template: #${s}.`)}static get UNESPECIFIED_SLOT(){return e(this,O).call(this,30,s=>`Unespecified slot: #${s}.`)}},_=De;Yt=new WeakMap,O=new WeakMap,o(_,Yt,"[WUSE:ERROR]"),o(_,O,(s,n)=>({code:s,emit:t=>{let i=`${e(De,Yt)} ${s} | ${n(t)}`;if(Wuse.FATALS||s<10)throw new window.Error(i);return window.console.error(i),null}}));var At,Tt,Ot,Rt,dt=class{constructor(s){l(this,"rounds",0);o(this,At,0);o(this,Tt,null);o(this,Ot,!1);o(this,Rt,null);f(this,Rt,typeof s=="function"?s:()=>{})}compute(s){return this.rounds+=+f(this,Ot,e(this,At)==f(this,Tt,e(this,Rt).call(this,s))),f(this,At,e(this,Tt)),e(this,Ot)}};At=new WeakMap,Tt=new WeakMap,Ot=new WeakMap,Rt=new WeakMap;var k,vt,Le,Nt=class{constructor(){o(this,vt);o(this,k,new window.Object)}get length(){return h(this,vt,Le).call(this).length}key(s){return h(this,vt,Le).call(this)[s]||null}getItem(s){return e(this,k)[s]}setItem(s,n){e(this,k)[s]=n}removeItem(s){delete e(this,k)[s]}clear(){f(this,k,new window.Object)}has(s){return e(this,k).hasOwnProperty(s)}};k=new WeakMap,vt=new WeakSet,Le=function(){return window.Object.keys(e(this,k))};var ie,W,Je,ne,We,re,Ye,ae,Xe,oe,qe,pt,te,he,Me,Qe,Xt,ce,Dt,qt,Qt,Zt,M,wt,ee,He,C,_t,y,mt,le,de,et,Lt,Mt,It,st,x,Y,ue,Ze,Ve,it,nt,ze,X,U,T,b,P,m,Et,K,B,q,j,G,Ut,rt,at,Q,N,H,V,p,Ft,fe,$,pe,we,ot,ht,F,xt,Fe,z,tt,me,_e,Ee,ts,ge,es,ye,ss,Z,ft,Pt,xe,jt,Pe,$t,je,Se,is,kt,$e,be,ns,Kt,ke,Ae,rs,ct,Ct,R,I,Bt,Ke,gt,Te,as,yt,se,Gt,Be,Oe,ut,os,Re,hs,Ne,cs,ve,ls,A,Ht,Ue,Vt,g,Ie,lt,zt,Jt,S,Wt,St,v,J,r=class{static get VERSION(){return"0.3.4"}static blockUpdate(s,n){if(r.isOf(s,Function)){r.DEBUG&&r.debug("blocking"),r.RENDERING=!1;try{s(n)}catch(t){throw t}finally{r.RENDERING=!0,r.DEBUG&&r.debug("unblocking")}}}static debug(s){window.console.log("[WUSE:DEBUG]",s)}static isOf(s,n){return!!(s&&s.constructor===n)}static isNonEmptyString(s){return typeof s=="string"&&!!s.length}static forcedStringSplit(s,n){return typeof s=="string"?s.split(n):new window.Array}static hasObjectKeys(s){return!!window.Object.keys(s).length}static buildArray(s){var n;return h(n=r,Ht,Ue).call(n,new window.Array,s)}static buildObject(s){var n;return h(n=r,Ht,Ue).call(n,new window.Object,s)}static register(s){return e(r,J).registerClasses(r.isOf(s,window.Array)?s:new window.Array(s))}static instantiate(s,n){return e(r,J).instantiateClasses(r.isOf(s,window.Array)?s:new window.Array(s),n)}static isShadowElement(s){let n=window.Object.getPrototypeOf(s.constructor);return n===r.OpenShadowElement||n===r.ClosedShadowElement}},w=r;A=new WeakMap,Ht=new WeakSet,Ue=function(s,n){return r.isOf(n,window.Function)&&n(s),s},Vt=new WeakMap,g=new WeakMap,Ie=new WeakMap,lt=new WeakMap,zt=new WeakMap,Jt=new WeakMap,S=new WeakMap,Wt=new WeakMap,St=new WeakMap,v=new WeakMap,J=new WeakMap,o(w,Ht),o(w,A,_),l(w,"WebHelpers",bt),l(w,"tmp",new window.Object),l(w,"DEBUG",!1),l(w,"FATALS",!1),l(w,"MEASURE",!1),l(w,"RENDERING",!0),o(w,Vt,new window.Array),o(w,g,(Xt=class{static makeStyleNode(s,n){var t=window.document.createElement("style");return r.isNonEmptyString(s)&&t.setAttribute("media",s),r.isNonEmptyString(n)&&t.setAttribute("type",n),t.appendChild(window.document.createTextNode("")),t}static newRule(s,n){let t=r.isOf(s,window.Array)?s.join(","):""+s,i=r.isOf(n,window.Object)?n:e(this,Dt).parse(n);return t.length?{selector:t,properties:i,cache:null}:null}static newNestedRule(s,n,t){let i=r.isOf(s,window.Array)?s.join(","):""+s,a=r.isOf(n,window.Array)?n.join(","):""+n,c=r.isOf(t,window.Object)?t:e(this,Dt).parse(t);return!i.length||!a.length?null:{selector:i,nested:[{selector:a,properties:c}],cache:null}}static tryToJoinRules(s,n){if(s.selector===n.selector){for(let t in n.properties)s.properties[t]=n.properties[t];return s.cache=null,!0}return!1}static tryToJoinNestedRules(s,n){return r.isOf(s.nested,window.Array)&&s.selector===n.selector?(n.nested.forEach(t=>{var i=!1;for(let a in s.nested)if(i=s.nested[a].selector===t.selector){for(let c in t.properties)s.nested[a].properties[c]=t.properties[c];break}i||s.nested.push(t)}),s.cache=null,!0):!1}static makeMainNode(s){var n=window.document.createElement(s.tag);if(s.id.length&&n.setAttribute("id",s.id),s.classes.length&&n.setAttribute("class",s.classes.join(" ")),r.hasObjectKeys(s.style)){var t="";for(let i in s.style)t+=i+": "+s.style[i]+"; ";if(t.length){let i=t.trim();n.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(r.hasObjectKeys(s.attributes))for(let i in s.attributes)n.setAttribute(i,s.attributes[i]);return n}static newEvent(s,n){return typeof s=="string"&&typeof n=="boolean"?{kind:s,capture:n}:null}static performValidations(s){if(s.kind===e(r,S).TEMPLATES_KIND){if(!window.document.getElementById(s.id))return e(r,A).INEXISTENT_TEMPLATE.emit(s.id)}else if(s.kind===e(r,S).SLOTS_KIND){if(new String(s.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return e(r,A).UNESPECIFIED_SLOT.emit(s.id)}else if(typeof s.id!="string"||s.id!==""&&window.document.getElementById(s.id)!==null)return e(r,A).INVALID_ID.emit(s.id);return s}static newChild(s,n){var t=e(this,ce).parse(s.trimLeft());return t?(t.rules=r.isOf(n,window.Array)?n:new window.Array,t.rendering=!0,t.cache=null,t):e(r,A).INVALID_DEFINITION.emit(s)}static newDefinition(){return{kind:e(r,S).DEFAULT_KIND,tag:e(r,S).DEFAULT_TAG,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}}},ce=new WeakMap,Dt=new WeakMap,o(Xt,ce,(W=class{static parse(s){if(r.isNonEmptyString(s)){var n=e(r,g).newDefinition();return s.charAt(0)==="%"?s.startsWith(e(r,S).TEMPLATES_KIND)?h(this,pt,te).call(this,n,s.replace(n.kind=e(r,S).TEMPLATES_KIND,"")):s.startsWith(e(r,S).SLOTS_KIND)?h(this,pt,te).call(this,n,s.replace(n.kind=e(r,S).SLOTS_KIND,"")):null:h(this,pt,te).call(this,n,s)}return null}},ie=new WeakSet,Je=function(s,n){let t=n.indexOf("["),i=n.indexOf("]");if(t>-1&&i>-1&&i>t){let c=n.substr(t,i-t+1),d=c.substr(1,c.length-2).split("|");for(var a in d){let u=d[a].split("=");u[0]==="style"?u[1].split(";").forEach(D=>{let L=D.split(":"),Ge=L[0].trim();Ge.length&&(s.style[Ge]=L[1].trim())}):s.attributes[u[0]]=u[1]}return n.replace(c,"")}return n},ne=new WeakSet,We=function(s,n){let t=n.indexOf("=");return t>-1?(s.content=n.slice(t+1),!!s.content.length&&s.content.charAt(0)==="&"&&(s.content=s.content.slice(1),s.encode=!!s.content.length&&s.content.charAt(0)!=="&"),n.slice(0,t)):n},re=new WeakSet,Ye=function(s,n){let t=n.replaceAll("!"," ").split(" ");return t.slice(1).map(i=>{let[a,...c]=i.toLowerCase().split("+"),d=(c||e(r,Vt)).indexOf("capture")>-1;s.events.push(e(r,g).newEvent(a,d))}),t[0]},ae=new WeakSet,Xe=function(s,n){let t=n.replaceAll("."," ").split(" ");return s.classes=t.slice(1),t[0]},oe=new WeakSet,qe=function(s,n){if(n!==""){let t=n.indexOf("#");t===-1?s.tag=n:(t>0&&(s.tag=n.substr(0,t)),s.id=n.substr(t+1))}return s},pt=new WeakSet,te=function(s,n){return h(this,oe,qe).call(this,s,h(this,ae,Xe).call(this,s,h(this,re,Ye).call(this,s,h(this,ne,We).call(this,s,h(this,ie,Je).call(this,s,n)))))},o(W,ie),o(W,ne),o(W,re),o(W,ae),o(W,oe),o(W,pt),W)),o(Xt,Dt,(Me=class{static parse(s){let n=new window.Object;return(r.isOf(s,window.Array)?s:r.forcedStringSplit(s,`
`).map(t=>t.trim()).join("").split(";")).forEach(t=>r.isNonEmptyString(t)&&h(this,he,Qe).call(this,n,t.trim())),n}},he=new WeakSet,Qe=function(s,n){if(!!n.length&&n.indexOf(":")>-1){let[t,...i]=n.split(":"),a=t.trim();if(a.length){let c=i.join(":").trim();s[a]=c.endsWith(";")?c.slice(0,-1):c}}},o(Me,he),Me)),Xt)),o(w,Ie,new Nt),o(w,lt,s=>s>1e3?(s/1e3).toFixed(2)+"s":s.toFixed(2)+"ms"),o(w,zt,class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var n,t;var s=new window.Object;return s.round=this.round,s.domTime=e(n=r,lt).call(n,this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(s.renderTime=e(t=r,lt).call(t,this.renderTime)),s}}),o(w,Jt,class{constructor(s){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=s}compute(s){this.rounds++,this.time+=s,this.average=this.time/this.rounds}getDebugInfo(){var t,i;let s=e(t=r,lt).call(t,this.time),n=e(i=r,lt).call(i,this.average);return{name:this.name,rounds:this.rounds,spent:s,average:n}}}),l(w,"StopWatch",(Zt=class{constructor(){l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new(e(r,zt)));l(this,"best",new(e(r,zt)));l(this,"averages",{dom:0,render:0})}start(){(r.StopWatch.DOMUpdate.check||r.StopWatch.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(){r.StopWatch.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,r.StopWatch.DOMUpdate.overall.compute(this.last.domTime)),r.StopWatch.BrowserRender.check?setTimeout(this.finish.bind(this)):r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.DOMUpdate.overall.getDebugInfo()))}finish(){this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,r.StopWatch.BrowserRender.overall.compute(this.last.renderTime),r.DEBUG&&r.debug(JSON.stringify(this.getDebugInfo()),JSON.stringify(r.StopWatch.BrowserRender.overall.getDebugInfo()))}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages,instances:e(r,v).instancesCount}}},l(Zt,"DOMUpdate",(qt=class{},l(qt,"check",!0),l(qt,"overall",new(e(r,Jt))("overall-dom-update")),qt)),l(Zt,"BrowserRender",(Qt=class{},l(Qt,"check",!1),l(Qt,"overall",new(e(r,Jt))("overall-browser-render")),Qt)),Zt)),l(w,"hashRoutine",s=>{var n=0;for(let t=0;t<s.length;t++)n=(n=(n<<5)-n+s.charCodeAt(t))&n;return n}),o(w,S,(M=class{},l(M,"TEMPLATES_KIND","%templates%"),l(M,"SLOTS_KIND","%slots%"),l(M,"TEXTNODE_TAG","^text^"),l(M,"DEFAULT_KIND",""),l(M,"DEFAULT_TAG","div"),l(M,"DEFAULT_STYLE_MEDIA","screen"),l(M,"DEFAULT_STYLE_TYPE","text/css"),l(M,"DEFAULT_REPLACEMENT_OPEN","~{"),l(M,"DEFAULT_REPLACEMENT_CLOSE","}~"),M)),l(w,"ObjectsArray",(He=class extends window.Array{constructor(n){super();o(this,wt);l(this,"owner",null);l(this,"last",null);l(this,"version",0);this.owner=n}append(n){r.isOf(n,window.Object)&&(this.push(n),h(this,wt,ee).call(this,n))}prepend(n){r.isOf(n,window.Object)&&(this.unshift(n),h(this,wt,ee).call(this,n))}replace(n,t){n>-1&&r.isOf(t,window.Object)&&h(this,wt,ee).call(this,this[n]=t)}on_version_change(){}persist(){let n=new window.Array;return window.Object.getOwnPropertyNames(this).forEach(t=>{switch(t){case"owner":case"last":case"length":break;case"version":n[t]=this[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,this[t]);i.cache&&(i.cache=null),n.push(i)}break}}),n}restore(n){window.Object.getOwnPropertyNames(n).forEach(t=>{switch(t){case"length":break;case"version":this[t]=n[t];break;default:if(window.Number.isInteger(Number(t))){let i=window.Object.assign(new window.Object,n[t]);i.cache&&(i.cache=null),this.push(i)}break}})}},wt=new WeakSet,ee=function(n){this.last=n,this.version++,this.on_version_change()},He)),l(w,"ReactiveFields",(It=class{static make(s,n,t,i,a){let c=(D,L)=>window.Object.defineProperty(s,n,{get:D,set:L,enumerable:!0,configurable:!0}),d=()=>delete s[n],u=(D,L)=>this.make(s,n,D,L,a);c(()=>t,D=>{u(D,i),r.isOf(i,window.Function)?i({renderize:L=>a(n,L),automate:()=>u(D,null),freeze:()=>c(()=>D,L=>{}),defreeze:()=>u(D,i),dereact:()=>c(()=>D,L=>{d(),s[n]=L}),remove:()=>d()}):a(n)})}},l(It,"ReplacementMarkers",(C=class{},l(C,"begin",e(r,S).DEFAULT_REPLACEMENT_OPEN),l(C,"end",e(r,S).DEFAULT_REPLACEMENT_CLOSE),l(C,"enclose",n=>C.begin+n+C.end),l(C,"makeRegExp",()=>new RegExp("(?<="+C.begin+").*?(?="+C.end+")","gs")),C)),l(It,"ReplacementsScanners",(_t=class{},l(_t,"rules",(s,n)=>r.buildArray(t=>s.forEach(i=>i.replacements.forEach(a=>a.field===n&&t.push(i))))),l(_t,"children",(s,n)=>r.buildArray(t=>{let i=a=>{let c=d=>d.forEach(u=>u.field===n&&t.push(a));["contents","classes","styles","attributes"].forEach(d=>c(a.replacements[d])),a.rules.forEach(d=>d.replacements.forEach(u=>u.field===n&&t.push(a)))};s.forEach(a=>a.rendering&&i(a))})),_t)),l(It,"ReplacementsExtractors",(y=class{},mt=new WeakMap,le=new WeakMap,de=new WeakMap,et=new WeakMap,Lt=new WeakMap,Mt=new WeakMap,o(y,mt,null),o(y,le,n=>n.match(e(y,mt)?e(y,mt):f(y,mt,r.ReactiveFields.ReplacementMarkers.makeRegExp()))),o(y,de,(n,t,i)=>n.push({at:t,find:r.ReactiveFields.ReplacementMarkers.enclose(i),field:i.trim()})),o(y,et,(n,t,i)=>{var a;return r.isNonEmptyString(i)&&(e(a=y,le).call(a,i)||e(r,Vt)).forEach(c=>{var d;return e(d=y,de).call(d,n,t,c)})}),o(y,Lt,(n,t,i)=>{var a;n[t]=new window.Array,e(a=y,et).call(a,n[t],t,i)}),o(y,Mt,(n,t,i)=>{n[t]=new window.Array,window.Object.keys(i).forEach(a=>{var c,d;e(c=r.ReactiveFields.ReplacementsExtractors,et).call(c,n[t],t,a),e(d=r.ReactiveFields.ReplacementsExtractors,et).call(d,n[t],t,i[a])})}),l(y,"child",n=>r.buildObject(t=>{var i,a,c,d;e(i=y,Lt).call(i,t,"contents",n.content),e(a=y,Lt).call(a,t,"classes",n.classes.join(" ")),e(c=y,Mt).call(c,t,"styles",n.style),e(d=y,Mt).call(d,t,"attributes",n.attributes),n.rules.forEach(u=>u.replacements=r.ReactiveFields.ReplacementsExtractors.rule(u))})),l(y,"rule",n=>r.buildArray(t=>{var a;if(r.isOf(n.nested,window.Array))return n.nested.map(c=>r.ReactiveFields.ReplacementsExtractors.rule(c));var i="";for(let c in n.properties)i+=c+":"+n.properties[c]+";";e(a=y,et).call(a,t,"rules",i)})),y)),It)),o(w,Wt,(Ve=class{constructor(s,n){o(this,ue);o(this,st,null);o(this,x,null);o(this,Y,null);f(this,st,s),f(this,x,n),f(this,Y,n.cloneNode(!1))}get element(){return e(this,x)}affiliate(){e(this,st).appendChild(e(this,x))}disaffiliate(s){e(this,st).removeChild(e(this,x))}promote(s){e(this,Y).innerHTML=s,e(this,st).replaceChild(e(this,Y),e(this,x)),h(this,ue,Ze).call(this)}},st=new WeakMap,x=new WeakMap,Y=new WeakMap,ue=new WeakSet,Ze=function(){let s=e(this,Y);f(this,Y,e(this,x).cloneNode(!1)),f(this,x,s)},Ve)),o(w,St,(ze=class{constructor(s){l(this,"owner",null);o(this,it,!1);o(this,nt,"");this.owner=s}reset(s){f(this,it,!1),f(this,nt,s)}append(s){f(this,nt,e(this,nt)+s)}verify(s){r.isOf(s,window.Function)&&f(this,it,s(e(this,nt)))}process(){e(this,it)&&this.on_content_invalidation(e(this,nt))}get invalidated(){return e(this,it)}on_content_invalidation(s){}},it=new WeakMap,nt=new WeakMap,ze)),o(w,v,(X=class extends window.HTMLElement{constructor(t){super();o(this,xt);o(this,z);o(this,me);o(this,Ee);o(this,ge);o(this,ye);o(this,Z);o(this,Pt);o(this,jt);o(this,$t);o(this,Se);o(this,kt);o(this,be);o(this,Kt);o(this,Ae);o(this,ct);o(this,R);o(this,Bt);o(this,Te);o(this,yt);o(this,Gt);o(this,U,"");o(this,T,new class extends r.ObjectsArray{on_version_change(){var t;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.rule(this.last),r.DEBUG&&h(t=this.owner,z,tt).call(t,`rules list version change: ${this.version}`)}}(this));o(this,b,new class extends r.ObjectsArray{on_version_change(){var t,i;this.last.version=this.version,this.last.replacements=r.ReactiveFields.ReplacementsExtractors.child(this.last),f(t=this.owner,B,e(t,B)|this.last.kind===e(r,S).SLOTS_KIND),r.DEBUG&&h(i=this.owner,z,tt).call(i,`children list version change: ${this.version}`)}}(this));o(this,P,new class extends r.ObjectsArray{on_version_change(){var t;r.DEBUG&&h(t=this.owner,z,tt).call(t,`fields list version change: ${this.version}`)}snapshot(){this.forEach(t=>t.value=this.owner[t.name])}recall(){this.forEach(t=>this.owner[t.name]=t.value)}}(this));o(this,m,{mainDefinition:e(r,g).newDefinition(),styleMedia:e(r,S).DEFAULT_STYLE_MEDIA,styleType:e(r,S).DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});o(this,Et,new window.Object);o(this,K,!1);o(this,B,!1);o(this,q,void 0);o(this,j,void 0);o(this,G,null);o(this,Ut,r.isShadowElement(this));o(this,rt,!1);o(this,at,!1);o(this,Q,e(r,Ie));o(this,N,null);o(this,H,"");o(this,V,!1);o(this,p,{root:new class extends e(r,St){on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends e(r,St){on_content_invalidation(t){e(this.owner,j).promote(t)}}(this),main:new class extends e(r,St){on_content_invalidation(t){e(this.owner,q).promote(t)}}(this),renderizers:{rule:t=>e(this,p).style.append(t.cache?t.cache:t.cache=e(this,ot).rule(t)),children:{mixed:t=>e(this,Ut)&&t.kind===e(r,S).SLOTS_KIND?e(this,p).renderizers.children.slot(t):e(this,p).renderizers.children.normal(t),slot:t=>{t.cache||(e(this,p).root.verify(i=>!0),e(this,p).root.append(t.cache=e(this,ot).child(t)))},normal:t=>{e(this,p).main.append(t.cache?t.cache:t.cache=e(this,ot).child(t)),t.rules.forEach(e(this,p).renderizers.rule)}}},gotModified:()=>e(this,p).root.invalidated||e(this,p).main.invalidated||e(this,p).style.invalidated,getDebugInfo:()=>`updated (root: ${e(this,p).root.invalidated}, main: ${e(this,p).main.invalidated}, style: ${e(this,p).style.invalidated})`});o(this,Ft,{bind:{key:()=>{let t=i=>{r.isNonEmptyString(i)&&(this[i]=h(this,Pt,xe).call(this,i))};return e(this,K)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"addEventListener"},unbind:{key:()=>{let t=i=>delete this[i];return e(this,K)&&t(e(this,m).mainDefinition.id),i=>t(i.id)},event:"removeEventListener"}});o(this,fe,t=>{let i=window.document.getElementById(t);return i===null?e(r,A).EXTINCT_TEMPLATE.emit(t):i.tagName!=="TEMPLATE"?e(r,A).INVALID_TEMPLATE.emit(t):i.innerHTML});o(this,$,t=>t.cache=null);o(this,pe,t=>t.rendering=!0);o(this,we,t=>t.rendering=!1);o(this,ot,{rule:t=>{if(r.isOf(t.nested,window.Array))return t.selector+"{"+t.nested.map(a=>e(this,ot).rule(a)).join(`
`)+"}";if(t.selector!==""){var i="";for(let a in t.properties)i+=a+":"+t.properties[a]+";";return r.isOf(t.replacements,window.Array)&&t.replacements.forEach(a=>i=i.replace(a.find,this[a.field]!==void 0?this[a.field]:"")),t.selector+"{"+i+"}"}return null},child:t=>{if(t.kind===e(r,S).TEMPLATES_KIND)return e(this,fe).call(this,t.id);let i=(d,u)=>d.replace(u.find,this[u.field]!==void 0?this[u.field]:"");if(t.tag===e(r,S).TEXTNODE_TAG){var a=t.content;return t.replacements.contents.forEach(d=>a=i(a,d)),t.encode?r.WebHelpers.htmlEncode(a):a}var c=r.isNonEmptyString(t.id)?`<${t.tag} id='${t.id}'`:"<"+t.tag;if(t.classes.length){var a=t.classes.join(" ");t.replacements.classes.forEach(u=>a=i(a,u)),c+=` class='${a}'`}if(r.hasObjectKeys(t.style)){var a=" style='";for(let u in t.style)a+=u+": "+t.style[u]+"; ";a+="'",t.replacements.styles.forEach(u=>a=i(a,u)),c+=a}if(r.hasObjectKeys(t.attributes)){var a="";for(let u in t.attributes)a+=" "+u+"="+t.attributes[u];t.replacements.attributes.forEach(u=>a=i(a,u)),c+=a}if(typeof t.content=="string"){var a=t.content;t.replacements.contents.forEach(u=>a=i(a,u)),c+=`>${t.encode?r.WebHelpers.htmlEncode(a):a}</${t.tag}>`}else c+="/>";return c}});o(this,ht,{main:new dt(r.hashRoutine),style:new dt(r.hashRoutine)});o(this,F,{attachment:new r.StopWatch,partial:new r.StopWatch,full:new r.StopWatch,dettachment:new r.StopWatch});o(this,gt,()=>e(r,v).EVENT_NAMES.forEach(t=>e(this,Et)[t]=typeof this[t]=="function"));l(this,"info",{instanceNumber:++e(r,v).instancesCount,unmodifiedRounds:0,updatedRounds:0});f(this,G,t!==e(r,v).RootMode.REGULAR?this.attachShadow({mode:t}):this),e(this,gt).call(this),h(this,R,I).call(this,"on_create"),e(this,m).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),h(this,Te,as).call(this)&&e(this,N).generation>1?h(this,R,I).call(this,"on_reconstruct",e(this,N)):h(this,R,I).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}render(){}redraw(){}connectedCallback(){r.MEASURE&&e(this,F).attachment.start(),e(this,gt).call(this),h(this,R,I).call(this,"on_connect"),h(this,ct,Ct).call(this,"render",h(this,Se,is)),h(this,ct,Ct).call(this,"redraw",h(this,be,ns)),h(this,kt,$e).call(this,"on_load"),e(this,V)&&this.persistToElementsStore(),r.MEASURE&&e(this,F).attachment.stop()}disconnectedCallback(){r.MEASURE&&e(this,F).dettachment.start(),h(this,Z,ft).call(this,!1),h(this,ct,Ct).call(this,"render",h(this,xt,Fe)),h(this,ct,Ct).call(this,"redraw",h(this,xt,Fe)),h(this,R,I).call(this,"on_disconnect"),r.MEASURE&&e(this,F).dettachment.stop()}getElementsStore(){return e(this,Q)}setElementsStore(t){f(this,Q,t)}hasElementsStoreKey(t){return e(this,V)}getElementsStoreKey(t){return e(this,H)}setElementsStoreKey(t){return f(this,V,r.isNonEmptyString(f(this,H,t))),this}persistToElementsStore(){if(h(this,Gt,Be).call(this)){let t=e(this,N);if(t)return e(this,P).snapshot(),t.data=new window.Object({options:e(this,m),html:e(this,U),children:e(this,b).persist(),rules:e(this,T).persist(),fields:e(this,P).persist(),slotted:e(this,B),identified:e(this,K)}),h(this,yt,se).call(this),!0}return!1}restoreFromElementsStore(t){if(h(this,Gt,Be).call(this)){let i=e(this,N);if(i&&i.persisted&&i.data)return f(this,m,i.data.options),f(this,B,i.data.slotted),f(this,K,i.data.identified),f(this,U,i.data.html),e(this,b).restore(i.data.children),e(this,b).owner=this,e(this,T).restore(i.data.rules),e(this,T).owner=this,e(this,P).restore(i.data.fields),e(this,P).owner=this,e(this,P).recall(),t||(delete i.data,h(this,yt,se).call(this)),!0}return!1}selectChildElement(t){return e(this,G).querySelector(t)}setMainAttribute(t,i){e(this,rt)&&e(this,q).element.setAttribute(t,i)}setMainElement(t){let i=e(r,g).newChild(t);if(e(r,g).performValidations(i)){if(i.content!==""||!!i.events.length)return e(r,A).INVALID_DEFINITION.emit(t);f(this,K,!!i.id.length)&&(e(this,m).mainDefinition.id=i.id),i.tag.length&&(e(this,m).mainDefinition.tag=i.tag),i.classes.length&&(e(this,m).mainDefinition.classes=i.classes),i.style&&(e(this,m).mainDefinition.style=i.style),i.attributes&&(e(this,m).mainDefinition.attributes=i.attributes)}return this}setStyleOptions(t,i){return e(this,m).styleMedia=t||"",e(this,m).styleType=i||"",this}setElementsAsKeys(t){return e(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return e(this,m).attributeKeys=!!t,this}allowRawContent(t){return e(this,m).rawContent=!!t,this}setRawContent(t){return e(this,m).rawContent?f(this,U,t):e(r,A).ALLOW_HTML.emit(),this}appendRawContent(t){return e(this,m).rawContent?f(this,U,e(this,U)+t):e(r,A).ALLOW_HTML.emit(),this}prependRawContent(t){return e(this,m).rawContent?f(this,U,t+e(this,U)):e(r,A).ALLOW_HTML.emit(),this}appendCSSRule(t,i,a){if(a)return this.appendCSSNestedRule(t,i,a);let c=e(this,T).slice(-1),d=e(r,g).newRule(t,i);return(!c.length||!e(r,g).tryToJoinRules(c[0],d))&&e(this,T).append(d),this}prependCSSRule(t,i,a){if(a)return this.prependCSSNestedRule(t,i,a);let c=e(this,T).slice(0,1),d=e(r,g).newRule(t,i);return(!c.length||!e(r,g).tryToJoinRules(c[0],d))&&e(this,T).prepend(d),this}appendCSSNestedRule(t,i,a){let c=e(this,T).slice(-1),d=e(r,g).newNestedRule(t,i,a);return(!c.length||!e(r,g).tryToJoinNestedRules(c[0],d))&&e(this,T).append(d),this}prependCSSNestedRule(t,i,a){let c=e(this,T).slice(0,1),d=e(r,g).newNestedRule(t,i,a);return(!c.length||!e(r,g).tryToJoinNestedRules(c[0],d))&&e(this,T).prepend(d),this}appendChildElement(t,i){return e(this,b).append(e(r,g).performValidations(e(r,g).newChild(t,i))),this}prependChildElement(t,i){return e(this,b).prepend(e(r,g).performValidations(e(r,g).newChild(t,i))),this}replaceChildElement(t,i){return e(this,b).replace(e(this,b).findIndex(a=>a.id===t),e(r,g).newChild(i)),this}appendChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(r.isOf(t,window.Array)?t:r.forcedStringSplit(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}checkChildElementIsIncludedById(t,i,a){let c=d=>r.isOf(d,window.Function)?d():void 0;return e(this,b).some(d=>d.id===t&&d.rendering)?c(i):c(a),this}includeChildElementById(t){return e(this,b).forEach(i=>i.id===t&&e(this,pe).call(this,i)),this}excludeChildElementById(t){return e(this,b).forEach(i=>i.id===t&&e(this,we).call(this,i)),this}invalidateChildElementsById(t){return e(this,b).forEach(i=>t.indexOf(i.id)>-1&&e(this,$).call(this,i)),this}invalidateChildElements(t){return r.isOf(t,window.Array)&&t.forEach(e(this,$)),this}makeField(t,i){return this[t]=i,e(this,P).append({name:t,value:i}),this}makeReactiveField(t,i,a,c=!0){return h(this,Ae,rs).call(this,t,i,a,c),e(this,P).append({name:t,value:i}),this}makeExternalReactiveField(t,i,a,c,d=!0){return this.makeReactiveField(i,t[i]||a,u=>{t[i]=this[i],c(u)},d),this}},U=new WeakMap,T=new WeakMap,b=new WeakMap,P=new WeakMap,m=new WeakMap,Et=new WeakMap,K=new WeakMap,B=new WeakMap,q=new WeakMap,j=new WeakMap,G=new WeakMap,Ut=new WeakMap,rt=new WeakMap,at=new WeakMap,Q=new WeakMap,N=new WeakMap,H=new WeakMap,V=new WeakMap,p=new WeakMap,Ft=new WeakMap,fe=new WeakMap,$=new WeakMap,pe=new WeakMap,we=new WeakMap,ot=new WeakMap,ht=new WeakMap,F=new WeakMap,xt=new WeakSet,Fe=function(){},z=new WeakSet,tt=function(t){e(this,K)&&r.debug(`#${e(this,m).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof t=="string"?t:JSON.stringify(t)}`)},me=new WeakSet,_e=function(){e(this,j)&&e(this,j).affiliate(),e(this,q).affiliate(),f(this,rt,!0)},Ee=new WeakSet,ts=function(){f(this,j,e(this,T).length?new(e(r,Wt))(e(this,G),e(r,g).makeStyleNode(e(this,m).styleMedia,e(this,m).styleType)):null),f(this,q,new(e(r,Wt))(e(this,G),e(r,g).makeMainNode(e(this,m).mainDefinition))),e(this,b).forEach(e(this,$)),e(this,T).forEach(e(this,$))},ge=new WeakSet,es=function(){e(this,rt)&&(e(this,q).disaffiliate(),e(this,j)&&e(this,j).disaffiliate(),e(this,B)&&e(this,Ut)&&r.WebHelpers.removeChildren(this)),f(this,rt,!1)},ye=new WeakSet,ss=function(t){return{key:e(this,m).elementKeys&&t.key(),event:(i,a,c)=>{let d=this[`on_${i}_${a}`];if(d){let u=h(this,Pt,xe).call(this,i);u&&u[t.event](a,d,c)}},slots:()=>this.on_slot_change&&e(this,G).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}},Z=new WeakSet,ft=function(t){if(e(this,at)&&!t||!e(this,at)&&t){let i=h(this,ye,ss).call(this,t?e(this,Ft).bind:e(this,Ft).unbind);e(this,b).forEach(a=>{!a.rendering&&t||(i.key&&i.key(a),a.events.forEach(c=>c&&i.event(a.id,c.kind,c.capture)))}),e(this,B)&&i.slots(),f(this,at,t)}},Pt=new WeakSet,xe=function(t){return r.isNonEmptyString(t)?e(this,G).querySelector(`#${t}`):void 0},jt=new WeakSet,Pe=function(){e(this,p).root.reset(""),e(this,p).style.reset(""),e(this,p).main.reset(e(this,U));let t=e(this,B)?e(this,p).renderizers.children.mixed:e(this,p).renderizers.children.normal;e(this,b).forEach(i=>i.rendering&&t(i)),e(this,T).forEach(e(this,p).renderizers.rule),e(this,p).main.verify(i=>!e(this,ht).main.compute(i)),e(this,p).style.verify(i=>!e(this,ht).style.compute(i))},$t=new WeakSet,je=function(){e(this,p).root.process(),e(this,p).style.process(),e(this,p).main.process(),r.DEBUG&&h(this,z,tt).call(this,e(this,p).getDebugInfo())},Se=new WeakSet,is=function(){!r.RENDERING||(r.MEASURE&&e(this,F).partial.start(),h(this,R,I).call(this,"on_prerender"),h(this,jt,Pe).call(this),e(this,p).gotModified()?(h(this,Z,ft).call(this,!1),h(this,$t,je).call(this),h(this,Z,ft).call(this,!0),this.info.updatedRounds++,h(this,R,I).call(this,"on_update"),h(this,Bt,Ke).call(this,"on_refresh")):this.info.unmodifiedRounds++,r.DEBUG&&h(this,z,tt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${e(this,ht).main.rounds}, style: ${e(this,ht).style.rounds}) | updated: ${this.info.updatedRounds}`),h(this,R,I).call(this,"on_postrender"),r.MEASURE&&e(this,F).partial.stop())},kt=new WeakSet,$e=function(t){h(this,Ee,ts).call(this),h(this,me,_e).call(this),h(this,R,I).call(this,"on_inject"),h(this,jt,Pe).call(this),e(this,p).style.verify(i=>!!e(this,j)),h(this,$t,je).call(this),h(this,Z,ft).call(this,!0),h(this,R,I).call(this,t)},be=new WeakSet,ns=function(t){r.MEASURE&&e(this,F).full.start(),h(this,Z,ft).call(this,!1),h(this,ge,es).call(this),h(this,R,I).call(this,"on_unload"),e(this,gt).call(this),h(this,kt,$e).call(this,"on_reload"),h(this,Bt,Ke).call(this,"on_repaint"),r.MEASURE&&e(this,F).full.stop()},Kt=new WeakSet,ke=function(t,i="$none"){if(e(this,at)){let a=r.ReactiveFields.ReplacementsScanners.rules(e(this,T),t);a.forEach(e(this,$));let c=r.ReactiveFields.ReplacementsScanners.children(e(this,b),t);c.forEach(e(this,$)),r.DEBUG&&h(this,z,tt).call(this,`reactive render (label: ${i}, field: ${t}, children: ${c.length}, rules: ${a.length})`),(!!a.length||!!c.length)&&(c.some(d=>!!d.kind.length)&&e(this,b).forEach(d=>d.kind===e(r,S).SLOTS_KIND?e(this,$).call(this,d):void 0),this.render())}},Ae=new WeakSet,rs=function(t,i,a,c=!0){r.ReactiveFields.make(this,t,i,a,(d,u)=>h(this,Kt,ke).call(this,d,u||"$auto")),c&&h(this,Kt,ke).call(this,t,"$init")},ct=new WeakSet,Ct=function(t,i){delete this[t],window.Object.defineProperty(this,t,{value:i})},R=new WeakSet,I=function(t,i){e(this,Et)[t]&&this[t].call(this,i)},Bt=new WeakSet,Ke=function(t,i){e(this,V)&&this.persistToElementsStore(),e(this,Et)[t]&&window.requestAnimationFrame(()=>this[t].call(this,i))},gt=new WeakMap,Te=new WeakSet,as=function(){return e(this,V)?(f(this,N,e(this,Q).has(e(this,H))?e(this,Q).getItem(e(this,H)):{generation:0,persisted:!1}),e(this,N).generation++,h(this,yt,se).call(this),!0):!1},yt=new WeakSet,se=function(){r.DEBUG&&(e(this,N).key=e(this,H)),e(this,N).persisted=!!e(this,N).data,e(this,Q).setItem(e(this,H),e(this,N))},Gt=new WeakSet,Be=function(){return e(this,V)?!0:(e(r,A).INVALID_KEY.emit(),!1)},l(X,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),l(X,"specializeClass",t=>class extends X{constructor(){super(t)}}),l(X,"instancesCount",0),X)),o(w,J,(ut=class{static registerClasses(s){window.Array.prototype.forEach.call(s,h(e(r,J),Re,hs))}static instantiateClasses(s,n){window.Array.prototype.forEach.call(s,t=>{var i;return window.customElements.get(t.tag)?h(i=e(r,J),ve,ls).call(i,t,n):e(r,A).UNREGISTERED_CLASS.emit(t.name)})}},Oe=new WeakSet,os=function(s){return s.toLowerCase().replaceAll("_","-")},Re=new WeakSet,hs=function(s){var n;r.isNonEmptyString(s.name)&&s.name.indexOf("_")>0?s.tag=h(n=e(r,J),Oe,os).call(n,s.name):e(r,A).MISNAMED_CLASS.emit(s.name),window.HTMLElement.isPrototypeOf(s)?window.customElements.define(s.tag,s):e(r,A).INVALID_CLASS.emit(s.name)},Ne=new WeakSet,cs=function(s,n){let t=r.isNonEmptyString(n)?window.document.querySelector(n):window.document.body;t&&t.appendChild(window.document.createElement(s.tag))},ve=new WeakSet,ls=function(s,n){let t=()=>{var i;return h(i=e(r,J),Ne,cs).call(i,s,n)};window.document.body?t():r.WebHelpers.onDOMContentLoaded(t)},o(ut,Oe),o(ut,Re),o(ut,Ne),o(ut,ve),ut)),l(w,"NonShadowElement",e(r,v).specializeClass(e(r,v).RootMode.REGULAR)),l(w,"OpenShadowElement",e(r,v).specializeClass(e(r,v).RootMode.OPEN)),l(w,"ClosedShadowElement",e(r,v).specializeClass(e(r,v).RootMode.CLOSED)),(()=>{let s=(n,t)=>!n&&e(r,A).UNSUPPORTED_FEATURE.emit(t);try{s(r.isOf(window.document,window.HTMLDocument),"HTML Document"),s(r.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),r.WebHelpers.onDOMContentLoaded(()=>s(r.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(n){e(r,A).UNKNOWN_ERROR.emit()}})(),window.Wuse=w;})();
