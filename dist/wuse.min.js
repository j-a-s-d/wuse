(()=>{var Sn=Object.defineProperty;var An=(r,e,t)=>e in r?Sn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var d=(r,e,t)=>(An(r,typeof e!="symbol"?e+"":e,t),t),wi=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var n=(r,e,t)=>(wi(r,e,"read from private field"),t?t.call(r):e.get(r)),o=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},l=(r,e,t,i)=>(wi(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);var h=(r,e,t)=>(wi(r,e,"access private method"),t);var A=(r,e)=>({code:r,emit:t=>{let i=r<80?"error":"warn",s=`[WUSE:${i.toUpperCase()}] ${r} | ${e(t)}`;if(window.Wuse&&window.Wuse.FATALS||r<10)throw new window.Error(s);return window.console[i](s),null}}),E=class{static get UNKNOWN_ERROR(){return A(0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return A(1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return A(2,e=>`Unregistered class: ${e}.`)}static get UNREGISTRABLE_CLASS(){return A(3,e=>`Unregistrable class: ${e}.`)}static get INVALID_CLASS(){return A(4,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return A(5,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return A(10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return A(11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return A(12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return A(13,e=>"Call first: this.allowRawContent(true).")}static get INVALID_STATE(){return A(14,e=>"Invalid state.")}static get TAKEN_ID(){return A(15,e=>`Taken id: ${e}.`)}static get INEXISTENT_TEMPLATE(){return A(20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return A(21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return A(22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return A(30,e=>`Unespecified slot: #${e}.`)}static get LOCKED_DEFINITION(){return A(40,e=>`Locked definition: #${e}.`)}static get UNKNOWN_TAG(){return A(80,e=>`Unknown tag: ${e}.`)}static get BAD_TARGET(){return A(81,e=>`Bad target: ${e}.`)}static get ALREADY_REGISTERED(){return A(90,e=>`Already registered: ${e}.`)}};var Re,Ue,Ri=(r,e)=>(typeof e=="function"&&e(r),r),p=class{static get EMPTY_STRING(){return n(this,Re)}static get EMPTY_ARRAY(){return n(this,Ue)}static noop(){}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,t){return typeof e=="string"?e.split(t):new window.Array}static buildArray(e){return Ri(new window.Array,e)}static buildObject(e){return Ri(new window.Object,e)}static ensureFunction(e,t=()=>{}){return typeof e=="function"?e:t}static isOf(e,t){return e!=null&&(e.constructor===t||t!=null&&e.constructor.name===t.name)}static areOf(e,t){var i=!!(e&&e.constructor===window.Array&&!!e.length);if(i)for(var s in e){let a=e[s];if(!(a!=null&&(a.constructor===t||t!=null&&a.constructor.name===t.name))){i=!1;break}}return i}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static cloneObject(e){return window.Object.assign(new window.Object,e)}static forEachOwnProperty(e,t){e&&window.Object.getOwnPropertyNames(e).forEach(t)}static isAssignedObject(e){return typeof e=="object"&&e!==null}static isAssignedArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"}static isNonEmptyArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"&&!!e.length}static isIntegerNumber(e){return(typeof e=="number"||typeof e=="string"&&!!e.length)&&window.Number.isInteger(window.Number(e))}};Re=new WeakMap,Ue=new WeakMap,o(p,Re,new window.String().valueOf()),o(p,Ue,window.Object.freeze(new window.Array));var Ct,Lt,{noop:Ui,ensureFunction:ki,isAssignedObject:_n}=p,dt=class{static fetch(e){let t=window.document.getElementById(e);return t===null?n(this,Ct).call(this,e):t.tagName!=="TEMPLATE"?n(this,Lt).call(this,e):t.innerHTML}static initialize(e){_n(e)&&(l(this,Ct,ki(e.onExtinctTemplate,n(this,Ct))),l(this,Lt,ki(e.onInvalidTemplate,n(this,Lt))))}};Ct=new WeakMap,Lt=new WeakMap,o(dt,Ct,Ui),o(dt,Lt,Ui);var Rt,Ut,kt,Wt,Ft,Mt,xt,ke,Mi,We,xi,Zt,mi,Fe,$i,te,pi,{noop:mt,ensureFunction:lt,isAssignedObject:Wi,isAssignedArray:Ls,isNonEmptyArray:Fi,isOf:Qt,forEachOwnProperty:Rs}=p,vn=r=>r.toLowerCase().replaceAll("_","-"),S=class{static registerClasses(e){Fi(e)&&window.Array.prototype.forEach.call(e,t=>typeof t=="function"?h(this,Zt,mi).call(this,t):n(this,Wt).call(this,t))}static instantiateClasses(e,t,i,s){Fi(e)&&window.Array.prototype.forEach.call(e,a=>h(this,te,pi).call(this,a,t,Wi(i)?i:new window.Object,s))}static createInstance(e,t,i){if(Qt(e,window.Object)&&Qt(e.type,window.Function))return e.register===!0&&h(this,Zt,mi).call(this,e.type),t=Qt(t,window.Object)?t:{selector:"body"},i=Qt(i,window.Object)?i:new window.Object,h(this,te,pi).call(this,e.type,t.selector,{on_bad_target:t.on_bad_target,on_element_instantiated:i.on_element_instantiated},i.parameters)}static initialize(e){Wi(e)&&(l(this,Rt,lt(e.onBadTarget,n(this,Rt))),l(this,Ut,lt(e.onDeferredInstantiation,n(this,Ut))),l(this,Wt,lt(e.onInvalidClass,n(this,Wt))),l(this,kt,lt(e.onMisnamedClass,n(this,kt))),l(this,Ft,lt(e.onUnregistrableClass,n(this,Ft))),l(this,Mt,lt(e.onUnregisteredClass,n(this,Mt))),l(this,xt,lt(e.onAlreadyRegistered,n(this,xt))))}};Rt=new WeakMap,Ut=new WeakMap,kt=new WeakMap,Wt=new WeakMap,Ft=new WeakMap,Mt=new WeakMap,xt=new WeakMap,ke=new WeakSet,Mi=function(e){window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):n(this,Ft).call(this,e.name)},We=new WeakSet,xi=function(e){window.customElements.get(e.tag=vn(e.name))?n(this,xt).call(this,e.name):h(this,ke,Mi).call(this,e)},Zt=new WeakSet,mi=function(e){e.name.indexOf("_")>0?h(this,We,xi).call(this,e):n(this,kt).call(this,e.name)},Fe=new WeakSet,$i=function(e,t,i,s){let a=null;try{a=window.document.querySelector(t)}catch(u){if(Qt(i.on_bad_target,window.Function)){if(i.on_bad_target(t)===!1)return}else{n(this,Rt).call(this,t);return}}finally{a=a||window.document.body}let c=window.document.createElement(e.tag);return c.parameters=s,lt(i.on_element_instantiated)(c,t),a.appendChild(c),c},te=new WeakSet,pi=function(e,t,i,s){let a=()=>h(this,Fe,$i).call(this,e,t,i,s);return window.customElements.get(e.tag)?window.document.body?a():n(this,Ut).call(this,a):n(this,Mt).call(this,e.name)},o(S,ke),o(S,We),o(S,Zt),o(S,Fe),o(S,te),o(S,Rt,mt),o(S,Ut,mt),o(S,kt,mt),o(S,Wt,mt),o(S,Ft,mt),o(S,Mt,mt),o(S,xt,mt);var q=class{static defaultRoutine(e=""){var t=0;for(let i=0;i<e.length;i++)t=(t=(t<<5)-t+e.charCodeAt(i))&t;return t}};var ji=q.defaultRoutine,On=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","content","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","marquee","mark","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","shadow","select","slot","small","source","spacer","span","strike","strong","style","sub","sup","summary","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","xmp","wbr"].map(ji),j=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let t=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",t),100)};window.addEventListener("DOMContentLoaded",t)}}static getUniqueId(e="WUSE"){let t="_"+(e||"")+"_";for(var i;window.document.getElementById(i=t+(""+window.Math.random()).substring(2))!==null;);return i}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static isHTMLTag(e){return On.indexOf(ji(e))>-1}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),i=window.Array.prototype.slice.call(e).filter(s=>s.charAt(0)==="-");return i.length?"-"+i[0].split("-")[1]+"-":""}};var K=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}static get WUSEKEY_ATTRIBUTE(){return"data-wusekey"}static get WUSENODE_ATTRIBUTE(){return"data-wusenode"}};var{noop:$s,isOf:Ki,isNonEmptyString:Dn}=p,Bi=r=>!Ki(r,window.Function),Nn=(r,e,t,i,s,a,c,u)=>s(()=>e,L=>{a(L,t),Bi(t)?i(r):t({renderize:Dt=>i(r,Dt),automate:()=>a(L,null),dereact:()=>s(()=>L,c),remove:()=>u(r)})}),Cn=(r,e,t,i,s,a)=>{let c=(P,Nt)=>{window.Object.defineProperty(r,e,{get:P,set:Nt,enumerable:!0,configurable:!0})},u=Bi(a)?P=>delete r[P]:a,L=P=>{u(e),r[e]=P},Dt=(P,Nt)=>Nn(e,P,Nt,s,c,Dt,L,u);return Dt(t,i)},ee=class{static createReactiveField(e,t,i,s,a,c){return e&&Dn(t)&&Ki(a,window.Function)?Cn(e,t,i,s,a,c):null}};var ie,Me,pt,ne,se,{EMPTY_ARRAY:Ln,buildArray:gi,buildObject:Rn,isNonEmptyString:Un,isOf:kn}=p,jt=class{static initialize(e,t){this.begin=e,this.end=t}},X=jt;d(X,"begin",null),d(X,"end",null),d(X,"enclose",e=>jt.begin+e+jt.end),d(X,"makeRegExp",()=>new window.RegExp(`(?<=${jt.begin}).*?(?=${jt.end})`,"gs"));var Wn=["contents","classes","styles","attributes"],$t=class{};d($t,"rules",(e,t)=>gi(i=>e.forEach(s=>s.replacements.forEach(a=>a.field===t&&i.push(s))))),d($t,"children",(e,t)=>gi(i=>{let s=a=>{let c=u=>u.forEach(L=>L.field===t&&i.push(a));Wn.forEach(u=>c(a.replacements[u])),a.rules.forEach(u=>u.replacements.forEach(L=>L.field===t&&i.push(a)))};e.forEach(a=>a.included&&s(a))}));var R=class{static initialize(e){l(this,ie,e)}},x=R;ie=new WeakMap,Me=new WeakMap,pt=new WeakMap,ne=new WeakMap,se=new WeakMap,o(x,ie,null),o(x,Me,(e,t,i)=>e.push({at:t,field:i.trim(),find:X.enclose(i)})),o(x,pt,(e,t,i)=>Un(i)&&(i.match(n(R,ie))||Ln).forEach(s=>{var a;return n(a=R,Me).call(a,e,t,s)})),o(x,ne,(e,t,i)=>{var s;e[t]=new window.Array,n(s=R,pt).call(s,e[t],t,i)}),o(x,se,(e,t,i)=>{e[t]=new window.Array,window.Object.keys(i).forEach(s=>{var a,c;n(a=R,pt).call(a,e[t],t,s),n(c=R,pt).call(c,e[t],t,i[s])})}),d(x,"child",e=>Rn(t=>{var i,s,a,c;n(i=R,ne).call(i,t,"contents",e.content),n(s=R,ne).call(s,t,"classes",e.classes.join(" ")),n(a=R,se).call(a,t,"styles",e.style),n(c=R,se).call(c,t,"attributes",e.attributes),e.rules.forEach(u=>u.replacements=R.rule(u))})),d(x,"rule",e=>gi(t=>{var s;if(kn(e.nested,window.Array))return e.nested.map(a=>R.rule(a));var i="";for(let a in e.properties)i+=`${a}:${e.properties[a]};`;n(s=R,pt).call(s,t,"rules",i)}));var U=class{static initialize(e,t){X.initialize(e,t),x.initialize(X.makeRegExp())}};d(U,"extractReplacementsFromRule",x.rule),d(U,"extractReplacementsFromChild",x.child),d(U,"scanRulesForReplacements",$t.rules),d(U,"scanChildrenForReplacements",$t.children);var Kt,{noop:Fn,isOf:Mn,hasObjectKeys:Gi,isNonEmptyString:Hi,isNonEmptyArray:xn,isAssignedObject:$n,ensureFunction:jn}=p,{htmlEncode:Pi}=j,{SLOTS_KIND:Kn,TEMPLATES_KIND:Bn,TEXTNODE_TAG:Gn}=K,re=class{static initialize(e){$n(e)&&l(this,Kt,jn(e.onFetchTemplate,n(this,Kt)))}},y=re;Kt=new WeakMap,o(y,Kt,Fn),d(y,"cacheInvalidator",e=>e.cache=null),d(y,"slotsInvalidator",e=>e.kind===Kn?re.cacheInvalidator(e):void 0),d(y,"renderingIncluder",e=>e.included=!0),d(y,"renderingExcluder",e=>e.included=!1),d(y,"renderRule",(e,t)=>{if(Mn(t.nested,window.Array))return`${t.selector}{${t.nested.map(s=>re.renderRule(e,s)).join(`
`)}}`;if(Hi(t.selector)&&!t.nested){var i=new window.String;for(let s in t.properties)i+=`${s}:${t.properties[s]};`;return xn(t.replacements)&&t.replacements.forEach(s=>i=e(i,s)),`${t.selector}{${i}}`}return null}),d(y,"renderChild",(e,t)=>{var a;if(t.kind===Bn)return n(a=re,Kt).call(a,t.id);if(t.tag===Gn){var i=t.content;return t.replacements.contents.forEach(c=>i=e(i,c)),t.encode?Pi(i):i}var s=Hi(t.id)?`<${t.tag} id='${t.id}'`:`<${t.tag}`;if(t.classes.length){var i=t.classes.join(" ");t.replacements.classes.forEach(u=>i=e(i,u)),s+=` class='${i}'`}if(Gi(t.style)){var i=" style='";for(let u in t.style)i+=`${u}: ${t.style[u]}; `;i+="'",t.replacements.styles.forEach(u=>i=e(i,u)),s+=i}if(Gi(t.attributes)){var i=new window.String;for(let u in t.attributes)i+=` ${u}=${t.attributes[u]}`;t.replacements.attributes.forEach(u=>i=e(i,u)),s+=i}if(typeof t.content=="string"){var i=t.content;t.replacements.contents.forEach(u=>i=e(i,u)),s+=`>${t.encode?Pi(i):i}</${t.tag}>`}else s+="/>";return s});var oe,ae,de,le,{ensureFunction:Hn}=p,Bt=class{constructor(e){d(this,"rounds",0);o(this,oe,0);o(this,ae,null);o(this,de,!1);o(this,le,null);l(this,le,Hn(e))}compute(e){return this.rounds+=+l(this,de,n(this,oe)==l(this,ae,n(this,le).call(this,e))),l(this,oe,n(this,ae)),n(this,de)}};oe=new WeakMap,ae=new WeakMap,de=new WeakMap,le=new WeakMap;var gt,ht,Gt,ce,ue,N,Q,Et,Ht,$e,{ensureFunction:Ei,isNonEmptyString:Pn,isOf:xe}=p,he=class{constructor(e,t,i,s={}){o(this,Ht);o(this,gt,new window.String);o(this,ht,!1);o(this,Gt,null);o(this,ce,null);o(this,ue,null);o(this,N,null);o(this,Q,null);o(this,Et,new class extends window.Set{name(e,t){let i=`${e}_${t}`;for(var s=0;this.has(i);)i=`${e}_${t}_${++s}`;return this.add(i),i}});l(this,Gt,Ei(e)),l(this,ce,Ei(t)),l(this,ue,Ei(i)),l(this,Q,s)}getStore(){return n(this,Q)}setStore(e){l(this,Q,e)}get state(){return n(this,N)}get key(){return n(this,gt)}set key(e){return l(this,ht,Pn(l(this,gt,e)))}hasKey(){return n(this,ht)}validateKey(){return n(this,ht)?!0:(this.on_invalid_key(),!1)}nameFiliatedKey(e){return n(this,Et).name(n(this,gt),e)}rememberFiliatedKey(e){n(this,Et).add(e)}hasFiliatedKey(e){return n(this,Et).has(e)}initializeState(){if(n(this,Et).clear(),n(this,ht)){let e=n(this,Q).hasItem(this.key)?n(this,Q).getItem(this.key):n(this,Gt).call(this);if(xe(e,window.Object))l(this,N,e),n(this,N).generation++,h(this,Ht,$e).call(this);else return this.on_invalid_state(),-1}else l(this,N,n(this,Gt).call(this)),n(this,N).generation++;return n(this,N).generation}writeState(){let e=n(this,N);return xe(e,window.Object)?(e.data=n(this,ue).call(this),h(this,Ht,$e).call(this),!0):!1}readState(){let e=n(this,N);return xe(e,window.Object)&&e.persisted?(n(this,ce).call(this,e.data),!0):!1}eraseState(){let e=n(this,N);return xe(e,window.Object)&&e.persisted&&e.data?(delete e.data,h(this,Ht,$e).call(this),!0):!1}on_invalid_state(){}on_invalid_key(){}};gt=new WeakMap,ht=new WeakMap,Gt=new WeakMap,ce=new WeakMap,ue=new WeakMap,N=new WeakMap,Q=new WeakMap,Et=new WeakMap,Ht=new WeakSet,$e=function(){n(this,ht)&&(n(this,N).persisted=!!n(this,N).data,n(this,Q).setItem(n(this,gt),n(this,N)))};var Z,z,ct,je,Ji,Ke,Yi,{WUSENODE_ATTRIBUTE:zi}=K,Pt=class{constructor(e,t){o(this,je);o(this,Ke);o(this,Z,null);o(this,z,null);o(this,ct,null);if(e instanceof Node&&t instanceof Node)l(this,Z,e),h(this,je,Ji).call(this,t.getAttribute(zi)),l(this,z,t),l(this,ct,t.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return n(this,z)}affiliate(){n(this,Z).appendChild(n(this,z))}disaffiliate(){n(this,Z).removeChild(n(this,z))}promote(e){n(this,ct).innerHTML=e,n(this,Z).replaceChild(n(this,ct),n(this,z)),h(this,Ke,Yi).call(this)}};Z=new WeakMap,z=new WeakMap,ct=new WeakMap,je=new WeakSet,Ji=function(e){let t=n(this,Z).querySelector(`[${zi}='${e}']`);t&&n(this,Z).removeChild(t)},Ke=new WeakSet,Yi=function(){let e=n(this,ct);l(this,ct,n(this,z).cloneNode(!1)),l(this,z,e)};var yt,bt,Tt=class{constructor(e){d(this,"owner",null);o(this,yt,!1);o(this,bt,"");this.owner=e}get invalidated(){return n(this,yt)}reset(e){l(this,yt,!1),l(this,bt,e)}append(e){l(this,bt,n(this,bt)+e)}verify(e){l(this,yt,e(n(this,bt)))}process(e){(e||n(this,yt))&&this.on_content_invalidation(n(this,bt))}on_content_invalidation(e){}};yt=new WeakMap,bt=new WeakMap;var It,fe,{isIntegerNumber:zn,isOf:yi,cloneObject:Jn,forEachOwnProperty:Yn,buildArray:Vn}=p,Vi=(r,e,t)=>Yn(r,i=>{switch(i){case"owner":case"last":case"length":break;case"version":case"locked":t(i);break;default:zn(i)&&e(i)}}),qi=(r,e,t)=>{t(e);let i=Jn(e);i.cache=null,r.push(i)},St=class extends window.Array{constructor(t){super();o(this,It);d(this,"owner",null);d(this,"last",null);d(this,"version",0);d(this,"locked",!1);this.owner=t}append(t){this.locked?this.on_forbidden_change():yi(t,window.Object)&&(this.push(t),h(this,It,fe).call(this,t))}prepend(t){this.locked?this.on_forbidden_change():yi(t,window.Object)&&(this.unshift(t),h(this,It,fe).call(this,t))}replace(t,i){this.locked?this.on_forbidden_change():t>-1&&yi(i,window.Object)&&h(this,It,fe).call(this,this[t]=i)}remove(t){if(this.locked)this.on_forbidden_change();else if(t>-1){let i=this.splice(t,1);h(this,It,fe).call(this,i.length?i[0]:null)}}persist(){return Vn(t=>Vi(this,i=>qi(t,this[i],this.on_snapshot_part),i=>t[i]=this[i]))}restore(t,i){this.owner=t,Vi(i,s=>qi(this,i[s],this.on_recall_part),s=>this[s]=i[s])}getIndexOf(t){}on_snapshot_part(){}on_recall_part(){}on_version_change(){}on_forbidden_change(){}};It=new WeakSet,fe=function(t){this.last=t,this.version++,this.on_version_change()};var Ge,nn,He,sn,Pe,rn,ze,on,Je,an,zt,Be,Ye,dn,{isHTMLTag:qn}=j,{EMPTY_STRING:$,EMPTY_ARRAY:Xn,noop:we,buildArray:rr,buildObject:Qn,isOf:C,hasObjectKeys:Xi,isNonEmptyString:ut,forcedStringSplit:Zn}=p,{WUSENODE_ATTRIBUTE:Qi,DEFAULT_TAG:ts,DEFAULT_KIND:Zi,TEMPLATES_KIND:bi,SLOTS_KIND:Ti,TEXTNODE_TAG:ar}=K,es=q.defaultRoutine,J={onInvalidDefinition:we,onInexistentTemplate:we,onUnespecifiedSlot:we,onInvalidId:we,onUnknownTag:we},is=r=>r.indexOf("-")>0&&!qn(r),tt=class{static parse(e){if(ut(e)){let t=e.trimLeft(),i=tn();return t.charAt(0)==="%"?t.startsWith(bi)?h(this,zt,Be).call(this,i,t.replace(i.kind=bi,$)):t.startsWith(Ti)?h(this,zt,Be).call(this,i,t.replace(i.kind=Ti,$)):null:h(this,zt,Be).call(this,i,t)}return null}};Ge=new WeakSet,nn=function(e,t){let i=t.indexOf("["),s=t.indexOf("]");if(i>-1&&s>-1&&s>i){let a=t.substr(i,s-i+1),c=a.substr(1,a.length-2).split("|");for(let u in c){let L=c[u].split("=");L[0]==="style"?L[1].split(";").forEach(Dt=>{let P=Dt.split(":"),Nt=P[0].trim();Nt.length&&(e.style[Nt]=P[1].trim())}):e.attributes[L[0]]=L[1]}return t.replace(a,$)}return t},He=new WeakSet,sn=function(e,t){let i=t.indexOf("=");return i>-1?(e.content=t.slice(i+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),t.slice(0,i)):t},Pe=new WeakSet,rn=function(e,t){let i=t.replaceAll("!"," ").split(" ");return i.slice(1).map(s=>{let[a,...c]=s.toLowerCase().split("+"),u=(c||Xn).indexOf("capture")>-1;e.events.push(en(a,u))}),i[0]},ze=new WeakSet,on=function(e,t){let i=t.replaceAll("."," ").split(" ");return e.classes=i.slice(1),i[0]},Je=new WeakSet,an=function(e,t){if(ut(t)){let i=t.indexOf("#");i===-1?e.tag=t:(i>0&&(e.tag=t.substr(0,i)),e.id=t.substr(i+1))}return e},zt=new WeakSet,Be=function(e,t){return h(this,Je,an).call(this,e,h(this,ze,on).call(this,e,h(this,Pe,rn).call(this,e,h(this,He,sn).call(this,e,h(this,Ge,nn).call(this,e,t)))))},o(tt,Ge),o(tt,He),o(tt,Pe),o(tt,ze),o(tt,Je),o(tt,zt);var me=class{static parse(e){return Qn(t=>(C(e,window.Array)?e:Zn(e,`
`).map(i=>i.trim()).join($).split(";")).forEach(i=>ut(i)&&h(this,Ye,dn).call(this,t,i.trim())))}};Ye=new WeakSet,dn=function(e,t){if(!!t.length&&t.indexOf(":")>-1){let[i,...s]=t.split(":"),a=i.trim();if(a.length){let c=s.join(":").trim();e[a]=c.endsWith(";")?c.slice(0,-1):c}}},o(me,Ye);var tn=()=>({kind:Zi,tag:ts,id:$,classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:$,encode:!1}),ns=()=>({generation:0,persisted:!1}),en=(r,e)=>typeof r=="string"&&typeof e=="boolean"?{kind:r,capture:e}:null,ss=(r,e)=>{let t=tt.parse(r);return t?(t.custom=t.kind===Zi&&is(t.tag),t.hash=es(r),t.rules=C(e,window.Array)?e:new window.Array,t.included=!0,t.cache=null,t):J.onInvalidDefinition(r)},rs=r=>{if(r!==null)if(r.kind===bi){if(!window.document.getElementById(r.id))return J.onInexistentTemplate(r.id)}else if(r.kind===Ti){if(new window.String(r.attributes.slot).replaceAll('"',$).replaceAll("'",$).length===0)return J.onUnespecifiedSlot(r.id)}else{if(typeof r.id!="string")return J.onInvalidId(r.id);r.custom&&!window.customElements.get(r.tag)&&J.onUnknownTag(r.tag)}return r},os=r=>{if(!C(r,window.Object))return null;let e=window.document.createElement(r.tag);if(r.id.length&&e.setAttribute("id",r.id),r.classes.length&&e.setAttribute("class",r.classes.join(" ")),Xi(r.style)){var t=new window.String;for(let i in r.style)t+=`${i}: ${r.style[i]}; `;if(t.length){let i=t.trim();e.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(Xi(r.attributes))for(let i in r.attributes)e.setAttribute(i,r.attributes[i]);return e.setAttribute(Qi,"main"),e},as=(r,e)=>{let t=window.document.createElement("style");return ut(r)&&t.setAttribute("media",r),ut(e)&&t.setAttribute("type",e),t.setAttribute(Qi,"style"),t.appendChild(window.document.createTextNode($)),t},ds=(r,e)=>{let t=C(r,window.Array)?r.join(","):ut(r)?r:$;return t.length?{selector:t,properties:C(e,window.Object)?e:me.parse(e),cache:null}:null},ls=(r,e,t)=>{let i=C(r,window.Array)?r.join(","):ut(r)?r:$,s=C(e,window.Array)?e.join(","):ut(e)?e:$;return!i.length||!s.length?null:{selector:i,nested:[{selector:s,properties:C(t,window.Object)?t:me.parse(t)}],cache:null}},hs=(r,e)=>{if(r.selector===e.selector){for(let t in e.properties)r.properties[t]=e.properties[t];return r.cache=null,!0}return!1},cs=(r,e)=>C(r.nested,window.Array)&&r.selector===e.selector?(e.nested.forEach(t=>{var i=!1;for(let s in r.nested)if(i=r.nested[s].selector===t.selector){for(let a in t.properties)r.nested[s].properties[a]=t.properties[a];break}i||r.nested.push(t)}),r.cache=null,!0):!1,w=class{static initialize(e){C(e,window.Object)&&(C(e.onInvalidDefinition,window.Function)&&(J.onInvalidDefinition=e.onInvalidDefinition),C(e.onInexistentTemplate,window.Function)&&(J.onInexistentTemplate=e.onInexistentTemplate),C(e.onUnespecifiedSlot,window.Function)&&(J.onUnespecifiedSlot=e.onUnespecifiedSlot),C(e.onInvalidId,window.Function)&&(J.onInvalidId=e.onInvalidId),C(e.onUnknownTag,window.Function)&&(J.onUnknownTag=e.onUnknownTag))}};d(w,"makeStyleNode",as),d(w,"newRule",ds),d(w,"newNestedRule",ls),d(w,"tryToJoinRules",hs),d(w,"tryToJoinNestedRules",cs),d(w,"performValidations",rs),d(w,"makeMainNode",os),d(w,"newChild",ss),d(w,"newDefinition",tn),d(w,"newEvent",en),d(w,"newState",ns);var k=class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}};d(k,"specializeClass",(e,t)=>class extends e{constructor(){super(t)}});var et,Jt,us=["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"],pe=class{constructor(e){o(this,et,null);o(this,Jt,new window.Object);l(this,et,e)}detect(){us.forEach(e=>n(this,Jt)[e]=typeof n(this,et)[e]=="function")}immediateTrigger(e,t){n(this,Jt)[e]&&n(this,et)[e].call(n(this,et),t)}committedTrigger(e,t){n(this,Jt)[e]&&window.requestAnimationFrame(()=>n(this,et)[e].call(n(this,et),t))}};et=new WeakMap,Jt=new WeakMap;var B,b,I,F,m,Ee,v,ye,D,Y,Vt,nt,V,st,ft,rt,_t,be,Qe,Ze,T,f,vt,G,ti,un,ei,fn,ii,wn,Te,Ii,ni,mn,wt,Yt,qt,Xe,si,pn,Ie,Si,Se,Ai,ri,gn,Ae,_i,oi,En,_e,vi,ve,Oi,Oe,Di,De,Ni,{EMPTY_STRING:ge,noop:W,isOf:_,isAssignedObject:fs,isNonEmptyArray:ln,isNonEmptyString:At,forcedStringSplit:hn,forEachOwnProperty:ws}=p,{removeChildren:ms}=j,{WUSEKEY_ATTRIBUTE:Ve,DEFAULT_STYLE_TYPE:ps,DEFAULT_STYLE_MEDIA:gs,DEFAULT_REPLACEMENT_OPEN:Es,DEFAULT_REPLACEMENT_CLOSE:ys,SLOTS_KIND:cn}=K,{createReactiveField:bs}=ee,O={onInvalidState:W,onInvalidKey:W,onInvalidDefinition:W,onLockedDefinition:W,onTakenId:W,onAllowHTML:W},it=(r,e)=>window.Wuse.debug(`#${r.id} (${r.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`),qe=(r,e)=>w.performValidations(w.newChild(r,e)),Ts=()=>({mainDefinition:w.newDefinition(),styleMedia:gs,styleType:ps,rawContent:!1,attributeKeys:!1,elementKeys:!0,autokeyChildren:!0}),Is=()=>({attachment:new window.Wuse.PerformanceMeasurement.StopWatch,partial:new window.Wuse.PerformanceMeasurement.StopWatch,full:new window.Wuse.PerformanceMeasurement.StopWatch,dettachment:new window.Wuse.PerformanceMeasurement.StopWatch}),Ss=()=>({main:new Bt(window.Wuse.hashRoutine),style:new Bt(window.Wuse.hashRoutine)}),Ci=class extends window.HTMLElement{constructor(t){super();o(this,ti);o(this,ei);o(this,ii);o(this,Te);o(this,ni);o(this,wt);o(this,qt);o(this,si);o(this,Ie);o(this,Se);o(this,ri);o(this,Ae);o(this,oi);o(this,_e);o(this,ve);o(this,Oe);o(this,De);o(this,B,new window.String);o(this,b,new class extends St{constructor(){super(...arguments);d(this,"on_version_change",()=>{this.last!==null&&(this.last.version=this.version,this.last.replacements=U.extractReplacementsFromRule(this.last)),window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,`rules list version change: ${this.version}`)});d(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,"rules list is locked and can not be changed"),O.onLockedDefinition(n(this,m).mainDefinition.id)})}getIndexOf(i){for(let s=0;s<this.length;s++)if(this[s].selector===i)return s;return-1}}(this));o(this,I,new class extends St{constructor(){super(...arguments);d(this,"on_version_change",()=>{var i;this.last!==null&&(this.last.version=this.version,this.last.replacements=U.extractReplacementsFromChild(this.last)),n(this.owner,Y)||l(i=this.owner,Y,n(i,Y)|this.some(s=>s.kind===cn)),window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,`children list version change: ${this.version}`)});d(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,"children list is locked and can not be changed"),O.onLockedDefinition(n(this,m).mainDefinition.id)});d(this,"on_recall_part",i=>n(this.owner,be).tryToRemember(i))}getIndexOf(i){for(let s=0;s<this.length;s++)if(this[s].id===i)return s;return-1}}(this));o(this,F,new class extends St{constructor(){super(...arguments);d(this,"on_version_change",()=>{window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,`fields list version change: ${this.version}`)});d(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&n(this.owner,D)&&it(this.owner,"fields list is locked and can not be changed"),O.onLockedDefinition(n(this,m).mainDefinition.id)});d(this,"on_snapshot_part",i=>i.value=this.owner[i.name]);d(this,"on_recall_part",i=>this.owner[i.name]=i.value)}getIndexOf(i){for(let s=0;s<this.length;s++)if(this[s].name===i)return s;return-1}}(this));o(this,m,Ts());o(this,Ee,void 0);o(this,v,new pe(this));o(this,ye,!1);o(this,D,!1);o(this,Y,!1);o(this,Vt,window.Wuse.isShadowElement(this));o(this,nt,void 0);o(this,V,void 0);o(this,st,null);o(this,ft,!1);o(this,rt,!1);o(this,_t,!0);o(this,be,{tryToName:t=>{t.attributes[Ve]||(t.attributes[Ve]=n(this,T).nameFiliatedKey(t.hash))},tryToRemember:t=>{let i=t.attributes[Ve];i&&n(this,T).rememberFiliatedKey(i)}});o(this,Qe,t=>{t&&(l(this,m,t.options),l(this,Y,t.slotted),l(this,D,t.identified),l(this,B,t.html),n(this,I).restore(this,t.children),n(this,b).restore(this,t.rules),n(this,F).restore(this,t.fields))});o(this,Ze,()=>({options:n(this,m),html:n(this,B),children:n(this,I).persist(),rules:n(this,b).persist(),fields:n(this,F).persist(),slotted:n(this,Y),identified:n(this,D)}));o(this,T,new class extends he{on_invalid_state(){O.onInvalidState()}on_invalid_key(){O.onInvalidKey()}}(w.newState,n(this,Qe),n(this,Ze),window.Wuse.elementsStorage));o(this,f,{root:new class extends Tt{on_content_invalidation(t){this.owner.innerHTML=t}}(this),style:new class extends Tt{on_content_invalidation(t){n(this.owner,V).promote(t)}}(this),main:new class extends Tt{on_content_invalidation(t){n(this.owner,nt).promote(t)}}(this),verifiers:{main:t=>!n(this,vt).main.compute(t),style:t=>!n(this,vt).style.compute(t)},renderizers:{rule:t=>n(this,f).style.append(t.cache?t.cache:t.cache=y.renderRule(n(this,f).replacer,t)),children:{mixed:t=>t.kind===cn?n(this,f).renderizers.children.slot(t):n(this,f).renderizers.children.normal(t),slot:t=>{t.cache||(n(this,f).root.verify(i=>!0),n(this,f).root.append(t.cache=y.renderChild(n(this,f).replacer,t)))},normal:t=>{n(this,f).main.append(t.cache?t.cache:t.cache=y.renderChild(n(this,f).replacer,t)),t.rules.forEach(n(this,f).renderizers.rule)}}},replacer:(t,i)=>t.replace(i.find,this[i.field]!==void 0?this[i.field]:ge),gotModified:()=>n(this,f).root.invalidated||n(this,f).main.invalidated||n(this,f).style.invalidated,getDebugInfo:()=>`updated (root: ${n(this,f).root.invalidated}, main: ${n(this,f).main.invalidated}, style: ${n(this,f).style.invalidated})`});o(this,vt,Ss());o(this,G,Is());d(this,"info",{instanceNumber:++Ci.instancesCount,unmodifiedRounds:0,updatedRounds:0});l(this,st,t===k.REGULAR?this:this.shadowRoot||this.attachShadow({mode:t})),n(this,v).detect(),n(this,v).immediateTrigger("on_create"),n(this,m).attributeKeys&&this.getAttributeNames().forEach(i=>this[i]=this.getAttribute(i)),this.dataset.wusekey&&this.setElementsStoreKey(this.dataset.wusekey),n(this,v).immediateTrigger(n(this,T).initializeState()>1?"on_reconstruct":"on_construct",n(this,T).state),l(this,ye,!0)}get render(){return n(this,rt)?h(this,ri,gn):W}get redraw(){return n(this,rt)?h(this,oi,En):W}get parameters(){return n(this,Ee)}set parameters(t){fs(l(this,Ee,t))&&ws(t,i=>this[i]=t[i])}connectedCallback(){window.Wuse.MEASURE&&n(this,G).attachment.start(),n(this,v).detect(),n(this,v).immediateTrigger("on_connect"),h(this,Ae,_i).call(this,"on_load"),window.Wuse.MEASURE&&n(this,G).attachment.stop(window.Wuse.DEBUG)}disconnectedCallback(){window.Wuse.MEASURE&&n(this,G).dettachment.start(),h(this,wt,Yt).call(this,!1),n(this,v).immediateTrigger("on_disconnect"),n(this,T).writeState(),window.Wuse.MEASURE&&n(this,G).dettachment.stop(window.Wuse.DEBUG)}getElementsStore(){return n(this,T).getStore()}setElementsStore(t){return n(this,T).setStore(t),this}hasElementsStoreKey(){return n(this,T).hasKey()}getElementsStoreKey(t){return n(this,T).key}setElementsStoreKey(t){return(n(this,T).key=t)&&(this.setAttribute(Ve,t),n(this,T).writeState()),this}deriveChildrenStoreKey(t){n(this,m).autokeyChildren=t}persistToElementsStore(){return n(this,T).validateKey()&&n(this,T).writeState()}restoreFromElementsStore(){return n(this,T).validateKey()&&n(this,T).readState()}removeFromElementsStore(){return n(this,T).validateKey()&&n(this,T).eraseState()}selectChildElement(t){return n(this,st).querySelector(t)}getMainAttribute(t){return n(this,ft)?n(this,nt).element.setAttribute(t):void 0}setMainAttribute(t,i){return n(this,ft)&&n(this,nt).element.setAttribute(t,i),this}setMainElement(t){let i=qe(t);if(i!==null){if(At(i.content)||ln(i.events))return O.onInvalidDefinition(t);l(this,D,At(i.id))&&(n(this,m).mainDefinition.id=i.id),At(i.tag)&&(n(this,m).mainDefinition.tag=i.tag),ln(i.classes)&&(n(this,m).mainDefinition.classes=i.classes),_(i.style,window.Object)&&(n(this,m).mainDefinition.style=i.style),_(i.attributes,window.Array)&&(n(this,m).mainDefinition.attributes=i.attributes)}return this}setStyleOptions(t,i){return n(this,m).styleMedia=At(t)?t:ge,n(this,m).styleType=At(i)?i:ge,this}setElementsAsKeys(t){return n(this,m).elementKeys=!!t,this}setAttributesAsKeys(t){return n(this,m).attributeKeys=!!t,this}allowRawContent(t){return n(this,m).rawContent=!!t,this}setRawContent(t){return n(this,m).rawContent?l(this,B,t):O.onAllowHTML(),this}appendRawContent(t){return n(this,m).rawContent?l(this,B,n(this,B)+t):O.onAllowHTML(),this}prependRawContent(t){return n(this,m).rawContent?l(this,B,t+n(this,B)):O.onAllowHTML(),this}lockCSSRules(){return n(this,b).locked=!0,this}unlockCSSRules(){return n(this,b).locked=!1,this}appendCSSRule(t,i,s){if(s)return this.appendCSSNestedRule(t,i,s);let a=n(this,b).slice(-1),c=w.newRule(t,i);return(!a.length||!w.tryToJoinRules(a[0],c))&&n(this,b).append(c),this}prependCSSRule(t,i,s){if(s)return this.prependCSSNestedRule(t,i,s);let a=n(this,b).slice(0,1),c=w.newRule(t,i);return(!a.length||!w.tryToJoinRules(a[0],c))&&n(this,b).prepend(c),this}appendCSSNestedRule(t,i,s){let a=n(this,b).slice(-1),c=w.newNestedRule(t,i,s);return(!a.length||!w.tryToJoinNestedRules(a[0],c))&&n(this,b).append(c),this}prependCSSNestedRule(t,i,s){let a=n(this,b).slice(0,1),c=w.newNestedRule(t,i,s);return(!a.length||!w.tryToJoinNestedRules(a[0],c))&&n(this,b).prepend(c),this}hasCSSRuleBySelector(t){return n(this,b).getIndexOf(t)>-1}replaceCSSRuleBySelector(t,i){let s=n(this,b).getIndexOf(t);return s>-1&&(n(this,b)[s]=w.newRule(t,i)),this}removeCSSRuleBySelector(t){let i=n(this,b).getIndexOf(t);return i>-1&&n(this,b).splice(i,1),this}lockChildElements(){return n(this,I).locked=!0,this}unlockChildElements(){return n(this,I).locked=!1,this}appendChildElement(t,i){let s=h(this,De,Ni).call(this,qe(t,i));return s!==null&&n(this,I).append(s),this}prependChildElement(t,i){let s=h(this,De,Ni).call(this,qe(t,i));return s!==null&&n(this,I).prepend(s),this}appendChildElements(t){return(_(t,window.Array)?t:hn(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(_(t,window.Array)?t:hn(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}replaceChildElementById(t,i,s){let a=n(this,I).getIndexOf(t);if(a>-1){let c=qe(i,s);c!==null&&n(this,I).replace(a,c)}return this}removeChildElementById(t){let i=n(this,I).getIndexOf(t);return i>-1&&n(this,I).remove(i),this}checkChildElementIsIncludedById(t,i,s){let a=c=>_(c,window.Function)?c():void 0;return n(this,I).some(c=>c.id===t&&c.included)?a(i):a(s),this}includeChildElementById(t){return n(this,I).forEach(i=>i.id===t&&y.renderingIncluder(i)),this}excludeChildElementById(t){return n(this,I).forEach(i=>i.id===t&&y.renderingExcluder(i)),this}invalidateChildElementsById(t){return n(this,I).forEach(i=>t.indexOf(i.id)>-1&&y.cacheInvalidator(i)),this}invalidateChildElements(t){return _(t,window.Array)&&t.forEach(y.cacheInvalidator),this}lockInstanceFields(){return n(this,F).locked=!0,this}unlockInstanceFields(){return n(this,F).locked=!1,this}makeField(t,i){return h(this,Oe,Di).call(this,t,i,!0)}makeReadonlyField(t,i){return h(this,Oe,Di).call(this,t,i,!1)}makeReactiveField(t,i,s,a=!0){return bs(this,t,i,s,(c,u)=>h(this,_e,vi).call(this,c,u||"$auto"),c=>this.dropField(c)),h(this,ve,Oi).call(this,t,i),a&&h(this,_e,vi).call(this,t,"$init"),this}makeExternalReactiveField(t,i,s,a,c=!0){return this.makeReactiveField(i,t[i]||s,u=>{t[i]=this[i],a(u)},c)}hasField(t){return n(this,F).getIndexOf(t)>-1}dropField(t){let i=n(this,F).getIndexOf(t);return i>-1?(this.hasOwnProperty(t)&&delete this[t],n(this,F).splice(i,1),n(this,T).writeState(),!0):!1}suspendRender(){return l(this,_t,!1),this}resumeRender(t=!0){return l(this,_t,!0),t&&this.render(),this}isRenderSuspended(){return!n(this,_t)}static initialize(t){if(U.initialize(Es,ys),_(t,window.Object)){_(t.onFetchTemplate,window.Function)&&y.initialize({onFetchTemplate:t.onFetchTemplate}),_(t.onAllowHTML,window.Function)&&(O.onAllowHTML=t.onAllowHTML),_(t.onInvalidKey,window.Function)&&(O.onInvalidKey=t.onInvalidKey),_(t.onInvalidState,window.Function)&&(O.onInvalidState=t.onInvalidState),_(t.onLockedDefinition,window.Function)&&(O.onLockedDefinition=t.onLockedDefinition),_(t.onTakenId,window.Function)&&(O.onTakenId=t.onTakenId);let i={onInvalidDefinition:W,onInexistentTemplate:W,onUnespecifiedSlot:W,onInvalidId:W,onUnknownTag:W};_(t.onInvalidDefinition,window.Function)&&(O.onInvalidDefinition=t.onInvalidDefinition,i.onInvalidDefinition=t.onInvalidDefinition),_(t.onInexistentTemplate,window.Function)&&(i.onInexistentTemplate=t.onInexistentTemplate),_(t.onUnespecifiedSlot,window.Function)&&(i.onUnespecifiedSlot=t.onUnespecifiedSlot),_(t.onInvalidId,window.Function)&&(i.onInvalidId=t.onInvalidId),_(t.onUnknownTag,window.Function)&&(i.onUnknownTag=t.onUnknownTag),w.initialize(i)}}static register(){return Wuse.register(this)}static create(t,i="body"){return Wuse.create({element:{type:this},target:{selector:i},instance:{parameters:t}})}},H=Ci;B=new WeakMap,b=new WeakMap,I=new WeakMap,F=new WeakMap,m=new WeakMap,Ee=new WeakMap,v=new WeakMap,ye=new WeakMap,D=new WeakMap,Y=new WeakMap,Vt=new WeakMap,nt=new WeakMap,V=new WeakMap,st=new WeakMap,ft=new WeakMap,rt=new WeakMap,_t=new WeakMap,be=new WeakMap,Qe=new WeakMap,Ze=new WeakMap,T=new WeakMap,f=new WeakMap,vt=new WeakMap,G=new WeakMap,ti=new WeakSet,un=function(){n(this,V)&&n(this,V).affiliate(),n(this,nt).affiliate(),l(this,ft,!0)},ei=new WeakSet,fn=function(){l(this,V,n(this,b).length?new Pt(n(this,st),w.makeStyleNode(n(this,m).styleMedia,n(this,m).styleType)):null),l(this,nt,new Pt(n(this,st),w.makeMainNode(n(this,m).mainDefinition)))},ii=new WeakSet,wn=function(){n(this,ft)&&(n(this,nt).disaffiliate(),n(this,V)&&n(this,V).disaffiliate(),n(this,Y)&&n(this,Vt)&&ms(this)),l(this,ft,!1)},Te=new WeakSet,Ii=function(t,i){return{event:t,key:()=>(n(this,D)&&i(n(this,m).mainDefinition.id),s=>i(s.id))}},ni=new WeakSet,mn=function(t){return{key:n(this,m).elementKeys&&t.key(),event:(i,s,a)=>{let c=this[`on_${i}_${s}`];if(c){let u=h(this,qt,Xe).call(this,i);u&&u[t.event](s,c,a)}},slots:()=>this.on_slot_change&&n(this,st).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}},wt=new WeakSet,Yt=function(t){if(n(this,rt)&&!t||!n(this,rt)&&t){let i=h(this,ni,mn).call(this,t?h(this,Te,Ii).call(this,"addEventListener",s=>At(s)&&(this[s]=h(this,qt,Xe).call(this,s))):h(this,Te,Ii).call(this,"removeEventListener",s=>delete this[s]));n(this,I).forEach(s=>{!s.included&&t||(i.key&&i.key(s),s.events.forEach(a=>a&&i.event(s.id,a.kind,a.capture)))}),n(this,Y)&&n(this,Vt)&&i.slots(),l(this,rt,t)}},qt=new WeakSet,Xe=function(t){return At(t)?n(this,st).querySelector(`#${t}`):void 0},si=new WeakSet,pn=function(){n(this,I).forEach(y.cacheInvalidator),n(this,b).forEach(y.cacheInvalidator)},Ie=new WeakSet,Si=function(){n(this,f).root.reset(ge),n(this,f).style.reset(ge),n(this,f).main.reset(n(this,B));let t=n(this,Y)&&n(this,Vt)?n(this,f).renderizers.children.mixed:n(this,f).renderizers.children.normal;n(this,I).forEach(i=>i.included&&t(i)),n(this,b).forEach(n(this,f).renderizers.rule),n(this,f).main.verify(n(this,f).verifiers.main),n(this,f).style.verify(n(this,f).verifiers.style)},Se=new WeakSet,Ai=function(t,i,s){n(this,f).root.process(t),n(this,f).style.process(i),n(this,f).main.process(s),window.Wuse.DEBUG&&n(this,D)&&it(this,n(this,f).getDebugInfo())},ri=new WeakSet,gn=function(){!window.Wuse.RENDERING||!n(this,_t)||(window.Wuse.MEASURE&&n(this,G).partial.start(),n(this,v).immediateTrigger("on_prerender"),h(this,Ie,Si).call(this),n(this,f).gotModified()?(h(this,wt,Yt).call(this,!1),h(this,Se,Ai).call(this,!1,!1,!1),h(this,wt,Yt).call(this,!0),this.info.updatedRounds++,n(this,v).immediateTrigger("on_update"),n(this,T).writeState(),n(this,v).committedTrigger("on_refresh")):this.info.unmodifiedRounds++,window.Wuse.DEBUG&&n(this,D)&&it(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${n(this,vt).main.rounds}, style: ${n(this,vt).style.rounds}) | updated: ${this.info.updatedRounds}`),n(this,v).immediateTrigger("on_postrender"),window.Wuse.MEASURE&&n(this,G).partial.stop(window.Wuse.DEBUG))},Ae=new WeakSet,_i=function(t){h(this,si,pn).call(this),h(this,ei,fn).call(this),h(this,ti,un).call(this),n(this,v).immediateTrigger("on_inject"),h(this,Ie,Si).call(this),h(this,Se,Ai).call(this,!1,!!n(this,V),!0),h(this,wt,Yt).call(this,!0),n(this,v).immediateTrigger(t),n(this,T).writeState()},oi=new WeakSet,En=function(){window.Wuse.MEASURE&&n(this,G).full.start(),h(this,wt,Yt).call(this,!1),h(this,ii,wn).call(this),n(this,v).immediateTrigger("on_unload"),n(this,v).detect(),h(this,Ae,_i).call(this,"on_reload"),n(this,v).committedTrigger("on_repaint"),window.Wuse.MEASURE&&n(this,G).full.stop(window.Wuse.DEBUG)},_e=new WeakSet,vi=function(t,i="$none"){if(n(this,rt)){let s=U.scanRulesForReplacements(n(this,b),t);s.forEach(y.cacheInvalidator);let a=U.scanChildrenForReplacements(n(this,I),t);a.forEach(y.cacheInvalidator),window.Wuse.DEBUG&&n(this,D)&&it(this,`reactive render (label: ${i}, field: ${t}, children: ${a.length}, rules: ${s.length})`),(!!s.length||!!a.length)&&(a.some(c=>!!c.kind.length)&&n(this,I).forEach(y.slotsInvalidator),this.render())}},ve=new WeakSet,Oi=function(t,i){let s=n(this,F).getIndexOf(t);s>-1?n(this,F)[s].value=i:n(this,F).append({name:t,value:i})},Oe=new WeakSet,Di=function(t,i,s){return window.Object.defineProperty(this,t,{value:i,writable:s}),h(this,ve,Oi).call(this,t,i),this},De=new WeakSet,Ni=function(t){if(t!==null){if(n(this,ye)&&h(this,qt,Xe).call(this,t.id))return O.onTakenId(t.id);t.custom&&n(this,m).autokeyChildren&&n(this,T).hasKey()&&n(this,be).tryToName(t)}return t},d(H,"instancesCount",0);var yn=(r,e)=>window.Object.getOwnPropertyNames(e).forEach(t=>Object.defineProperty(r,t,{value:e[t],writable:!1,configurable:!1,enumerable:!1})),Ot=class{static detectFeatures(e){let t=(i,s)=>!i&&E.UNSUPPORTED_FEATURE.emit(s);try{t(e.JsHelpers.isOf(window.document,window.HTMLDocument),"HTML Document"),t(e.JsHelpers.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),e.WebHelpers.onDOMContentLoaded(()=>t(e.JsHelpers.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(i){E.UNKNOWN_ERROR.emit()}}static initializeModules(e){e.PerformanceMeasurement.initialize((t,i)=>e.debug(JSON.stringify(e.JsHelpers.buildArray(s=>{switch(s.push({instances:e.elementCount}),s.push(t.getDebugInfo()),i){case"stop":s.push(e.PerformanceMeasurement.DOMUpdate.overall.getDebugInfo());break;case"finish":s.push(e.PerformanceMeasurement.BrowserRender.overall.getDebugInfo());break}})))),dt.initialize({onExtinctTemplate:E.EXTINCT_TEMPLATE.emit,onInvalidTemplate:E.INVALID_TEMPLATE.emit}),S.initialize({onBadTarget:E.BAD_TARGET.emit,onMisnamedClass:E.MISNAMED_CLASS.emit,onUnregistrableClass:E.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:E.UNREGISTERED_CLASS.emit,onAlreadyRegistered:E.ALREADY_REGISTERED.emit,onInvalidClass:E.INVALID_CLASS.emit,onDeferredInstantiation:e.WebHelpers.onDOMContentLoaded}),H.initialize({onAllowHTML:E.ALLOW_HTML.emit,onInvalidKey:E.INVALID_KEY.emit,onInvalidDefinition:E.INVALID_DEFINITION.emit,onLockedDefinition:E.LOCKED_DEFINITION.emit,onInexistentTemplate:E.INEXISTENT_TEMPLATE.emit,onUnespecifiedSlot:E.UNESPECIFIED_SLOT.emit,onUnknownTag:E.UNKNOWN_TAG.emit,onInvalidId:E.INVALID_ID.emit,onTakenId:E.TAKEN_ID.emit,onInvalidState:E.INVALID_STATE.emit,onFetchTemplate:dt.fetch})}static declareUnwritableMembers(e,t){yn(e,t.fields),yn(e,t.methods)}};var ui,Tn,bn,hi,ci,Xt,ai=r=>r>1e3?(r/1e3).toFixed(2)+"s":r.toFixed(2)+"ms",di=class{constructor(){d(this,"round",0);d(this,"domTime",window.Number.MAX_SAFE_INTEGER);d(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=ai(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=ai(this.renderTime)),e}},li=class{constructor(e){d(this,"name","");d(this,"rounds",0);d(this,"time",0);d(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=ai(this.time),t=ai(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:t}}},M=class{static initialize(e){typeof e=="function"&&l(M,Xt,e),M.DOMUpdate.overall=new li("overall-dom-update"),M.BrowserRender.overall=new li("overall-browser-render")}},ot=M;Xt=new WeakMap,o(ot,Xt,()=>{}),d(ot,"StopWatch",(bn=class{constructor(){o(this,ui);d(this,"_begin",0);d(this,"_end",{dom:0,render:0});d(this,"rounds",0);d(this,"last",new di);d(this,"best",new di);d(this,"averages",{dom:0,render:0})}start(){(M.DOMUpdate.check||M.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var t;M.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,M.DOMUpdate.overall.compute(this.last.domTime)),M.BrowserRender.check?setTimeout(()=>h(this,ui,Tn).bind(this)(e)):e&&n(t=M,Xt).call(t,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},ui=new WeakSet,Tn=function(e){var t;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,M.BrowserRender.overall.compute(this.last.renderTime),e&&n(t=M,Xt).call(t,this,"finish")},bn)),d(ot,"DOMUpdate",(hi=class{},d(hi,"check",!0),d(hi,"overall",null),hi)),d(ot,"BrowserRender",(ci=class{},d(ci,"check",!1),d(ci,"overall",null),ci));var at,Ce,Li,Ne=class{constructor(){o(this,Ce);o(this,at,new window.Object)}get length(){return h(this,Ce,Li).call(this).length}key(e){return h(this,Ce,Li).call(this)[e]||null}getItem(e){return n(this,at)[e]}setItem(e,t){n(this,at)[e]=t}removeItem(e){delete n(this,at)[e]}clear(){l(this,at,new window.Object)}hasItem(e){return n(this,at).hasOwnProperty(e)}};at=new WeakMap,Ce=new WeakSet,Li=function(){return window.Object.keys(n(this,at))};var In="0.7.0";var g,{noop:Le,isOf:fi}=p;window.Wuse=window.Wuse||(g=class{static get VERSION(){return In}static get elementCount(){return H.instancesCount}},d(g,"DEBUG",!1),d(g,"FATALS",!1),d(g,"MEASURE",!1),d(g,"RENDERING",!0),d(g,"hashRoutine",q.defaultRoutine),d(g,"elementsStorage",new Ne),d(g,"tmp",null),d(g,"WebHelpers",null),d(g,"JsHelpers",null),d(g,"PerformanceMeasurement",null),d(g,"NonShadowElement",null),d(g,"OpenShadowElement",null),d(g,"ClosedShadowElement",null),d(g,"debug",Le),d(g,"blockUpdate",Le),d(g,"register",Le),d(g,"instantiate",Le),d(g,"isShadowElement",Le),(()=>{Ot.declareUnwritableMembers(g,{fields:{tmp:new window.Object,WebHelpers:j,JsHelpers:p,PerformanceMeasurement:ot,NonShadowElement:k.specializeClass(H,k.REGULAR),OpenShadowElement:k.specializeClass(H,k.OPEN),ClosedShadowElement:k.specializeClass(H,k.CLOSED)},methods:{debug:e=>window.console.log("[WUSE:DEBUG]",e),blockUpdate:(e,t)=>{if(fi(e,Function)){window.Wuse.DEBUG&&window.Wuse.debug("blocking"),window.Wuse.RENDERING=!1;try{e(t)}catch(i){throw i}finally{window.Wuse.RENDERING=!0,window.Wuse.DEBUG&&window.Wuse.debug("unblocking")}}},isShadowElement:e=>{let t=window.Object.getPrototypeOf(e.constructor);return t===window.Wuse.OpenShadowElement||t===window.Wuse.ClosedShadowElement},register:e=>S.registerClasses(fi(e,window.Array)?e:new window.Array(e)),instantiate:(e,t,i)=>S.instantiateClasses(fi(e,window.Array)?e:new window.Array(e),t,i),create:(e,t)=>fi(e,window.Object)?S.createInstance(e.element,e.target,e.instance):void 0}}),Ot.detectFeatures(g),Ot.initializeModules(g)})(),g);})();
