(()=>{var Ms=Object.defineProperty;var Us=(r,e,t)=>e in r?Ms(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var l=(r,e,t)=>(Us(r,typeof e!="symbol"?e+"":e,t),t),Ei=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var s=(r,e,t)=>(Ei(r,e,"read from private field"),t?t.call(r):e.get(r)),a=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},c=(r,e,t,i)=>(Ei(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);var h=(r,e,t)=>(Ei(r,e,"access private method"),t);var y=(r,e)=>({code:r,emit:t=>{let i=r<80?"error":"warn",n=`[WUSE:${i.toUpperCase()}] ${r} | ${e(t)}`;if(window.Wuse&&window.Wuse.FATALS||r<10)throw new window.Error(n);return window.console[i](n),null}}),g=class{static get UNKNOWN_ERROR(){return y(0,e=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return y(1,e=>`Unsupported feature: ${e}.`)}static get UNREGISTERED_CLASS(){return y(2,e=>`Unregistered class: ${e}.`)}static get UNREGISTRABLE_CLASS(){return y(3,e=>`Unregistrable class: ${e}.`)}static get INVALID_CLASS(){return y(4,e=>`Invalid class: ${e}.`)}static get MISNAMED_CLASS(){return y(5,e=>`Misnamed class: ${e}.`)}static get INVALID_DEFINITION(){return y(10,e=>`Invalid definition: ${e}.`)}static get INVALID_ID(){return y(11,e=>`Invalid id: ${e}.`)}static get INVALID_KEY(){return y(12,e=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return y(13,e=>"Call first: this.allowRawContent(true).")}static get INVALID_STATE(){return y(14,e=>"Invalid state.")}static get TAKEN_ID(){return y(15,e=>`Taken id: ${e}.`)}static get MISNAMED_FIELD(){return y(16,e=>`Misnamed field: ${e}.`)}static get INEXISTENT_TEMPLATE(){return y(20,e=>`Inexistent template: #${e}.`)}static get EXTINCT_TEMPLATE(){return y(21,e=>`Extinct template: #${e}.`)}static get INVALID_TEMPLATE(){return y(22,e=>`Invalid template: #${e}.`)}static get UNESPECIFIED_SLOT(){return y(30,e=>`Unespecified slot: #${e}.`)}static get LOCKED_DEFINITION(){return y(40,e=>`Locked definition: #${e}.`)}static get UNKNOWN_TAG(){return y(80,e=>`Unknown tag: ${e}.`)}static get BAD_TARGET(){return y(81,e=>`Bad target: ${e}.`)}static get ALREADY_REGISTERED(){return y(90,e=>`Already registered: ${e}.`)}};var He,Ke,w=class{static get EMPTY_STRING(){return s(this,He)}static get EMPTY_ARRAY(){return s(this,Ke)}static noop(){}static isNonEmptyString(e){return typeof e=="string"&&!!e.length}static forcedStringSplit(e,t){return typeof e=="string"?e.split(t):new window.Array}static buildArray(e){let t=new window.Array;return typeof e=="function"&&e(t),t}static buildObject(e){let t=new window.Object;return typeof e=="function"&&e(t),t}static ensureFunction(e,t=()=>{}){return typeof e=="function"?e:t}static isOf(e,t){return e!=null&&(e.constructor===t||t!=null&&e.constructor.name===t.name)}static areOf(e,t){var i=!!(e&&e.constructor===window.Array&&!!e.length);if(i)for(var n in e){let o=e[n];if(!(o!=null&&(o.constructor===t||t!=null&&o.constructor.name===t.name))){i=!1;break}}return i}static hasObjectKeys(e){return!!(e&&!!window.Object.keys(e).length)}static cloneObject(e){return window.Object.assign(new window.Object,e)}static forEachOwnProperty(e,t){e&&window.Object.getOwnPropertyNames(e).forEach(t)}static isAssignedObject(e){return typeof e=="object"&&e!==null}static isAssignedArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"}static isNonEmptyArray(e){return typeof e=="object"&&e!==null&&e.constructor.name==="Array"&&!!e.length}static isIntegerNumber(e){return(typeof e=="number"||typeof e=="string"&&!!e.length)&&window.Number.isInteger(window.Number(e))}};He=new WeakMap,Ke=new WeakMap,a(w,He,new window.String().valueOf()),a(w,Ke,window.Object.freeze(new window.Array));var Ft,xt,{noop:Gi,ensureFunction:Pi,isAssignedObject:Fs}=w,ot=class{static fetch(e){let t=window.document.getElementById(e);return t===null?s(this,Ft).call(this,e):t.tagName!=="TEMPLATE"?s(this,xt).call(this,e):t.innerHTML}static initialize(e){Fs(e)&&(c(this,Ft,Pi(e.onExtinctTemplate,s(this,Ft))),c(this,xt,Pi(e.onInvalidTemplate,s(this,xt))))}};Ft=new WeakMap,xt=new WeakMap,a(ot,Ft,Gi),a(ot,xt,Gi);var $t,jt,Ht,Kt,Bt,Gt,Pt,Be,Yi,Ge,Vi,le,yi,Pe,qi,de,bi,{noop:yt,ensureFunction:at,isAssignedObject:Wt,isAssignedArray:hr,isNonEmptyArray:zi,isOf:Ji,forEachOwnProperty:ur}=w,xs=r=>r.toLowerCase().replaceAll("_","-"),b=class{static registerClasses(e){zi(e)&&window.Array.prototype.forEach.call(e,t=>typeof t=="function"?h(this,le,yi).call(this,t):s(this,Kt).call(this,t))}static instantiateClasses(e,t,i,n){zi(e)&&window.Array.prototype.forEach.call(e,o=>h(this,de,bi).call(this,o,Wt(t)?t:t instanceof window.HTMLElement?{node:t}:{selector:t},Wt(i)?i:new window.Object,n))}static createInstance(e,t,i){if(Wt(e)&&Ji(e.type,window.Function))return e.register===!0&&h(this,le,yi).call(this,e.type),t=Wt(t)?t:new window.Object,i=Wt(i)?i:new window.Object,h(this,de,bi).call(this,e.type,t,{on_bad_target:t.on_bad_target,on_element_instantiated:i.on_element_instantiated},i.parameters)}static initialize(e){Wt(e)&&(c(this,$t,at(e.onBadTarget,s(this,$t))),c(this,jt,at(e.onDeferredInstantiation,s(this,jt))),c(this,Kt,at(e.onInvalidClass,s(this,Kt))),c(this,Ht,at(e.onMisnamedClass,s(this,Ht))),c(this,Bt,at(e.onUnregistrableClass,s(this,Bt))),c(this,Gt,at(e.onUnregisteredClass,s(this,Gt))),c(this,Pt,at(e.onAlreadyRegistered,s(this,Pt))))}};$t=new WeakMap,jt=new WeakMap,Ht=new WeakMap,Kt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,Pt=new WeakMap,Be=new WeakSet,Yi=function(e){window.HTMLElement.isPrototypeOf(e)?window.customElements.define(e.tag,e):s(this,Bt).call(this,e.name)},Ge=new WeakSet,Vi=function(e){window.customElements.get(e.tag=xs(e.name))?s(this,Pt).call(this,e.name):h(this,Be,Yi).call(this,e)},le=new WeakSet,yi=function(e){e.name.indexOf("_")>0?h(this,Ge,Vi).call(this,e):s(this,Ht).call(this,e.name)},Pe=new WeakSet,qi=function(e,t,i,n){let o=t.selector,d=t.node;if(!(d instanceof window.HTMLElement))try{d=window.document.querySelector(o)}catch(T){if(Ji(i.on_bad_target,window.Function)){if(i.on_bad_target(o)===!1)return}else{s(this,$t).call(this,o);return}}finally{d=d||window.document.body}let f=window.document.createElement(e.tag);return f.parameters=n,at(i.on_element_instantiated)(f,o),d.appendChild(f),f},de=new WeakSet,bi=function(e,t,i,n){let o=()=>h(this,Pe,qi).call(this,e,t,i,n);return window.customElements.get(e.tag)?window.document.body?o():s(this,jt).call(this,o):s(this,Gt).call(this,e.name)},a(b,Be),a(b,Ge),a(b,le),a(b,Pe),a(b,de),a(b,$t,yt),a(b,jt,yt),a(b,Ht,yt),a(b,Kt,yt),a(b,Bt,yt),a(b,Gt,yt),a(b,Pt,yt);var J=class{static defaultRoutine(e=""){var t=0;for(let i=0;i<e.length;i++)t=(t=(t<<5)-t+e.charCodeAt(i))&t;return t}};var bt=J.defaultRoutine,Xi=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","command","content","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","marquee","mark","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","shadow","select","slot","small","source","spacer","span","strike","strong","style","sub","sup","summary","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","xmp","wbr"].map(bt),Ws=["area","base","br","col","hr","img","input","link","meta","param","command","keygen","source"].map(bt),$s=["accept","accept-charset","accesskey","action","align","allow","alt","async","autocapitalize","autocomplete","autofocus","autoplay","buffered","capture","challenge","charset","checked","cite","class","code","codebase","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","csp","data","datetime","decoding","default","defer","dir","dirname","disabled","download","draggable","enctype","enterkeyhint","for","form","formaction","formenctype","formmethod","formnovalidate","formtarget","headers","hidden","high","href","hreflang","http-equiv","icon","id","importance","integrity","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","referrerpolicy","rel","required","reversed","role","rows","rowspan","sandbox","scope","scoped","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","translate","type","usemap","value","width","wrap"].map(bt),k=class{static onDOMContentLoaded(e){if(e&&e.constructor===window.Function){let t=()=>{e(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",t),100)};window.addEventListener("DOMContentLoaded",t)}}static buildDOMElement(e,t){if(typeof e!="string"||Xi.indexOf(bt(e))===-1)return null;let i=window.document.createElement(e);return typeof t=="function"&&t(i),i}static buildDOMFragment(e){let t=window.document.createDocumentFragment();return typeof e=="function"&&e(t),t}static getUniqueId(e="WUSE"){let t="_"+(e||"")+"_";for(var i;window.document.getElementById(i=t+(""+window.Math.random()).substring(2))!==null;);return i}static removeChildren(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}static isHTMLTag(e){return typeof e=="string"&&Xi.indexOf(bt(e))>-1}static isHTMLVoidTag(e){return typeof e=="string"&&Ws.indexOf(bt(e))>-1}static isHTMLAttribute(e){return typeof e=="string"&&$s.indexOf(bt(e))>-1}static htmlEncode(e=""){return typeof e!="string"?null:e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let e=window.getComputedStyle(window.document.body,""),i=window.Array.prototype.slice.call(e).filter(n=>n.charAt(0)==="-");return i.length?"-"+i[0].split("-")[1]+"-":""}};var M=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}static get WUSEKEY_ATTRIBUTE(){return"data-wusekey"}static get WUSENODE_ATTRIBUTE(){return"data-wusenode"}};var{noop:yr,isOf:Qi,isNonEmptyString:js}=w,Zi=r=>!Qi(r,window.Function),Hs=(r,e,t,i,n,o,d,f)=>n(()=>e,T=>{o(T,t),Zi(t)?i(r):t({renderize:H=>i(r,H),automate:()=>o(T,null),dereact:()=>n(()=>T,d),remove:()=>f(r)})}),Ks=(r,e,t,i,n,o)=>{let d=(v,rt)=>{window.Object.defineProperty(r,e,{get:v,set:rt,enumerable:!0,configurable:!0})},f=Zi(o)?v=>delete r[v]:o,T=v=>{f(e),r[e]=v},H=(v,rt)=>Hs(e,v,rt,n,d,H,T,f);return H(t,i)},ce=class{static createReactiveField(e,t,i,n,o,d){return e&&js(t)&&Qi(o,window.Function)?Ks(e,t,i,n,o,d):null}};var lt=class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}};l(lt,"specializeClass",(e,t)=>class extends e{constructor(){super(t)}});var Y,zt,Bs=["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"],he=class{constructor(e){a(this,Y,null);a(this,zt,new window.Object);c(this,Y,e)}detect(){Bs.forEach(e=>s(this,zt)[e]=typeof s(this,Y)[e]=="function")}immediateTrigger(e,t){s(this,zt)[e]&&s(this,Y)[e].call(s(this,Y),t)}committedTrigger(e,t){s(this,zt)[e]&&window.requestAnimationFrame(()=>s(this,Y)[e].call(s(this,Y),t))}};Y=new WeakMap,zt=new WeakMap;var Ye,rs,Ve,os,qe,as,Xe,ls,Qe,ds,Yt,Je,Ze,cs,{isHTMLTag:Gs}=k,{EMPTY_STRING:L,EMPTY_ARRAY:Ps,noop:ue,buildArray:vr,buildObject:zs,isAssignedObject:ze,isAssignedArray:Jt,ensureFunction:fe,hasObjectKeys:ts,isNonEmptyString:dt,forcedStringSplit:Js}=w,{WUSENODE_ATTRIBUTE:es,DEFAULT_TAG:Ys,DEFAULT_KIND:is,TEMPLATES_KIND:Ti,SLOTS_KIND:Ii,TEXTNODE_TAG:Dr}=M,Vs=J.defaultRoutine,K={onInvalidDefinition:ue,onInexistentTemplate:ue,onUnespecifiedSlot:ue,onInvalidId:ue,onUnknownTag:ue},qs=r=>r.indexOf("-")>0&&!Gs(r),V=class{static parse(e){if(dt(e)){let t=e.trimLeft(),i=ss();return t.charAt(0)==="%"?t.startsWith(Ti)?h(this,Yt,Je).call(this,i,t.replace(i.kind=Ti,L)):t.startsWith(Ii)?h(this,Yt,Je).call(this,i,t.replace(i.kind=Ii,L)):null:h(this,Yt,Je).call(this,i,t)}return null}};Ye=new WeakSet,rs=function(e,t){let i=t.indexOf("["),n=t.indexOf("]");if(i>-1&&n>-1&&n>i){let o=t.substr(i,n-i+1),d=o.substr(1,o.length-2).split("|");for(let f in d){let T=d[f].split("=");T[0]==="style"?T[1].split(";").forEach(H=>{let v=H.split(":"),rt=v[0].trim();rt.length&&(e.style[rt]=v[1].trim())}):e.attributes[T[0]]=T[1]||""}return t.replace(o,L)}return t},Ve=new WeakSet,os=function(e,t){let i=t.indexOf("=");return i>-1?(e.content=t.slice(i+1),!!e.content.length&&e.content.charAt(0)==="&"&&(e.content=e.content.slice(1),e.encode=!!e.content.length&&e.content.charAt(0)!=="&"),t.slice(0,i)):t},qe=new WeakSet,as=function(e,t){let i=t.replaceAll("!"," ").split(" ");return i.slice(1).map(n=>{let[o,...d]=n.toLowerCase().split("+"),f=(d||Ps).indexOf("capture")>-1;e.events.push(ns(o,f))}),i[0]},Xe=new WeakSet,ls=function(e,t){let i=t.replaceAll("."," ").split(" ");return e.classes=i.slice(1),i[0]},Qe=new WeakSet,ds=function(e,t){if(dt(t)){let i=t.indexOf("#");i===-1?e.tag=t:(i>0&&(e.tag=t.substr(0,i)),e.id=t.substr(i+1))}return e},Yt=new WeakSet,Je=function(e,t){return h(this,Qe,ds).call(this,e,h(this,Xe,ls).call(this,e,h(this,qe,as).call(this,e,h(this,Ve,os).call(this,e,h(this,Ye,rs).call(this,e,t)))))},a(V,Ye),a(V,Ve),a(V,qe),a(V,Xe),a(V,Qe),a(V,Yt);var me=class{static parse(e){return zs(t=>(Jt(e)?e:Js(e,`
`).map(i=>i.trim()).join(L).split(";")).forEach(i=>dt(i)&&h(this,Ze,cs).call(this,t,i.trim())))}};Ze=new WeakSet,cs=function(e,t){if(!!t.length&&t.indexOf(":")>-1){let[i,...n]=t.split(":"),o=i.trim();if(o.length){let d=n.join(":").trim();e[o]=d.endsWith(";")?d.slice(0,-1):d}}},a(me,Ze);var ss=()=>({kind:is,tag:Ys,id:L,classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:L,encode:!1}),Xs=()=>({generation:0,persisted:!1}),ns=(r,e)=>typeof r=="string"&&typeof e=="boolean"?{kind:r,capture:e}:null,Qs=(r,e)=>{let t=V.parse(r);return t?(t.custom=t.kind===is&&qs(t.tag),t.hash=Vs(r),t.rules=Jt(e)?e:new window.Array,t.included=!0,t.cache=null,t):K.onInvalidDefinition(r)},Zs=r=>{if(r!==null)if(r.kind===Ti){if(!window.document.getElementById(r.id))return K.onInexistentTemplate(r.id)}else if(r.kind===Ii){if(new window.String(r.attributes.slot).replaceAll('"',L).replaceAll("'",L).length===0)return K.onUnespecifiedSlot(r.id)}else{if(typeof r.id!="string")return K.onInvalidId(r.id);r.custom&&!window.customElements.get(r.tag)&&K.onUnknownTag(r.tag)}return r},tn=r=>{if(!ze(r))return null;let e=window.document.createElement(r.tag);if(r.id.length&&e.setAttribute("id",r.id),r.classes.length&&e.setAttribute("class",r.classes.join(" ")),ts(r.style)){var t=new window.String;for(let i in r.style)t+=`${i}: ${r.style[i]}; `;if(t.length){let i=t.trim();e.setAttribute("style",i.endsWith(";")?i.slice(0,-1):i)}}if(ts(r.attributes))for(let i in r.attributes)e.setAttribute(i,r.attributes[i]);return e.setAttribute(es,"main"),e},en=(r,e)=>{let t=window.document.createElement("style");return dt(r)&&t.setAttribute("media",r),dt(e)&&t.setAttribute("type",e),t.setAttribute(es,"style"),t.appendChild(window.document.createTextNode(L)),t},sn=(r,e)=>{let t=Jt(r)?r.join(","):dt(r)?r:L;return t.length?{selector:t,properties:ze(e)?e:me.parse(e),cache:null}:null},nn=(r,e,t)=>{let i=Jt(r)?r.join(","):dt(r)?r:L,n=Jt(e)?e.join(","):dt(e)?e:L;return!i.length||!n.length?null:{selector:i,nested:[{selector:n,properties:ze(t)?t:me.parse(t)}],cache:null}},rn=(r,e)=>{if(r.selector===e.selector){for(let t in e.properties)r.properties[t]=e.properties[t];return r.cache=null,!0}return!1},on=(r,e)=>Jt(r.nested)&&r.selector===e.selector?(e.nested.forEach(t=>{var i=!1;for(let n in r.nested)if(i=r.nested[n].selector===t.selector){for(let o in t.properties)r.nested[n].properties[o]=t.properties[o];break}i||r.nested.push(t)}),r.cache=null,!0):!1,S=class{static initialize(e){ze(e)&&(K.onInvalidDefinition=fe(e.onInvalidDefinition),K.onInexistentTemplate=fe(e.onInexistentTemplate),K.onUnespecifiedSlot=fe(e.onUnespecifiedSlot),K.onInvalidId=fe(e.onInvalidId),K.onUnknownTag=fe(e.onUnknownTag))}};l(S,"makeStyleNode",en),l(S,"newRule",sn),l(S,"newNestedRule",nn),l(S,"tryToJoinRules",rn),l(S,"tryToJoinNestedRules",on),l(S,"performValidations",Zs),l(S,"makeMainNode",tn),l(S,"newChild",Qs),l(S,"newDefinition",ss),l(S,"newEvent",ns),l(S,"newState",Xs);var pe,ti,Tt,we,ge,{EMPTY_ARRAY:an,buildArray:Si,buildObject:ln,isNonEmptyString:dn,isAssignedArray:cn}=w,qt=class{static initialize(e,t){this.begin=e,this.end=t}},q=qt;l(q,"begin",null),l(q,"end",null),l(q,"enclose",e=>qt.begin+e+qt.end),l(q,"makeRegExp",()=>new window.RegExp(`(?<=${qt.begin}).*?(?=${qt.end})`,"gs"));var hn=["contents","classes","styles","attributes"],Vt=class{};l(Vt,"rules",(e,t)=>Si(i=>e.forEach(n=>n.replacements.forEach(o=>o.field===t&&i.push(n))))),l(Vt,"children",(e,t)=>Si(i=>{let n=o=>{let d=f=>f.forEach(T=>T.field===t&&i.push(o));hn.forEach(f=>d(o.replacements[f])),o.rules.forEach(f=>f.replacements.forEach(T=>T.field===t&&i.push(o)))};e.forEach(o=>o.included&&n(o))}));var D=class{static initialize(e){c(this,pe,e)}},R=D;pe=new WeakMap,ti=new WeakMap,Tt=new WeakMap,we=new WeakMap,ge=new WeakMap,a(R,pe,null),a(R,ti,(e,t,i)=>e.push({at:t,field:i.trim(),find:q.enclose(i)})),a(R,Tt,(e,t,i)=>dn(i)&&(i.match(s(D,pe))||an).forEach(n=>{var o;return s(o=D,ti).call(o,e,t,n)})),a(R,we,(e,t,i)=>{var n;e[t]=new window.Array,s(n=D,Tt).call(n,e[t],t,i)}),a(R,ge,(e,t,i)=>{e[t]=new window.Array,window.Object.keys(i).forEach(n=>{var o,d;s(o=D,Tt).call(o,e[t],t,n),s(d=D,Tt).call(d,e[t],t,i[n])})}),l(R,"child",e=>ln(t=>{var i,n,o,d;s(i=D,we).call(i,t,"contents",e.content),s(n=D,we).call(n,t,"classes",e.classes.join(" ")),s(o=D,ge).call(o,t,"styles",e.style),s(d=D,ge).call(d,t,"attributes",e.attributes),e.rules.forEach(f=>f.replacements=D.rule(f))})),l(R,"rule",e=>Si(t=>{var n;if(cn(e.nested))return e.nested.map(o=>D.rule(o));var i="";for(let o in e.properties)i+=`${o}:${e.properties[o]};`;s(n=D,Tt).call(n,t,"rules",i)}));var B=class{static initialize(e,t){q.initialize(e,t),R.initialize(q.makeRegExp())}};l(B,"extractReplacementsFromRule",R.rule),l(B,"extractReplacementsFromChild",R.child),l(B,"scanRulesForReplacements",Vt.rules),l(B,"scanChildrenForReplacements",Vt.children);var Xt,{noop:un,isAssignedArray:fn,hasObjectKeys:hs,isNonEmptyString:us,isNonEmptyArray:mn,isAssignedObject:pn,ensureFunction:wn}=w,{htmlEncode:fs}=k,{SLOTS_KIND:gn,TEMPLATES_KIND:En,TEXTNODE_TAG:yn}=M,Ee=class{static initialize(e){pn(e)&&c(this,Xt,wn(e.onFetchTemplate,s(this,Xt)))}},C=Ee;Xt=new WeakMap,a(C,Xt,un),l(C,"cacheInvalidator",e=>e.cache=null),l(C,"slotsInvalidator",e=>e.kind===gn?Ee.cacheInvalidator(e):void 0),l(C,"renderingIncluder",e=>e.included=!0),l(C,"renderingExcluder",e=>e.included=!1),l(C,"renderRule",(e,t)=>{if(fn(t.nested))return`${t.selector}{${t.nested.map(i=>Ee.renderRule(e,i)).join(`
`)}}`;if(us(t.selector)&&!t.nested){let i=new window.String;for(let n in t.properties)i+=`${n}:${t.properties[n]};`;return mn(t.replacements)&&t.replacements.forEach(n=>i=e(i,n)),`${t.selector}{${i}}`}return null}),l(C,"renderChild",(e,t)=>{var n;if(t.kind===En)return s(n=Ee,Xt).call(n,t.id);if(t.tag===yn){let o=t.content;return t.replacements.contents.forEach(d=>o=e(o,d)),t.encode?fs(o):o}var i=us(t.id)?`<${t.tag} id='${t.id}'`:`<${t.tag}`;if(t.classes.length){let o=t.classes.join(" ");t.replacements.classes.forEach(d=>o=e(o,d)),i+=` class='${o}'`}if(hs(t.style)){let o=" style='";for(let d in t.style)o+=`${d}: ${t.style[d]}; `;o+="'",t.replacements.styles.forEach(d=>o=e(o,d)),i+=o}if(hs(t.attributes)){let o=new window.String;for(let d in t.attributes)o+=` ${d}=${t.attributes[d]}`;t.replacements.attributes.forEach(d=>o=e(o,d)),i+=o}if(typeof t.content=="string"){let o=t.content;t.replacements.contents.forEach(d=>o=e(o,d)),i+=`>${t.encode?fs(o):o}</${t.tag}>`}else i+="/>";return i});var It,ct,Qt,be,Te,O,X,St,Zt,ii,{ensureFunction:Ai,isNonEmptyString:bn,isAssignedObject:ei}=w,ye=class{constructor(e,t,i,n={}){a(this,Zt);a(this,It,new window.String);a(this,ct,!1);a(this,Qt,null);a(this,be,null);a(this,Te,null);a(this,O,null);a(this,X,null);a(this,St,new class extends window.Set{name(e,t){let i=`${e}_${t}`;for(var n=0;this.has(i);)i=`${e}_${t}_${++n}`;return this.add(i),i}});c(this,Qt,Ai(e)),c(this,be,Ai(t)),c(this,Te,Ai(i)),c(this,X,n)}getStore(){return s(this,X)}setStore(e){c(this,X,e)}get state(){return s(this,O)}get key(){return s(this,It)}set key(e){return c(this,ct,bn(c(this,It,e)))}hasKey(){return s(this,ct)}validateKey(){return s(this,ct)?!0:(this.on_invalid_key(),!1)}nameFiliatedKey(e){return s(this,St).name(s(this,It),e)}rememberFiliatedKey(e){s(this,St).add(e)}hasFiliatedKey(e){return s(this,St).has(e)}initializeState(){if(s(this,St).clear(),s(this,ct)){let e=s(this,X).hasItem(this.key)?s(this,X).getItem(this.key):s(this,Qt).call(this);if(ei(e))c(this,O,e),s(this,O).generation++,h(this,Zt,ii).call(this);else return this.on_invalid_state(),-1}else c(this,O,s(this,Qt).call(this)),s(this,O).generation++;return s(this,O).generation}writeState(){let e=s(this,O);return ei(e)?(e.data=s(this,Te).call(this),h(this,Zt,ii).call(this),!0):!1}readState(){let e=s(this,O);return ei(e)&&e.persisted?(s(this,be).call(this,e.data),!0):!1}eraseState(){let e=s(this,O);return ei(e)&&e.persisted&&e.data?(delete e.data,h(this,Zt,ii).call(this),!0):!1}on_invalid_state(){}on_invalid_key(){}};It=new WeakMap,ct=new WeakMap,Qt=new WeakMap,be=new WeakMap,Te=new WeakMap,O=new WeakMap,X=new WeakMap,St=new WeakMap,Zt=new WeakSet,ii=function(){s(this,ct)&&(s(this,O).persisted=!!s(this,O).data,s(this,X).setItem(s(this,It),s(this,O)))};var Q,G,ht,si,ps,ni,ws,{WUSENODE_ATTRIBUTE:ms}=M,te=class{constructor(e,t){a(this,si);a(this,ni);a(this,Q,null);a(this,G,null);a(this,ht,null);if(e instanceof window.Node&&t instanceof window.Node)c(this,Q,e),this.element=t;else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}set element(e){h(this,si,ps).call(this,e.getAttribute(ms)),c(this,G,e),c(this,ht,e.cloneNode(!1))}get element(){return s(this,G)}affiliate(){s(this,Q).appendChild(s(this,G))}disaffiliate(){s(this,Q).removeChild(s(this,G))}promote(e){s(this,ht).innerHTML=e,s(this,Q).replaceChild(s(this,ht),s(this,G)),h(this,ni,ws).call(this)}};Q=new WeakMap,G=new WeakMap,ht=new WeakMap,si=new WeakSet,ps=function(e){let t=s(this,Q).querySelector(`[${ms}='${e}']`);t&&s(this,Q).removeChild(t)},ni=new WeakSet,ws=function(){let e=s(this,ht);c(this,ht,s(this,G).cloneNode(!1)),c(this,G,e)};var At,_t,{isOf:gs}=w,vt=class{constructor(e,t){a(this,At,!1);a(this,_t,"");gs(e,window.Function)&&(this.on_content_invalidation=e),gs(t,window.Function)&&(this.on_content_verification=t)}get invalidated(){return s(this,At)}reset(e){c(this,At,!1),c(this,_t,e)}append(e){c(this,_t,s(this,_t)+e)}verify(){c(this,At,this.on_content_verification(s(this,_t)))}process(e){(e||s(this,At))&&this.on_content_invalidation(s(this,_t))}on_content_verification(e){}on_content_invalidation(e){}};At=new WeakMap,_t=new WeakMap;var ut,ee,{isIntegerNumber:Tn,isAssignedObject:_i,cloneObject:In,forEachOwnProperty:Sn,buildArray:An}=w,Es=(r,e,t)=>Sn(r,i=>{switch(i){case"owner":case"last":case"length":break;case"version":case"locked":t(i);break;default:Tn(i)&&e(i)}}),ys=(r,e,t)=>{t(e);let i=In(e);i.cache=null,r.push(i)},Ot=class extends window.Array{constructor(t){super();a(this,ut);l(this,"owner",null);l(this,"last",null);l(this,"version",0);l(this,"locked",!1);this.owner=t}prepare(){return this.locked?(this.on_forbidden_change(),!1):!0}append(t){this.prepare()&&_i(t)&&(this.push(t),h(this,ut,ee).call(this,t))}prepend(t){this.prepare()&&_i(t)&&(this.unshift(t),h(this,ut,ee).call(this,t))}replace(t,i){this.prepare()&&t>-1&&_i(i)&&h(this,ut,ee).call(this,this[t]=i)}remove(t){if(this.prepare()&&t>-1){let i=this.splice(t,1);h(this,ut,ee).call(this,i.length?i[0]:null)}}clear(){return this.prepare()?(this.length=0,h(this,ut,ee).call(this,null),!0):!1}persist(){return An(t=>Es(this,i=>ys(t,this[i],this.on_snapshot_part),i=>t[i]=this[i]))}restore(t,i){this.clear()&&(this.owner=t,Es(i,n=>ys(this,i[n],this.on_recall_part),n=>this[n]=i[n]))}getIndexOf(t,i){for(let n=0;n<this.length;n++)if(this[n][t]===i)return n;return-1}on_snapshot_part(){}on_recall_part(){}on_version_change(){}on_forbidden_change(){}};ut=new WeakSet,ee=function(t){this.last=t,this.version++,this.on_version_change()};var Ie,Se,Ae,_e,{ensureFunction:_n}=w,ie=class{constructor(e){l(this,"rounds",0);a(this,Ie,0);a(this,Se,null);a(this,Ae,!1);a(this,_e,null);c(this,_e,_n(e))}compute(e){return this.rounds+=+c(this,Ae,s(this,Ie)==c(this,Se,s(this,_e).call(this,e))),c(this,Ie,s(this,Se)),s(this,Ae)}};Ie=new WeakMap,Se=new WeakMap,Ae=new WeakMap,_e=new WeakMap;var U,p,m,_,F,u,ne,mt,De,A,P,Rt,re,x,pt,z,W,tt,wt,gt,ai,li,E,et,$,kt,it,Ce,Ci,di,Os,ci,Ds,Et,se,hi,Cs,Ne,Ni,Le,Li,Re,Ri,ke,ki,Me,Mi,Ue,Ui,Fe,Fi,xe,xi,We,Wi,Mt,Oe,{EMPTY_STRING:ve,noop:Dt,ensureFunction:Ct,isOf:vn,isAssignedObject:ri,isAssignedArray:vi,isNonEmptyArray:bs,isNonEmptyString:ft,forcedStringSplit:Ts,forEachOwnProperty:On,buildArray:Dn}=w,{removeChildren:Cn,isHTMLAttribute:Nn}=k,{WUSEKEY_ATTRIBUTE:Nt,DEFAULT_STYLE_TYPE:Ln,DEFAULT_STYLE_MEDIA:Rn,DEFAULT_REPLACEMENT_OPEN:kn,DEFAULT_REPLACEMENT_CLOSE:Mn,SLOTS_KIND:Is}=M,{createReactiveField:Un}=ce,{REGULAR:Fn}=lt,{newDefinition:xn,newState:Wn,makeMainNode:$n,makeStyleNode:jn,performValidations:Hn,newChild:Kn,newRule:Oi,newNestedRule:Ss,tryToJoinRules:As,tryToJoinNestedRules:_s}=S,{extractReplacementsFromChild:Bn,extractReplacementsFromRule:Gn,scanChildrenForReplacements:Pn,scanRulesForReplacements:zn}=B,{renderChild:vs,renderRule:Jn,renderingIncluder:Yn,renderingExcluder:Vn,cacheInvalidator:Lt,slotsInvalidator:qn}=C,I={onInvalidState:Dt,onInvalidKey:Dt,onInvalidDefinition:Dt,onLockedDefinition:Dt,onTakenId:Dt,onMisnamedField:Dt,onAllowHTML:Dt},Z=(r,e)=>window.Wuse.debug(`#${r.id} (${r.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`),oi=(r,e)=>Hn(Kn(r,e)),Di=(r,e)=>ft(e)?r.selectChildElement(`#${e}`):void 0,Xn=r=>typeof r!="string"||!r.trim().length||r.startsWith("data")||Nn(r),Qn=()=>({mainDefinition:xn(),styleMedia:Rn,styleType:Ln,rawContent:!1,attributeKeys:!1,elementKeys:!0,autokeyChildren:!0,automaticallyRestore:!0,redrawReload:!1,redrawRepaint:!1,enclosingEvents:!1}),Zn=()=>({attachment:new window.Wuse.PerformanceMeasurement.StopWatch,partial:new window.Wuse.PerformanceMeasurement.StopWatch,full:new window.Wuse.PerformanceMeasurement.StopWatch,dettachment:new window.Wuse.PerformanceMeasurement.StopWatch}),tr=()=>({main:new ie(window.Wuse.hashRoutine),style:new ie(window.Wuse.hashRoutine)}),$i=class extends window.HTMLElement{constructor(t){super();a(this,Ce);a(this,di);a(this,ci);a(this,Et);a(this,hi);a(this,Ne);a(this,Le);a(this,Re);a(this,ke);a(this,Me);a(this,Ue);a(this,Fe);a(this,xe);a(this,We);a(this,Mt);a(this,U,new window.String);a(this,p,new class extends Ot{constructor(){super(...arguments);l(this,"getIndexOf",i=>super.getIndexOf("selector",i));l(this,"on_version_change",()=>{this.last!==null&&(this.last.version=this.version,this.last.replacements=Gn(this.last)),window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,`rules list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,"rules list is locked and can not be changed"),I.onLockedDefinition(s(this.owner,u).mainDefinition.id)})}}(this));a(this,m,new class extends Ot{constructor(){super(...arguments);l(this,"getIndexOf",i=>super.getIndexOf("id",i));l(this,"on_version_change",()=>{var i;this.last!==null&&(this.last.version=this.version,this.last.replacements=Bn(this.last)),s(this.owner,P)||c(i=this.owner,P,s(i,P)|this.some(n=>n.kind===Is)),window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,`children list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,"children list is locked and can not be changed"),I.onLockedDefinition(s(this.owner,u).mainDefinition.id)});l(this,"on_recall_part",i=>s(this.owner,gt).tryToRemember(i))}}(this));a(this,_,new class extends Ot{constructor(){super(...arguments);l(this,"establish",(i,n)=>{if(this.prepare()){let o=super.getIndexOf("name",i);return o>-1?this[o].value=n:this.append({name:i,value:n}),!0}return!1});l(this,"snapshot",()=>Dn(i=>this.persist().forEach(n=>i.push({name:n.name,value:n.value}))));l(this,"getIndexOf",i=>super.getIndexOf("name",i));l(this,"on_version_change",()=>{window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,`fields list version change: ${this.version}`)});l(this,"on_forbidden_change",()=>{window.Wuse.DEBUG&&s(this.owner,A)&&Z(this.owner,"fields list is locked and can not be changed"),I.onLockedDefinition(s(this.owner,u).mainDefinition.id)});l(this,"on_snapshot_part",i=>i.value=this.owner[i.name]);l(this,"on_recall_part",i=>this.owner[i.name]=i.value)}}(this));a(this,F,new window.Set);a(this,u,Qn());a(this,ne,void 0);a(this,mt,new he(this));a(this,De,!1);a(this,A,!1);a(this,P,!1);a(this,Rt,!1);a(this,re,window.Wuse.isShadowElement(this));a(this,x,void 0);a(this,pt,void 0);a(this,z,null);a(this,W,!1);a(this,tt,!1);a(this,wt,!0);a(this,gt,{forget:t=>{let i=t.attributes[Nt];return t.attributes[Nt]="",i},tryToName:t=>{t.attributes[Nt]||(t.attributes[Nt]=s(this,E).nameFiliatedKey(t.hash))},tryToRemember:t=>{let i=t.attributes[Nt];i&&s(this,E).rememberFiliatedKey(i)}});a(this,ai,t=>{t&&(this.parameters=t.parameters,c(this,u,t.options),c(this,P,t.slotted),c(this,A,t.identified),c(this,U,t.html),s(this,m).restore(this,t.children),s(this,p).restore(this,t.rules),s(this,_).restore(this,t.fields),c(this,F,t.reactives).forEach(i=>this.makeReactiveField(i,this[i])))});a(this,li,()=>({parameters:s(this,ne),options:s(this,u),slotted:s(this,P),identified:s(this,A),html:s(this,U),children:s(this,m).persist(),rules:s(this,p).persist(),fields:s(this,_).persist(),reactives:s(this,F)}));a(this,E,new class extends ye{on_invalid_state(){I.onInvalidState()}on_invalid_key(){I.onInvalidKey()}}(Wn,s(this,ai),s(this,li),window.Wuse.elementsStorage));a(this,et,{binder:t=>{let i=Di(this,t);i&&(this[t]=i)},unbinder:t=>delete this[t],makePerformers:(t,i)=>({event:t,key:()=>(s(this,A)&&i(s(this,u).mainDefinition.id),n=>i(n.id))}),makeHandlers:t=>({key:s(this,u).elementKeys&&t.key(),event:(i,n,o)=>{let d=this[`on_${i}_${n}`];if(d){let f=Di(this,i);f&&f[t.event](n,d,o)}},slots:()=>this.on_slot_change&&s(this,z).querySelectorAll("slot").forEach(i=>i[t.event]("slotchange",this.on_slot_change))}),getHandlers:t=>s(this,et).makeHandlers(t?s(this,et).makePerformers("addEventListener",s(this,et).binder):s(this,et).makePerformers("removeEventListener",s(this,et).unbinder))});a(this,$,{root:new vt(t=>this.innerHTML=t,t=>!0),style:new vt(t=>s(this,pt)&&s(this,pt).promote(t),t=>!s(this,kt).style.compute(t)),main:new vt(t=>s(this,x).promote(t),t=>!s(this,kt).main.compute(t)),renderizers:{replacer:(t,i)=>t.replace(i.find,this[i.field]!==void 0?this[i.field]:ve),rule:t=>{let i=s(this,$);return i.style.append(t.cache?t.cache:t.cache=Jn(i.renderizers.replacer,t))},children:{mixed:t=>t.kind===Is?s(this,$).renderizers.children.slot(t):s(this,$).renderizers.children.normal(t),slot:t=>{if(!t.cache){let i=s(this,$);return i.root.append(t.cache=vs(i.renderizers.replacer,t),i.root.verify())}},normal:t=>{let i=s(this,$);i.main.append(t.cache?t.cache:t.cache=vs(i.renderizers.replacer,t)),t.rules.length&&t.rules.forEach(i.renderizers.rule)}}}});a(this,kt,tr());a(this,it,Zn());l(this,"info",{instanceNumber:++$i.instancesCount,unmodifiedRounds:0,updatedRounds:0});c(this,z,t===Fn?this:this.shadowRoot||this.attachShadow({mode:t}));let i=s(this,mt);if(i.detect(),i.immediateTrigger("on_create"),s(this,u).attributeKeys){let o=this.getAttributeNames();o.length&&o.forEach(d=>this[d]=this.getAttribute(d))}this.dataset.wusekey&&this.setElementsStoreKey(this.dataset.wusekey);let n=s(this,E);n.initializeState()>1?n.state.data.options.automaticallyRestore?this.restoreFromElementsStore():i.immediateTrigger("on_reconstruct",n.state):i.immediateTrigger("on_construct",n.state),n.writeState(),c(this,De,!0)}get parameters(){return s(this,ne)}set parameters(t){ri(c(this,ne,t))&&On(t,i=>this[i]=t[i])}render(){window.Wuse.RENDERING&&s(this,wt)&&s(this,tt)&&h(this,Ue,Ui).call(this,!0)}redraw(){window.Wuse.RENDERING&&s(this,wt)&&s(this,tt)&&h(this,Ue,Ui).call(this,!1)}suspendRender(){return c(this,wt,!1),this}resumeRender(t=!0){return c(this,wt,!0),t&&this.render(),this}isRenderSuspended(){return!s(this,wt)}selectChildElement(t){return s(this,z).querySelector(t)}selectChildElements(t){return s(this,z).querySelectorAll(t)}connectedCallback(){window.Wuse.MEASURE&&s(this,it).attachment.start();let t=s(this,mt);t.detect(),t.immediateTrigger("on_connect"),h(this,ke,ki).call(this,t,"on_load"),window.Wuse.MEASURE&&s(this,it).attachment.stop(window.Wuse.DEBUG)}disconnectedCallback(){window.Wuse.MEASURE&&s(this,it).dettachment.start(),h(this,Et,se).call(this,!1),s(this,mt).immediateTrigger("on_disconnect"),s(this,E).writeState(),window.Wuse.MEASURE&&s(this,it).dettachment.stop(window.Wuse.DEBUG)}deriveChildrenStoreKey(t){return s(this,u).autokeyChildren=t,this}restoreOnReconstruct(t){return s(this,u).automaticallyRestore=t,this}encloseRenderingEvents(t){return s(this,u).enclosingEvents=t,this}fireSpecificRedrawEvents(t,i){return s(this,u).redrawReload=!!t,s(this,u).redrawRepaint=!!i,this}setElementsAsKeys(t){return s(this,u).elementKeys=!!t,this}setAttributesAsKeys(t){return s(this,u).attributeKeys=!!t,this}setStyleOptions(t,i){return s(this,u).styleMedia=ft(t)?t:ve,s(this,u).styleType=ft(i)?i:ve,this}getElementsStore(){return s(this,E).getStore()}setElementsStore(t){return s(this,E).setStore(t),this}hasElementsStoreKey(){return s(this,E).hasKey()}getElementsStoreKey(t){return s(this,E).key}setElementsStoreKey(t){return(s(this,E).key=t)&&(this.setAttribute(Nt,t),s(this,u).autokeyChildren&&!!s(this,m).length&&(s(this,m).forEach(i=>{i.custom&&(s(this,gt).forget(i),s(this,gt).tryToName(i),Lt(i))}),this.redraw()),s(this,E).writeState()),this}persistToElementsStore(){return s(this,E).validateKey()&&s(this,E).writeState()}restoreFromElementsStore(){return s(this,E).validateKey()&&s(this,E).readState()}removeFromElementsStore(){return s(this,E).validateKey()&&s(this,E).eraseState()}getMainAttribute(t){return t==="id"&&s(this,A)?s(this,u).mainDefinition.id:s(this,u).mainDefinition.attributes[t]}setMainAttribute(t,i){return s(this,u).mainDefinition.attributes[t]=i,s(this,W)&&s(this,x).element.setAttribute(t,i),this}removeMainAttribute(t){return delete s(this,u).mainDefinition.attributes[t],s(this,W)&&s(this,x).element.removeAttribute(t),this}addMainClass(t){let i=s(this,u).mainDefinition.classes;return i.indexOf(t)===-1&&(i.push(t),s(this,W)&&s(this,x).element.classList.add(t)),this}removeMainClass(t){let i=s(this,u).mainDefinition.classes,n=i.indexOf(t);return n>-1&&(i.splice(n,1),s(this,W)&&s(this,x).element.classList.remove(t)),this}toggleMainClass(t){let i=s(this,u).mainDefinition.classes,n=i.indexOf(t);return n>-1?i.splice(n,1):i.push(t),s(this,W)&&s(this,x).element.classList.toggle(t),this}setMainElement(t){let i=oi(t);if(i!==null){if(ft(i.content)||bs(i.events))return I.onInvalidDefinition(t);let n=s(this,u).mainDefinition;c(this,A,ft(i.id))&&(n.id=i.id),ft(i.tag)&&(n.tag=i.tag),bs(i.classes)&&(n.classes=i.classes),ri(i.style)&&(n.style=i.style),ri(i.attributes)&&(n.attributes=i.attributes)}return this}allowRawContent(t){return s(this,u).rawContent=!!t,this}setRawContent(t){return s(this,u).rawContent?c(this,U,t):I.onAllowHTML(),this}appendRawContent(t){return s(this,u).rawContent?c(this,U,s(this,U)+t):I.onAllowHTML(),this}prependRawContent(t){return s(this,u).rawContent?c(this,U,t+s(this,U)):I.onAllowHTML(),this}lockCSSRules(){return s(this,p).locked=!0,this}unlockCSSRules(){return s(this,p).locked=!1,this}getCSSRulesCount(){return s(this,p).length}appendCSSRule(t,i,n){if(n)return this.appendCSSNestedRule(t,i,n);let o=s(this,p).slice(-1),d=Oi(t,i);return(!o.length||!As(o[0],d))&&s(this,p).append(d),this}prependCSSRule(t,i,n){if(n)return this.prependCSSNestedRule(t,i,n);let o=s(this,p).slice(0,1),d=Oi(t,i);return(!o.length||!As(o[0],d))&&s(this,p).prepend(d),this}appendCSSNestedRule(t,i,n){let o=s(this,p).slice(-1),d=Ss(t,i,n);return(!o.length||!_s(o[0],d))&&s(this,p).append(d),this}prependCSSNestedRule(t,i,n){let o=s(this,p).slice(0,1),d=Ss(t,i,n);return(!o.length||!_s(o[0],d))&&s(this,p).prepend(d),this}hasCSSRuleBySelector(t){return s(this,p).getIndexOf(t)>-1}replaceCSSRuleBySelector(t,i){return s(this,p).replace(s(this,p).getIndexOf(t),Oi(t,i)),this}transferCSSRuleBySelector(t,i){if(ft(t)&&typeof i=="object"&&typeof s(i,p)=="object"){let n=s(this,p),o=n.getIndexOf(t);if(o>-1)return s(i,p).append(n[o]),n.remove(o),!0}return!1}removeCSSRuleBySelector(t){return s(this,p).remove(s(this,p).getIndexOf(t)),this}removeAllCSSRules(){return s(this,p).clear(),this}lockChildElements(){return s(this,m).locked=!0,this}unlockChildElements(){return s(this,m).locked=!1,this}getChildElementsCount(){return s(this,m).length}appendChildElement(t,i){let n=h(this,Mt,Oe).call(this,oi(t,i));return n!==null&&s(this,m).append(n),this}prependChildElement(t,i){let n=h(this,Mt,Oe).call(this,oi(t,i));return n!==null&&s(this,m).prepend(n),this}appendChildElements(t){return(vi(t)?t:Ts(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.appendChildElement(i)),this}prependChildElements(t){return(vi(window.Array)?t:Ts(t,`
`)).forEach(i=>typeof i=="string"&&!!i.trim().length&&this.prependChildElement(i)),this}replaceChildElementById(t,i,n){let o=oi(i,n);return o!==null&&s(this,m).replace(s(this,m).getIndexOf(t),o),this}transferChildElementById(t,i){var n;if(ft(t)&&typeof i=="object"&&typeof h(i,Mt,Oe)=="function"){let o=s(this,m),d=o.getIndexOf(t);if(d>-1){let f=o[d],T=s(this,gt).forget(f),H=h(n=i,Mt,Oe).call(n,f);if(H!==null){s(i,m).append(H),o.remove(d);let v=`on_${H.id}_click`;if(typeof this[v]=="function"){let rt=this[v];delete this[v],i[v]=rt}return!0}else f.attributes[Nt]=T}}return!1}removeChildElementById(t){return s(this,m).remove(s(this,m).getIndexOf(t)),this}removeAllChildElements(){return s(this,m).clear(),this}checkChildElementIsIncludedById(t,i,n){let o=d=>vn(d,window.Function)?d():void 0;return s(this,m).some(d=>d.id===t&&d.included)?o(i):o(n),this}includeChildElementById(t){return s(this,m).length&&s(this,m).forEach(i=>i.id===t&&Yn(i)),this}excludeChildElementById(t){return s(this,m).length&&s(this,m).forEach(i=>i.id===t&&Vn(i)),this}invalidateChildElementsById(t){return s(this,m).length&&s(this,m).forEach(i=>t.indexOf(i.id)>-1&&Lt(i)),this}invalidateChildElements(t){return vi(t)&&t.forEach(Lt),this}lockInstanceFields(){return s(this,_).locked=!0,this}unlockInstanceFields(){return s(this,_).locked=!1,this}getInstanceFieldsCount(){return s(this,_).length}makeField(t,i){return h(this,xe,xi).call(this,t,i,!0)}makeReadonlyField(t,i){return h(this,xe,xi).call(this,t,i,!1)}makeReactiveField(t,i,n,o=!0){return h(this,We,Wi).call(this,t)&&(s(this,_).establish(t,i)&&(Un(this,t,i,n,(d,f)=>h(this,Fe,Fi).call(this,d,f||"$auto"),d=>this.dropField(d)),s(this,F).add(t)),o&&h(this,Fe,Fi).call(this,t,"$init")),this}makeExternalReactiveField(t,i,n,o,d=!0){return this.makeReactiveField(i,t[i]||n,f=>{t[i]=this[i],o(f)},d)}isReactiveField(t){return s(this,F).has(t)}hasField(t){return s(this,_).getIndexOf(t)>-1}dropField(t){let i=s(this,_);if(i.prepare()){let n=i.getIndexOf(t);if(n>-1)return i.splice(n,1),this.hasOwnProperty(t)&&delete this[t],s(this,F).has(t)&&s(this,F).delete(t),s(this,E).writeState(),!0}return!1}dropAllFields(){let t=[],i=[];return s(this,_).forEach(n=>{let o=n.name;this.hasOwnProperty(o)&&t.push(o),s(this,F).has(o)&&i.push(o)}),s(this,_).clear()?(t.forEach(n=>delete this[n]),i.forEach(n=>s(this,F).delete(n)),s(this,E).writeState(),!0):!1}snapshotInstanceFields(){return s(this,_).snapshot()}static initialize(t){B.initialize(kn,Mn),ri(t)&&(C.initialize({onFetchTemplate:t.onFetchTemplate}),S.initialize({onInvalidDefinition:t.onInvalidDefinition,onInexistentTemplate:t.onInexistentTemplate,onUnespecifiedSlot:t.onUnespecifiedSlot,onInvalidId:t.onInvalidId,onUnknownTag:t.onUnknownTag}),I.onAllowHTML=Ct(t.onAllowHTML),I.onInvalidKey=Ct(t.onInvalidKey),I.onInvalidState=Ct(t.onInvalidState),I.onInvalidDefinition=Ct(t.onInvalidDefinition),I.onLockedDefinition=Ct(t.onLockedDefinition),I.onTakenId=Ct(t.onTakenId),I.onMisnamedField=Ct(t.onMisnamedField))}static register(){return window.Wuse.register(this)}static create(t,i="body"){return window.Wuse.create({element:{type:this},target:i instanceof window.HTMLElement?{node:i}:typeof i=="string"?{selector:i}:i,instance:{parameters:t}})}},j=$i;U=new WeakMap,p=new WeakMap,m=new WeakMap,_=new WeakMap,F=new WeakMap,u=new WeakMap,ne=new WeakMap,mt=new WeakMap,De=new WeakMap,A=new WeakMap,P=new WeakMap,Rt=new WeakMap,re=new WeakMap,x=new WeakMap,pt=new WeakMap,z=new WeakMap,W=new WeakMap,tt=new WeakMap,wt=new WeakMap,gt=new WeakMap,ai=new WeakMap,li=new WeakMap,E=new WeakMap,et=new WeakMap,$=new WeakMap,kt=new WeakMap,it=new WeakMap,Ce=new WeakSet,Ci=function(){c(this,Rt,c(this,pt,s(this,p).length?new te(s(this,z),jn(s(this,u).styleMedia,s(this,u).styleType)):null))&&s(this,pt).affiliate()},di=new WeakSet,Os=function(){c(this,x,new te(s(this,z),$n(s(this,u).mainDefinition))).affiliate()},ci=new WeakSet,Ds=function(){s(this,x).disaffiliate(),s(this,Rt)&&s(this,pt).disaffiliate(),s(this,P)&&s(this,re)&&Cn(s(this,z))},Et=new WeakSet,se=function(t){if(s(this,tt)&&!t||!s(this,tt)&&t){let i=s(this,et).getHandlers(t);s(this,m).length&&s(this,m).forEach(n=>{!n.included&&t||(i.key&&i.key(n),n.events.length&&n.events.forEach(o=>o&&i.event(n.id,o.kind,o.capture)))}),s(this,P)&&s(this,re)&&i.slots(),c(this,tt,t)}},hi=new WeakSet,Cs=function(){s(this,m).length&&s(this,m).forEach(Lt),s(this,p).length&&s(this,p).forEach(Lt)},Ne=new WeakSet,Ni=function(){let t=s(this,$);t.root.reset(ve),t.style.reset(ve),t.main.reset(s(this,U));let i=s(this,P)&&s(this,re)?t.renderizers.children.mixed:t.renderizers.children.normal;s(this,m).length&&s(this,m).forEach(n=>n.included&&i(n)),s(this,p).length&&s(this,p).forEach(t.renderizers.rule),t.main.verify(),t.style.verify()},Le=new WeakSet,Li=function(t,i,n){let o=s(this,$);o.root.process(t),o.style.process(i),o.main.process(n),window.Wuse.DEBUG&&s(this,A)&&Z(this,`updated (root: ${o.root.invalidated}, main: ${o.main.invalidated}, style: ${o.style.invalidated})`)},Re=new WeakSet,Ri=function(){s(this,Rt)||h(this,Ce,Ci).call(this);let t=s(this,u),i=s(this,mt);t.enclosingEvents&&i.immediateTrigger("on_prerender"),h(this,Ne,Ni).call(this);let n=this.info,o=s(this,$),d=o.root.invalidated||o.main.invalidated||o.style.invalidated;return d?(h(this,Et,se).call(this,!1),h(this,Le,Li).call(this,!1,!1,!1),h(this,Et,se).call(this,!0),n.updatedRounds++,i.immediateTrigger("on_update"),s(this,E).writeState(),i.committedTrigger("on_refresh")):n.unmodifiedRounds++,window.Wuse.DEBUG&&s(this,A)&&Z(this,`unmodified: ${n.unmodifiedRounds} (main: ${s(this,kt).main.rounds}, style: ${s(this,kt).style.rounds}) | updated: ${n.updatedRounds}`),t.enclosingEvents&&i.immediateTrigger("on_postrender"),d},ke=new WeakSet,ki=function(t,i){h(this,hi,Cs).call(this),h(this,Ce,Ci).call(this),h(this,di,Os).call(this),c(this,W,!0),t.immediateTrigger("on_inject"),h(this,Ne,Ni).call(this),h(this,Le,Li).call(this,!1,s(this,Rt),!0),h(this,Et,se).call(this,!0),t.immediateTrigger(i),s(this,E).writeState()},Me=new WeakSet,Mi=function(){h(this,Et,se).call(this,!1),s(this,W)&&(h(this,ci,Ds).call(this),c(this,W,!1));let t=s(this,mt);t.immediateTrigger("on_unload"),t.detect();let i=s(this,u);return h(this,ke,ki).call(this,t,i.redrawReload?"on_reload":"on_load"),t.committedTrigger(i.redrawRepaint?"on_repaint":"on_refresh"),!0},Ue=new WeakSet,Ui=function(t){if(window.Wuse.MEASURE){let i=t?s(this,it).partial:s(this,it).full;i.start();let n=t?h(this,Re,Ri).call(this):h(this,Me,Mi).call(this);return i.stop(window.Wuse.DEBUG),n}else return t?h(this,Re,Ri).call(this):h(this,Me,Mi).call(this)},Fe=new WeakSet,Fi=function(t,i="$none"){if(s(this,tt)){let n,o,d=zn(s(this,p),t);(n=!!d.length)&&d.forEach(Lt);let f=Pn(s(this,m),t);(o=!!f.length)&&f.forEach(Lt),window.Wuse.DEBUG&&s(this,A)&&Z(this,`reactive render (label: ${i}, field: ${t}, children: ${f.length}, rules: ${d.length})`),(o||n)&&(f.some(T=>!!T.kind.length)&&s(this,m).forEach(qn),this.render())}},xe=new WeakSet,xi=function(t,i,n){return h(this,We,Wi).call(this,t)&&s(this,_).establish(t,i)&&window.Object.defineProperty(this,t,{value:i,writable:n}),this},We=new WeakSet,Wi=function(t){return s(this,_).getIndexOf(t)===-1&&Xn(t)?(I.onMisnamedField(t),!1):!0},Mt=new WeakSet,Oe=function(t){if(t!==null){if(s(this,De)&&Di(this,t.id))return I.onTakenId(t.id);t.custom&&s(this,u).autokeyChildren&&s(this,E).hasKey()&&s(this,gt).tryToName(t)}return t},l(j,"instancesCount",0);var Ns=(r,e)=>window.Object.getOwnPropertyNames(e).forEach(t=>window.Object.defineProperty(r,t,{value:e[t],writable:!1,configurable:!1,enumerable:!1})),Ut=class{static detectFeatures(e){let t=(i,n)=>!i&&g.UNSUPPORTED_FEATURE.emit(n);try{t(e.JsHelpers.isOf(window.document,window.HTMLDocument),"HTML Document"),t(e.JsHelpers.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),e.WebHelpers.onDOMContentLoaded(()=>t(e.JsHelpers.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(i){g.UNKNOWN_ERROR.emit()}}static initializeModules(e){e.PerformanceMeasurement.initialize((t,i)=>e.debug(JSON.stringify(e.JsHelpers.buildArray(n=>{switch(n.push({instances:e.elementCount}),n.push(t.getDebugInfo()),i){case"stop":n.push(e.PerformanceMeasurement.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(e.PerformanceMeasurement.BrowserRender.overall.getDebugInfo());break}})))),ot.initialize({onExtinctTemplate:g.EXTINCT_TEMPLATE.emit,onInvalidTemplate:g.INVALID_TEMPLATE.emit}),b.initialize({onBadTarget:g.BAD_TARGET.emit,onMisnamedClass:g.MISNAMED_CLASS.emit,onUnregistrableClass:g.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:g.UNREGISTERED_CLASS.emit,onAlreadyRegistered:g.ALREADY_REGISTERED.emit,onInvalidClass:g.INVALID_CLASS.emit,onDeferredInstantiation:e.WebHelpers.onDOMContentLoaded}),j.initialize({onAllowHTML:g.ALLOW_HTML.emit,onInvalidKey:g.INVALID_KEY.emit,onInvalidDefinition:g.INVALID_DEFINITION.emit,onLockedDefinition:g.LOCKED_DEFINITION.emit,onInexistentTemplate:g.INEXISTENT_TEMPLATE.emit,onUnespecifiedSlot:g.UNESPECIFIED_SLOT.emit,onUnknownTag:g.UNKNOWN_TAG.emit,onInvalidId:g.INVALID_ID.emit,onTakenId:g.TAKEN_ID.emit,onMisnamedField:g.MISNAMED_FIELD.emit,onInvalidState:g.INVALID_STATE.emit,onFetchTemplate:ot.fetch})}static declareUnwritableMembers(e,t){Ns(e,t.fields),Ns(e,t.methods)}};var gi,Rs,Ls,pi,wi,oe,ui=r=>r>1e3?(r/1e3).toFixed(2)+"s":r.toFixed(2)+"ms",fi=class{constructor(){l(this,"round",0);l(this,"domTime",window.Number.MAX_SAFE_INTEGER);l(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var e=new window.Object;return e.round=this.round,e.domTime=ui(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(e.renderTime=ui(this.renderTime)),e}},mi=class{constructor(e){l(this,"name","");l(this,"rounds",0);l(this,"time",0);l(this,"average",0);this.name=e}compute(e){this.rounds++,this.time+=e,this.average=this.time/this.rounds}getDebugInfo(){let e=ui(this.time),t=ui(this.average);return{name:this.name,rounds:this.rounds,spent:e,average:t}}},N=class{static initialize(e){typeof e=="function"&&c(N,oe,e),N.DOMUpdate.overall=new mi("overall-dom-update"),N.BrowserRender.overall=new mi("overall-browser-render")}},st=N;oe=new WeakMap,a(st,oe,()=>{}),l(st,"StopWatch",(Ls=class{constructor(){a(this,gi);l(this,"_begin",0);l(this,"_end",{dom:0,render:0});l(this,"rounds",0);l(this,"last",new fi);l(this,"best",new fi);l(this,"averages",{dom:0,render:0})}start(){(N.DOMUpdate.check||N.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(e){var t;N.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,N.DOMUpdate.overall.compute(this.last.domTime)),N.BrowserRender.check?setTimeout(()=>h(this,gi,Rs).bind(this)(e)):e&&s(t=N,oe).call(t,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},gi=new WeakSet,Rs=function(e){var t;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,N.BrowserRender.overall.compute(this.last.renderTime),e&&s(t=N,oe).call(t,this,"finish")},Ls)),l(st,"DOMUpdate",(pi=class{},l(pi,"check",!0),l(pi,"overall",null),pi)),l(st,"BrowserRender",(wi=class{},l(wi,"check",!1),l(wi,"overall",null),wi));var nt,je,ji,$e=class{constructor(){a(this,je);a(this,nt,new window.Object)}get length(){return h(this,je,ji).call(this).length}key(e){return h(this,je,ji).call(this)[e]||null}getItem(e){return s(this,nt)[e]}setItem(e,t){s(this,nt)[e]=t}removeItem(e){delete s(this,nt)[e]}clear(){c(this,nt,new window.Object)}hasItem(e){return s(this,nt).hasOwnProperty(e)}};nt=new WeakMap,je=new WeakSet,ji=function(){return window.Object.keys(s(this,nt))};var{noop:ae,isOf:Hi}=w,{specializeClass:Ki,REGULAR:er,OPEN:ir,CLOSED:sr}=lt;function Bi(r){var e;return e=class{static get VERSION(){return r}static get elementCount(){return j.instancesCount}},l(e,"DEBUG",!1),l(e,"FATALS",!1),l(e,"MEASURE",!1),l(e,"RENDERING",!0),l(e,"hashRoutine",J.defaultRoutine),l(e,"elementsStorage",new $e),l(e,"tmp",null),l(e,"WebHelpers",null),l(e,"JsHelpers",null),l(e,"PerformanceMeasurement",null),l(e,"NonShadowElement",null),l(e,"OpenShadowElement",null),l(e,"ClosedShadowElement",null),l(e,"debug",ae),l(e,"blockUpdate",ae),l(e,"register",ae),l(e,"instantiate",ae),l(e,"create",ae),l(e,"isShadowElement",ae),(()=>{Ut.declareUnwritableMembers(e,{fields:{tmp:new window.Object,WebHelpers:k,JsHelpers:w,PerformanceMeasurement:st,NonShadowElement:Ki(j,er),OpenShadowElement:Ki(j,ir),ClosedShadowElement:Ki(j,sr)},methods:{debug:i=>window.console.log("[WUSE:DEBUG]",i),blockUpdate:(i,n)=>{if(Hi(i,Function)){window.Wuse.DEBUG&&window.Wuse.debug("blocking"),window.Wuse.RENDERING=!1;try{i(n)}catch(o){throw o}finally{window.Wuse.RENDERING=!0,window.Wuse.DEBUG&&window.Wuse.debug("unblocking")}}},isShadowElement:i=>{let n=window.Object.getPrototypeOf(i.constructor);return n===window.Wuse.OpenShadowElement||n===window.Wuse.ClosedShadowElement},register:i=>b.registerClasses(Hi(i,window.Array)?i:new window.Array(i)),create:(i,n)=>Hi(i,window.Object)?b.createInstance(i.element,i.target,i.instance):void 0}}),Ut.detectFeatures(e),Ut.initializeModules(e)})(),e}var ks="0.8.4";window.Wuse=window.Wuse||Bi(ks);})();
