(()=>{var Ui=Object.defineProperty;var Mi=(r,t,s)=>t in r?Ui(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var h=(r,t,s)=>(Mi(r,typeof t!="symbol"?t+"":t,s),s),je=(r,t,s)=>{if(!t.has(r))throw TypeError("Cannot "+s)};var i=(r,t,s)=>(je(r,t,"read from private field"),s?s.call(r):t.get(r)),o=(r,t,s)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,s)},u=(r,t,s,e)=>(je(r,t,"write to private field"),e?e.call(r,s):t.set(r,s),s);var l=(r,t,s)=>(je(r,t,"access private method"),s);var B=class{static onDOMContentLoaded(t){if(t&&t.constructor===window.Function){let s=()=>{t(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",s),100)};window.addEventListener("DOMContentLoaded",s)}}static getUniqueId(t="WUSE"){let s="_"+(t||"")+"_";for(var e;window.document.getElementById(e=s+(""+window.Math.random()).substring(2))!==null;);return e}static removeChildren(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}static htmlEncode(t=""){return typeof t!="string"?null:t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let t=window.getComputedStyle(window.document.body,""),e=window.Array.prototype.slice.call(t).filter(n=>n.charAt(0)==="-");return e.length?"-"+e[0].split("-")[1]+"-":""}};var ne,Qe=(r,t)=>(typeof t=="function"&&t(r),r),p=class{static get EMPTY_ARRAY(){return i(this,ne)}static noop(){}static isNonEmptyString(t){return typeof t=="string"&&!!t.length}static forcedStringSplit(t,s){return typeof t=="string"?t.split(s):new window.Array}static buildArray(t){return Qe(new window.Array,t)}static buildObject(t){return Qe(new window.Object,t)}static ensureFunction(t,s=()=>{}){return typeof t=="function"?t:s}static isOf(t,s){return t!=null&&(t.constructor===s||s!=null&&t.constructor.name===s.name)}static hasObjectKeys(t){return!!(t&&!!window.Object.keys(t).length)}static cloneObject(t){return window.Object.assign(new window.Object,t)}static forEachOwnProperty(t,s){t&&window.Object.getOwnPropertyNames(t).forEach(s)}static isAssignedObject(t){return typeof t=="object"&&t!==null}static isAssignedArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"}static isNonEmptyArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"&&!!t.length}};ne=new WeakMap,o(p,ne,new window.Array);var re,S,xe=class{static get UNKNOWN_ERROR(){return i(this,S).call(this,0,t=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return i(this,S).call(this,1,t=>`Unsupported feature: ${t}.`)}static get UNREGISTERED_CLASS(){return i(this,S).call(this,2,t=>`Unregistered class: ${t}.`)}static get UNREGISTRABLE_CLASS(){return i(this,S).call(this,3,t=>`Unregistrable class: ${t}.`)}static get INVALID_CLASS(){return i(this,S).call(this,4,t=>`Invalid class: ${t}.`)}static get MISNAMED_CLASS(){return i(this,S).call(this,5,t=>`Misnamed class: ${t}.`)}static get INVALID_DEFINITION(){return i(this,S).call(this,10,t=>`Invalid definition: ${t}.`)}static get INVALID_ID(){return i(this,S).call(this,11,t=>`Invalid id: ${t}.`)}static get INVALID_KEY(){return i(this,S).call(this,12,t=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return i(this,S).call(this,13,t=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return i(this,S).call(this,20,t=>`Inexistent template: #${t}.`)}static get EXTINCT_TEMPLATE(){return i(this,S).call(this,21,t=>`Extinct template: #${t}.`)}static get INVALID_TEMPLATE(){return i(this,S).call(this,22,t=>`Invalid template: #${t}.`)}static get UNESPECIFIED_SLOT(){return i(this,S).call(this,30,t=>`Unespecified slot: #${t}.`)}},g=xe;re=new WeakMap,S=new WeakMap,o(g,re,"[WUSE:ERROR]"),o(g,S,(t,s)=>({code:t,emit:e=>{let n=`${i(xe,re)} ${t} | ${s(e)}`;if(window.Wuse&&window.Wuse.FATALS||t<10)throw new window.Error(n);return window.console.error(n),null}}));var gt,yt,At,bt,Tt,oe,ei,ae,ii,he,si,le,ni,{noop:xt,ensureFunction:at,isAssignedObject:Ze,isAssignedArray:fs,isNonEmptyArray:ti}=p,_i=r=>r.toLowerCase().replaceAll("_","-"),C=class{static registerClasses(t){ti(t)&&window.Array.prototype.forEach.call(t,s=>typeof s=="function"?l(this,ae,ii).call(this,s):i(this,At).call(this,s))}static instantiateClasses(t,s,e){ti(t)&&window.Array.prototype.forEach.call(t,n=>window.customElements.get(n.tag)?l(this,le,ni).call(this,n,s,Ze(e)?e:new window.Object):i(this,Tt).call(this,n.name))}static initialize(t){Ze(t)&&(u(this,gt,at(t.onDeferredInstantiation,i(this,gt))),u(this,At,at(t.onInvalidClass,i(this,At))),u(this,yt,at(t.onMisnamedClass,i(this,yt))),u(this,bt,at(t.onUnregistrableClass,i(this,bt))),u(this,Tt,at(t.onUnregisteredClass,i(this,Tt))))}};gt=new WeakMap,yt=new WeakMap,At=new WeakMap,bt=new WeakMap,Tt=new WeakMap,oe=new WeakSet,ei=function(t){window.HTMLElement.isPrototypeOf(t)?window.customElements.define(t.tag,t):i(this,bt).call(this,t.name)},ae=new WeakSet,ii=function(t){t.name.indexOf("_")>0?(t.tag=_i(t.name),l(this,oe,ei).call(this,t)):i(this,yt).call(this,t.name)},he=new WeakSet,si=function(t,s,e){let n=null;try{n=window.document.querySelector(s)}catch(d){if(at(e.onBadTarget)(s)===!1)return}finally{n=n||window.document.body}let a=window.document.createElement(t.tag);at(e.onElementInstantiated)(a,s),n.appendChild(a)},le=new WeakSet,ni=function(t,s,e){let n=()=>l(this,he,si).call(this,t,s,e);window.document.body?n():i(this,gt).call(this,n)},o(C,oe),o(C,ae),o(C,he),o(C,le),o(C,gt,xt),o(C,yt,xt),o(C,At,xt),o(C,bt,xt),o(C,Tt,xt);var W,Bt,ke,kt=class{constructor(){o(this,Bt);o(this,W,new window.Object)}get length(){return l(this,Bt,ke).call(this).length}key(t){return l(this,Bt,ke).call(this)[t]||null}getItem(t){return i(this,W)[t]}setItem(t,s){i(this,W)[t]=s}removeItem(t){delete i(this,W)[t]}clear(){u(this,W,new window.Object)}hasItem(t){return i(this,W).hasOwnProperty(t)}};W=new WeakMap,Bt=new WeakSet,ke=function(){return window.Object.keys(i(this,W))};var we,oi,ri,fe,pe,St,ce=r=>r>1e3?(r/1e3).toFixed(2)+"s":r.toFixed(2)+"ms",de=class{constructor(){h(this,"round",0);h(this,"domTime",window.Number.MAX_SAFE_INTEGER);h(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var t=new window.Object;return t.round=this.round,t.domTime=ce(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(t.renderTime=ce(this.renderTime)),t}},ue=class{constructor(t){h(this,"name","");h(this,"rounds",0);h(this,"time",0);h(this,"average",0);this.name=t}compute(t){this.rounds++,this.time+=t,this.average=this.time/this.rounds}getDebugInfo(){let t=ce(this.time),s=ce(this.average);return{name:this.name,rounds:this.rounds,spent:t,average:s}}},L=class{static initialize(t){typeof t=="function"&&u(L,St,t),L.DOMUpdate.overall=new ue("overall-dom-update"),L.BrowserRender.overall=new ue("overall-browser-render")}},N=L;St=new WeakMap,o(N,St,()=>{}),h(N,"StopWatch",(ri=class{constructor(){o(this,we);h(this,"_begin",0);h(this,"_end",{dom:0,render:0});h(this,"rounds",0);h(this,"last",new de);h(this,"best",new de);h(this,"averages",{dom:0,render:0})}start(){(L.DOMUpdate.check||L.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(t){var s;L.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,L.DOMUpdate.overall.compute(this.last.domTime)),L.BrowserRender.check?setTimeout(()=>l(this,we,oi).bind(this)(t)):t&&i(s=L,St).call(s,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},we=new WeakSet,oi=function(t){var s;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,L.BrowserRender.overall.compute(this.last.renderTime),t&&i(s=L,St).call(s,this,"finish")},ri)),h(N,"DOMUpdate",(fe=class{},h(fe,"check",!0),h(fe,"overall",null),fe)),h(N,"BrowserRender",(pe=class{},h(pe,"check",!1),h(pe,"overall",null),pe));var O=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var Gt,me,ht,Kt,zt,{EMPTY_ARRAY:Fi,buildArray:Be,buildObject:$i,isNonEmptyString:ji,isOf:xi}=p,Ct=class{static initialize(t,s){this.begin=t,this.end=s}},H=Ct;h(H,"begin",null),h(H,"end",null),h(H,"enclose",t=>Ct.begin+t+Ct.end),h(H,"makeRegExp",()=>new window.RegExp("(?<="+Ct.begin+").*?(?="+Ct.end+")","gs"));var ki=["contents","classes","styles","attributes"],It=class{};h(It,"rules",(t,s)=>Be(e=>t.forEach(n=>n.replacements.forEach(a=>a.field===s&&e.push(n))))),h(It,"children",(t,s)=>Be(e=>{let n=a=>{let d=c=>c.forEach(A=>A.field===s&&e.push(a));ki.forEach(c=>d(a.replacements[c])),a.rules.forEach(c=>c.replacements.forEach(A=>A.field===s&&e.push(a)))};t.forEach(a=>a.rendering&&n(a))}));var v=class{static initialize(t){u(this,Gt,t)}},_=v;Gt=new WeakMap,me=new WeakMap,ht=new WeakMap,Kt=new WeakMap,zt=new WeakMap,o(_,Gt,null),o(_,me,(t,s,e)=>t.push({at:s,field:e.trim(),find:H.enclose(e)})),o(_,ht,(t,s,e)=>ji(e)&&(e.match(i(v,Gt))||Fi).forEach(n=>{var a;return i(a=v,me).call(a,t,s,n)})),o(_,Kt,(t,s,e)=>{var n;t[s]=new window.Array,i(n=v,ht).call(n,t[s],s,e)}),o(_,zt,(t,s,e)=>{t[s]=new window.Array,window.Object.keys(e).forEach(n=>{var a,d;i(a=v,ht).call(a,t[s],s,n),i(d=v,ht).call(d,t[s],s,e[n])})}),h(_,"child",t=>$i(s=>{var e,n,a,d;i(e=v,Kt).call(e,s,"contents",t.content),i(n=v,Kt).call(n,s,"classes",t.classes.join(" ")),i(a=v,zt).call(a,s,"styles",t.style),i(d=v,zt).call(d,s,"attributes",t.attributes),t.rules.forEach(c=>c.replacements=v.rule(c))})),h(_,"rule",t=>Be(s=>{var n;if(xi(t.nested,window.Array))return t.nested.map(a=>v.rule(a));var e="";for(let a in t.properties)e+=`${a}:${t.properties[a]};`;i(n=v,ht).call(n,s,"rules",e)}));var R=class{static initialize(t,s){H.initialize(t,s),_.initialize(H.makeRegExp())}};h(R,"extractReplacementsFromRule",_.rule),h(R,"extractReplacementsFromChild",_.child),h(R,"scanRulesForReplacements",It.rules),h(R,"scanChildrenForReplacements",It.children);var Nt,Ot,{noop:ai,ensureFunction:hi,isAssignedObject:Bi}=p,et=class{static fetch(t){let s=window.document.getElementById(t);return s===null?i(this,Nt).call(this,t):s.tagName!=="TEMPLATE"?i(this,Ot).call(this,t):s.innerHTML}static initialize(t){Bi(t)&&(u(this,Nt,hi(t.onExtinctTemplate,i(this,Nt))),u(this,Ot,hi(t.onInvalidTemplate,i(this,Ot))))}};Nt=new WeakMap,Ot=new WeakMap,o(et,Nt,ai),o(et,Ot,ai);var vt,{noop:Gi,isOf:Ki,hasObjectKeys:li,isNonEmptyString:ci,isNonEmptyArray:zi,isAssignedObject:Wi,ensureFunction:Hi}=p,{htmlEncode:di}=B,{TEMPLATES_KIND:Pi,TEXTNODE_TAG:Vi}=O,Ee=class{static initialize(t){Wi(t)&&u(this,vt,Hi(t.onFetchTemplate,i(this,vt)))}},y=Ee;vt=new WeakMap,o(y,vt,Gi),h(y,"cacheInvalidator",t=>t.cache=null),h(y,"renderingIncluder",t=>t.rendering=!0),h(y,"renderingExcluder",t=>t.rendering=!1),h(y,"renderRule",(t,s)=>{if(Ki(s.nested,window.Array))return`${s.selector}{${s.nested.map(n=>Ee.renderRule(t,n)).join(`
`)}}`;if(ci(s.selector)&&!s.nested){var e="";for(let n in s.properties)e+=`${n}:${s.properties[n]};`;return zi(s.replacements)&&s.replacements.forEach(n=>e=t(e,n)),`${s.selector}{${e}}`}return null}),h(y,"renderChild",(t,s)=>{var a;if(s.kind===Pi)return i(a=Ee,vt).call(a,s.id);if(s.tag===Vi){var e=s.content;return s.replacements.contents.forEach(d=>e=t(e,d)),s.encode?di(e):e}var n=ci(s.id)?`<${s.tag} id='${s.id}'`:`<${s.tag}`;if(s.classes.length){var e=s.classes.join(" ");s.replacements.classes.forEach(c=>e=t(e,c)),n+=` class='${e}'`}if(li(s.style)){var e=" style='";for(let c in s.style)e+=c+": "+s.style[c]+"; ";e+="'",s.replacements.styles.forEach(c=>e=t(e,c)),n+=e}if(li(s.attributes)){var e="";for(let c in s.attributes)e+=` ${c}=${s.attributes[c]}`;s.replacements.attributes.forEach(c=>e=t(e,c)),n+=e}if(typeof s.content=="string"){var e=s.content;s.replacements.contents.forEach(c=>e=t(e,c)),n+=`>${s.encode?di(e):e}</${s.tag}>`}else n+="/>";return n});var Wt,Ht,Pt,Vt,Dt=class{constructor(t){h(this,"rounds",0);o(this,Wt,0);o(this,Ht,null);o(this,Pt,!1);o(this,Vt,null);u(this,Vt,typeof t=="function"?t:()=>{})}compute(t){return this.rounds+=+u(this,Pt,i(this,Wt)==u(this,Ht,i(this,Vt).call(this,t))),u(this,Wt,i(this,Ht)),i(this,Pt)}};Wt=new WeakMap,Ht=new WeakMap,Pt=new WeakMap,Vt=new WeakMap;var lt,G,it,ge,ui,Lt=class{constructor(t,s){o(this,ge);o(this,lt,null);o(this,G,null);o(this,it,null);if(t instanceof Node&&s instanceof Node)u(this,lt,t),u(this,G,s),u(this,it,s.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return i(this,G)}affiliate(){i(this,lt).appendChild(i(this,G))}disaffiliate(){i(this,lt).removeChild(i(this,G))}promote(t){i(this,it).innerHTML=t,i(this,lt).replaceChild(i(this,it),i(this,G)),l(this,ge,ui).call(this)}};lt=new WeakMap,G=new WeakMap,it=new WeakMap,ge=new WeakSet,ui=function(){let t=i(this,it);u(this,it,i(this,G).cloneNode(!1)),u(this,G,t)};var ct,dt,ut=class{constructor(t){h(this,"owner",null);o(this,ct,!1);o(this,dt,"");this.owner=t}get invalidated(){return i(this,ct)}reset(t){u(this,ct,!1),u(this,dt,t)}append(t){u(this,dt,i(this,dt)+t)}verify(t){u(this,ct,t(i(this,dt)))}process(){i(this,ct)&&this.on_content_invalidation(i(this,dt))}on_content_invalidation(t){}};ct=new WeakMap,dt=new WeakMap;var Rt,ye,{isOf:Ge,cloneObject:fi,forEachOwnProperty:pi,buildArray:Ji}=p,ft=class extends window.Array{constructor(s){super();o(this,Rt);h(this,"owner",null);h(this,"last",null);h(this,"version",0);this.owner=s}append(s){Ge(s,window.Object)&&(this.push(s),l(this,Rt,ye).call(this,s))}prepend(s){Ge(s,window.Object)&&(this.unshift(s),l(this,Rt,ye).call(this,s))}replace(s,e){s>-1&&Ge(e,window.Object)&&l(this,Rt,ye).call(this,this[s]=e)}on_version_change(){}persist(){return Ji(s=>pi(this,e=>{switch(e){case"owner":case"last":case"length":break;case"version":s[e]=this[e];break;default:if(window.Number.isInteger(window.Number(e))){let n=fi(this[e]);n.cache&&(n.cache=null),s.push(n)}break}}))}restore(s){pi(s,e=>{switch(e){case"length":break;case"version":this[e]=s[e];break;default:if(window.Number.isInteger(window.Number(e))){let n=fi(s[e]);n.cache&&(n.cache=null),this.push(n)}break}})}};Rt=new WeakSet,ye=function(s){this.last=s,this.version++,this.on_version_change()};var be,gi,Te,yi,Se,Ai,Ie,bi,Ce,Ti,Ut,Ae,Ne,Si,{EMPTY_ARRAY:Yi,buildArray:Fs,buildObject:Xi,isOf:P,hasObjectKeys:wi,isNonEmptyString:pt,forcedStringSplit:qi}=p,{DEFAULT_TAG:Qi,DEFAULT_KIND:Zi,TEMPLATES_KIND:Ke,SLOTS_KIND:ze}=O,V=class{static parse(t){if(pt(t)){let s=t.trimLeft(),e=mi();return s.charAt(0)==="%"?s.startsWith(Ke)?l(this,Ut,Ae).call(this,e,s.replace(e.kind=Ke,"")):s.startsWith(ze)?l(this,Ut,Ae).call(this,e,s.replace(e.kind=ze,"")):null:l(this,Ut,Ae).call(this,e,s)}return null}};be=new WeakSet,gi=function(t,s){let e=s.indexOf("["),n=s.indexOf("]");if(e>-1&&n>-1&&n>e){let a=s.substr(e,n-e+1),d=a.substr(1,a.length-2).split("|");for(let c in d){let A=d[c].split("=");A[0]==="style"?A[1].split(";").forEach($=>{let j=$.split(":"),qe=j[0].trim();qe.length&&(t.style[qe]=j[1].trim())}):t.attributes[A[0]]=A[1]}return s.replace(a,"")}return s},Te=new WeakSet,yi=function(t,s){let e=s.indexOf("=");return e>-1?(t.content=s.slice(e+1),!!t.content.length&&t.content.charAt(0)==="&"&&(t.content=t.content.slice(1),t.encode=!!t.content.length&&t.content.charAt(0)!=="&"),s.slice(0,e)):s},Se=new WeakSet,Ai=function(t,s){let e=s.replaceAll("!"," ").split(" ");return e.slice(1).map(n=>{let[a,...d]=n.toLowerCase().split("+"),c=(d||Yi).indexOf("capture")>-1;t.events.push(Ei(a,c))}),e[0]},Ie=new WeakSet,bi=function(t,s){let e=s.replaceAll("."," ").split(" ");return t.classes=e.slice(1),e[0]},Ce=new WeakSet,Ti=function(t,s){if(s!==""){let e=s.indexOf("#");e===-1?t.tag=s:(e>0&&(t.tag=s.substr(0,e)),t.id=s.substr(e+1))}return t},Ut=new WeakSet,Ae=function(t,s){return l(this,Ce,Ti).call(this,t,l(this,Ie,bi).call(this,t,l(this,Se,Ai).call(this,t,l(this,Te,yi).call(this,t,l(this,be,gi).call(this,t,s)))))},o(V,be),o(V,Te),o(V,Se),o(V,Ie),o(V,Ce),o(V,Ut);var Jt=class{static parse(t){return Xi(s=>(P(t,window.Array)?t:qi(t,`
`).map(e=>e.trim()).join("").split(";")).forEach(e=>pt(e)&&l(this,Ne,Si).call(this,s,e.trim())))}};Ne=new WeakSet,Si=function(t,s){if(!!s.length&&s.indexOf(":")>-1){let[e,...n]=s.split(":"),a=e.trim();if(a.length){let d=n.join(":").trim();t[a]=d.endsWith(";")?d.slice(0,-1):d}}},o(Jt,Ne);var mi=()=>({kind:Zi,tag:Qi,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}),Ei=(r,t)=>typeof r=="string"&&typeof t=="boolean"?{kind:r,capture:t}:null,ts=(r,t)=>{let s=V.parse(r);return s?(s.rules=P(t,window.Array)?t:new window.Array,s.rendering=!0,s.cache=null,s):g.INVALID_DEFINITION.emit(r)},es=r=>{if(r.kind===Ke){if(!window.document.getElementById(r.id))return g.INEXISTENT_TEMPLATE.emit(r.id)}else if(r.kind===ze){if(new window.String(r.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return g.UNESPECIFIED_SLOT.emit(r.id)}else if(typeof r.id!="string"||r.id!==""&&window.document.getElementById(r.id)!==null)return g.INVALID_ID.emit(r.id);return r},is=r=>{if(!P(r,window.Object))return null;let t=window.document.createElement(r.tag);if(r.id.length&&t.setAttribute("id",r.id),r.classes.length&&t.setAttribute("class",r.classes.join(" ")),wi(r.style)){var s="";for(let e in r.style)s+=e+": "+r.style[e]+"; ";if(s.length){let e=s.trim();t.setAttribute("style",e.endsWith(";")?e.slice(0,-1):e)}}if(wi(r.attributes))for(let e in r.attributes)t.setAttribute(e,r.attributes[e]);return t},ss=(r,t)=>{let s=window.document.createElement("style");return pt(r)&&s.setAttribute("media",r),pt(t)&&s.setAttribute("type",t),s.appendChild(window.document.createTextNode("")),s},ns=(r,t)=>{let s=P(r,window.Array)?r.join(","):pt(r)?r:"";return s.length?{selector:s,properties:P(t,window.Object)?t:Jt.parse(t),cache:null}:null},rs=(r,t,s)=>{let e=P(r,window.Array)?r.join(","):pt(r)?r:"",n=P(t,window.Array)?t.join(","):pt(t)?t:"";return!e.length||!n.length?null:{selector:e,nested:[{selector:n,properties:P(s,window.Object)?s:Jt.parse(s)}],cache:null}},os=(r,t)=>{if(r.selector===t.selector){for(let s in t.properties)r.properties[s]=t.properties[s];return r.cache=null,!0}return!1},as=(r,t)=>P(r.nested,window.Array)&&r.selector===t.selector?(t.nested.forEach(s=>{var e=!1;for(let n in r.nested)if(e=r.nested[n].selector===s.selector){for(let a in s.properties)r.nested[n].properties[a]=s.properties[a];break}e||r.nested.push(s)}),r.cache=null,!0):!1,w=class{};h(w,"makeStyleNode",ss),h(w,"newRule",ns),h(w,"newNestedRule",rs),h(w,"tryToJoinRules",os),h(w,"tryToJoinNestedRules",as),h(w,"performValidations",es),h(w,"makeMainNode",is),h(w,"newChild",ts),h(w,"newDefinition",mi),h(w,"newEvent",Ei);var st,x,T,b,K,E,_t,J,Y,nt,z,X,Yt,mt,q,rt,U,Q,Z,m,Ft,Xt,Et,k,tt,wt,ve,Ii,De,Ci,Le,Ni,Re,Oi,ot,Mt,qt,We,Qt,He,Zt,Pe,Ue,vi,te,Ve,Me,Di,ee,Je,_e,Li,D,F,ie,Ye,$t,Fe,Ri,jt,Oe,se,Xe,$e,M,f=class{static get VERSION(){return"0.4.2"}static blockUpdate(t,s){if(p.isOf(t,Function)){f.DEBUG&&f.debug("blocking"),f.RENDERING=!1;try{t(s)}catch(e){throw e}finally{f.RENDERING=!0,f.DEBUG&&f.debug("unblocking")}}}static debug(t){window.console.log("[WUSE:DEBUG]",t)}static register(t){return C.registerClasses(p.isOf(t,window.Array)?t:new window.Array(t))}static instantiate(t,s,e){return C.instantiateClasses(p.isOf(t,window.Array)?t:new window.Array(t),s,e)}static isShadowElement(t){let s=window.Object.getPrototypeOf(t.constructor);return s===f.OpenShadowElement||s===f.ClosedShadowElement}static get elementCount(){return i(f,M).instancesCount}static makeReactiveField(t,s,e,n,a){let d=($,j)=>window.Object.defineProperty(t,s,{get:$,set:j,enumerable:!0,configurable:!0}),c=()=>delete t[s],A=($,j)=>f.makeReactiveField(t,s,$,j,a);d(()=>e,$=>{A($,n),p.isOf(n,window.Function)?n({renderize:j=>a(s,j),automate:()=>A($,null),freeze:()=>d(()=>$,j=>{}),defreeze:()=>A($,n),dereact:()=>d(()=>$,j=>{c(),t[s]=j}),remove:()=>c()}):a(s)})}},I=f;$e=new WeakMap,M=new WeakMap,h(I,"WebHelpers",B),h(I,"JsHelpers",p),h(I,"PerformanceMeasurement",N),h(I,"tmp",new window.Object),h(I,"DEBUG",!1),h(I,"FATALS",!1),h(I,"MEASURE",!1),h(I,"RENDERING",!0),o(I,$e,new kt),h(I,"hashRoutine",t=>{var s=0;for(let e=0;e<t.length;e++)s=(s=(s<<5)-s+t.charCodeAt(e))&s;return s}),o(I,M,(st=class extends window.HTMLElement{constructor(e){super();o(this,tt);o(this,ve);o(this,De);o(this,Le);o(this,Re);o(this,ot);o(this,qt);o(this,Qt);o(this,Zt);o(this,Ue);o(this,te);o(this,Me);o(this,ee);o(this,_e);o(this,D);o(this,ie);o(this,Fe);o(this,jt);o(this,se);o(this,x,"");o(this,T,new class extends ft{on_version_change(){var e;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromRule(this.last),f.DEBUG&&l(e=this.owner,tt,wt).call(e,`rules list version change: ${this.version}`)}}(this));o(this,b,new class extends ft{on_version_change(){var e,n;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromChild(this.last),u(e=this.owner,Y,i(e,Y)|this.last.kind===O.SLOTS_KIND),f.DEBUG&&l(n=this.owner,tt,wt).call(n,`children list version change: ${this.version}`)}}(this));o(this,K,new class extends ft{on_version_change(){var e;f.DEBUG&&l(e=this.owner,tt,wt).call(e,`fields list version change: ${this.version}`)}snapshot(){this.forEach(e=>e.value=this.owner[e.name])}recall(){this.forEach(e=>this.owner[e.name]=e.value)}}(this));o(this,E,{mainDefinition:w.newDefinition(),styleMedia:O.DEFAULT_STYLE_MEDIA,styleType:O.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});o(this,_t,new window.Object);o(this,J,!1);o(this,Y,!1);o(this,nt,void 0);o(this,z,void 0);o(this,X,null);o(this,Yt,f.isShadowElement(this));o(this,mt,!1);o(this,q,!1);o(this,rt,i(f,$e));o(this,U,null);o(this,Q,"");o(this,Z,!1);o(this,m,{root:new class extends ut{on_content_invalidation(e){this.owner.innerHTML=e}}(this),style:new class extends ut{on_content_invalidation(e){i(this.owner,z).promote(e)}}(this),main:new class extends ut{on_content_invalidation(e){i(this.owner,nt).promote(e)}}(this),renderizers:{rule:e=>i(this,m).style.append(e.cache?e.cache:e.cache=y.renderRule(i(this,Ft),e)),children:{mixed:e=>i(this,Yt)&&e.kind===O.SLOTS_KIND?i(this,m).renderizers.children.slot(e):i(this,m).renderizers.children.normal(e),slot:e=>{e.cache||(i(this,m).root.verify(n=>!0),i(this,m).root.append(e.cache=y.renderChild(i(this,Ft),e)))},normal:e=>{i(this,m).main.append(e.cache?e.cache:e.cache=y.renderChild(i(this,Ft),e)),e.rules.forEach(i(this,m).renderizers.rule)}}},gotModified:()=>i(this,m).root.invalidated||i(this,m).main.invalidated||i(this,m).style.invalidated,getDebugInfo:()=>`updated (root: ${i(this,m).root.invalidated}, main: ${i(this,m).main.invalidated}, style: ${i(this,m).style.invalidated})`});o(this,Ft,(e,n)=>e.replace(n.find,this[n.field]!==void 0?this[n.field]:""));o(this,Xt,{bind:{key:()=>{let e=n=>{p.isNonEmptyString(n)&&(this[n]=l(this,qt,We).call(this,n))};return i(this,J)&&e(i(this,E).mainDefinition.id),n=>e(n.id)},event:"addEventListener"},unbind:{key:()=>{let e=n=>delete this[n];return i(this,J)&&e(i(this,E).mainDefinition.id),n=>e(n.id)},event:"removeEventListener"}});o(this,Et,{main:new Dt(f.hashRoutine),style:new Dt(f.hashRoutine)});o(this,k,{attachment:new N.StopWatch,partial:new N.StopWatch,full:new N.StopWatch,dettachment:new N.StopWatch});o(this,$t,()=>i(f,M).EVENT_NAMES.forEach(e=>i(this,_t)[e]=typeof this[e]=="function"));h(this,"info",{instanceNumber:++i(f,M).instancesCount,unmodifiedRounds:0,updatedRounds:0});u(this,X,e!==i(f,M).RootMode.REGULAR?this.attachShadow({mode:e}):this),i(this,$t).call(this),l(this,D,F).call(this,"on_create"),i(this,E).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),l(this,Fe,Ri).call(this)&&i(this,U).generation>1?l(this,D,F).call(this,"on_reconstruct",i(this,U)):l(this,D,F).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return i(this,q)?l(this,Ue,vi):p.noop}get redraw(){return i(this,q)?l(this,Me,Di):p.noop}connectedCallback(){f.MEASURE&&i(this,k).attachment.start(),i(this,$t).call(this),l(this,D,F).call(this,"on_connect"),l(this,te,Ve).call(this,"on_load"),i(this,Z)&&this.persistToElementsStore(),f.MEASURE&&i(this,k).attachment.stop(f.DEBUG)}disconnectedCallback(){f.MEASURE&&i(this,k).dettachment.start(),l(this,ot,Mt).call(this,!1),l(this,D,F).call(this,"on_disconnect"),f.MEASURE&&i(this,k).dettachment.stop(f.DEBUG)}getElementsStore(){return i(this,rt)}setElementsStore(e){u(this,rt,e)}hasElementsStoreKey(e){return i(this,Z)}getElementsStoreKey(e){return i(this,Q)}setElementsStoreKey(e){return u(this,Z,p.isNonEmptyString(u(this,Q,e))),this}persistToElementsStore(){if(l(this,se,Xe).call(this)){let e=i(this,U);if(e)return i(this,K).snapshot(),e.data=new window.Object({options:i(this,E),html:i(this,x),children:i(this,b).persist(),rules:i(this,T).persist(),fields:i(this,K).persist(),slotted:i(this,Y),identified:i(this,J)}),l(this,jt,Oe).call(this),!0}return!1}restoreFromElementsStore(e){if(l(this,se,Xe).call(this)){let n=i(this,U);if(n&&n.persisted&&n.data)return u(this,E,n.data.options),u(this,Y,n.data.slotted),u(this,J,n.data.identified),u(this,x,n.data.html),i(this,b).restore(n.data.children),i(this,b).owner=this,i(this,T).restore(n.data.rules),i(this,T).owner=this,i(this,K).restore(n.data.fields),i(this,K).owner=this,i(this,K).recall(),e||(delete n.data,l(this,jt,Oe).call(this)),!0}return!1}selectChildElement(e){return i(this,X).querySelector(e)}setMainAttribute(e,n){i(this,mt)&&i(this,nt).element.setAttribute(e,n)}setMainElement(e){let n=w.newChild(e);if(w.performValidations(n)){if(n.content!==""||!!n.events.length)return g.INVALID_DEFINITION.emit(e);u(this,J,!!n.id.length)&&(i(this,E).mainDefinition.id=n.id),n.tag.length&&(i(this,E).mainDefinition.tag=n.tag),n.classes.length&&(i(this,E).mainDefinition.classes=n.classes),n.style&&(i(this,E).mainDefinition.style=n.style),n.attributes&&(i(this,E).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(e,n){return i(this,E).styleMedia=e||"",i(this,E).styleType=n||"",this}setElementsAsKeys(e){return i(this,E).elementKeys=!!e,this}setAttributesAsKeys(e){return i(this,E).attributeKeys=!!e,this}allowRawContent(e){return i(this,E).rawContent=!!e,this}setRawContent(e){return i(this,E).rawContent?u(this,x,e):g.ALLOW_HTML.emit(),this}appendRawContent(e){return i(this,E).rawContent?u(this,x,i(this,x)+e):g.ALLOW_HTML.emit(),this}prependRawContent(e){return i(this,E).rawContent?u(this,x,e+i(this,x)):g.ALLOW_HTML.emit(),this}appendCSSRule(e,n,a){if(a)return this.appendCSSNestedRule(e,n,a);let d=i(this,T).slice(-1),c=w.newRule(e,n);return(!d.length||!w.tryToJoinRules(d[0],c))&&i(this,T).append(c),this}prependCSSRule(e,n,a){if(a)return this.prependCSSNestedRule(e,n,a);let d=i(this,T).slice(0,1),c=w.newRule(e,n);return(!d.length||!w.tryToJoinRules(d[0],c))&&i(this,T).prepend(c),this}appendCSSNestedRule(e,n,a){let d=i(this,T).slice(-1),c=w.newNestedRule(e,n,a);return(!d.length||!w.tryToJoinNestedRules(d[0],c))&&i(this,T).append(c),this}prependCSSNestedRule(e,n,a){let d=i(this,T).slice(0,1),c=w.newNestedRule(e,n,a);return(!d.length||!w.tryToJoinNestedRules(d[0],c))&&i(this,T).prepend(c),this}appendChildElement(e,n){return i(this,b).append(w.performValidations(w.newChild(e,n))),this}prependChildElement(e,n){return i(this,b).prepend(w.performValidations(w.newChild(e,n))),this}replaceChildElement(e,n){return i(this,b).replace(i(this,b).findIndex(a=>a.id===e),w.newChild(n)),this}appendChildElements(e){return(p.isOf(e,window.Array)?e:p.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(e){return(p.isOf(e,window.Array)?e:p.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}checkChildElementIsIncludedById(e,n,a){let d=c=>p.isOf(c,window.Function)?c():void 0;return i(this,b).some(c=>c.id===e&&c.rendering)?d(n):d(a),this}includeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingIncluder(n)),this}excludeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingExcluder(n)),this}invalidateChildElementsById(e){return i(this,b).forEach(n=>e.indexOf(n.id)>-1&&y.cacheInvalidator(n)),this}invalidateChildElements(e){return p.isOf(e,window.Array)&&e.forEach(y.cacheInvalidator),this}makeField(e,n){return this[e]=n,i(this,K).append({name:e,value:n}),this}makeReactiveField(e,n,a,d=!0){return l(this,_e,Li).call(this,e,n,a,d)}makeExternalReactiveField(e,n,a,d,c=!0){return this.makeReactiveField(n,e[n]||a,A=>{e[n]=this[n],d(A)},c)}},x=new WeakMap,T=new WeakMap,b=new WeakMap,K=new WeakMap,E=new WeakMap,_t=new WeakMap,J=new WeakMap,Y=new WeakMap,nt=new WeakMap,z=new WeakMap,X=new WeakMap,Yt=new WeakMap,mt=new WeakMap,q=new WeakMap,rt=new WeakMap,U=new WeakMap,Q=new WeakMap,Z=new WeakMap,m=new WeakMap,Ft=new WeakMap,Xt=new WeakMap,Et=new WeakMap,k=new WeakMap,tt=new WeakSet,wt=function(e){i(this,J)&&f.debug(`#${i(this,E).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`)},ve=new WeakSet,Ii=function(){i(this,z)&&i(this,z).affiliate(),i(this,nt).affiliate(),u(this,mt,!0)},De=new WeakSet,Ci=function(){u(this,z,i(this,T).length?new Lt(i(this,X),w.makeStyleNode(i(this,E).styleMedia,i(this,E).styleType)):null),u(this,nt,new Lt(i(this,X),w.makeMainNode(i(this,E).mainDefinition))),i(this,b).forEach(y.cacheInvalidator),i(this,T).forEach(y.cacheInvalidator)},Le=new WeakSet,Ni=function(){i(this,mt)&&(i(this,nt).disaffiliate(),i(this,z)&&i(this,z).disaffiliate(),i(this,Y)&&i(this,Yt)&&B.removeChildren(this)),u(this,mt,!1)},Re=new WeakSet,Oi=function(e){return{key:i(this,E).elementKeys&&e.key(),event:(n,a,d)=>{let c=this[`on_${n}_${a}`];if(c){let A=l(this,qt,We).call(this,n);A&&A[e.event](a,c,d)}},slots:()=>this.on_slot_change&&i(this,X).querySelectorAll("slot").forEach(n=>n[e.event]("slotchange",this.on_slot_change))}},ot=new WeakSet,Mt=function(e){if(i(this,q)&&!e||!i(this,q)&&e){let n=l(this,Re,Oi).call(this,e?i(this,Xt).bind:i(this,Xt).unbind);i(this,b).forEach(a=>{!a.rendering&&e||(n.key&&n.key(a),a.events.forEach(d=>d&&n.event(a.id,d.kind,d.capture)))}),i(this,Y)&&n.slots(),u(this,q,e)}},qt=new WeakSet,We=function(e){return p.isNonEmptyString(e)?i(this,X).querySelector(`#${e}`):void 0},Qt=new WeakSet,He=function(){i(this,m).root.reset(""),i(this,m).style.reset(""),i(this,m).main.reset(i(this,x));let e=i(this,Y)?i(this,m).renderizers.children.mixed:i(this,m).renderizers.children.normal;i(this,b).forEach(n=>n.rendering&&e(n)),i(this,T).forEach(i(this,m).renderizers.rule),i(this,m).main.verify(n=>!i(this,Et).main.compute(n)),i(this,m).style.verify(n=>!i(this,Et).style.compute(n))},Zt=new WeakSet,Pe=function(){i(this,m).root.process(),i(this,m).style.process(),i(this,m).main.process(),f.DEBUG&&l(this,tt,wt).call(this,i(this,m).getDebugInfo())},Ue=new WeakSet,vi=function(){!f.RENDERING||(f.MEASURE&&i(this,k).partial.start(),l(this,D,F).call(this,"on_prerender"),l(this,Qt,He).call(this),i(this,m).gotModified()?(l(this,ot,Mt).call(this,!1),l(this,Zt,Pe).call(this),l(this,ot,Mt).call(this,!0),this.info.updatedRounds++,l(this,D,F).call(this,"on_update"),l(this,ie,Ye).call(this,"on_refresh")):this.info.unmodifiedRounds++,f.DEBUG&&l(this,tt,wt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${i(this,Et).main.rounds}, style: ${i(this,Et).style.rounds}) | updated: ${this.info.updatedRounds}`),l(this,D,F).call(this,"on_postrender"),f.MEASURE&&i(this,k).partial.stop(f.DEBUG))},te=new WeakSet,Ve=function(e){l(this,De,Ci).call(this),l(this,ve,Ii).call(this),l(this,D,F).call(this,"on_inject"),l(this,Qt,He).call(this),i(this,m).style.verify(n=>!!i(this,z)),l(this,Zt,Pe).call(this),l(this,ot,Mt).call(this,!0),l(this,D,F).call(this,e)},Me=new WeakSet,Di=function(){f.MEASURE&&i(this,k).full.start(),l(this,ot,Mt).call(this,!1),l(this,Le,Ni).call(this),l(this,D,F).call(this,"on_unload"),i(this,$t).call(this),l(this,te,Ve).call(this,"on_reload"),l(this,ie,Ye).call(this,"on_repaint"),f.MEASURE&&i(this,k).full.stop(f.DEBUG)},ee=new WeakSet,Je=function(e,n="$none"){if(i(this,q)){let a=R.scanRulesForReplacements(i(this,T),e);a.forEach(y.cacheInvalidator);let d=R.scanChildrenForReplacements(i(this,b),e);d.forEach(y.cacheInvalidator),f.DEBUG&&l(this,tt,wt).call(this,`reactive render (label: ${n}, field: ${e}, children: ${d.length}, rules: ${a.length})`),(!!a.length||!!d.length)&&(d.some(c=>!!c.kind.length)&&i(this,b).forEach(c=>c.kind===O.SLOTS_KIND?y.cacheInvalidator(c):void 0),this.render())}},_e=new WeakSet,Li=function(e,n,a,d=!0){return f.makeReactiveField(this,e,n,a,(c,A)=>l(this,ee,Je).call(this,c,A||"$auto")),i(this,K).append({name:e,value:n}),d&&l(this,ee,Je).call(this,e,"$init"),this},D=new WeakSet,F=function(e,n){i(this,_t)[e]&&this[e].call(this,n)},ie=new WeakSet,Ye=function(e,n){i(this,Z)&&this.persistToElementsStore(),i(this,_t)[e]&&window.requestAnimationFrame(()=>this[e].call(this,n))},$t=new WeakMap,Fe=new WeakSet,Ri=function(){return i(this,Z)?(u(this,U,i(this,rt).hasItem(i(this,Q))?i(this,rt).getItem(i(this,Q)):{generation:0,persisted:!1}),i(this,U).generation++,l(this,jt,Oe).call(this),!0):!1},jt=new WeakSet,Oe=function(){f.DEBUG&&(i(this,U).key=i(this,Q)),i(this,U).persisted=!!i(this,U).data,i(this,rt).setItem(i(this,Q),i(this,U))},se=new WeakSet,Xe=function(){return i(this,Z)?!0:(g.INVALID_KEY.emit(),!1)},h(st,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),h(st,"specializeClass",e=>class extends st{constructor(){super(e)}}),h(st,"instancesCount",0),st)),h(I,"NonShadowElement",i(f,M).specializeClass(i(f,M).RootMode.REGULAR)),h(I,"OpenShadowElement",i(f,M).specializeClass(i(f,M).RootMode.OPEN)),h(I,"ClosedShadowElement",i(f,M).specializeClass(i(f,M).RootMode.CLOSED)),(()=>{let t=(s,e)=>!s&&g.UNSUPPORTED_FEATURE.emit(e);try{t(p.isOf(window.document,window.HTMLDocument),"HTML Document"),t(p.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),B.onDOMContentLoaded(()=>t(p.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(s){g.UNKNOWN_ERROR.emit()}N.initialize((s,e)=>f.debug(JSON.stringify(p.buildArray(n=>{switch(n.push({instances:f.elementCount}),n.push(s.getDebugInfo()),e){case"stop":n.push(N.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(N.BrowserRender.overall.getDebugInfo());break}})))),C.initialize({onMisnamedClass:g.MISNAMED_CLASS.emit,onUnregistrableClass:g.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:g.UNREGISTERED_CLASS.emit,onInvalidClass:g.INVALID_CLASS.emit,onDeferredInstantiation:B.onDOMContentLoaded}),et.initialize({onExtinctTemplate:g.EXTINCT_TEMPLATE.emit,onInvalidTemplate:g.INVALID_TEMPLATE.emit}),y.initialize({onFetchTemplate:et.fetch}),R.initialize(O.DEFAULT_REPLACEMENT_OPEN,O.DEFAULT_REPLACEMENT_CLOSE)})(),window.Wuse=I;})();
