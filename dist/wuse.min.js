(()=>{var Ui=Object.defineProperty;var Mi=(o,t,s)=>t in o?Ui(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var h=(o,t,s)=>(Mi(o,typeof t!="symbol"?t+"":t,s),s),je=(o,t,s)=>{if(!t.has(o))throw TypeError("Cannot "+s)};var i=(o,t,s)=>(je(o,t,"read from private field"),s?s.call(o):t.get(o)),r=(o,t,s)=>{if(t.has(o))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(o):t.set(o,s)},u=(o,t,s,e)=>(je(o,t,"write to private field"),e?e.call(o,s):t.set(o,s),s);var l=(o,t,s)=>(je(o,t,"access private method"),s);var B=class{static onDOMContentLoaded(t){if(t&&t.constructor===window.Function){let s=()=>{t(),setTimeout(()=>window.removeEventListener("DOMContentLoaded",s),100)};window.addEventListener("DOMContentLoaded",s)}}static getUniqueId(t="WUSE"){let s="_"+(t||"")+"_";for(var e;window.document.getElementById(e=s+(""+window.Math.random()).substring(2))!==null;);return e}static removeChildren(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}static htmlEncode(t=""){return typeof t!="string"?null:t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static getCSSVendorPrefix(){let t=window.getComputedStyle(window.document.body,""),e=window.Array.prototype.slice.call(t).filter(n=>n.charAt(0)==="-");return e.length?"-"+e[0].split("-")[1]+"-":""}};var se,Qe=(o,t)=>(typeof t=="function"&&t(o),o),p=class{static get EMPTY_ARRAY(){return i(this,se)}static noop(){}static isNonEmptyString(t){return typeof t=="string"&&!!t.length}static forcedStringSplit(t,s){return typeof t=="string"?t.split(s):new window.Array}static buildArray(t){return Qe(new window.Array,t)}static buildObject(t){return Qe(new window.Object,t)}static ensureFunction(t,s=()=>{}){return typeof t=="function"?t:s}static isOf(t,s){return t!=null&&(t.constructor===s||s!=null&&t.constructor.name===s.name)}static hasObjectKeys(t){return!!(t&&!!window.Object.keys(t).length)}static cloneObject(t){return window.Object.assign(new window.Object,t)}static forEachOwnProperty(t,s){t&&window.Object.getOwnPropertyNames(t).forEach(s)}static isAssignedObject(t){return typeof t=="object"&&t!==null}static isAssignedArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"}static isNonEmptyArray(t){return typeof t=="object"&&t!==null&&t.constructor.name==="Array"&&!!t.length}};se=new WeakMap,r(p,se,new window.Array);var ne,S,xe=class{static get UNKNOWN_ERROR(){return i(this,S).call(this,0,t=>"Unknown error.")}static get UNSUPPORTED_FEATURE(){return i(this,S).call(this,1,t=>`Unsupported feature: ${t}.`)}static get UNREGISTERED_CLASS(){return i(this,S).call(this,2,t=>`Unregistered class: ${t}.`)}static get UNREGISTRABLE_CLASS(){return i(this,S).call(this,3,t=>`Unregistrable class: ${t}.`)}static get INVALID_CLASS(){return i(this,S).call(this,4,t=>`Invalid class: ${t}.`)}static get MISNAMED_CLASS(){return i(this,S).call(this,5,t=>`Misnamed class: ${t}.`)}static get INVALID_DEFINITION(){return i(this,S).call(this,10,t=>`Invalid definition: ${t}.`)}static get INVALID_ID(){return i(this,S).call(this,11,t=>`Invalid id: ${t}.`)}static get INVALID_KEY(){return i(this,S).call(this,12,t=>"Call first: this.setElementsStoreKey(<your-valid-key>).")}static get ALLOW_HTML(){return i(this,S).call(this,13,t=>"Call first: this.allowRawContent(true).")}static get INEXISTENT_TEMPLATE(){return i(this,S).call(this,20,t=>`Inexistent template: #${t}.`)}static get EXTINCT_TEMPLATE(){return i(this,S).call(this,21,t=>`Extinct template: #${t}.`)}static get INVALID_TEMPLATE(){return i(this,S).call(this,22,t=>`Invalid template: #${t}.`)}static get UNESPECIFIED_SLOT(){return i(this,S).call(this,30,t=>`Unespecified slot: #${t}.`)}},g=xe;ne=new WeakMap,S=new WeakMap,r(g,ne,"[WUSE:ERROR]"),r(g,S,(t,s)=>({code:t,emit:e=>{let n=`${i(xe,ne)} ${t} | ${s(e)}`;if(Wuse.FATALS||t<10)throw new window.Error(n);return window.console.error(n),null}}));var Et,gt,yt,At,bt,re,ei,oe,ii,ae,si,he,ni,{noop:jt,ensureFunction:at,isAssignedObject:Ze,isAssignedArray:fs,isNonEmptyArray:ti}=p,_i=o=>o.toLowerCase().replaceAll("_","-"),C=class{static registerClasses(t){ti(t)&&window.Array.prototype.forEach.call(t,s=>typeof s=="function"?l(this,oe,ii).call(this,s):i(this,yt).call(this,s))}static instantiateClasses(t,s,e){ti(t)&&window.Array.prototype.forEach.call(t,n=>window.customElements.get(n.tag)?l(this,he,ni).call(this,n,s,Ze(e)?e:new window.Object):i(this,bt).call(this,n.name))}static initialize(t){Ze(t)&&(u(this,Et,at(t.onDeferredInstantiation,i(this,Et))),u(this,yt,at(t.onInvalidClass,i(this,yt))),u(this,gt,at(t.onMisnamedClass,i(this,gt))),u(this,At,at(t.onUnregistrableClass,i(this,At))),u(this,bt,at(t.onUnregisteredClass,i(this,bt))))}};Et=new WeakMap,gt=new WeakMap,yt=new WeakMap,At=new WeakMap,bt=new WeakMap,re=new WeakSet,ei=function(t){window.HTMLElement.isPrototypeOf(t)?window.customElements.define(t.tag,t):i(this,At).call(this,t.name)},oe=new WeakSet,ii=function(t){t.name.indexOf("_")>0?(t.tag=_i(t.name),l(this,re,ei).call(this,t)):i(this,gt).call(this,t.name)},ae=new WeakSet,si=function(t,s,e){let n=null;try{n=window.document.querySelector(s)}catch(d){if(at(e.onBadTarget)(s)===!1)return}finally{n=n||window.document.body}let a=window.document.createElement(t.tag);at(e.onElementInstantiated)(a,s),n.appendChild(a)},he=new WeakSet,ni=function(t,s,e){let n=()=>l(this,ae,si).call(this,t,s,e);window.document.body?n():i(this,Et).call(this,n)},r(C,re),r(C,oe),r(C,ae),r(C,he),r(C,Et,jt),r(C,gt,jt),r(C,yt,jt),r(C,At,jt),r(C,bt,jt);var H,kt,ke,xt=class{constructor(){r(this,kt);r(this,H,new window.Object)}get length(){return l(this,kt,ke).call(this).length}key(t){return l(this,kt,ke).call(this)[t]||null}getItem(t){return i(this,H)[t]}setItem(t,s){i(this,H)[t]=s}removeItem(t){delete i(this,H)[t]}clear(){u(this,H,new window.Object)}hasItem(t){return i(this,H).hasOwnProperty(t)}};H=new WeakMap,kt=new WeakSet,ke=function(){return window.Object.keys(i(this,H))};var pe,oi,ri,ue,fe,Tt,le=o=>o>1e3?(o/1e3).toFixed(2)+"s":o.toFixed(2)+"ms",ce=class{constructor(){h(this,"round",0);h(this,"domTime",window.Number.MAX_SAFE_INTEGER);h(this,"renderTime",window.Number.MAX_SAFE_INTEGER)}getDebugInfo(){var t=new window.Object;return t.round=this.round,t.domTime=le(this.domTime),this.renderTime!==window.Number.MAX_SAFE_INTEGER&&(t.renderTime=le(this.renderTime)),t}},de=class{constructor(t){h(this,"name","");h(this,"rounds",0);h(this,"time",0);h(this,"average",0);this.name=t}compute(t){this.rounds++,this.time+=t,this.average=this.time/this.rounds}getDebugInfo(){let t=le(this.time),s=le(this.average);return{name:this.name,rounds:this.rounds,spent:t,average:s}}},L=class{static initialize(t){typeof t=="function"&&u(L,Tt,t),L.DOMUpdate.overall=new de("overall-dom-update"),L.BrowserRender.overall=new de("overall-browser-render")}},N=L;Tt=new WeakMap,r(N,Tt,()=>{}),h(N,"StopWatch",(ri=class{constructor(){r(this,pe);h(this,"_begin",0);h(this,"_end",{dom:0,render:0});h(this,"rounds",0);h(this,"last",new ce);h(this,"best",new ce);h(this,"averages",{dom:0,render:0})}start(){(L.DOMUpdate.check||L.BrowserRender.check)&&(this.last.round=++this.rounds,this._begin=performance.now())}stop(t){var s;L.DOMUpdate.check&&(this.best.domTime>(this.last.domTime=(this._end.dom=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.domTime=this.last.domTime),this.averages.dom=(this.averages.dom*(this.rounds-1)+this.last.domTime)/this.rounds,L.DOMUpdate.overall.compute(this.last.domTime)),L.BrowserRender.check?setTimeout(()=>l(this,pe,oi).bind(this)(t)):t&&i(s=L,Tt).call(s,this,"stop")}getDebugInfo(){return{rounds:this.rounds,last:this.last.getDebugInfo(),best:this.best.getDebugInfo(),averages:this.averages}}},pe=new WeakSet,oi=function(t){var s;this.best.renderTime>(this.last.renderTime=(this._end.render=performance.now())-this._begin)&&(this.best.round=this.last.round,this.best.renderTime=this.last.renderTime),this.averages.render=(this.averages.render*(this.rounds-1)+this.last.renderTime)/this.rounds,L.BrowserRender.overall.compute(this.last.renderTime),t&&i(s=L,Tt).call(s,this,"finish")},ri)),h(N,"DOMUpdate",(ue=class{},h(ue,"check",!0),h(ue,"overall",null),ue)),h(N,"BrowserRender",(fe=class{},h(fe,"check",!1),h(fe,"overall",null),fe));var O=class{static get TEMPLATES_KIND(){return"%templates%"}static get SLOTS_KIND(){return"%slots%"}static get TEXTNODE_TAG(){return"^text^"}static get DEFAULT_KIND(){return""}static get DEFAULT_TAG(){return"div"}static get DEFAULT_STYLE_MEDIA(){return"screen"}static get DEFAULT_STYLE_TYPE(){return"text/css"}static get DEFAULT_REPLACEMENT_OPEN(){return"~{"}static get DEFAULT_REPLACEMENT_CLOSE(){return"}~"}};var Bt,we,ht,Gt,Kt,{EMPTY_ARRAY:Fi,buildArray:Be,buildObject:$i,isNonEmptyString:ji,isOf:xi}=p,It=class{static initialize(t,s){this.begin=t,this.end=s}},W=It;h(W,"begin",null),h(W,"end",null),h(W,"enclose",t=>It.begin+t+It.end),h(W,"makeRegExp",()=>new window.RegExp("(?<="+It.begin+").*?(?="+It.end+")","gs"));var ki=["contents","classes","styles","attributes"],St=class{};h(St,"rules",(t,s)=>Be(e=>t.forEach(n=>n.replacements.forEach(a=>a.field===s&&e.push(n))))),h(St,"children",(t,s)=>Be(e=>{let n=a=>{let d=c=>c.forEach(A=>A.field===s&&e.push(a));ki.forEach(c=>d(a.replacements[c])),a.rules.forEach(c=>c.replacements.forEach(A=>A.field===s&&e.push(a)))};t.forEach(a=>a.rendering&&n(a))}));var v=class{static initialize(t){u(this,Bt,t)}},_=v;Bt=new WeakMap,we=new WeakMap,ht=new WeakMap,Gt=new WeakMap,Kt=new WeakMap,r(_,Bt,null),r(_,we,(t,s,e)=>t.push({at:s,field:e.trim(),find:W.enclose(e)})),r(_,ht,(t,s,e)=>ji(e)&&(e.match(i(v,Bt))||Fi).forEach(n=>{var a;return i(a=v,we).call(a,t,s,n)})),r(_,Gt,(t,s,e)=>{var n;t[s]=new window.Array,i(n=v,ht).call(n,t[s],s,e)}),r(_,Kt,(t,s,e)=>{t[s]=new window.Array,window.Object.keys(e).forEach(n=>{var a,d;i(a=v,ht).call(a,t[s],s,n),i(d=v,ht).call(d,t[s],s,e[n])})}),h(_,"child",t=>$i(s=>{var e,n,a,d;i(e=v,Gt).call(e,s,"contents",t.content),i(n=v,Gt).call(n,s,"classes",t.classes.join(" ")),i(a=v,Kt).call(a,s,"styles",t.style),i(d=v,Kt).call(d,s,"attributes",t.attributes),t.rules.forEach(c=>c.replacements=v.rule(c))})),h(_,"rule",t=>Be(s=>{var n;if(xi(t.nested,window.Array))return t.nested.map(a=>v.rule(a));var e="";for(let a in t.properties)e+=`${a}:${t.properties[a]};`;i(n=v,ht).call(n,s,"rules",e)}));var R=class{static initialize(t,s){W.initialize(t,s),_.initialize(W.makeRegExp())}};h(R,"extractReplacementsFromRule",_.rule),h(R,"extractReplacementsFromChild",_.child),h(R,"scanRulesForReplacements",St.rules),h(R,"scanChildrenForReplacements",St.children);var Ct,Nt,{noop:ai,ensureFunction:hi,isAssignedObject:Bi}=p,tt=class{static fetch(t){let s=window.document.getElementById(t);return s===null?i(this,Ct).call(this,t):s.tagName!=="TEMPLATE"?i(this,Nt).call(this,t):s.innerHTML}static initialize(t){Bi(t)&&(u(this,Ct,hi(t.onExtinctTemplate,i(this,Ct))),u(this,Nt,hi(t.onInvalidTemplate,i(this,Nt))))}};Ct=new WeakMap,Nt=new WeakMap,r(tt,Ct,ai),r(tt,Nt,ai);var Ot,{noop:Gi,isOf:Ki,hasObjectKeys:li,isNonEmptyString:ci,isNonEmptyArray:zi,isAssignedObject:Hi,ensureFunction:Wi}=p,{htmlEncode:di}=B,{TEMPLATES_KIND:Pi,TEXTNODE_TAG:Vi}=O,me=class{static initialize(t){Hi(t)&&u(this,Ot,Wi(t.onFetchTemplate,i(this,Ot)))}},y=me;Ot=new WeakMap,r(y,Ot,Gi),h(y,"cacheInvalidator",t=>t.cache=null),h(y,"renderingIncluder",t=>t.rendering=!0),h(y,"renderingExcluder",t=>t.rendering=!1),h(y,"renderRule",(t,s)=>{if(Ki(s.nested,window.Array))return`${s.selector}{${s.nested.map(n=>me.renderRule(t,n)).join(`
`)}}`;if(ci(s.selector)&&!s.nested){var e="";for(let n in s.properties)e+=`${n}:${s.properties[n]};`;return zi(s.replacements)&&s.replacements.forEach(n=>e=t(e,n)),`${s.selector}{${e}}`}return null}),h(y,"renderChild",(t,s)=>{var a;if(s.kind===Pi)return i(a=me,Ot).call(a,s.id);if(s.tag===Vi){var e=s.content;return s.replacements.contents.forEach(d=>e=t(e,d)),s.encode?di(e):e}var n=ci(s.id)?`<${s.tag} id='${s.id}'`:`<${s.tag}`;if(s.classes.length){var e=s.classes.join(" ");s.replacements.classes.forEach(c=>e=t(e,c)),n+=` class='${e}'`}if(li(s.style)){var e=" style='";for(let c in s.style)e+=c+": "+s.style[c]+"; ";e+="'",s.replacements.styles.forEach(c=>e=t(e,c)),n+=e}if(li(s.attributes)){var e="";for(let c in s.attributes)e+=` ${c}=${s.attributes[c]}`;s.replacements.attributes.forEach(c=>e=t(e,c)),n+=e}if(typeof s.content=="string"){var e=s.content;s.replacements.contents.forEach(c=>e=t(e,c)),n+=`>${s.encode?di(e):e}</${s.tag}>`}else n+="/>";return n});var zt,Ht,Wt,Pt,vt=class{constructor(t){h(this,"rounds",0);r(this,zt,0);r(this,Ht,null);r(this,Wt,!1);r(this,Pt,null);u(this,Pt,typeof t=="function"?t:()=>{})}compute(t){return this.rounds+=+u(this,Wt,i(this,zt)==u(this,Ht,i(this,Pt).call(this,t))),u(this,zt,i(this,Ht)),i(this,Wt)}};zt=new WeakMap,Ht=new WeakMap,Wt=new WeakMap,Pt=new WeakMap;var lt,G,et,Ee,ui,Dt=class{constructor(t,s){r(this,Ee);r(this,lt,null);r(this,G,null);r(this,et,null);if(t instanceof Node&&s instanceof Node)u(this,lt,t),u(this,G,s),u(this,et,s.cloneNode(!1));else throw new Error("[WUSE:ERROR] Wrong arguments supplied.")}get element(){return i(this,G)}affiliate(){i(this,lt).appendChild(i(this,G))}disaffiliate(){i(this,lt).removeChild(i(this,G))}promote(t){i(this,et).innerHTML=t,i(this,lt).replaceChild(i(this,et),i(this,G)),l(this,Ee,ui).call(this)}};lt=new WeakMap,G=new WeakMap,et=new WeakMap,Ee=new WeakSet,ui=function(){let t=i(this,et);u(this,et,i(this,G).cloneNode(!1)),u(this,G,t)};var ct,dt,ut=class{constructor(t){h(this,"owner",null);r(this,ct,!1);r(this,dt,"");this.owner=t}get invalidated(){return i(this,ct)}reset(t){u(this,ct,!1),u(this,dt,t)}append(t){u(this,dt,i(this,dt)+t)}verify(t){u(this,ct,t(i(this,dt)))}process(){i(this,ct)&&this.on_content_invalidation(i(this,dt))}on_content_invalidation(t){}};ct=new WeakMap,dt=new WeakMap;var Lt,ge,{isOf:Ge,cloneObject:fi,forEachOwnProperty:pi,buildArray:Ji}=p,ft=class extends window.Array{constructor(s){super();r(this,Lt);h(this,"owner",null);h(this,"last",null);h(this,"version",0);this.owner=s}append(s){Ge(s,window.Object)&&(this.push(s),l(this,Lt,ge).call(this,s))}prepend(s){Ge(s,window.Object)&&(this.unshift(s),l(this,Lt,ge).call(this,s))}replace(s,e){s>-1&&Ge(e,window.Object)&&l(this,Lt,ge).call(this,this[s]=e)}on_version_change(){}persist(){return Ji(s=>pi(this,e=>{switch(e){case"owner":case"last":case"length":break;case"version":s[e]=this[e];break;default:if(window.Number.isInteger(Number(e))){let n=fi(this[e]);n.cache&&(n.cache=null),s.push(n)}break}}))}restore(s){pi(s,e=>{switch(e){case"length":break;case"version":this[e]=s[e];break;default:if(window.Number.isInteger(Number(e))){let n=fi(s[e]);n.cache&&(n.cache=null),this.push(n)}break}})}};Lt=new WeakSet,ge=function(s){this.last=s,this.version++,this.on_version_change()};var be,gi,Te,yi,Se,Ai,Ie,bi,Ce,Ti,Rt,Ae,Ne,Si,{EMPTY_ARRAY:Yi,buildArray:Fs,buildObject:Xi,isOf:it,hasObjectKeys:wi,isNonEmptyString:ye,forcedStringSplit:qi}=p,{DEFAULT_TAG:Qi,DEFAULT_KIND:Zi,TEMPLATES_KIND:Ke,SLOTS_KIND:ze}=O,P=class{static parse(t){if(ye(t)){let s=mi();return t.charAt(0)==="%"?t.startsWith(Ke)?l(this,Rt,Ae).call(this,s,t.replace(s.kind=Ke,"")):t.startsWith(ze)?l(this,Rt,Ae).call(this,s,t.replace(s.kind=ze,"")):null:l(this,Rt,Ae).call(this,s,t)}return null}};be=new WeakSet,gi=function(t,s){let e=s.indexOf("["),n=s.indexOf("]");if(e>-1&&n>-1&&n>e){let a=s.substr(e,n-e+1),d=a.substr(1,a.length-2).split("|");for(let c in d){let A=d[c].split("=");A[0]==="style"?A[1].split(";").forEach($=>{let j=$.split(":"),qe=j[0].trim();qe.length&&(t.style[qe]=j[1].trim())}):t.attributes[A[0]]=A[1]}return s.replace(a,"")}return s},Te=new WeakSet,yi=function(t,s){let e=s.indexOf("=");return e>-1?(t.content=s.slice(e+1),!!t.content.length&&t.content.charAt(0)==="&"&&(t.content=t.content.slice(1),t.encode=!!t.content.length&&t.content.charAt(0)!=="&"),s.slice(0,e)):s},Se=new WeakSet,Ai=function(t,s){let e=s.replaceAll("!"," ").split(" ");return e.slice(1).map(n=>{let[a,...d]=n.toLowerCase().split("+"),c=(d||Yi).indexOf("capture")>-1;t.events.push(Ei(a,c))}),e[0]},Ie=new WeakSet,bi=function(t,s){let e=s.replaceAll("."," ").split(" ");return t.classes=e.slice(1),e[0]},Ce=new WeakSet,Ti=function(t,s){if(s!==""){let e=s.indexOf("#");e===-1?t.tag=s:(e>0&&(t.tag=s.substr(0,e)),t.id=s.substr(e+1))}return t},Rt=new WeakSet,Ae=function(t,s){return l(this,Ce,Ti).call(this,t,l(this,Ie,bi).call(this,t,l(this,Se,Ai).call(this,t,l(this,Te,yi).call(this,t,l(this,be,gi).call(this,t,s)))))},r(P,be),r(P,Te),r(P,Se),r(P,Ie),r(P,Ce),r(P,Rt);var Vt=class{static parse(t){return Xi(s=>(it(t,window.Array)?t:qi(t,`
`).map(e=>e.trim()).join("").split(";")).forEach(e=>ye(e)&&l(this,Ne,Si).call(this,s,e.trim())))}};Ne=new WeakSet,Si=function(t,s){if(!!s.length&&s.indexOf(":")>-1){let[e,...n]=s.split(":"),a=e.trim();if(a.length){let d=n.join(":").trim();t[a]=d.endsWith(";")?d.slice(0,-1):d}}},r(Vt,Ne);var mi=()=>({kind:Zi,tag:Qi,id:"",classes:new window.Array,attributes:new window.Object,style:new window.Object,events:new window.Array,content:"",encode:!1}),Ei=(o,t)=>typeof o=="string"&&typeof t=="boolean"?{kind:o,capture:t}:null,ts=(o,t)=>{let s=P.parse(o.trimLeft());return s?(s.rules=it(t,window.Array)?t:new window.Array,s.rendering=!0,s.cache=null,s):g.INVALID_DEFINITION.emit(o)},es=o=>{if(o.kind===Ke){if(!window.document.getElementById(o.id))return g.INEXISTENT_TEMPLATE.emit(o.id)}else if(o.kind===ze){if(new String(o.attributes.slot).replaceAll('"',"").replaceAll("'","").length===0)return g.UNESPECIFIED_SLOT.emit(o.id)}else if(typeof o.id!="string"||o.id!==""&&window.document.getElementById(o.id)!==null)return g.INVALID_ID.emit(o.id);return o},is=o=>{let t=window.document.createElement(o.tag);if(o.id.length&&t.setAttribute("id",o.id),o.classes.length&&t.setAttribute("class",o.classes.join(" ")),wi(o.style)){var s="";for(let e in o.style)s+=e+": "+o.style[e]+"; ";if(s.length){let e=s.trim();t.setAttribute("style",e.endsWith(";")?e.slice(0,-1):e)}}if(wi(o.attributes))for(let e in o.attributes)t.setAttribute(e,o.attributes[e]);return t},ss=(o,t)=>{let s=window.document.createElement("style");return ye(o)&&s.setAttribute("media",o),ye(t)&&s.setAttribute("type",t),s.appendChild(window.document.createTextNode("")),s},ns=(o,t)=>{let s=it(o,window.Array)?o.join(","):""+o;return s.length?{selector:s,properties:it(t,window.Object)?t:Vt.parse(t),cache:null}:null},rs=(o,t,s)=>{let e=it(o,window.Array)?o.join(","):""+o,n=it(t,window.Array)?t.join(","):""+t;return!e.length||!n.length?null:{selector:e,nested:[{selector:n,properties:it(s,window.Object)?s:Vt.parse(s)}],cache:null}},os=(o,t)=>{if(o.selector===t.selector){for(let s in t.properties)o.properties[s]=t.properties[s];return o.cache=null,!0}return!1},as=(o,t)=>it(o.nested,window.Array)&&o.selector===t.selector?(t.nested.forEach(s=>{var e=!1;for(let n in o.nested)if(e=o.nested[n].selector===s.selector){for(let a in s.properties)o.nested[n].properties[a]=s.properties[a];break}e||o.nested.push(s)}),o.cache=null,!0):!1,w=class{};h(w,"makeStyleNode",ss),h(w,"newRule",ns),h(w,"newNestedRule",rs),h(w,"tryToJoinRules",os),h(w,"tryToJoinNestedRules",as),h(w,"performValidations",es),h(w,"makeMainNode",is),h(w,"newChild",ts),h(w,"newDefinition",mi),h(w,"newEvent",Ei);var st,x,T,b,K,E,Mt,V,J,nt,z,Y,Jt,wt,X,rt,U,q,Q,m,_t,Yt,mt,k,Z,pt,ve,Ii,De,Ci,Le,Ni,Re,Oi,ot,Ut,Xt,He,qt,We,Qt,Pe,Ue,vi,Zt,Ve,Me,Di,te,Je,_e,Li,D,F,ee,Ye,Ft,Fe,Ri,$t,Oe,ie,Xe,$e,M,f=class{static get VERSION(){return"0.4.1"}static blockUpdate(t,s){if(p.isOf(t,Function)){f.DEBUG&&f.debug("blocking"),f.RENDERING=!1;try{t(s)}catch(e){throw e}finally{f.RENDERING=!0,f.DEBUG&&f.debug("unblocking")}}}static debug(t){window.console.log("[WUSE:DEBUG]",t)}static register(t){return C.registerClasses(p.isOf(t,window.Array)?t:new window.Array(t))}static instantiate(t,s,e){return C.instantiateClasses(p.isOf(t,window.Array)?t:new window.Array(t),s,e)}static isShadowElement(t){let s=window.Object.getPrototypeOf(t.constructor);return s===f.OpenShadowElement||s===f.ClosedShadowElement}static get elementCount(){return i(f,M).instancesCount}static makeReactiveField(t,s,e,n,a){let d=($,j)=>window.Object.defineProperty(t,s,{get:$,set:j,enumerable:!0,configurable:!0}),c=()=>delete t[s],A=($,j)=>f.makeReactiveField(t,s,$,j,a);d(()=>e,$=>{A($,n),p.isOf(n,window.Function)?n({renderize:j=>a(s,j),automate:()=>A($,null),freeze:()=>d(()=>$,j=>{}),defreeze:()=>A($,n),dereact:()=>d(()=>$,j=>{c(),t[s]=j}),remove:()=>c()}):a(s)})}},I=f;$e=new WeakMap,M=new WeakMap,h(I,"WebHelpers",B),h(I,"JsHelpers",p),h(I,"PerformanceMeasurement",N),h(I,"tmp",new window.Object),h(I,"DEBUG",!1),h(I,"FATALS",!1),h(I,"MEASURE",!1),h(I,"RENDERING",!0),r(I,$e,new xt),h(I,"hashRoutine",t=>{var s=0;for(let e=0;e<t.length;e++)s=(s=(s<<5)-s+t.charCodeAt(e))&s;return s}),r(I,M,(st=class extends window.HTMLElement{constructor(e){super();r(this,Z);r(this,ve);r(this,De);r(this,Le);r(this,Re);r(this,ot);r(this,Xt);r(this,qt);r(this,Qt);r(this,Ue);r(this,Zt);r(this,Me);r(this,te);r(this,_e);r(this,D);r(this,ee);r(this,Fe);r(this,$t);r(this,ie);r(this,x,"");r(this,T,new class extends ft{on_version_change(){var e;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromRule(this.last),f.DEBUG&&l(e=this.owner,Z,pt).call(e,`rules list version change: ${this.version}`)}}(this));r(this,b,new class extends ft{on_version_change(){var e,n;this.last.version=this.version,this.last.replacements=R.extractReplacementsFromChild(this.last),u(e=this.owner,J,i(e,J)|this.last.kind===O.SLOTS_KIND),f.DEBUG&&l(n=this.owner,Z,pt).call(n,`children list version change: ${this.version}`)}}(this));r(this,K,new class extends ft{on_version_change(){var e;f.DEBUG&&l(e=this.owner,Z,pt).call(e,`fields list version change: ${this.version}`)}snapshot(){this.forEach(e=>e.value=this.owner[e.name])}recall(){this.forEach(e=>this.owner[e.name]=e.value)}}(this));r(this,E,{mainDefinition:w.newDefinition(),styleMedia:O.DEFAULT_STYLE_MEDIA,styleType:O.DEFAULT_STYLE_TYPE,rawContent:!1,attributeKeys:!1,elementKeys:!0});r(this,Mt,new window.Object);r(this,V,!1);r(this,J,!1);r(this,nt,void 0);r(this,z,void 0);r(this,Y,null);r(this,Jt,f.isShadowElement(this));r(this,wt,!1);r(this,X,!1);r(this,rt,i(f,$e));r(this,U,null);r(this,q,"");r(this,Q,!1);r(this,m,{root:new class extends ut{on_content_invalidation(e){this.owner.innerHTML=e}}(this),style:new class extends ut{on_content_invalidation(e){i(this.owner,z).promote(e)}}(this),main:new class extends ut{on_content_invalidation(e){i(this.owner,nt).promote(e)}}(this),renderizers:{rule:e=>i(this,m).style.append(e.cache?e.cache:e.cache=y.renderRule(i(this,_t),e)),children:{mixed:e=>i(this,Jt)&&e.kind===O.SLOTS_KIND?i(this,m).renderizers.children.slot(e):i(this,m).renderizers.children.normal(e),slot:e=>{e.cache||(i(this,m).root.verify(n=>!0),i(this,m).root.append(e.cache=y.renderChild(i(this,_t),e)))},normal:e=>{i(this,m).main.append(e.cache?e.cache:e.cache=y.renderChild(i(this,_t),e)),e.rules.forEach(i(this,m).renderizers.rule)}}},gotModified:()=>i(this,m).root.invalidated||i(this,m).main.invalidated||i(this,m).style.invalidated,getDebugInfo:()=>`updated (root: ${i(this,m).root.invalidated}, main: ${i(this,m).main.invalidated}, style: ${i(this,m).style.invalidated})`});r(this,_t,(e,n)=>e.replace(n.find,this[n.field]!==void 0?this[n.field]:""));r(this,Yt,{bind:{key:()=>{let e=n=>{p.isNonEmptyString(n)&&(this[n]=l(this,Xt,He).call(this,n))};return i(this,V)&&e(i(this,E).mainDefinition.id),n=>e(n.id)},event:"addEventListener"},unbind:{key:()=>{let e=n=>delete this[n];return i(this,V)&&e(i(this,E).mainDefinition.id),n=>e(n.id)},event:"removeEventListener"}});r(this,mt,{main:new vt(f.hashRoutine),style:new vt(f.hashRoutine)});r(this,k,{attachment:new N.StopWatch,partial:new N.StopWatch,full:new N.StopWatch,dettachment:new N.StopWatch});r(this,Ft,()=>i(f,M).EVENT_NAMES.forEach(e=>i(this,Mt)[e]=typeof this[e]=="function"));h(this,"info",{instanceNumber:++i(f,M).instancesCount,unmodifiedRounds:0,updatedRounds:0});u(this,Y,e!==i(f,M).RootMode.REGULAR?this.attachShadow({mode:e}):this),i(this,Ft).call(this),l(this,D,F).call(this,"on_create"),i(this,E).attributeKeys&&this.getAttributeNames().forEach(n=>this[n]=this.getAttribute(n)),l(this,Fe,Ri).call(this)&&i(this,U).generation>1?l(this,D,F).call(this,"on_reconstruct",i(this,U)):l(this,D,F).call(this,"on_construct")}static get EVENT_NAMES(){return["on_create","on_construct","on_reconstruct","on_connect","on_inject","on_load","on_prerender","on_update","on_postrender","on_refresh","on_unload","on_reload","on_repaint","on_disconnect"]}get render(){return i(this,X)?l(this,Ue,vi):p.noop}get redraw(){return i(this,X)?l(this,Me,Di):p.noop}connectedCallback(){f.MEASURE&&i(this,k).attachment.start(),i(this,Ft).call(this),l(this,D,F).call(this,"on_connect"),l(this,Zt,Ve).call(this,"on_load"),i(this,Q)&&this.persistToElementsStore(),f.MEASURE&&i(this,k).attachment.stop(f.DEBUG)}disconnectedCallback(){f.MEASURE&&i(this,k).dettachment.start(),l(this,ot,Ut).call(this,!1),l(this,D,F).call(this,"on_disconnect"),f.MEASURE&&i(this,k).dettachment.stop(f.DEBUG)}getElementsStore(){return i(this,rt)}setElementsStore(e){u(this,rt,e)}hasElementsStoreKey(e){return i(this,Q)}getElementsStoreKey(e){return i(this,q)}setElementsStoreKey(e){return u(this,Q,p.isNonEmptyString(u(this,q,e))),this}persistToElementsStore(){if(l(this,ie,Xe).call(this)){let e=i(this,U);if(e)return i(this,K).snapshot(),e.data=new window.Object({options:i(this,E),html:i(this,x),children:i(this,b).persist(),rules:i(this,T).persist(),fields:i(this,K).persist(),slotted:i(this,J),identified:i(this,V)}),l(this,$t,Oe).call(this),!0}return!1}restoreFromElementsStore(e){if(l(this,ie,Xe).call(this)){let n=i(this,U);if(n&&n.persisted&&n.data)return u(this,E,n.data.options),u(this,J,n.data.slotted),u(this,V,n.data.identified),u(this,x,n.data.html),i(this,b).restore(n.data.children),i(this,b).owner=this,i(this,T).restore(n.data.rules),i(this,T).owner=this,i(this,K).restore(n.data.fields),i(this,K).owner=this,i(this,K).recall(),e||(delete n.data,l(this,$t,Oe).call(this)),!0}return!1}selectChildElement(e){return i(this,Y).querySelector(e)}setMainAttribute(e,n){i(this,wt)&&i(this,nt).element.setAttribute(e,n)}setMainElement(e){let n=w.newChild(e);if(w.performValidations(n)){if(n.content!==""||!!n.events.length)return g.INVALID_DEFINITION.emit(e);u(this,V,!!n.id.length)&&(i(this,E).mainDefinition.id=n.id),n.tag.length&&(i(this,E).mainDefinition.tag=n.tag),n.classes.length&&(i(this,E).mainDefinition.classes=n.classes),n.style&&(i(this,E).mainDefinition.style=n.style),n.attributes&&(i(this,E).mainDefinition.attributes=n.attributes)}return this}setStyleOptions(e,n){return i(this,E).styleMedia=e||"",i(this,E).styleType=n||"",this}setElementsAsKeys(e){return i(this,E).elementKeys=!!e,this}setAttributesAsKeys(e){return i(this,E).attributeKeys=!!e,this}allowRawContent(e){return i(this,E).rawContent=!!e,this}setRawContent(e){return i(this,E).rawContent?u(this,x,e):g.ALLOW_HTML.emit(),this}appendRawContent(e){return i(this,E).rawContent?u(this,x,i(this,x)+e):g.ALLOW_HTML.emit(),this}prependRawContent(e){return i(this,E).rawContent?u(this,x,e+i(this,x)):g.ALLOW_HTML.emit(),this}appendCSSRule(e,n,a){if(a)return this.appendCSSNestedRule(e,n,a);let d=i(this,T).slice(-1),c=w.newRule(e,n);return(!d.length||!w.tryToJoinRules(d[0],c))&&i(this,T).append(c),this}prependCSSRule(e,n,a){if(a)return this.prependCSSNestedRule(e,n,a);let d=i(this,T).slice(0,1),c=w.newRule(e,n);return(!d.length||!w.tryToJoinRules(d[0],c))&&i(this,T).prepend(c),this}appendCSSNestedRule(e,n,a){let d=i(this,T).slice(-1),c=w.newNestedRule(e,n,a);return(!d.length||!w.tryToJoinNestedRules(d[0],c))&&i(this,T).append(c),this}prependCSSNestedRule(e,n,a){let d=i(this,T).slice(0,1),c=w.newNestedRule(e,n,a);return(!d.length||!w.tryToJoinNestedRules(d[0],c))&&i(this,T).prepend(c),this}appendChildElement(e,n){return i(this,b).append(w.performValidations(w.newChild(e,n))),this}prependChildElement(e,n){return i(this,b).prepend(w.performValidations(w.newChild(e,n))),this}replaceChildElement(e,n){return i(this,b).replace(i(this,b).findIndex(a=>a.id===e),w.newChild(n)),this}appendChildElements(e){return(p.isOf(e,window.Array)?e:p.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.appendChildElement(n)),this}prependChildElements(e){return(p.isOf(e,window.Array)?e:p.forcedStringSplit(e,`
`)).forEach(n=>typeof n=="string"&&!!n.trim().length&&this.prependChildElement(n)),this}checkChildElementIsIncludedById(e,n,a){let d=c=>p.isOf(c,window.Function)?c():void 0;return i(this,b).some(c=>c.id===e&&c.rendering)?d(n):d(a),this}includeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingIncluder(n)),this}excludeChildElementById(e){return i(this,b).forEach(n=>n.id===e&&y.renderingExcluder(n)),this}invalidateChildElementsById(e){return i(this,b).forEach(n=>e.indexOf(n.id)>-1&&y.cacheInvalidator(n)),this}invalidateChildElements(e){return p.isOf(e,window.Array)&&e.forEach(y.cacheInvalidator),this}makeField(e,n){return this[e]=n,i(this,K).append({name:e,value:n}),this}makeReactiveField(e,n,a,d=!0){return l(this,_e,Li).call(this,e,n,a,d)}makeExternalReactiveField(e,n,a,d,c=!0){return this.makeReactiveField(n,e[n]||a,A=>{e[n]=this[n],d(A)},c)}},x=new WeakMap,T=new WeakMap,b=new WeakMap,K=new WeakMap,E=new WeakMap,Mt=new WeakMap,V=new WeakMap,J=new WeakMap,nt=new WeakMap,z=new WeakMap,Y=new WeakMap,Jt=new WeakMap,wt=new WeakMap,X=new WeakMap,rt=new WeakMap,U=new WeakMap,q=new WeakMap,Q=new WeakMap,m=new WeakMap,_t=new WeakMap,Yt=new WeakMap,mt=new WeakMap,k=new WeakMap,Z=new WeakSet,pt=function(e){i(this,V)&&f.debug(`#${i(this,E).mainDefinition.id} (${this.info.instanceNumber}) | ${typeof e=="string"?e:JSON.stringify(e)}`)},ve=new WeakSet,Ii=function(){i(this,z)&&i(this,z).affiliate(),i(this,nt).affiliate(),u(this,wt,!0)},De=new WeakSet,Ci=function(){u(this,z,i(this,T).length?new Dt(i(this,Y),w.makeStyleNode(i(this,E).styleMedia,i(this,E).styleType)):null),u(this,nt,new Dt(i(this,Y),w.makeMainNode(i(this,E).mainDefinition))),i(this,b).forEach(y.cacheInvalidator),i(this,T).forEach(y.cacheInvalidator)},Le=new WeakSet,Ni=function(){i(this,wt)&&(i(this,nt).disaffiliate(),i(this,z)&&i(this,z).disaffiliate(),i(this,J)&&i(this,Jt)&&B.removeChildren(this)),u(this,wt,!1)},Re=new WeakSet,Oi=function(e){return{key:i(this,E).elementKeys&&e.key(),event:(n,a,d)=>{let c=this[`on_${n}_${a}`];if(c){let A=l(this,Xt,He).call(this,n);A&&A[e.event](a,c,d)}},slots:()=>this.on_slot_change&&i(this,Y).querySelectorAll("slot").forEach(n=>n[e.event]("slotchange",this.on_slot_change))}},ot=new WeakSet,Ut=function(e){if(i(this,X)&&!e||!i(this,X)&&e){let n=l(this,Re,Oi).call(this,e?i(this,Yt).bind:i(this,Yt).unbind);i(this,b).forEach(a=>{!a.rendering&&e||(n.key&&n.key(a),a.events.forEach(d=>d&&n.event(a.id,d.kind,d.capture)))}),i(this,J)&&n.slots(),u(this,X,e)}},Xt=new WeakSet,He=function(e){return p.isNonEmptyString(e)?i(this,Y).querySelector(`#${e}`):void 0},qt=new WeakSet,We=function(){i(this,m).root.reset(""),i(this,m).style.reset(""),i(this,m).main.reset(i(this,x));let e=i(this,J)?i(this,m).renderizers.children.mixed:i(this,m).renderizers.children.normal;i(this,b).forEach(n=>n.rendering&&e(n)),i(this,T).forEach(i(this,m).renderizers.rule),i(this,m).main.verify(n=>!i(this,mt).main.compute(n)),i(this,m).style.verify(n=>!i(this,mt).style.compute(n))},Qt=new WeakSet,Pe=function(){i(this,m).root.process(),i(this,m).style.process(),i(this,m).main.process(),f.DEBUG&&l(this,Z,pt).call(this,i(this,m).getDebugInfo())},Ue=new WeakSet,vi=function(){!f.RENDERING||(f.MEASURE&&i(this,k).partial.start(),l(this,D,F).call(this,"on_prerender"),l(this,qt,We).call(this),i(this,m).gotModified()?(l(this,ot,Ut).call(this,!1),l(this,Qt,Pe).call(this),l(this,ot,Ut).call(this,!0),this.info.updatedRounds++,l(this,D,F).call(this,"on_update"),l(this,ee,Ye).call(this,"on_refresh")):this.info.unmodifiedRounds++,f.DEBUG&&l(this,Z,pt).call(this,`unmodified: ${this.info.unmodifiedRounds} (main: ${i(this,mt).main.rounds}, style: ${i(this,mt).style.rounds}) | updated: ${this.info.updatedRounds}`),l(this,D,F).call(this,"on_postrender"),f.MEASURE&&i(this,k).partial.stop(f.DEBUG))},Zt=new WeakSet,Ve=function(e){l(this,De,Ci).call(this),l(this,ve,Ii).call(this),l(this,D,F).call(this,"on_inject"),l(this,qt,We).call(this),i(this,m).style.verify(n=>!!i(this,z)),l(this,Qt,Pe).call(this),l(this,ot,Ut).call(this,!0),l(this,D,F).call(this,e)},Me=new WeakSet,Di=function(){f.MEASURE&&i(this,k).full.start(),l(this,ot,Ut).call(this,!1),l(this,Le,Ni).call(this),l(this,D,F).call(this,"on_unload"),i(this,Ft).call(this),l(this,Zt,Ve).call(this,"on_reload"),l(this,ee,Ye).call(this,"on_repaint"),f.MEASURE&&i(this,k).full.stop(f.DEBUG)},te=new WeakSet,Je=function(e,n="$none"){if(i(this,X)){let a=R.scanRulesForReplacements(i(this,T),e);a.forEach(y.cacheInvalidator);let d=R.scanChildrenForReplacements(i(this,b),e);d.forEach(y.cacheInvalidator),f.DEBUG&&l(this,Z,pt).call(this,`reactive render (label: ${n}, field: ${e}, children: ${d.length}, rules: ${a.length})`),(!!a.length||!!d.length)&&(d.some(c=>!!c.kind.length)&&i(this,b).forEach(c=>c.kind===O.SLOTS_KIND?y.cacheInvalidator(c):void 0),this.render())}},_e=new WeakSet,Li=function(e,n,a,d=!0){return f.makeReactiveField(this,e,n,a,(c,A)=>l(this,te,Je).call(this,c,A||"$auto")),i(this,K).append({name:e,value:n}),d&&l(this,te,Je).call(this,e,"$init"),this},D=new WeakSet,F=function(e,n){i(this,Mt)[e]&&this[e].call(this,n)},ee=new WeakSet,Ye=function(e,n){i(this,Q)&&this.persistToElementsStore(),i(this,Mt)[e]&&window.requestAnimationFrame(()=>this[e].call(this,n))},Ft=new WeakMap,Fe=new WeakSet,Ri=function(){return i(this,Q)?(u(this,U,i(this,rt).hasItem(i(this,q))?i(this,rt).getItem(i(this,q)):{generation:0,persisted:!1}),i(this,U).generation++,l(this,$t,Oe).call(this),!0):!1},$t=new WeakSet,Oe=function(){f.DEBUG&&(i(this,U).key=i(this,q)),i(this,U).persisted=!!i(this,U).data,i(this,rt).setItem(i(this,q),i(this,U))},ie=new WeakSet,Xe=function(){return i(this,Q)?!0:(g.INVALID_KEY.emit(),!1)},h(st,"RootMode",class{static get REGULAR(){return"regular"}static get OPEN(){return"open"}static get CLOSED(){return"closed"}}),h(st,"specializeClass",e=>class extends st{constructor(){super(e)}}),h(st,"instancesCount",0),st)),h(I,"NonShadowElement",i(f,M).specializeClass(i(f,M).RootMode.REGULAR)),h(I,"OpenShadowElement",i(f,M).specializeClass(i(f,M).RootMode.OPEN)),h(I,"ClosedShadowElement",i(f,M).specializeClass(i(f,M).RootMode.CLOSED)),(()=>{let t=(s,e)=>!s&&g.UNSUPPORTED_FEATURE.emit(e);try{t(p.isOf(window.document,window.HTMLDocument),"HTML Document"),t(p.isOf(window.customElements,window.CustomElementRegistry),"Custom Elements"),B.onDOMContentLoaded(()=>t(p.isOf(window.document.body.attachShadow,window.Function),"Shadow DOM"))}catch(s){g.UNKNOWN_ERROR.emit()}N.initialize((s,e)=>f.debug(JSON.stringify(p.buildArray(n=>{switch(n.push({instances:f.elementCount}),n.push(s.getDebugInfo()),e){case"stop":n.push(N.DOMUpdate.overall.getDebugInfo());break;case"finish":n.push(N.BrowserRender.overall.getDebugInfo());break}})))),C.initialize({onMisnamedClass:g.MISNAMED_CLASS.emit,onUnregistrableClass:g.UNREGISTRABLE_CLASS.emit,onUnregisteredClass:g.UNREGISTERED_CLASS.emit,onInvalidClass:g.INVALID_CLASS.emit,onDeferredInstantiation:B.onDOMContentLoaded}),tt.initialize({onExtinctTemplate:g.EXTINCT_TEMPLATE.emit,onInvalidTemplate:g.INVALID_TEMPLATE.emit}),y.initialize({onFetchTemplate:tt.fetch}),R.initialize(O.DEFAULT_REPLACEMENT_OPEN,O.DEFAULT_REPLACEMENT_CLOSE)})(),window.Wuse=I;})();
